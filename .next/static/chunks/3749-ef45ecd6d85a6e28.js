"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3749],{25193:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(57437);r(2265);var a=r(38616),d=r(87530);function o(e){let{children:t,maxWidth:r=d.H.pageMaxWidth,style:o}=e,i=a.default.useBreakpoint().md?d.H.pagePaddingXDesktop:d.H.pagePaddingXMobile;return(0,n.jsx)("div",{style:{width:"100%",maxWidth:r,margin:"0 auto",padding:"".concat(d.H.pagePaddingY,"px ").concat(i,"px"),...o},children:t})}},20148:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(57437);r(2265);var a=r(17588),d=r(2651),o=r(38616),i=r(10868),l=r(50742),s=r(39486),u=r(87530);function c(e){let{title:t,subtitle:r,icon:c,onBack:p,actions:f,style:g}=e,{token:h}=d.default.useToken(),x=o.default.useBreakpoint().md?u.H.pagePaddingXDesktop:u.H.pagePaddingXMobile;return(0,n.jsx)("div",{style:{padding:"".concat(u.H.pagePaddingY,"px ").concat(x,"px"),background:h.colorBgContainer,borderBottom:"1px solid ".concat(h.colorBorderSecondary),...g},children:(0,n.jsxs)(i.Z,{align:"center",justify:"space-between",wrap:"wrap",gap:12,style:{maxWidth:u.H.pageMaxWidth,margin:"0 auto"},children:[(0,n.jsxs)(i.Z,{align:"center",gap:12,style:{minWidth:0},children:[p&&(0,n.jsx)(l.ZP,{type:"text","aria-label":"ย้อนกลับ",icon:(0,n.jsx)(a.Z,{}),onClick:p,style:{borderRadius:12,width:44,height:44}}),c&&(0,n.jsx)("div",{style:{width:44,height:44,borderRadius:14,display:"grid",placeItems:"center",background:h.colorFillTertiary,color:h.colorText},children:c}),(0,n.jsxs)("div",{style:{minWidth:0},children:[(0,n.jsx)(s.default.Title,{level:4,style:{margin:0},children:t}),r&&(0,n.jsx)(s.default.Text,{type:"secondary",children:r})]})]}),f&&(0,n.jsx)(i.Z,{gap:8,wrap:"wrap",children:f})]})})}},37410:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(57437);r(2265);var a=r(2651),d=r(96931),o=r(10868),i=r(39486),l=r(87530);function s(e){let{title:t,extra:r,children:s,style:u}=e,{token:c}=a.default.useToken();return(0,n.jsx)(d.Z,{size:"small",variant:"outlined",style:{borderRadius:l.H.cardRadiusLG,...u},styles:{header:t?{borderBottomColor:c.colorBorderSecondary}:{display:"none"}},title:t?(0,n.jsxs)(o.Z,{align:"center",justify:"space-between",gap:12,children:[(0,n.jsx)(i.default.Text,{strong:!0,children:t}),r]}):void 0,children:s})}},27623:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(57437);r(2265);var a=r(10868),d=r(87530);function o(e){let{children:t,gap:r=d.H.sectionGap,style:o}=e;return(0,n.jsx)(a.Z,{vertical:!0,gap:r,style:o,children:t})}},2786:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(57437);r(2265);var a=r(96931),d=r(85180),o=r(39486),i=r(87530);function l(e){let{title:t="ไม่มีข้อมูล",description:r,action:l,image:s}=e;return(0,n.jsx)(a.Z,{size:"small",variant:"outlined",style:{borderRadius:i.H.cardRadiusLG},bodyStyle:{padding:20},children:(0,n.jsx)(d.Z,{image:s,description:(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,n.jsx)(o.default.Text,{strong:!0,children:t}),r?(0,n.jsx)(o.default.Text,{type:"secondary",children:r}):null]}),children:l})})}},87530:function(e,t,r){r.d(t,{H:function(){return n}});let n={pageMaxWidth:1200,pagePaddingXMobile:16,pagePaddingXDesktop:24,pagePaddingY:16,sectionGap:16,cardRadius:16,cardRadiusLG:20,cardShadow:"0 10px 24px rgba(15, 23, 42, 0.08)",surfaceBg:"#ffffff",surfaceBorder:"#e2e8f0"}},14362:function(e,t,r){r.d(t,{AuthProvider:function(){return p},a:function(){return f}});var n=r(57437),a=r(2265),d=r(99376),o=r(5447),i=r(84859),l=r(48651),s=r(3369),u=r(36799);let c=(0,a.createContext)(void 0),p=e=>{let{children:t}=e,[r,p]=(0,a.useState)(null),[f,g]=(0,a.useState)(!0),h=(0,d.useRouter)(),x=(0,d.usePathname)(),y=async()=>{try{let e=await o.O.getMe();p(e)}catch(e){p(null)}finally{g(!1)}};(0,a.useEffect)(()=>{y()},[]);let{showLoading:m,hideLoading:b}=(0,s.x)();(0,a.useEffect)(()=>{f||r||"/login"===x||h.push("/login")},[r,f,x,h]);let v=async e=>{try{m((0,u.t)("auth.loadingLogin"));let t=await o.O.getCsrfToken(),{token:r,...n}=await o.O.login(e,t);p(n),h.push("/")}catch(e){throw e}finally{b()}},k=async()=>{try{m((0,u.t)("auth.loadingLogout")),await o.O.logout(),i.x.clearQueue(),p(null),h.push("/login")}catch(e){console.error("Logout error:",e)}finally{b()}};return f?(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"#ffffff"},children:(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",padding:"24px",background:"#ffffff",borderRadius:"20px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:[(0,n.jsx)(l.Z,{size:"large"}),(0,n.jsx)("div",{style:{color:"#64748b",fontSize:"14px",fontWeight:500},children:"กำลังตรวจสอบสิทธิ์..."})]})}):r||"/login"===x?(0,n.jsx)(c.Provider,{value:{user:r,loading:f,login:v,logout:k,checkAuth:y},children:t}):null},f=()=>{let e=(0,a.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},46252:function(e,t,r){r.d(t,{J:function(){return l},SocketProvider:function(){return s}});var n=r(57437),a=r(2265),d=r(68680),o=r(34029),i=r(14362);let l=(0,a.createContext)({socket:null,isConnected:!1}),s=e=>{let{children:t}=e,[r,s]=(0,a.useState)(null),[u,c]=(0,a.useState)(!1),p=(0,a.useRef)(!1),{user:f}=(0,i.a)();return(0,a.useEffect)(()=>{var e;if(!f){r&&(r.disconnect(),s(null),c(!1));return}let t=(null===(e=f.branch)||void 0===e?void 0:e.id)||f.branch_id||null,n=(0,d.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:{userId:f.id,branchId:t},reconnection:!0,reconnectionAttempts:5,reconnectionDelay:800,reconnectionDelayMax:8e3});return n.on("connect",()=>{console.log("Socket Connected:",n.id),c(!0),p.current=!1,o.ZP.success({content:"เชื่อมต่อเรียลไทม์แล้ว",key:"socket-status",duration:1.5})}),n.on("disconnect",()=>{console.log("Socket Disconnected"),c(!1),p.current||(p.current=!0,o.ZP.warning({content:"การเชื่อมต่อเรียลไทม์หลุด กำลังพยายามเชื่อมต่อใหม่...",key:"socket-status",duration:2}))}),n.io.on("reconnect_attempt",e=>{console.log("Socket reconnect attempt",e),c(!1)}),n.io.on("reconnect_failed",()=>{console.log("Socket reconnect failed"),o.ZP.error({content:"เชื่อมต่อเรียลไทม์ไม่สำเร็จ",key:"socket-status",duration:2})}),s(n),()=>{n.disconnect()}},[null==f?void 0:f.id]),(0,n.jsx)(l.Provider,{value:{socket:r,isConnected:u},children:t})}},3369:function(e,t,r){r.d(t,{GlobalLoadingProvider:function(){return l},O:function(){return u},x:function(){return s}});var n=r(57437),a=r(2265),d=r(48651);let o=(0,a.createContext)(void 0),i=(0,a.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)({}),[s,u]=(0,a.useState)(void 0),c=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";l(e=>({...e,[t]:(e[t]||0)+1})),e&&u(e)},[]),p=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";l(t=>{if(!t[e])return t;let r={...t};return r[e]-=1,r[e]<=0&&delete r[e],r})},[]),f=(0,a.useCallback)(()=>{l({}),u(void 0)},[]),g=Object.keys(r).length>0,h=(0,a.useMemo)(()=>({isLoading:g,loadingMessage:s}),[g,s]),x=(0,a.useMemo)(()=>({showLoading:c,hideLoading:p,resetLoading:f}),[c,p,f]);return(0,n.jsx)(i.Provider,{value:x,children:(0,n.jsxs)(o.Provider,{value:h,children:[t,g&&(0,n.jsx)("div",{role:"status","aria-live":"polite",className:"global-loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:13e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(6px)",WebkitBackdropFilter:"blur(6px)",transition:"opacity 0.25s ease"},children:(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16,background:"rgba(255, 255, 255, 0.95)",padding:"28px 40px",borderRadius:20,boxShadow:"0 10px 32px rgba(15, 23, 42, 0.14)",border:"1px solid rgba(148, 163, 184, 0.35)",minWidth:240,textAlign:"center"},children:[(0,n.jsx)(d.Z,{size:"large"}),s&&(0,n.jsx)("div",{style:{fontSize:16,color:"#334155",fontWeight:600,letterSpacing:"0.01em"},children:s})]})})]})})};function s(){let e=(0,a.useContext)(o),t=(0,a.useContext)(i);if(!e||!t)throw Error("useGlobalLoading must be used within a GlobalLoadingProvider");return(0,a.useMemo)(()=>({...e,...t}),[e,t])}function u(){let e=(0,a.useContext)(i);if(!e)throw Error("useGlobalLoadingDispatch must be used within a GlobalLoadingProvider");return e}},24675:function(e,t,r){r.d(t,{s:function(){return d}});var n=r(2265),a=r(46252);let d=()=>(0,n.useContext)(a.J)},84859:function(e,t,r){r.d(t,{M:function(){return l},x:function(){return i}});let n="pos_offline_queue",a=()=>{let e=localStorage.getItem(n);return e?JSON.parse(e):[]},d=e=>{let t=Date.now();return e.filter(e=>t-e.timestamp<=6048e5)},o=e=>{localStorage.setItem(n,JSON.stringify(e))},i={addToQueue:(e,t)=>{let r=d(a()),n={id:"offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,payload:t,timestamp:Date.now(),retryCount:0};return o([...r,n]),n},getQueue:()=>a(),removeFromQueue:e=>{o(a().filter(t=>t.id!==e))},incrementRetry:(e,t)=>{o(a().map(r=>r.id===e?{...r,retryCount:r.retryCount+1,lastError:t}:r))},clearQueue:()=>{localStorage.removeItem(n)},pruneExceeded:()=>{o(d(a()).filter(e=>e.retryCount<=5))}},l={maxRetry:5,backoff:e=>Math.min(3e4,2e3*e)}},12028:function(e,t,r){r.d(t,{b:function(){return n},g:function(){return a}});let n={system:{announcement:"system:announcement"},users:{create:"users:create",update:"users:update",delete:"users:delete",status:"users:update-status"},roles:{create:"roles:create",update:"roles:update",delete:"roles:delete"},branches:{create:"branches:create",update:"branches:update",delete:"branches:delete"},products:{create:"products:create",update:"products:update",delete:"products:delete"},productsUnit:{create:"productsUnit:create",update:"productsUnit:update",delete:"productsUnit:delete"},categories:{create:"category:create",update:"category:update",delete:"category:delete"},tables:{create:"tables:create",update:"tables:update",delete:"tables:delete"},orders:{create:"orders:create",update:"orders:update",delete:"orders:delete"},payments:{create:"payments:create",update:"payments:update",delete:"payments:delete"},discounts:{create:"discounts:create",update:"discounts:update",delete:"discounts:delete"},delivery:{create:"delivery:create",update:"delivery:update",delete:"delivery:delete"},shifts:{update:"shifts:update"},orderQueue:{added:"order-queue:added",updated:"order-queue:updated",removed:"order-queue:removed",reordered:"order-queue:reordered"},ingredients:{create:"ingredients:create",update:"ingredients:update",delete:"ingredients:delete"},ingredientsUnit:{create:"ingredientsUnit:create",update:"ingredientsUnit:update",delete:"ingredientsUnit:delete"},stock:{update:"stock:update"},stockOrders:{create:"stock:orders:create",update:"stock:orders:update",status:"stock:orders:status",delete:"stock:orders:delete",detailUpdate:"stock:orders:detail:update"},paymentAccounts:{create:"payment-accounts:create",update:"payment-accounts:update",delete:"payment-accounts:delete"},paymentMethods:{create:"paymentMethod:create",update:"paymentMethod:update",delete:"paymentMethod:delete"},shopProfile:{update:"shopProfile:update"},salesOrderItem:{create:"salesOrderItem:create",update:"salesOrderItem:update",delete:"salesOrderItem:delete"},salesOrderDetail:{create:"salesOrderDetail:create",update:"salesOrderDetail:update",delete:"salesOrderDetail:delete"}},a={stockOrdersUpdated:"orders_updated"}}}]);