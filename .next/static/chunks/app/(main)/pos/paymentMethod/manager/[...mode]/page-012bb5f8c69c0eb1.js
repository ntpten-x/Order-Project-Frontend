(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9776],{81316:function(e,t,a){Promise.resolve().then(a.bind(a,53544))},53544:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var n=a(57437),s=a(2265),o=a(44967),r=a(34029),i=a(53743),l=a(48651),d=a(88589),c=a(80336),m=a(99376),h=a(82646),p=a(99458),y=a(72175);let{Text:u}=h.default,{pageStyles:f,ManagePageStyles:g}=(0,y.dg)({focusColor:"#10b981",focusShadow:"rgba(16, 185, 129, 0.1)",switchGradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)"}),x=e=>{let{isEdit:t,onBack:a,onDelete:s}=e;return(0,n.jsx)(y.oI,{pageStyles:f,isEdit:t,onBack:a,onDelete:s,titleCreate:"เพิ่มวิธีชำระเงิน",titleEdit:"แก้ไขวิธีชำระเงิน"})},_=e=>{let{name:t,displayName:a}=e;return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:14,padding:16,background:"#fafafa",borderRadius:16,marginTop:12},children:[(0,n.jsx)("div",{style:{width:80,height:80,borderRadius:14,border:"2px solid white",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",overflow:"hidden",position:"relative",flexShrink:0,background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)(p.Z,{style:{fontSize:32,color:"#10b981",opacity:.8}})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(u,{strong:!0,style:{display:"block",marginBottom:4,fontSize:16},children:a||t||"ตัวอย่างวิธีชำระเงิน"}),(0,n.jsx)(u,{type:"secondary",style:{fontSize:12},children:t||"รหัสวิธีชำระเงิน"})]})]})},j=e=>{let{isEdit:t,loading:a,onCancel:s}=e;return(0,n.jsx)(y.uM,{pageStyles:f,isEdit:t,loading:a,onCancel:s})};var k=a(97235),C=a(3286),b=a(2938);function v(e){let{params:t}=e,a=(0,m.useRouter)(),[h]=o.Z.useForm(),[p,y]=(0,s.useState)(!1),[u,v]=(0,s.useState)(!1),[w,S]=(0,s.useState)(""),[E,Z]=(0,s.useState)(""),[P,T]=(0,s.useState)(""),M=t.mode[0],N=t.mode[1]||null,I="edit"===M&&!!N,{isAuthorized:R,isChecking:z}=(0,C.e)({requiredRole:"Admin"});(0,s.useEffect)(()=>{(async()=>{T(await (0,k.P)())})()},[]);let F=(0,s.useCallback)(async()=>{y(!0);try{let e=await fetch("/api/pos/paymentMethod/getById/".concat(N));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลวิธีการชำระเงินได้");let t=await e.json();h.setFieldsValue({payment_method_name:t.payment_method_name,display_name:t.display_name,is_active:t.is_active}),S(t.payment_method_name||""),Z(t.display_name||"")}catch(e){console.error(e),r.ZP.error("ไม่สามารถดึงข้อมูลวิธีการชำระเงินได้"),a.push("/pos/paymentMethod")}finally{y(!1)}},[N,h,a]);(0,s.useEffect)(()=>{I&&F()},[I,N,F]);let O=async e=>{v(!0);try{if(I){let t=await fetch("/api/pos/paymentMethod/update/".concat(N),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":P},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตวิธีการชำระเงินได้")}r.ZP.success("อัปเดตวิธีการชำระเงินสำเร็จ")}else{let t=await fetch("/api/pos/paymentMethod/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":P},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างวิธีการชำระเงินได้")}r.ZP.success("สร้างวิธีการชำระเงินสำเร็จ")}a.push("/pos/paymentMethod")}catch(e){console.error(e),r.ZP.error(e.message||(I?"ไม่สามารถอัปเดตวิธีการชำระเงินได้":"ไม่สามารถสร้างวิธีการชำระเงินได้"))}finally{v(!1)}},q=()=>a.push("/pos/paymentMethod");return z?(0,n.jsx)(b.H,{message:"กำลังตรวจสอบสิทธิ์..."}):R?(0,n.jsxs)("div",{className:"manage-page",style:f.container,children:[(0,n.jsx)(g,{}),(0,n.jsx)(x,{isEdit:I,onBack:q,onDelete:I?()=>{N&&i.Z.confirm({title:"ยืนยันการลบวิธีการชำระเงิน",content:'คุณต้องการลบวิธีการชำระเงิน "'.concat(E||w,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{if(!(await fetch("/api/pos/paymentMethod/delete/".concat(N),{method:"DELETE",headers:{"X-CSRF-Token":P}})).ok)throw Error("ไม่สามารถลบวิธีการชำระเงินได้");r.ZP.success("ลบวิธีการชำระเงินสำเร็จ"),a.push("/pos/paymentMethod")}catch(e){console.error(e),r.ZP.error("ไม่สามารถลบวิธีการชำระเงินได้")}}})}:void 0}),(0,n.jsx)("div",{className:"manage-form-card",style:f.formCard,children:p?(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:(0,n.jsx)(l.Z,{size:"large"})}):(0,n.jsxs)(o.Z,{form:h,layout:"vertical",onFinish:O,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.payment_method_name&&S(e.payment_method_name),void 0!==e.display_name&&Z(e.display_name)},children:[(0,n.jsx)(o.Z.Item,{name:"payment_method_name",label:"รหัสวิธีการชำระเงิน *",rules:[{required:!0,message:"กรุณากรอกรหัสวิธีการชำระเงิน"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,n.jsx)(d.default,{size:"large",placeholder:"เช่น Cash, CreditCard, PromptPay",maxLength:100})}),(0,n.jsx)(o.Z.Item,{name:"display_name",label:"ชื่อที่แสดง *",rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,n.jsx)(d.default,{size:"large",placeholder:"เช่น เงินสด, บัตรเครดิต, พร้อมเพย์",maxLength:100})}),(0,n.jsx)(o.Z.Item,{noStyle:!0,dependencies:["payment_method_name","display_name"],children:e=>{let{getFieldValue:t}=e;return(0,n.jsx)(_,{name:t("payment_method_name"),displayName:t("display_name")})}}),(0,n.jsx)(o.Z.Item,{name:"is_active",label:"สถานะการใช้งาน",valuePropName:"checked",style:{marginTop:20},children:(0,n.jsx)(c.Z,{checkedChildren:"เปิดใช้งาน",unCheckedChildren:"ปิดใช้งาน"})}),(0,n.jsx)(j,{isEdit:I,loading:u,onCancel:q})]})})]}):(0,n.jsx)(b.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,5616,8589,4967,5775,1668,4243,2971,2117,1744],function(){return e(e.s=81316)}),_N_E=e.O()}]);