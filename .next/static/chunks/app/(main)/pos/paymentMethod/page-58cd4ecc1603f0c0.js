(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3468],{67601:function(e,t,n){Promise.resolve().then(n.bind(n,74841))},74841:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var i=n(57437),s=n(2265),d=n(19683),a=n(50742),l=n(88589),r=n(62297),o=n(85180),c=n(69410),h=n(80009),x=n(53743),p=n(34029),g=n(47451),y=n(99458),f=n(89245),u=n(29436),m=n(96473),j=n(20955),b=n(86955),v=n(37527),S=n(8900),k=n(39725),w=n(13377),_=n(26349),Z=n(99376),E=n(3369),C=n(26972),R=n(24675),z=n(97235),F=n(3286),P=n(67697),M=n(73814),A=n(63836),B=n(69397);({...(0,B.yf)("linear-gradient(135deg, #10b981 0%, #059669 100%)"),paymentMethodCard:B.YO,paymentMethodCardInner:B.lv});let I=(0,B.IU)(".payment-method-page",".payment-method-card");var T=n(12093),W=n(2938);let{Text:L,Title:N}=d.default,O="pos:payment-methods",D=e=>{let{onRefresh:t,onAdd:n,searchValue:s,onSearchChange:d,page:o,total:c,lastPage:h,setPage:x}=e;return(0,i.jsxs)("div",{style:{marginBottom:16,background:"white",borderRadius:16,padding:16,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:14},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,i.jsx)("div",{style:{width:40,height:40,background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 3px 8px rgba(16, 185, 129, 0.3)"},children:(0,i.jsx)(y.Z,{style:{fontSize:20,color:"white"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(N,{level:5,style:{margin:0,fontSize:16,fontWeight:700,color:"#1E293B"},children:"วิธีชำระเงิน"}),(0,i.jsxs)(L,{style:{fontSize:12,color:"#64748B"},children:[c," รายการ"]})]})]}),(0,i.jsx)(a.ZP,{icon:(0,i.jsx)(f.Z,{}),onClick:t,style:{borderRadius:8,border:"1px solid #E2E8F0",color:"#64748B"}})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)(l.default,{allowClear:!0,placeholder:"ค้นหาวิธีชำระเงิน...",prefix:(0,i.jsx)(u.Z,{style:{color:"#94A3B8"}}),value:s,onChange:e=>d(e.target.value),style:{flex:1,height:42,borderRadius:10,background:"#F8FAFC",border:"1px solid #E2E8F0"}}),(0,i.jsx)(a.ZP,{type:"primary",icon:(0,i.jsx)(m.Z,{}),onClick:n,style:{height:42,borderRadius:10,background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none",fontWeight:600,boxShadow:"0 3px 8px rgba(16, 185, 129, 0.25)",paddingLeft:14,paddingRight:14},children:"เพิ่ม"})]}),h>1&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:12},children:(0,i.jsx)(r.Z,{current:o,pageSize:50,total:c,onChange:e=>x(e),size:"small",hideOnSinglePage:!0})})]})},q=e=>{let{totalPaymentMethods:t,activePaymentMethods:n,inactivePaymentMethods:s}=e;return(0,i.jsxs)("div",{className:"grid grid-cols-3 gap-2 md:gap-4",style:{background:"white",borderRadius:16,boxShadow:"0 2px 12px rgba(0,0,0,0.04)",padding:"12px 8px",marginBottom:20},children:[(0,i.jsxs)("div",{style:{textAlign:"center",padding:"8px 4px"},children:[(0,i.jsx)("span",{style:{fontSize:20,fontWeight:700,color:"#10b981",display:"block"},children:t}),(0,i.jsx)(L,{style:{fontSize:11,color:"#64748b"},children:"ทั้งหมด"})]}),(0,i.jsxs)("div",{style:{textAlign:"center",padding:"8px 4px",borderLeft:"1px solid #f0f0f0",borderRight:"1px solid #f0f0f0"},children:[(0,i.jsx)("span",{style:{fontSize:20,fontWeight:700,color:"#52c41a",display:"block"},children:n}),(0,i.jsx)(L,{style:{fontSize:11,color:"#64748b"},children:"เปิดใช้"})]}),(0,i.jsxs)("div",{style:{textAlign:"center",padding:"8px 4px"},children:[(0,i.jsx)("span",{style:{fontSize:20,fontWeight:700,color:"#ff4d4f",display:"block"},children:s}),(0,i.jsx)(L,{style:{fontSize:11,color:"#64748b"},children:"ปิดใช้"})]})]})},H=e=>{let{onAdd:t}=e;return(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",width:"100%"},children:(0,i.jsx)(o.Z,{image:o.Z.PRESENTED_IMAGE_SIMPLE,description:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)(L,{type:"secondary",style:{fontSize:16,fontWeight:500},children:"ยังไม่มีวิธีชำระเงิน"}),(0,i.jsx)("br",{}),(0,i.jsx)(L,{type:"secondary",style:{fontSize:14},children:"เริ่มต้นเพิ่มวิธีชำระเงินแรกของคุณ"})]}),style:{padding:"40px",background:"white",borderRadius:24,boxShadow:"0 8px 24px rgba(0,0,0,0.04)",width:"100%",maxWidth:400},children:(0,i.jsx)(a.ZP,{type:"primary",size:"large",icon:(0,i.jsx)(m.Z,{}),onClick:t,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none",borderRadius:12,marginTop:16,height:44,boxShadow:"0 4px 12px rgba(16, 185, 129, 0.3)"},children:"เพิ่มวิธีชำระเงิน"})})})},U=e=>{let t=e.toLowerCase();return t.includes("cash")||t.includes("เงินสด")?(0,i.jsx)(j.Z,{}):t.includes("promptpay")||t.includes("พร้อมเพย์")||t.includes("qr")?(0,i.jsx)(b.Z,{}):t.includes("bank")||t.includes("โอน")?(0,i.jsx)(v.Z,{}):(0,i.jsx)(y.Z,{})},G=e=>{let{paymentMethod:t,onEdit:n,onDelete:s}=e,d=U(t.payment_method_name);return(0,i.jsx)(c.Z,{xs:24,sm:12,lg:8,children:(0,i.jsxs)("div",{style:{background:"white",borderRadius:14,padding:14,boxShadow:"0 2px 6px rgba(0,0,0,0.04)",border:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:12,opacity:t.is_active?1:.7},onClick:()=>n(t),children:[(0,i.jsx)("div",{style:{width:44,height:44,borderRadius:10,background:t.is_active?"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,i.jsx)("div",{style:{fontSize:20,color:t.is_active?"#059669":"#94A3B8"},children:d})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,i.jsx)(L,{strong:!0,ellipsis:!0,style:{fontSize:14,color:"#1E293B"},children:t.display_name||t.payment_method_name}),t.is_active?(0,i.jsx)(S.Z,{style:{color:"#10B981",fontSize:13,flexShrink:0}}):(0,i.jsx)(k.Z,{style:{color:"#EF4444",fontSize:13,flexShrink:0}})]}),(0,i.jsx)(h.Z,{style:{borderRadius:4,margin:0,marginTop:4,fontSize:10,padding:"1px 6px",border:"none",background:"#F1F5F9",color:"#64748B"},children:t.payment_method_name})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:4,flexShrink:0},children:[(0,i.jsx)(a.ZP,{type:"text",size:"small",icon:(0,i.jsx)(w.Z,{}),onClick:e=>{e.stopPropagation(),n(t)},style:{borderRadius:6,color:"#10B981",width:32,height:32,padding:0}}),(0,i.jsx)(a.ZP,{type:"text",size:"small",icon:(0,i.jsx)(_.Z,{}),onClick:e=>{e.stopPropagation(),s(t)},style:{borderRadius:6,color:"#EF4444",width:32,height:32,padding:0}})]})]})})};function J(){let e=(0,Z.useRouter)(),[t,n]=(0,s.useState)([]),[d,a]=(0,s.useState)(1),[l,r]=(0,s.useState)(0),[o,c]=(0,s.useState)(1),[h,y]=(0,s.useState)(""),f=(0,T.c)(h.trim(),400),{execute:u}=(0,C.J)(),{showLoading:m}=(0,E.x)(),{socket:j}=(0,R.s)(),{isAuthorized:b,isChecking:v}=(0,F.e)({requiredRole:"Admin"});(0,s.useEffect)(()=>{(0,z.P)()},[]),(0,s.useEffect)(()=>{a(1)},[f]),(0,s.useEffect)(()=>{var e;if(f||1!==d)return;let t=(0,M.t)(O,3e5);(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.length)&&(n(t.data),r(t.total),c(t.last_page))},[f,d]);let S=(0,s.useCallback)(async()=>{u(async()=>{let e=new URLSearchParams;e.set("page",d.toString()),e.set("limit","50"),f&&e.set("q",f);let t=await A.E.getAll(void 0,e);n(t.data),r(t.total),c(t.last_page),f||1!==d||(0,M.v)(O,t)},"กำลังโหลดข้อมูลวิธีการชำระเงิน...")},[f,u,d]);(0,s.useEffect)(()=>{b&&S()},[b,S]),(0,P.D)({socket:j,events:["paymentMethod:create","paymentMethod:update","paymentMethod:delete"],onRefresh:()=>S(),intervalMs:2e4,debounceMs:1e3});let k=()=>{m("กำลังเปิดหน้าจัดการวิธีชำระเงิน..."),e.push("/pos/paymentMethod/manager/add")},w=t=>{m("กำลังเปิดหน้าแก้ไขวิธีชำระเงิน..."),e.push("/pos/paymentMethod/manager/edit/".concat(t.id))},B=e=>{x.Z.confirm({title:"ยืนยันการลบวิธีชำระเงิน",content:'คุณต้องการลบวิธีชำระเงิน "'.concat(e.display_name||e.payment_method_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,i.jsx)(_.Z,{style:{color:"#ff4d4f"}}),onOk:async()=>{await u(async()=>{let t=await (0,z.P)();if(!(await fetch("/api/pos/paymentMethod/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบวิธีชำระเงินได้");p.ZP.success('ลบวิธีชำระเงิน "'.concat(e.display_name||e.payment_method_name,'" สำเร็จ'))},"กำลังลบวิธีชำระเงิน...")}})};if(v)return(0,i.jsx)(W.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."});if(!b)return(0,i.jsx)(W.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"});let L=t.filter(e=>e.is_active),N=t.filter(e=>!e.is_active);return(0,i.jsxs)("div",{style:{padding:16,background:"#F8FAFC",minHeight:"100vh"},children:[(0,i.jsx)("style",{children:I}),(0,i.jsx)(D,{onRefresh:S,onAdd:k,searchValue:h,onSearchChange:y,page:d,total:l,lastPage:o,setPage:a}),(0,i.jsx)(q,{totalPaymentMethods:t.length,activePaymentMethods:L.length,inactivePaymentMethods:N.length}),(0,i.jsx)("div",{children:t.length>0?(0,i.jsx)(g.Z,{gutter:[12,12],children:t.map(e=>(0,i.jsx)(G,{paymentMethod:e,onEdit:w,onDelete:B},e.id))}):(0,i.jsx)(H,{onAdd:k})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=67601)}),_N_E=e.O()}]);