(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3468],{67601:function(e,t,n){Promise.resolve().then(n.bind(n,74841))},74841:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var a=n(57437),r=n(2265),i=n(82646),o=n(88589),s=n(50742),l=n(8056),d=n(80009),c=n(85180),h=n(53743),u=n(34029),f=n(48651),g=n(99458),p=n(89245),y=n(96473),x=n(8900),m=n(39725),b=n(13377),j=n(26349),v=n(99376),w=n(3369),k=n(26972),S=n(24675),C=n(97235),E=n(3286),_=n(67697),I=n(73814),P=n(63836),R=n(69397);let T={...(0,R.y)("linear-gradient(135deg, #10b981 0%, #059669 100%)"),paymentMethodCard:e=>({marginBottom:12,borderRadius:20,border:"none",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",overflow:"hidden",transition:"all 0.3s ease",background:e?"white":"linear-gradient(to right, #fafafa, white)",opacity:e?1:.7}),paymentMethodCardInner:{padding:16,display:"flex",alignItems:"center",gap:14}},z=(0,R.I)(".payment-method-page",".payment-method-card"),{Text:Z,Title:M}=i.default,D=e=>{let{onRefresh:t,onAdd:n,searchValue:r,onSearchChange:i,page:d,total:c,lastPage:h,setPage:u}=e;return(0,a.jsxs)("div",{style:T.header,children:[(0,a.jsx)("div",{style:T.headerDecoCircle1}),(0,a.jsx)("div",{style:T.headerDecoCircle2}),(0,a.jsxs)("div",{style:T.headerContent,children:[(0,a.jsxs)("div",{style:T.headerLeft,children:[(0,a.jsx)("div",{style:T.headerIconBox,children:(0,a.jsx)(g.Z,{style:{fontSize:24,color:"white"}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block"},children:"การจัดการข้อมูล"}),(0,a.jsx)(M,{level:4,style:{color:"white",margin:0,fontWeight:700,letterSpacing:"0.5px"},children:"วิธีการชำระเงิน"})]})]}),(0,a.jsxs)("div",{style:T.headerActions,children:[(0,a.jsx)(o.default,{allowClear:!0,placeholder:"ค้นหาวิธีการชำระเงิน...",value:r,onChange:e=>i(e.target.value),style:{width:220,borderRadius:10}}),(0,a.jsx)(s.ZP,{type:"text",icon:(0,a.jsx)(p.Z,{style:{color:"white"}}),onClick:t,style:{background:"rgba(255,255,255,0.2)",borderRadius:12,height:40,width:40}}),(0,a.jsx)(s.ZP,{type:"primary",icon:(0,a.jsx)(y.Z,{}),onClick:n,style:{background:"white",color:"#10b981",borderRadius:12,height:40,fontWeight:600,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:"เพิ่มวิธีการชำระเงิน"})]}),h>1&&(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:(0,a.jsx)(l.Z,{current:d,pageSize:N,total:c,onChange:e=>u(e),size:"small"})})]})]})},N=50,A="pos:payment-methods",F=e=>{let{totalPaymentMethods:t,activePaymentMethods:n,inactivePaymentMethods:r}=e;return(0,a.jsxs)("div",{style:T.statsCard,children:[(0,a.jsxs)("div",{style:T.statItem,children:[(0,a.jsx)("span",{style:{...T.statNumber,color:"#10b981"},children:t}),(0,a.jsx)(Z,{style:T.statLabel,children:"ทั้งหมด"})]}),(0,a.jsx)("div",{style:{width:1,background:"#f0f0f0"}}),(0,a.jsxs)("div",{style:T.statItem,children:[(0,a.jsx)("span",{style:{...T.statNumber,color:"#52c41a"},children:n}),(0,a.jsx)(Z,{style:T.statLabel,children:"เปิดใช้งาน"})]}),(0,a.jsx)("div",{style:{width:1,background:"#f0f0f0"}}),(0,a.jsxs)("div",{style:T.statItem,children:[(0,a.jsx)("span",{style:{...T.statNumber,color:"#ff4d4f"},children:r}),(0,a.jsx)(Z,{style:T.statLabel,children:"ปิดใช้งาน"})]})]})},L=e=>{let{paymentMethod:t,index:n,onEdit:r,onDelete:i}=e;return(0,a.jsx)("div",{className:"payment-method-card",style:{...T.paymentMethodCard(t.is_active),animationDelay:"".concat(.03*n,"s")},children:(0,a.jsxs)("div",{style:T.paymentMethodCardInner,children:[(0,a.jsx)("div",{style:{width:64,height:64,borderRadius:14,border:"2px solid #f0f0f0",boxShadow:"0 4px 12px rgba(0,0,0,0.06)",flexShrink:0,overflow:"hidden",position:"relative",background:t.is_active?"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)":"linear-gradient(135deg, #fff1f0 0%, #ffccc7 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(g.Z,{style:{fontSize:28,color:t.is_active?"#10b981":"#ff4d4f"}})}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,a.jsx)(Z,{strong:!0,style:{fontSize:16,color:"#1a1a2e"},children:t.display_name||t.payment_method_name}),t.is_active?(0,a.jsx)(x.Z,{style:{color:"#52c41a",fontSize:14}}):(0,a.jsx)(m.Z,{style:{color:"#ff4d4f",fontSize:14}})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",alignItems:"center"},children:[(0,a.jsx)(d.Z,{color:"green",style:{borderRadius:8,margin:0,fontSize:11},children:t.payment_method_name}),(0,a.jsx)(d.Z,{color:t.is_active?"success":"default",style:{borderRadius:8,margin:0,fontSize:11},children:t.is_active?"เปิดใช้งาน":"ปิดใช้งาน"})]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,a.jsx)(s.ZP,{type:"text",icon:(0,a.jsx)(b.Z,{}),onClick:e=>{e.stopPropagation(),r(t)},style:{borderRadius:10,color:"#10b981",background:"#d1fae5"}}),(0,a.jsx)(s.ZP,{type:"text",danger:!0,icon:(0,a.jsx)(j.Z,{}),onClick:e=>{e.stopPropagation(),i(t)},style:{borderRadius:10,background:"#fff2f0"}})]})]})})},O=e=>{let{onAdd:t}=e;return(0,a.jsx)(c.Z,{image:c.Z.PRESENTED_IMAGE_SIMPLE,description:(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)(Z,{type:"secondary",style:{fontSize:15},children:"ยังไม่มีวิธีชำระเงิน"}),(0,a.jsx)("br",{}),(0,a.jsx)(Z,{type:"secondary",style:{fontSize:13},children:"เริ่มต้นเพิ่มวิธีชำระเงินแรกของคุณ"})]}),style:{padding:"60px 20px",background:"white",borderRadius:20,margin:"0 16px"},children:(0,a.jsx)(s.ZP,{type:"primary",icon:(0,a.jsx)(y.Z,{}),onClick:t,style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none"},children:"เพิ่มวิธีชำระเงิน"})})};function B(){let e=(0,v.useRouter)(),[t,n]=(0,r.useState)([]),[i,o]=(0,r.useState)(1),[s,l]=(0,r.useState)(0),[d,c]=(0,r.useState)(1),[p,y]=(0,r.useState)(""),[x,m]=(0,r.useState)(""),{execute:b}=(0,k.J)(),{showLoading:j}=(0,w.x)(),{socket:R}=(0,S.s)(),{isAuthorized:M,isChecking:B}=(0,E.e)({requiredRole:"Admin"});(0,r.useEffect)(()=>{(0,C.P)()},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{m(p.trim()),o(1)},400);return()=>clearTimeout(e)},[p]),(0,r.useEffect)(()=>{var e;if(x||1!==i)return;let t=(0,I.t)(A,3e5);(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.length)&&(n(t.data),l(t.total),c(t.last_page))},[x,i]);let W=(0,r.useCallback)(async()=>{b(async()=>{let e=new URLSearchParams;e.set("page",i.toString()),e.set("limit",N.toString()),x&&e.set("q",x);let t=await P.E.getAll(void 0,e);n(t.data),l(t.total),c(t.last_page),x||1!==i||(0,I.v)(A,t)},"กำลังโหลดข้อมูลวิธีการชำระเงิน...")},[x,b,i]);(0,r.useEffect)(()=>{M&&W()},[M,W]),(0,_.D)({socket:R,events:["paymentMethod:create","paymentMethod:update","paymentMethod:delete"],onRefresh:()=>W(),intervalMs:2e4,debounceMs:1e3});let J=()=>{j("กำลังเปิดหน้าจัดการวิธีชำระเงิน..."),e.push("/pos/paymentMethod/manager/add")},G=t=>{j("กำลังเปิดหน้าแก้ไขวิธีชำระเงิน..."),e.push("/pos/paymentMethod/manager/edit/".concat(t.id))},U=e=>{h.Z.confirm({title:"ยืนยันการลบวิธีชำระเงิน",content:'คุณต้องการลบวิธีชำระเงิน "'.concat(e.display_name||e.payment_method_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{await b(async()=>{let t=await (0,C.P)();if(!(await fetch("/api/pos/paymentMethod/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบวิธีชำระเงินได้");u.ZP.success('ลบวิธีชำระเงิน "'.concat(e.display_name||e.payment_method_name,'" สำเร็จ'))},"กำลังลบวิธีชำระเงิน...")}})};if(B)return(0,a.jsxs)("div",{style:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:16},children:[(0,a.jsx)(f.Z,{size:"large"}),(0,a.jsx)(Z,{type:"secondary",children:"กำลังตรวจสอบสิทธิ์การใช้งาน..."})]});if(!M)return(0,a.jsxs)("div",{style:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:16},children:[(0,a.jsx)(f.Z,{size:"large"}),(0,a.jsx)(Z,{type:"danger",children:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ..."})]});let X=t.filter(e=>e.is_active),Y=t.filter(e=>!e.is_active);return(0,a.jsxs)("div",{className:"payment-method-page",style:T.container,children:[(0,a.jsx)("style",{children:z}),(0,a.jsx)(D,{onRefresh:W,onAdd:J,searchValue:p,onSearchChange:y,page:i,total:s,lastPage:d,setPage:o}),(0,a.jsx)(F,{totalPaymentMethods:t.length,activePaymentMethods:X.length,inactivePaymentMethods:Y.length}),(0,a.jsx)("div",{style:T.listContainer,children:t.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:T.sectionTitle,children:[(0,a.jsx)(g.Z,{style:{fontSize:18,color:"#10b981"}}),(0,a.jsx)("span",{style:{fontSize:16,fontWeight:600,color:"#1a1a2e"},children:"รายการวิธีชำระเงิน"}),(0,a.jsxs)("div",{style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",padding:"4px 12px",borderRadius:20,fontSize:12,fontWeight:600},children:[t.length," รายการ"]})]}),t.map((e,t)=>(0,a.jsx)(L,{paymentMethod:e,index:t,onEdit:G,onDelete:U},e.id))]}):(0,a.jsx)(O,{onAdd:J})})]})}},26972:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var a=n(2265),r=n(3369),i=n(53743);let o=()=>{let{showLoading:e,hideLoading:t}=(0,r.x)();return{execute:(0,a.useCallback)(async function(n){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"กำลังดำเนินการ...",r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"เกิดข้อผิดพลาด");try{return e(a,"async"),await n()}catch(e){console.error("Async action error:",e),i.Z.error({title:"ข้อผิดพลาด",content:e.message||r});return}finally{t("async")}},[e,t])}}},63836:function(e,t,n){"use strict";n.d(t,{E:function(){return o}});var a=n(2913);let r=n(71567).q.POS.PAYMENT_METHODS,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},o={getAll:async(e,t)=>{let n=(0,a.b)("GET",r),o=new URLSearchParams(t||"");o.has("page")||o.set("page","1"),o.has("limit")||o.set("limit","200");let s=o.toString();s&&(n+="?".concat(s));let l=i(e,""),d=await fetch(n,{cache:"no-store",headers:l,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch payment methods")}return d.json()},getById:async(e,t)=>{let n=(0,a.b)("GET","".concat(r,"/").concat(e)),o=i(t,""),s=await fetch(n,{cache:"no-store",headers:o,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch payment method")}return s.json()},getByName:async(e,t)=>{let n=(0,a.b)("GET","".concat(r,"/getByName/").concat(e)),o=i(t,""),s=await fetch(n,{cache:"no-store",headers:o,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch payment method")}return s.json()},create:async(e,t,n)=>{let o=(0,a.b)("POST","".concat(r)),s=i(t);n&&(s["X-CSRF-Token"]=n);let l=await fetch(o,{method:"POST",headers:s,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to create payment method")}return l.json()},update:async(e,t,n,o)=>{let s=(0,a.b)("PUT","".concat(r,"/").concat(e)),l=i(n);o&&(l["X-CSRF-Token"]=o);let d=await fetch(s,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(t)});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to update payment method")}return d.json()},delete:async(e,t,n)=>{let o=(0,a.b)("DELETE","".concat(r,"/").concat(e)),s=i(t,"");n&&(s["X-CSRF-Token"]=n);let l=await fetch(o,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to delete payment method")}}}},69397:function(e,t,n){"use strict";n.d(t,{I:function(){return i},y:function(){return r}});let a={container:{paddingBottom:100,backgroundColor:"#f8f9fc",minHeight:"100vh"},header:{background:"linear-gradient(135deg, #722ed1 0%, #531dab 100%)",padding:"20px 20px 60px 20px",position:"relative",overflow:"hidden"},headerDecoCircle1:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:"rgba(255,255,255,0.1)"},headerDecoCircle2:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},headerContent:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},headerLeft:{display:"flex",alignItems:"center",gap:12},headerIconBox:{width:48,height:48,borderRadius:14,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)"},headerActions:{display:"flex",gap:8},statsCard:{margin:"-40px 16px 0 16px",padding:"16px",background:"white",borderRadius:20,boxShadow:"0 8px 24px rgba(0,0,0,0.08)",display:"flex",justifyContent:"space-around",position:"relative",zIndex:10},statItem:{textAlign:"center",flex:1},statNumber:{fontSize:24,fontWeight:700,display:"block"},statLabel:{fontSize:12,color:"#8c8c8c",marginTop:2},listContainer:{padding:"20px 16px 0 16px"},sectionTitle:{display:"flex",alignItems:"center",gap:8,marginBottom:16}},r=e=>({...a,header:{...a.header,background:e}}),i=(e,t)=>"\n    @keyframes fadeSlideIn {\n        from {\n            opacity: 0;\n            transform: translateY(12px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n    \n    ".concat(t," {\n        animation: fadeSlideIn 0.4s ease both;\n    }\n    \n    ").concat(t,":hover {\n        transform: translateY(-2px);\n        box-shadow: 0 8px 24px rgba(0,0,0,0.1) !important;\n    }\n    \n    ").concat(t,":active {\n        transform: scale(0.98);\n    }\n    \n    ").concat(e," *::-webkit-scrollbar {\n        width: 6px;\n    }\n    ").concat(e," *::-webkit-scrollbar-track {\n        background: transparent;\n    }\n    ").concat(e," *::-webkit-scrollbar-thumb {\n        background: #d9d9d9;\n        border-radius: 3px;\n    }\n    ").concat(e," *::-webkit-scrollbar-thumb:hover {\n        background: #bfbfbf;\n    }\n")},3286:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var a=n(2265),r=n(34029),i=n(99376),o=n(14362);function s(){let{requiredRole:e="Admin",redirectUnauthenticated:t="/login",redirectUnauthorized:n="/pos",unauthorizedMessage:s="คุณไม่มีสิทธิ์เข้าถึงหน้านี้"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,i.useRouter)(),{user:d,loading:c}=(0,o.a)(),h=(0,a.useMemo)(()=>c?"checking":d?e&&d.role!==e?"unauthorized":"authorized":"unauthenticated",[d,c,e]),u=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{if("unauthenticated"===h){l.replace(t);return}"unauthorized"===h&&(u.current||(u.current=!0,r.ZP.error(s)),l.replace(n))},[h,l,t,n,s]),{status:h,isAuthorized:"authorized"===h,isChecking:"checking"===h,user:d}}},73814:function(e,t,n){"use strict";n.d(t,{t:function(){return r},v:function(){return i}});let a=()=>!0,r=(e,t)=>{if(!a())return null;try{var n;let a=window.localStorage.getItem(e);if(!a)return null;let r=JSON.parse(a);if(!(null==r?void 0:r.ts)||Date.now()-r.ts>t)return null;return null!==(n=r.data)&&void 0!==n?n:null}catch(e){return null}},i=(e,t)=>{if(a())try{let n={ts:Date.now(),data:t};window.localStorage.setItem(e,JSON.stringify(n))}catch(e){}}},97235:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var a=n(5447);let r=null,i=0,o=null;async function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&r&&t-i<6e5?r:(o||(o=a.O.getCsrfToken().then(e=>(r=e||"",i=Date.now(),r)).finally(()=>{o=null})),o)}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,9,5616,8589,5496,3834,8056,287,3490,2971,2117,1744],function(){return e(e.s=67601)}),_N_E=e.O()}]);