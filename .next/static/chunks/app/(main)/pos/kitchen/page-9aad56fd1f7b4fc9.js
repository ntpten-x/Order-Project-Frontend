(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5628],{85226:function(e,t,r){Promise.resolve().then(r.bind(r,35384))},35384:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var o=r(57437),n=r(2265),a=r(29827),i=r(11713),l=r(82646),s=r(34029),d=r(24783),c=r(23496),u=r(35713),f=r(50742),g=r(89970),h=r(80336),p=r(48651),b=r(85180),y=r(47451),m=r(69410),x=r(80009),S=r(441),v=r(25980),j=r(89245),_=r(5540),k=r(19574),w=r(9738),C=r(38576),E=r(46252),P=r(53286),T=r(5105),Z=r(44225),R=r(3369),I=r(97235),O=r(71096),A=r.n(O);r(6729);var M=r(45721),L=r.n(M);A().extend(L()),A().locale("th");let{Title:N,Text:D}=l.default,B=e=>{let t=A()().diff(A()(e),"minute");return t<5?{color:"#52c41a",bgColor:"rgba(82, 196, 26, 0.1)",urgency:"low",label:"ปกติ"}:t<15?{color:"#faad14",bgColor:"rgba(250, 173, 20, 0.1)",urgency:"medium",label:"ล่าช้า"}:{color:"#ff4d4f",bgColor:"rgba(255, 77, 79, 0.15)",urgency:"high",label:"ด่วนมาก"}};function F(){let{socket:e,isConnected:t}=(0,n.useContext)(E.J),{showLoading:r,hideLoading:l}=(0,R.x)(),O=(0,a.NL)(),[M,L]=(0,n.useState)(!0),[F,Q]=(0,n.useState)("all"),{data:U=[],isLoading:z,refetch:X}=(0,i.a)({queryKey:["orderItems","kitchen"],queryFn:async()=>(await P.x.getItems()).filter(e=>e.status!==T.M.Served&&e.status!==T.M.Cancelled),staleTime:2e3}),H=(0,n.useMemo)(()=>{let e={};return("all"===F?U.filter(e=>e.status!==T.M.Served&&e.status!==T.M.Cancelled):U.filter(e=>e.status===F)).forEach(t=>{let r=t.order_id;if(!e[r]){var o,n,a,i,l;let s=(null===(o=t.order)||void 0===o?void 0:o.create_date)||new Date().toISOString();e[r]={order_id:r,order_no:(null===(n=t.order)||void 0===n?void 0:n.order_no)||"N/A",table_name:(null===(i=t.order)||void 0===i?void 0:null===(a=i.table)||void 0===a?void 0:a.table_name)||null,order_type:(null===(l=t.order)||void 0===l?void 0:l.order_type)||"Unknown",created_at:s,items:[]}}e[r].items.push(t)}),Object.values(e).sort((e,t)=>A()(e.created_at).valueOf()-A()(t.created_at).valueOf())},[U,F]);(0,n.useEffect)(()=>{if(!e)return;let t=e=>{X(),M&&(G(),s.ZP.info("ออเดอร์ใหม่: #".concat(e.order_no)))},r=()=>{X()};return e.on("orders:create",t),e.on("orders:update",r),()=>{e.off("orders:create",t),e.off("orders:update",r)}},[e,M,X]);let G=()=>{try{let e=new Audio("https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3");e.volume=.5,e.play().catch(()=>{})}catch(e){}},q=async(e,t)=>{try{r("กำลังอัปเดต...");let o=await (0,I.P)();await P.x.updateItemStatus(e,t,void 0,o),O.setQueryData(["orderItems","kitchen"],function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r.map(r=>r.id===e?{...r,status:t}:r).filter(e=>e.status!==T.M.Served&&e.status!==T.M.Cancelled)}),s.ZP.success("อัปเดตสถานะสำเร็จ")}catch(e){s.ZP.error("ไม่สามารถอัปเดตสถานะได้")}finally{l()}},W=async e=>{try{r("กำลังเสิร์ฟทั้งหมด...");let t=H.find(t=>t.order_id===e);if(!t)return;let o=await (0,I.P)(),n=t.items.map(e=>P.x.updateItemStatus(e.id,T.M.Served,void 0,o));await Promise.all(n),O.setQueryData(["orderItems","kitchen"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter(t=>t.order_id!==e)}),s.ZP.success("เสิร์ฟออเดอร์ #".concat(t.order_no," ทั้งหมดแล้ว")),X()}catch(e){s.ZP.error("เกิดข้อผิดพลาดในการเสิร์ฟทั้งหมด")}finally{l()}},J=e=>{switch(e){case T.M.Pending:return"#faad14";case T.M.Cooking:return"#1890ff";case T.M.Served:return"#52c41a";default:return"#8c8c8c"}},Y=e=>{switch(e){case T.M.Pending:return"รอทำ";case T.M.Cooking:return"กำลังทำ";case T.M.Served:return"เสร็จแล้ว";default:return e}},V=U.filter(e=>e.status===T.M.Pending).length,K=U.filter(e=>e.status===T.M.Cooking).length;return(0,o.jsxs)("div",{style:Z.Np.kitchenContainer,children:[(0,o.jsxs)("div",{style:Z.Np.kitchenHeader,children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,o.jsx)("div",{style:{width:50,height:50,borderRadius:12,background:"linear-gradient(135deg, #ff6b35 0%, #ff9f1c 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(255, 107, 53, 0.4)"},children:(0,o.jsx)(S.Z,{style:{fontSize:28,color:"#fff"}})}),(0,o.jsxs)("div",{children:[(0,o.jsx)(N,{level:2,style:{margin:0,color:"#fff",fontSize:24},children:"Kitchen Display"}),(0,o.jsxs)(d.Z,{split:(0,o.jsx)(c.Z,{type:"vertical",style:{borderColor:"rgba(255,255,255,0.2)"}}),children:[(0,o.jsx)(D,{style:{color:"rgba(255,255,255,0.7)"},children:"จอครัวอัจฉริยะ"}),(0,o.jsx)(u.Z,{status:t?"success":"error",text:(0,o.jsx)(D,{style:{color:t?"#52c41a":"#ff4d4f",fontSize:12},children:t?"LIVE":"OFFLINE"})})]})]})]}),(0,o.jsxs)(d.Z,{wrap:!0,children:[(0,o.jsxs)("div",{style:{background:"rgba(255,255,255,0.05)",padding:"4px 8px",borderRadius:12,border:"1px solid rgba(255,255,255,0.1)",display:"flex",gap:8},children:[(0,o.jsxs)(f.ZP,{type:"text",onClick:()=>Q("all"),style:{color:"all"===F?"#fff":"rgba(255,255,255,0.5)",background:"all"===F?"rgba(255,255,255,0.1)":"transparent",borderRadius:8},children:["ทั้งหมด (",U.length,")"]}),(0,o.jsxs)(f.ZP,{type:"text",onClick:()=>Q(T.M.Pending),style:{color:F===T.M.Pending?"#faad14":"rgba(255,255,255,0.5)",background:F===T.M.Pending?"rgba(250, 173, 20, 0.1)":"transparent",borderRadius:8},children:["รอทำ (",V,")"]}),(0,o.jsxs)(f.ZP,{type:"text",onClick:()=>Q(T.M.Cooking),style:{color:F===T.M.Cooking?"#1890ff":"rgba(255,255,255,0.5)",background:F===T.M.Cooking?"rgba(24, 144, 255, 0.1)":"transparent",borderRadius:8},children:["กำลังปรุง (",K,")"]})]}),(0,o.jsxs)(d.Z,{size:12,children:[(0,o.jsx)(g.Z,{title:"เปิด/ปิดเสียงแจ้งเตือน",children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,color:"rgba(255,255,255,0.7)"},children:[(0,o.jsx)(v.Z,{}),(0,o.jsx)(h.Z,{size:"small",checked:M,onChange:L})]})}),(0,o.jsx)(f.ZP,{icon:(0,o.jsx)(j.Z,{}),onClick:()=>X(),loading:z,style:{background:"rgba(255,255,255,0.1)",borderColor:"transparent",color:"#fff",borderRadius:10},children:"รีเฟรช"})]})]})]}),z?(0,o.jsx)("div",{style:{textAlign:"center",padding:100},children:(0,o.jsx)(p.Z,{size:"large",tip:"กำลังโหลดออเดอร์..."})}):0===H.length?(0,o.jsx)("div",{style:{textAlign:"center",padding:100,background:"rgba(255,255,255,0.02)",borderRadius:24,border:"2px dashed rgba(255,255,255,0.05)"},children:(0,o.jsx)(b.Z,{image:b.Z.PRESENTED_IMAGE_SIMPLE,description:(0,o.jsx)(D,{style:{color:"rgba(255,255,255,0.4)",fontSize:18},children:"ไม่มีออเดอร์ค้างในครัว"})})}):(0,o.jsx)(y.Z,{gutter:[20,20],children:H.map(e=>{let t=B(e.created_at);return(0,o.jsx)(m.Z,{xs:24,sm:12,lg:8,xl:6,children:(0,o.jsxs)("div",{style:{...Z.Np.kitchenGlassCard,height:"100%",display:"flex",flexDirection:"column",borderTop:"4px solid ".concat(t.color),boxShadow:"high"===t.urgency?"0 0 20px ".concat(t.bgColor):Z.Np.kitchenGlassCard.boxShadow},children:[(0,o.jsx)("div",{style:{padding:"16px 16px 12px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)(N,{level:4,style:{margin:0,color:"#fff",fontSize:20},children:["#",e.order_no]}),(0,o.jsx)(d.Z,{style:{marginTop:4},children:e.table_name?(0,o.jsxs)(x.Z,{color:"blue",style:{borderRadius:4,margin:0},children:["โต๊ะ: ",e.table_name]}):(0,o.jsx)(x.Z,{color:"purple",style:{borderRadius:4,margin:0},children:e.order_type})})]}),(0,o.jsx)("div",{style:{textAlign:"right"},children:(0,o.jsx)(x.Z,{icon:(0,o.jsx)(_.Z,{}),style:{background:t.bgColor,color:t.color,border:"none",borderRadius:6,fontWeight:600,margin:0},children:A()(e.created_at).fromNow(!0)})})]})}),(0,o.jsx)("div",{style:{flex:1,padding:12,maxHeight:400,overflowY:"auto"},children:e.items.map(e=>{var t;return(0,o.jsx)("div",{style:{background:"rgba(255,255,255,0.03)",borderRadius:12,padding:12,marginBottom:10,border:"1px solid ".concat(e.status===T.M.Cooking?"rgba(24, 144, 255, 0.3)":"rgba(255,255,255,0.05)"),position:"relative"},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsxs)("div",{style:{flex:1},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,o.jsxs)("div",{style:{fontSize:18,fontWeight:800,color:e.status===T.M.Cooking?"#1890ff":"#fff",minWidth:35},children:[e.quantity,"x"]}),(0,o.jsx)(D,{style:{fontSize:15,color:"#f1f5f9",fontWeight:500},children:(null===(t=e.product)||void 0===t?void 0:t.display_name)||"สินค้า"})]}),e.notes&&(0,o.jsx)("div",{style:{marginTop:6,padding:"4px 8px",background:"rgba(250, 173, 20, 0.1)",borderRadius:6,borderLeft:"3px solid #faad14"},children:(0,o.jsx)(D,{style:{color:"#faad14",fontSize:13},children:e.notes})}),(0,o.jsx)("div",{style:{marginTop:8},children:(0,o.jsx)(u.Z,{status:e.status===T.M.Cooking?"processing":"default",text:(0,o.jsx)(D,{style:{color:J(e.status),fontSize:12,fontWeight:600},children:Y(e.status).toUpperCase()})})})]}),(0,o.jsxs)("div",{style:{marginLeft:12,display:"flex",alignItems:"center"},children:[e.status===T.M.Pending&&(0,o.jsx)(f.ZP,{type:"primary",shape:"circle",icon:(0,o.jsx)(k.Z,{}),onClick:()=>q(e.id,T.M.Cooking),style:{background:"#1890ff",boxShadow:"0 4px 10px rgba(24, 144, 255, 0.3)"}}),e.status===T.M.Cooking&&(0,o.jsx)(f.ZP,{type:"primary",shape:"circle",icon:(0,o.jsx)(w.Z,{}),onClick:()=>q(e.id,T.M.Served),style:{background:"#52c41a",borderColor:"#52c41a",boxShadow:"0 4px 10px rgba(82, 196, 26, 0.3)"}})]})]})},e.id)})}),(0,o.jsx)("div",{style:{padding:12,background:"rgba(255,255,255,0.02)",borderTop:"1px solid rgba(255,255,255,0.05)"},children:(0,o.jsx)(f.ZP,{block:!0,type:"primary",icon:(0,o.jsx)(C.Z,{}),onClick:()=>W(e.order_id),style:{background:"rgba(82, 196, 26, 0.15)",color:"#52c41a",borderColor:"rgba(82, 196, 26, 0.3)",height:40,borderRadius:10,fontWeight:600},children:"เสิร์ฟทั้งหมด"})})]})},e.order_id)})}),(0,o.jsxs)("div",{style:{position:"fixed",bottom:24,left:"50%",transform:"translateX(-50%)",zIndex:1e3,background:"rgba(15, 23, 42, 0.8)",backdropFilter:"blur(20px)",padding:"12px 24px",borderRadius:50,border:"1px solid rgba(255,255,255,0.1)",display:"flex",gap:24,alignItems:"center",boxShadow:"0 10px 40px rgba(0,0,0,0.5)"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,o.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",background:"#faad14"}}),(0,o.jsxs)(D,{style:{color:"#fff"},children:["รอทำ: ",(0,o.jsx)("span",{style:{fontWeight:800,fontSize:18},children:V})]})]}),(0,o.jsx)("div",{style:{height:20,width:1,background:"rgba(255,255,255,0.1)"}}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,o.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",background:"#1890ff",boxShadow:"0 0 10px #1890ff"}}),(0,o.jsxs)(D,{style:{color:"#fff"},children:["กำลังทำ: ",(0,o.jsx)("span",{style:{fontWeight:800,fontSize:18},children:K})]})]}),(0,o.jsx)("div",{style:{height:20,width:1,background:"rgba(255,255,255,0.1)"}}),(0,o.jsx)(f.ZP,{type:"text",icon:(0,o.jsx)(j.Z,{style:{color:"#fff"}}),onClick:()=>X(),style:{color:"#fff"},children:"REFRESH"})]})]})}},71567:function(e,t,r){"use strict";r.d(t,{q:function(){return n},v:function(){return o}});let o="/api",n={AUTH:{LOGIN:"/auth/login",ME:"/auth/me",CSRF:"/csrf"},POS:{PRODUCTS:"/pos/products",ORDERS:"/pos/orders",TABLES:"/pos/tables",DISCOUNTS:"/pos/discounts",DELIVERY:"/pos/delivery",PAYMENT_METHODS:"/pos/paymentMethod",PAYMENTS:"/pos/payments",CATEGORY:"/pos/category",SHIFTS:{BASE:"/pos/shifts",CURRENT:"/pos/shifts/current",OPEN:"/pos/shifts/open",CLOSE:"/pos/shifts/close"},DASHBOARD:{SALES:"/pos/dashboard/sales",TOP_ITEMS:"/pos/dashboard/top-items"},CHANNELS:{STATS:"/pos/orders/stats"},SHOP_PROFILE:"/pos/shopProfile",SALES_ORDER_ITEMS:"/pos/salesOrderItem",SALES_ORDER_DETAILS:"/pos/salesOrderDetail",PRODUCTS_UNIT:"/pos/productsUnit",PAYMENT_DETAILS:"/pos/paymentDetails",BRANCH:"/branches"}}},14362:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return u},a:function(){return f}});var o=r(57437),n=r(2265),a=r(99376),i=r(5447),l=r(84859),s=r(48651),d=r(3369);let c=(0,n.createContext)(void 0),u=e=>{let{children:t}=e,[r,u]=(0,n.useState)(null),[f,g]=(0,n.useState)(!0),h=(0,a.useRouter)(),p=(0,a.usePathname)(),b=async()=>{try{let e="";e=localStorage.getItem("token_ws")||"";let t=await i.O.getMe(e);u(t)}catch(e){u(null)}finally{g(!1)}};(0,n.useEffect)(()=>{b()},[]);let{showLoading:y,hideLoading:m}=(0,d.x)();(0,n.useEffect)(()=>{f||r||"/login"===p||h.push("/login")},[r,f,p,h]);let x=async e=>{try{y("กำลังเข้าสู่ระบบ...");let t=await i.O.getCsrfToken(),{token:r,...o}=await i.O.login(e,t);r&&localStorage.setItem("token_ws",r),u(o),h.push("/")}catch(e){throw e}finally{m()}},S=async()=>{try{y("กำลังออกจากระบบ...");let e="";e=localStorage.getItem("token_ws")||"",await i.O.logout(e),localStorage.removeItem("token_ws"),l.x.clearQueue(),u(null),h.push("/login")}catch(e){console.error("Logout error:",e)}finally{m()}};return f?(0,o.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-white",children:(0,o.jsx)(s.Z,{size:"large"})}):r||"/login"===p?(0,o.jsx)(c.Provider,{value:{user:r,loading:f,login:x,logout:S,checkAuth:b},children:t}):null},f=()=>{let e=(0,n.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},46252:function(e,t,r){"use strict";r.d(t,{J:function(){return l},SocketProvider:function(){return s}});var o=r(57437),n=r(2265),a=r(68680),i=r(14362);let l=(0,n.createContext)({socket:null,isConnected:!1}),s=e=>{let{children:t}=e,[r,s]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1),{user:u}=(0,i.a)();return(0,n.useEffect)(()=>{if(!u){r&&(r.disconnect(),s(null),c(!1));return}let e=localStorage.getItem("token_ws"),t=(0,a.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:e?{token:e}:void 0});return t.on("connect",()=>{console.log("Socket Connected:",t.id),c(!0)}),t.on("disconnect",()=>{console.log("Socket Disconnected"),c(!1)}),s(t),()=>{t.disconnect()}},[u]),(0,o.jsx)(l.Provider,{value:{socket:r,isConnected:d},children:t})}},3369:function(e,t,r){"use strict";r.d(t,{GlobalLoadingProvider:function(){return s},O:function(){return c},x:function(){return d}});var o=r(57437),n=r(2265),a=r(48651);let i=(0,n.createContext)(void 0),l=(0,n.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,n.useState)({}),[d,c]=(0,n.useState)(void 0),u=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";s(e=>({...e,[t]:(e[t]||0)+1})),e&&c(e)},[]),f=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";s(t=>{if(!t[e])return t;let r={...t};return r[e]-=1,r[e]<=0&&delete r[e],r})},[]),g=(0,n.useCallback)(()=>{s({}),c(void 0)},[]),h=Object.keys(r).length>0,p=(0,n.useMemo)(()=>({isLoading:h,loadingMessage:d}),[h,d]),b=(0,n.useMemo)(()=>({showLoading:u,hideLoading:f,resetLoading:g}),[u,f,g]);return(0,o.jsx)(l.Provider,{value:b,children:(0,o.jsxs)(i.Provider,{value:p,children:[t,h&&(0,o.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center pointer-events-auto bg-black/10 backdrop-blur-[1px]",children:(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,background:"rgba(255, 255, 255, 0.9)",padding:"20px 40px",borderRadius:12,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[(0,o.jsx)(a.Z,{size:"large"}),d&&(0,o.jsx)("div",{style:{fontSize:14,color:"#1f1f1f",fontWeight:500},children:d})]})})]})})};function d(){let e=(0,n.useContext)(i),t=(0,n.useContext)(l);if(!e||!t)throw Error("useGlobalLoading must be used within a GlobalLoadingProvider");return(0,n.useMemo)(()=>({...e,...t}),[e,t])}function c(){let e=(0,n.useContext)(l);if(!e)throw Error("useGlobalLoadingDispatch must be used within a GlobalLoadingProvider");return e}},2913:function(e,t,r){"use strict";function o(e,t){return({GET:"".concat(n.API_BASE_URL).concat(t),POST:"".concat(n.API_BASE_URL).concat(t),PUT:"".concat(n.API_BASE_URL).concat(t),DELETE:"".concat(n.API_BASE_URL).concat(t),PATCH:"".concat(n.API_BASE_URL).concat(t)})[e]}r.d(t,{b:function(){return o}});let n={get API_BASE_URL(){return"/api"}}},5447:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});var o=r(71567),n=r(2913);let a={login:async(e,t,r)=>{try{let a=(0,n.b)("POST",o.q.AUTH.LOGIN),i={"Content-Type":"application/json"};t&&(i["X-CSRF-Token"]=t),r&&(i.Cookie=r);let l=await fetch(a,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.message||e.detail||"เข้าสู่ระบบไม่สำเร็จ")}let s=await l.json();return{...s.user,token:s.token}}catch(e){throw Error(e.message||"เข้าสู่ระบบไม่สำเร็จ")}},logout:async(e,t,r)=>{try{let o=(0,n.b)("POST","/auth/logout"),a={"Content-Type":"application/json"};e&&(a.Authorization="Bearer ".concat(e)),t&&(a["X-CSRF-Token"]=t),r&&(a.Cookie=r),await fetch(o,{method:"POST",headers:a,credentials:"include"})}catch(e){console.error("Logout failed",e)}},getMe:async e=>{try{let t=(0,n.b)("GET",o.q.AUTH.ME),r=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include",cache:"no-store"});if(!r.ok)throw Error("Unauthorized");return await r.json()}catch(e){throw e}},async getCsrfToken(){try{let e=await fetch("".concat(o.v).concat(o.q.AUTH.CSRF),{credentials:"include"});if(!e.ok)return"";return(await e.json()).csrfToken}catch(e){return console.error("Failed to fetch CSRF token",e),""}}}},84859:function(e,t,r){"use strict";r.d(t,{M:function(){return l},x:function(){return i}});let o="pos_offline_queue",n=()=>{let e=localStorage.getItem(o);return e?JSON.parse(e):[]},a=e=>{localStorage.setItem(o,JSON.stringify(e))},i={addToQueue:(e,t)=>{let r=n(),o={id:"offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,payload:t,timestamp:Date.now(),retryCount:0};return a([...r,o]),o},getQueue:()=>n(),removeFromQueue:e=>{a(n().filter(t=>t.id!==e))},incrementRetry:(e,t)=>{a(n().map(r=>r.id===e?{...r,retryCount:r.retryCount+1,lastError:t}:r))},clearQueue:()=>{localStorage.removeItem(o)},pruneExceeded:()=>{a(n().filter(e=>e.retryCount<=5))}},l={maxRetry:5,backoff:e=>Math.min(3e4,2e3*e)}},53286:function(e,t,r){"use strict";r.d(t,{x:function(){return x}});var o=r(20019),n=r(2913),a=r(71567),i=r(32446);let l=o.Ryn({id:o.Z_8(),username:o.Z_8()}).partial().nullable(),s=o.Ryn({id:o.Z_8(),display_name:o.Z_8()}).partial().nullable(),d=o.Ryn({id:o.Z_8(),display_name:o.Z_8(),img_url:o.Z_8().nullable(),price:o.oQ2.number(),category:s.optional()}).partial().nullable(),c=o.Ryn({id:o.Z_8().optional(),detail_name:o.Z_8(),extra_price:o.oQ2.number()}).partial(),u=o.Ryn({id:o.Z_8(),order_id:o.Z_8(),product_id:o.Z_8(),product_name:o.Z_8().optional(),quantity:o.oQ2.number(),price:o.oQ2.number(),total_price:o.oQ2.number(),discount_amount:o.oQ2.number().optional().default(0),notes:o.Z_8().nullable().optional(),status:o.jbo(i.i).optional(),product:d.optional(),details:o.IXX(c).optional()}),f=o.Ryn({id:o.Z_8(),order_no:o.Z_8(),order_type:o.jbo(i.m),table_id:o.Z_8().nullable().optional(),delivery_id:o.Z_8().nullable().optional(),delivery_code:o.Z_8().nullable().optional(),sub_total:o.oQ2.number(),discount_id:o.Z_8().nullable().optional(),discount_amount:o.oQ2.number(),vat:o.oQ2.number(),total_amount:o.oQ2.number(),received_amount:o.oQ2.number(),change_amount:o.oQ2.number(),status:o.jbo(i.i),created_by_id:o.Z_8().nullable().optional(),create_date:o.Z_8(),update_date:o.Z_8(),items:o.IXX(u).optional(),created_by:l.optional(),table:o.YjB().optional(),delivery:o.YjB().optional(),discount:o.YjB().optional(),payments:o.IXX(o.YjB()).optional()}),g=o.Ryn({data:o.IXX(f),total:o.oQ2.number(),page:o.oQ2.number(),last_page:o.oQ2.number().optional()}),h=o.Ryn({table_name:o.Z_8().nullable().optional(),delivery_name:o.Z_8().nullable().optional()}).partial().nullable(),p=o.Ryn({id:o.Z_8(),order_no:o.Z_8(),order_type:o.jbo(i.m),status:o.jbo(i.i),create_date:o.Z_8(),total_amount:o.oQ2.number(),delivery_code:o.Z_8().nullable().optional(),table_id:o.Z_8().nullable().optional(),delivery_id:o.Z_8().nullable().optional(),table:h.optional(),delivery:h.optional(),items_summary:o.IMB(o.Z_8(),o.oQ2.number()).optional(),items_count:o.oQ2.number().optional()}),b=o.Ryn({data:o.IXX(p),total:o.oQ2.number(),page:o.oQ2.number(),last_page:o.oQ2.number().optional()}),y=a.q.POS.ORDERS,m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},x={getAll:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:t.toString(),limit:r.toString(),...a&&{status:a},...i&&{type:i},...l&&{q:l}}),d="".concat(y,"?").concat(s.toString()),c=(0,n.b)("GET",d),u=m(e,""),f=await fetch(c,{cache:"no-store",headers:u,credentials:"include"});if(!f.ok){let e=await f.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลออเดอร์ได้")}let h=await f.json();try{return g.parse(h)}catch(e){throw console.error("Zod Validation Error in ordersService.getAll:",e),e instanceof o.jmq&&console.error("Zod Issues:",e.issues),e}},getAllSummary:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:t.toString(),limit:r.toString(),...a&&{status:a},...i&&{type:i},...l&&{q:l}}),d="".concat(y,"/summary?").concat(s.toString()),c=(0,n.b)("GET",d),u=m(e,""),f=await fetch(c,{cache:"no-store",headers:u,credentials:"include"});if(!f.ok){let e=await f.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลออเดอร์ได้")}let g=await f.json();try{return b.parse(g)}catch(e){throw console.error("Zod Validation Error in ordersService.getAllSummary:",e),e instanceof o.jmq&&console.error("Zod Issues:",e.issues),e}},getStats:async e=>{let t=(0,n.b)("GET",a.q.POS.CHANNELS.STATS),r=m(e,""),o=await fetch(t,{cache:"no-store",headers:r,credentials:"include"});if(!o.ok){let e=await o.text();console.error("Order Stats Backend Error:",e);let t=await JSON.parse(e).catch(()=>({}));throw Error(t.error||t.message||"ไม่สามารถดึงข้อมูลสถิติได้")}return await o.json()},getById:async(e,t)=>{let r=(0,n.b)("GET","".concat(y,"/").concat(e)),a=m(t,""),i=await fetch(r,{cache:"no-store",headers:a,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลออเดอร์ได้")}let l=await i.json();try{return f.parse(l)}catch(e){throw console.error("Zod Validation Error in ordersService.getById:",e),e instanceof o.jmq&&console.error("Zod Issues:",e.issues),e}},create:async(e,t,r)=>{let o=(0,n.b)("POST","".concat(y)),a=m(t);r&&(a["X-CSRF-Token"]=r);let i=await fetch(o,{method:"POST",headers:a,credentials:"include",body:JSON.stringify(e)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างออเดอร์ได้")}return i.json()},update:async(e,t,r,o)=>{let a=(0,n.b)("PUT","".concat(y,"/").concat(e)),i=m(r);o&&(i["X-CSRF-Token"]=o);let l=await fetch(a,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถแก้ไขออเดอร์ได้")}return l.json()},delete:async(e,t,r)=>{let o=(0,n.b)("DELETE","".concat(y,"/").concat(e)),a=m(t,"");r&&(a["X-CSRF-Token"]=r);let i=await fetch(o,{method:"DELETE",headers:a,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถลบออเดอร์ได้")}},updateItemStatus:async(e,t,r,o)=>{let a=(0,n.b)("PATCH","".concat(y,"/items/").concat(e,"/status")),i=m(r);o&&(i["X-CSRF-Token"]=o);let l=await fetch(a,{method:"PATCH",headers:i,credentials:"include",body:JSON.stringify({status:t})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตสถานะรายการได้")}},getItems:async(e,t)=>{let r=(0,n.b)("GET","".concat(y,"/items").concat(e?"?status=".concat(e):"")),o=m(t,""),a=await fetch(r,{cache:"no-store",headers:o,credentials:"include"});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลรายการได้")}return a.json()},addItem:async(e,t,r,o)=>{let a=(0,n.b)("POST","".concat(y,"/").concat(e,"/items")),i=m(r);o&&(i["X-CSRF-Token"]=o);let l=await fetch(a,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถเพิ่มรายการได้")}return l.json()},updateItem:async(e,t,r,o)=>{let a=(0,n.b)("PUT","".concat(y,"/items/").concat(e)),i=m(r);o&&(i["X-CSRF-Token"]=o);let l=await fetch(a,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถแก้ไขรายการได้")}return l.json()},deleteItem:async(e,t,r)=>{let o=(0,n.b)("DELETE","".concat(y,"/items/").concat(e)),a=m(t,"");r&&(a["X-CSRF-Token"]=r);let i=await fetch(o,{method:"DELETE",headers:a,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถลบรายการได้")}return i.json()},updateStatus:async(e,t,r)=>{let o={"Content-Type":"application/json"};r&&(o["X-CSRF-Token"]=r);let a=(0,n.b)("PUT","".concat(y,"/").concat(e));if(!(await fetch(a,{method:"PUT",headers:o,body:JSON.stringify({status:t}),credentials:"include"})).ok)throw Error("Failed to update status")}}},44225:function(e,t,r){"use strict";r.d(t,{Np:function(){return a},X1:function(){return o},ax:function(){return i},hS:function(){return n}});let o={primary:"#1890ff",secondary:"#13c2c2",success:"#52c41a",warning:"#faad14",error:"#ff4d4f",background:"#f5f5f5",cardBg:"#ffffff",text:"#262626",textSecondary:"#8c8c8c",border:"#f0f0f0",id_dineIn:"#1890ff",id_takeaway:"#52c41a",id_delivery:"#722ed1",kitchen:"#ff6b35",shift:"#10b981",kitchenBg:"#0f172a",kitchenCard:"rgba(30, 41, 59, 0.7)",kitchenBorder:"rgba(255, 255, 255, 0.1)"},n={dineIn:{primary:"#1890ff",light:"#e6f7ff",border:"#91d5ff",gradient:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)"},takeaway:{primary:"#52c41a",light:"#f6ffed",border:"#b7eb8f",gradient:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)"},delivery:{primary:"#722ed1",light:"#f9f0ff",border:"#d3adf7",gradient:"linear-gradient(135deg, #722ed1 0%, #9254de 100%)"}},a={container:{minHeight:"100vh",background:o.background,fontFamily:"'Inter', 'Sarabun', sans-serif"},heroParams:{background:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)",padding:"32px 24px 70px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(24, 144, 255, 0.25)",marginBottom:-40,zIndex:1,overflow:"hidden"},kitchenContainer:{minHeight:"100vh",background:"#0f172a",padding:"24px 24px 100px",color:"#f8fafc",fontFamily:"'Inter', 'Sarabun', sans-serif"},kitchenGlassCard:{background:"rgba(30, 41, 59, 0.7)",backdropFilter:"blur(12px)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:20,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",overflow:"hidden"},kitchenHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24,flexWrap:"wrap",gap:16},shiftHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},sectionTitle:{display:"flex",alignItems:"center",gap:12,marginBottom:20,color:"#fff"},contentWrapper:{maxWidth:1400,margin:"-40px auto 30px",padding:"0 24px",position:"relative",zIndex:20},card:{borderRadius:16,boxShadow:"0 4px 12px rgba(0,0,0,0.05)",border:"none",overflow:"hidden",background:o.cardBg},itemCard:{marginBottom:8,borderRadius:8,transition:"all 0.3s ease"}},i={available:{primary:"#52c41a",light:"#f6ffed",border:"#b7eb8f",gradient:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)"},occupied:{primary:"#fa8c16",light:"#fff7e6",border:"#ffd591",gradient:"linear-gradient(135deg, #fa8c16 0%, #ffa940 100%)"},inactive:{primary:"#8c8c8c",light:"#fafafa",border:"#d9d9d9",gradient:"linear-gradient(135deg, #8c8c8c 0%, #bfbfbf 100%)"},waitingForPayment:{primary:"#1890ff",light:"#e6f7ff",border:"#91d5ff",gradient:"linear-gradient(135deg, #1890ff 0%, #40a9ff 100%)"}}},32446:function(e,t,r){"use strict";var o,n,a,i;r.d(t,{i:function(){return n},m:function(){return o}}),(a=o||(o={})).DineIn="DineIn",a.TakeAway="TakeAway",a.Delivery="Delivery",(i=n||(n={})).Pending="Pending",i.Cooking="Cooking",i.Served="Served",i.WaitingForPayment="WaitingForPayment",i.Paid="Paid",i.Completed="Completed",i.Cancelled="Cancelled"},5105:function(e,t,r){"use strict";var o,n;r.d(t,{M:function(){return o}}),(n=o||(o={})).Pending="Pending",n.Cooking="Cooking",n.Served="Served",n.Cancelled="Cancelled"},97235:function(e,t,r){"use strict";r.d(t,{P:function(){return l}});var o=r(5447);let n=null,a=0,i=null;async function l(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&n&&t-a<6e5?n:(i||(i=o.O.getCsrfToken().then(e=>(n=e||"",a=Date.now(),n)).finally(()=>{i=null})),i)}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,7213,9021,2224,1721,9,19,9763,5713,1713,3181,2971,2117,1744],function(){return e(e.s=85226)}),_N_E=e.O()}]);