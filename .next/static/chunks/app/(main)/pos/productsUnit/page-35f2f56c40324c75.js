(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4663],{10328:function(e,t,i){Promise.resolve().then(i.bind(i,89002))},89002:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return A}});var s=i(57437),r=i(29),n=i.n(r),a=i(2265),l=i(19683),o=i(50742),d=i(88589),c=i(85180),h=i(53743),p=i(34029),x=i(1915),u=i(89245),g=i(96473),y=i(29436),j=i(13377),b=i(26349),f=i(99376),m=i(3369),v=i(26972),w=i(24675),R=i(97235),k=i(3286),S=i(67697),C=i(73814),E=i(58525),_=i(2938);let{Text:F,Title:N}=l.default,Z=e=>{let{onRefresh:t,onAdd:i,onSearch:r}=e;return(0,s.jsxs)("div",{style:E.R.header,children:[(0,s.jsx)("div",{style:E.R.headerDecoCircle1}),(0,s.jsx)("div",{style:E.R.headerDecoCircle2}),(0,s.jsxs)("div",{style:E.R.headerContent,children:[(0,s.jsxs)("div",{style:E.R.headerLeft,children:[(0,s.jsx)("div",{style:E.R.headerIconBox,children:(0,s.jsx)(x.Z,{style:{fontSize:24,color:"white"}})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(F,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"จัดการข้อมูล"}),(0,s.jsx)(N,{level:4,style:{color:"white",margin:0,fontWeight:700,letterSpacing:"0.5px",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"หน่วยสินค้า"})]})]}),(0,s.jsxs)("div",{style:E.R.headerActions,children:[(0,s.jsx)(o.ZP,{type:"text",icon:(0,s.jsx)(u.Z,{style:{color:"white"}}),onClick:t,style:{background:"rgba(255,255,255,0.2)",backdropFilter:"blur(4px)",borderRadius:12,height:40,width:40,border:"1px solid rgba(255,255,255,0.3)"}}),(0,s.jsx)(o.ZP,{type:"primary",icon:(0,s.jsx)(g.Z,{}),onClick:i,style:{background:"white",color:"#0891B2",borderRadius:12,height:40,fontWeight:600,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:(0,s.jsx)("span",{className:"hidden sm:inline",children:"เพิ่มหน่วย"})})]})]}),(0,s.jsx)("div",{style:{marginTop:24,padding:"0 4px"},children:(0,s.jsx)(d.default,{prefix:(0,s.jsx)(y.Z,{style:{color:"#fff",opacity:.7}}),placeholder:"ค้นหาหน่วยสินค้า...",onChange:e=>r(e.target.value),bordered:!1,style:{background:"rgba(255,255,255,0.15)",backdropFilter:"blur(8px)",borderRadius:14,padding:"8px 16px",color:"white",fontSize:15},className:"search-input-placeholder-white"})})]})},B=e=>{let{totalUnits:t,activeUnits:i,inactiveUnits:r}=e;return(0,s.jsxs)("div",{style:E.R.statsCard,children:[(0,s.jsxs)("div",{style:E.R.statItem,children:[(0,s.jsx)("span",{style:{...E.R.statNumber,color:"#0891B2"},children:t}),(0,s.jsx)(F,{style:E.R.statLabel,children:"ทั้งหมด"})]}),(0,s.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,s.jsxs)("div",{style:E.R.statItem,children:[(0,s.jsx)("span",{style:{...E.R.statNumber,color:"#10B981"},children:i}),(0,s.jsx)(F,{style:E.R.statLabel,children:"ใช้งาน"})]}),(0,s.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,s.jsxs)("div",{style:E.R.statItem,children:[(0,s.jsx)("span",{style:{...E.R.statNumber,color:"#EF4444"},children:r}),(0,s.jsx)(F,{style:E.R.statLabel,children:"ไม่ใช้งาน"})]})]})},z=e=>{let{unit:t,index:i,onEdit:r,onDelete:n}=e;return(0,s.jsx)("div",{className:"unit-card",style:{...E.R.unitCard(t.is_active),animationDelay:"".concat(.05*i,"s")},onClick:()=>r(t),children:(0,s.jsxs)("div",{style:E.R.unitCardInner,children:[(0,s.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:t.is_active?"linear-gradient(135deg, #CFFAFE 0%, #A5F3FC 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:t.is_active?"0 4px 10px rgba(8, 145, 178, 0.1)":"none"},children:(0,s.jsx)(x.Z,{style:{fontSize:24,color:t.is_active?"#0891B2":"#94A3B8"}})}),(0,s.jsxs)("div",{style:{flex:1,minWidth:0,paddingRight:8},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,s.jsx)(F,{strong:!0,style:{fontSize:16,color:t.is_active?"#1E293B":"#64748B"},ellipsis:{tooltip:t.display_name},children:t.display_name}),t.is_active?(0,s.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#10B981",boxShadow:"0 0 0 2px #ecfdf5"}}):(0,s.jsx)("div",{style:{width:6,height:6,borderRadius:"50%",background:"#CBD5E1"}})]}),(0,s.jsx)(F,{type:"secondary",style:{fontSize:13,display:"block",color:"#64748B"},ellipsis:{tooltip:t.unit_name},children:t.unit_name})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,s.jsx)(o.ZP,{type:"text",icon:(0,s.jsx)(j.Z,{}),onClick:e=>{e.stopPropagation(),r(t)},style:{borderRadius:12,color:"#0891B2",background:"#CFFAFE",width:36,height:36}}),(0,s.jsx)(o.ZP,{type:"text",danger:!0,icon:(0,s.jsx)(b.Z,{}),onClick:e=>{e.stopPropagation(),n(t)},style:{borderRadius:12,background:"#FEF2F2",width:36,height:36}})]})]})})},P=e=>{let{onAdd:t,isSearch:i}=e;return(0,s.jsx)(c.Z,{image:c.Z.PRESENTED_IMAGE_SIMPLE,description:(0,s.jsxs)("div",{style:{textAlign:"center"},children:[(0,s.jsx)(F,{type:"secondary",style:{fontSize:15},children:i?"ไม่พบข้อมูลที่ค้นหา":"ยังไม่มีหน่วยสินค้า"}),(0,s.jsx)("br",{}),!i&&(0,s.jsx)(F,{type:"secondary",style:{fontSize:13},children:"เริ่มต้นเพิ่มหน่วยแรกของคุณได้เลย"})]}),style:{padding:"60px 20px",background:"white",borderRadius:24,margin:"24px 16px",boxShadow:"0 4px 24px rgba(0,0,0,0.04)"},children:!i&&(0,s.jsx)(o.ZP,{type:"primary",icon:(0,s.jsx)(g.Z,{}),onClick:t,size:"large",style:{background:"#0891B2",borderRadius:12,height:48,padding:"0 32px",boxShadow:"0 4px 12px rgba(8, 145, 178, 0.3)"},children:"เพิ่มหน่วยสินค้า"})})};function A(){let e=(0,f.useRouter)(),[t,i]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[o,d]=(0,a.useState)(""),{execute:c}=(0,v.J)(),{showLoading:x}=(0,m.x)(),{socket:u}=(0,w.s)(),{isAuthorized:g,isChecking:y}=(0,k.e)({requiredRole:"Admin"});(0,a.useEffect)(()=>{(0,R.P)()},[]),(0,a.useEffect)(()=>{let e=(0,C.t)("pos:products-units",6e5);e&&e.length>0&&i(e)},[]);let j=(0,a.useCallback)(async()=>{c(async()=>{let e=await fetch("/api/pos/productsUnit");if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||t.message||"ไม่สามารถดึงข้อมูลหน่วยสินค้าได้")}i(await e.json())},"กำลังโหลดข้อมูลหน่วยสินค้า...")},[c]);(0,a.useEffect)(()=>{g&&j()},[g,j]),(0,S.v)(u,{create:"productsUnit:create",update:"productsUnit:update",delete:"productsUnit:delete"},i),(0,a.useEffect)(()=>{if(o){let e=o.toLowerCase();l(t.filter(t=>t.display_name.toLowerCase().includes(e)||t.unit_name.toLowerCase().includes(e)))}else l(t)},[t,o]),(0,a.useEffect)(()=>{t.length>0&&(0,C.v)("pos:products-units",t)},[t]);let F=()=>{x("กำลังเปิดหน้าจัดการหน่วยสินค้า..."),e.push("/pos/productsUnit/manager/add")},N=t=>{x("กำลังเปิดหน้าแก้ไขหน่วยสินค้า..."),e.push("/pos/productsUnit/manager/edit/".concat(t.id))},A=e=>{h.Z.confirm({title:"ยืนยันการลบหน่วยสินค้า",content:'คุณต้องการลบหน่วย "'.concat(e.display_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,s.jsx)(b.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{await c(async()=>{let t=await (0,R.P)();if(!(await fetch("/api/pos/productsUnit/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบหน่วยสินค้าได้");p.ZP.success('ลบหน่วย "'.concat(e.display_name,'" สำเร็จ'))},"กำลังลบหน่วยสินค้า...")}})};if(y)return(0,s.jsx)(_.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."});if(!g)return(0,s.jsx)(_.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"});let I=t.filter(e=>e.is_active),L=t.filter(e=>!e.is_active);return(0,s.jsxs)("div",{style:E.R.container,className:"jsx-154188238361bfc6 unit-page",children:[(0,s.jsx)("style",{children:E.W}),(0,s.jsx)(n(),{id:"154188238361bfc6",children:".search-input-placeholder-white input::-webkit-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input{color:white!important}.unit-card{cursor:pointer;-webkit-tap-highlight-color:transparent}"}),(0,s.jsx)(Z,{onRefresh:j,onAdd:F,onSearch:e=>{d(e)}}),(0,s.jsx)("div",{style:{marginTop:-32,padding:"0 16px",position:"relative",zIndex:10},className:"jsx-154188238361bfc6",children:(0,s.jsx)(B,{totalUnits:t.length,activeUnits:I.length,inactiveUnits:L.length})}),(0,s.jsx)("div",{style:E.R.listContainer,className:"jsx-154188238361bfc6",children:r.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{style:E.R.sectionTitle,className:"jsx-154188238361bfc6",children:[(0,s.jsx)("div",{style:{width:4,height:16,background:"#0891B2",borderRadius:2},className:"jsx-154188238361bfc6"}),(0,s.jsx)("span",{style:{fontSize:16,fontWeight:700,color:"#1E293B"},className:"jsx-154188238361bfc6",children:"รายการหน่วยสินค้า"}),(0,s.jsx)("div",{style:{background:"#CFFAFE",color:"#0891B2",padding:"2px 10px",borderRadius:12,fontSize:12,fontWeight:700,marginLeft:"auto"},className:"jsx-154188238361bfc6",children:r.length})]}),r.map((e,t)=>(0,s.jsx)(z,{unit:e,index:t,onEdit:N,onDelete:A},e.id))]}):(0,s.jsx)(P,{onAdd:F,isSearch:!!o})}),(0,s.jsx)("div",{style:{height:40},className:"jsx-154188238361bfc6"})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=10328)}),_N_E=e.O()}]);