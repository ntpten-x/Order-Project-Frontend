(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7736],{40919:function(e,t,s){Promise.resolve().then(s.bind(s,10303))},10303:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return z}});var i=s(57437),n=s(2265),r=s(60283),a=s(19878),l=s(34029),o=s(53743),d=s(50742),c=s(48651),x=s(47451),h=s(69410),p=s(96931),u=s(88589),g=s(66487),y=s(99376),m=s(25193),f=s(37410),j=s(20148),b=s(1915),F=s(8900),v=s(26349),k=s(88009),Z=s(78355),S=s(97235),E=s(67918),_=s(2938),C=s(58525);let{Title:w,Text:B}=r.default,R=e=>{let{displayName:t,unitName:s,isActive:n}=e;return(0,i.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",textAlign:"center",border:"1px solid #F1F5F9",height:"100%"},children:[(0,i.jsx)(w,{level:5,style:{color:"#94A3B8",marginBottom:20,fontWeight:600},children:"ตัวอย่างการแสดงผล"}),(0,i.jsxs)("div",{style:{borderRadius:20,border:"1px solid ".concat(n?"#E2E8F0":"#F1F5F9"),padding:16,background:n?"white":"rgba(255,255,255,0.6)",boxShadow:n?"0 4px 12px rgba(0,0,0,0.06)":"none",display:"flex",alignItems:"center",gap:16,marginBottom:24,maxWidth:320,margin:"0 auto 24px"},children:[(0,i.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:n?"linear-gradient(135deg, #CFFAFE 0%, #A5F3FC 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,i.jsx)(b.Z,{style:{fontSize:24,color:n?"#0891B2":"#94A3B8"}})}),(0,i.jsxs)("div",{style:{textAlign:"left",flex:1},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.jsx)(B,{strong:!0,style:{fontSize:16,color:n?"#1E293B":"#64748B"},children:t||"ชื่อหน่วย"}),n&&(0,i.jsx)(F.Z,{style:{color:"#10B981",fontSize:14}})]}),(0,i.jsx)(B,{type:"secondary",style:{fontSize:13,display:"block"},children:s||"Unit Name"})]})]}),(0,i.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:16,padding:16},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,i.jsx)(B,{style:{fontSize:13,color:"#64748B"},children:"สถานะ"}),(0,i.jsx)("div",{style:{padding:"4px 12px",borderRadius:20,background:n?"#ECFDF5":"#FEF2F2",color:n?"#10B981":"#EF4444",fontSize:12,fontWeight:600},children:n?"พร้อมใช้งาน":"ปิดใช้งาน"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)(B,{style:{fontSize:13,color:"#64748B"},children:"ประเภท"}),(0,i.jsx)(B,{strong:!0,style:{fontSize:13,color:"#1E293B"},children:"หน่วยนับสินค้า"})]})]})]})};function z(e){let{params:t}=e,s=(0,y.useRouter)(),[r]=a.Z.useForm(),[b,F]=(0,n.useState)(!1),[z,A]=(0,n.useState)(!1),[P,T]=(0,n.useState)(""),[I,U]=(0,n.useState)(""),[N,W]=(0,n.useState)(!0),[O,L]=(0,n.useState)(""),q=t.mode[0],V=t.mode[1]||null,D="edit"===q&&!!V,{isAuthorized:H,isChecking:M}=(0,E.e)({allowedRoles:["Admin","Manager"]});(0,n.useEffect)(()=>{(async()=>{L(await (0,S.P)())})()},[]);let X=(0,n.useCallback)(async()=>{F(!0);try{let e=await fetch("/api/pos/productsUnit/getById/".concat(V));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลหน่วยสินค้าได้");let t=await e.json();r.setFieldsValue({unit_name:t.unit_name,display_name:t.display_name,is_active:t.is_active}),T(t.display_name||""),U(t.unit_name||""),W(t.is_active)}catch(e){console.error(e),l.ZP.error("ไม่สามารถดึงข้อมูลหน่วยสินค้าได้"),s.push("/pos/productsUnit")}finally{F(!1)}},[V,r,s]);(0,n.useEffect)(()=>{D&&X()},[D,V,X]);let J=async e=>{A(!0);try{let t=D?"/api/pos/productsUnit/update/".concat(V):"/api/pos/productsUnit/create",i=await fetch(t,{method:D?"PUT":"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":O},body:JSON.stringify(e)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||(D?"ไม่สามารถอัปเดตหน่วยสินค้าได้":"ไม่สามารถสร้างหน่วยสินค้าได้"))}l.ZP.success(D?"อัปเดตหน่วยสินค้าสำเร็จ":"สร้างหน่วยสินค้าสำเร็จ"),s.push("/pos/productsUnit")}catch(e){console.error(e),l.ZP.error(e instanceof Error?e.message:"ไม่สามารถสร้าง/แก้ไขหน่วยสินค้าได้")}finally{A(!1)}},K=()=>s.push("/pos/productsUnit");return M?(0,i.jsx)(_.H,{message:"กำลังตรวจสอบสิทธิ์..."}):H?(0,i.jsxs)("div",{className:"manage-page",style:C.R.container,children:[(0,i.jsx)(j.Z,{title:D?"แก้ไขหน่วยสินค้า":"เพิ่มหน่วยสินค้า",subtitle:D?"แก้ไขข้อมูลหน่วยสินค้า":"สร้างหน่วยสินค้าใหม่",onBack:K,actions:D?(0,i.jsx)(d.ZP,{danger:!0,onClick:()=>{V&&o.Z.confirm({title:"ยืนยันการลบหน่วยสินค้า",content:'คุณต้องการลบหน่วย "'.concat(P,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,i.jsx)(v.Z,{style:{color:"#EF4444"}}),onOk:async()=>{try{if(!(await fetch("/api/pos/productsUnit/delete/".concat(V),{method:"DELETE",headers:{"X-CSRF-Token":O}})).ok)throw Error("ไม่สามารถลบหน่วยสินค้าได้");l.ZP.success("ลบหน่วยสินค้าสำเร็จ"),s.push("/pos/productsUnit")}catch(e){console.error(e),l.ZP.error("ไม่สามารถลบหน่วยสินค้าได้")}}})},icon:(0,i.jsx)(v.Z,{}),children:"ลบ"}):null}),(0,i.jsx)(m.Z,{maxWidth:1e3,children:(0,i.jsx)(f.Z,{style:{background:"transparent",border:"none"},children:b?(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"100px 0",background:"rgba(255,255,255,0.8)",borderRadius:24,backdropFilter:"blur(10px)"},children:(0,i.jsx)(c.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,i.jsxs)(x.Z,{gutter:[24,24],children:[(0,i.jsx)(h.Z,{xs:24,lg:14,xl:15,children:(0,i.jsxs)(p.Z,{bordered:!1,style:{borderRadius:24,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},styles:{body:{padding:32}},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:24},children:[(0,i.jsx)(k.Z,{style:{fontSize:20,color:"#0891B2"}}),(0,i.jsx)(w,{level:5,style:{margin:0},children:"ข้อมูลหน่วยสินค้า"})]}),(0,i.jsxs)(a.Z,{form:r,layout:"vertical",onFinish:J,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.display_name&&T(e.display_name),void 0!==e.unit_name&&U(e.unit_name),void 0!==e.is_active&&W(e.is_active)},children:[(0,i.jsx)(a.Z.Item,{name:"unit_name",label:(0,i.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"Unit Name (English)"}),rules:[{required:!0,message:"กรุณากรอกชื่อหน่วย"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,i.jsx)(u.default,{size:"large",placeholder:"e.g. Box, Kg, Liter",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,i.jsx)(a.Z.Item,{name:"display_name",label:(0,i.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"ชื่อที่แสดง (ภาษาไทย)"}),rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,i.jsx)(u.default,{size:"large",placeholder:"เช่น กล่อง, กิโลกรัม, ลิตร",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,i.jsx)("div",{style:{padding:"20px",background:"#F8FAFC",borderRadius:16,marginTop:24},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{strong:!0,style:{fontSize:15,display:"block"},children:"สถานะการใช้งาน"}),(0,i.jsx)(B,{type:"secondary",style:{fontSize:13},children:"เปิดเพื่อให้แสดงในหน้าขายสินค้า"})]}),(0,i.jsx)(a.Z.Item,{name:"is_active",valuePropName:"checked",noStyle:!0,children:(0,i.jsx)(g.Z,{style:{background:N?"#10B981":void 0}})})]})}),(0,i.jsxs)("div",{style:{marginTop:32,display:"flex",gap:12},children:[(0,i.jsx)(d.ZP,{size:"large",onClick:K,style:{flex:1,borderRadius:12,height:48,fontWeight:600},children:"ยกเลิก"}),(0,i.jsx)(d.ZP,{type:"primary",htmlType:"submit",loading:z,icon:(0,i.jsx)(Z.Z,{}),style:{flex:2,borderRadius:12,height:48,fontWeight:600,background:"#0891B2",boxShadow:"0 4px 12px rgba(8, 145, 178, 0.3)"},children:"บันทึกข้อมูล"})]})]})]})}),(0,i.jsx)(h.Z,{xs:24,lg:10,xl:9,children:(0,i.jsx)(R,{displayName:P,unitName:I,isActive:N})})]})})})]}):(0,i.jsx)(_.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=40919)}),_N_E=e.O()}]);