(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7736],{40919:function(e,t,s){Promise.resolve().then(s.bind(s,10303))},10303:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return B}});var i=s(57437),r=s(2265),n=s(19683),l=s(50742),a=s(19878),o=s(34029),d=s(53743),c=s(48651),x=s(47451),h=s(69410),p=s(96931),g=s(88589),u=s(66487),y=s(99376),m=s(17588),f=s(26349),j=s(1915),b=s(8900),F=s(88009),v=s(78355),k=s(97235),S=s(3286),E=s(2938),Z=s(58525);let{Title:w,Text:C}=n.default,_=e=>{let{isEdit:t,onBack:s,onDelete:r}=e;return(0,i.jsxs)("div",{style:{...Z.R.header,minHeight:180},children:[(0,i.jsx)("div",{style:Z.R.headerDecoCircle1}),(0,i.jsx)("div",{style:Z.R.headerDecoCircle2}),(0,i.jsxs)("div",{style:Z.R.headerContent,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,i.jsx)(l.ZP,{type:"text",icon:(0,i.jsx)(m.Z,{style:{fontSize:20,color:"white"}}),onClick:s,style:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"white"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)(C,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:t?"แก้ไขข้อมูล":"สร้างรายการใหม่"}),(0,i.jsx)(w,{level:4,style:{color:"white",margin:0,fontWeight:700,textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:t?"แก้ไขหน่วยสินค้า":"เพิ่มหน่วยสินค้า"})]})]}),t&&r&&(0,i.jsx)(l.ZP,{type:"text",danger:!0,icon:(0,i.jsx)(f.Z,{}),onClick:r,style:{background:"#FEF2F2",color:"#EF4444",borderRadius:12,height:40,padding:"0 16px",fontWeight:600},children:(0,i.jsx)("span",{className:"hidden sm:inline",children:"ลบหน่วยสินค้า"})})]})]})},R=e=>{let{displayName:t,unitName:s,isActive:r}=e;return(0,i.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",textAlign:"center",border:"1px solid #F1F5F9",height:"100%"},children:[(0,i.jsx)(w,{level:5,style:{color:"#94A3B8",marginBottom:20,fontWeight:600},children:"ตัวอย่างการแสดงผล"}),(0,i.jsxs)("div",{style:{borderRadius:20,border:"1px solid ".concat(r?"#E2E8F0":"#F1F5F9"),padding:16,background:r?"white":"rgba(255,255,255,0.6)",boxShadow:r?"0 4px 12px rgba(0,0,0,0.06)":"none",display:"flex",alignItems:"center",gap:16,marginBottom:24,maxWidth:320,margin:"0 auto 24px"},children:[(0,i.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:r?"linear-gradient(135deg, #CFFAFE 0%, #A5F3FC 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,i.jsx)(j.Z,{style:{fontSize:24,color:r?"#0891B2":"#94A3B8"}})}),(0,i.jsxs)("div",{style:{textAlign:"left",flex:1},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.jsx)(C,{strong:!0,style:{fontSize:16,color:r?"#1E293B":"#64748B"},children:t||"ชื่อหน่วย"}),r&&(0,i.jsx)(b.Z,{style:{color:"#10B981",fontSize:14}})]}),(0,i.jsx)(C,{type:"secondary",style:{fontSize:13,display:"block"},children:s||"Unit Name"})]})]}),(0,i.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:16,padding:16},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,i.jsx)(C,{style:{fontSize:13,color:"#64748B"},children:"สถานะ"}),(0,i.jsx)("div",{style:{padding:"4px 12px",borderRadius:20,background:r?"#ECFDF5":"#FEF2F2",color:r?"#10B981":"#EF4444",fontSize:12,fontWeight:600},children:r?"พร้อมใช้งาน":"ปิดใช้งาน"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)(C,{style:{fontSize:13,color:"#64748B"},children:"ประเภท"}),(0,i.jsx)(C,{strong:!0,style:{fontSize:13,color:"#1E293B"},children:"หน่วยนับสินค้า"})]})]})]})};function B(e){let{params:t}=e,s=(0,y.useRouter)(),[n]=a.Z.useForm(),[m,j]=(0,r.useState)(!1),[b,B]=(0,r.useState)(!1),[z,P]=(0,r.useState)(""),[A,I]=(0,r.useState)(""),[T,N]=(0,r.useState)(!0),[U,W]=(0,r.useState)(""),D=t.mode[0],O=t.mode[1]||null,q="edit"===D&&!!O,{isAuthorized:L,isChecking:H}=(0,S.e)({requiredRole:"Admin"});(0,r.useEffect)(()=>{(async()=>{W(await (0,k.P)())})()},[]);let V=(0,r.useCallback)(async()=>{j(!0);try{let e=await fetch("/api/pos/productsUnit/getById/".concat(O));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลหน่วยสินค้าได้");let t=await e.json();n.setFieldsValue({unit_name:t.unit_name,display_name:t.display_name,is_active:t.is_active}),P(t.display_name||""),I(t.unit_name||""),N(t.is_active)}catch(e){console.error(e),o.ZP.error("ไม่สามารถดึงข้อมูลหน่วยสินค้าได้"),s.push("/pos/productsUnit")}finally{j(!1)}},[O,n,s]);(0,r.useEffect)(()=>{q&&V()},[q,O,V]);let X=async e=>{B(!0);try{let t=q?"/api/pos/productsUnit/update/".concat(O):"/api/pos/productsUnit/create",i=q?"PUT":"POST",r=await fetch(t,{method:i,headers:{"Content-Type":"application/json","X-CSRF-Token":U},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||(q?"ไม่สามารถอัปเดตหน่วยสินค้าได้":"ไม่สามารถสร้างหน่วยสินค้าได้"))}o.ZP.success(q?"อัปเดตหน่วยสินค้าสำเร็จ":"สร้างหน่วยสินค้าสำเร็จ"),s.push("/pos/productsUnit")}catch(e){console.error(e),o.ZP.error(e instanceof Error?e.message:"ไม่สามารถสร้าง/แก้ไขหน่วยสินค้าได้")}finally{B(!1)}},J=()=>s.push("/pos/productsUnit");return H?(0,i.jsx)(E.H,{message:"กำลังตรวจสอบสิทธิ์..."}):L?(0,i.jsxs)("div",{className:"manage-page",style:Z.R.container,children:[(0,i.jsx)(_,{isEdit:q,onBack:J,onDelete:q?()=>{O&&d.Z.confirm({title:"ยืนยันการลบหน่วยสินค้า",content:'คุณต้องการลบหน่วย "'.concat(z,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,i.jsx)(f.Z,{style:{color:"#EF4444"}}),onOk:async()=>{try{if(!(await fetch("/api/pos/productsUnit/delete/".concat(O),{method:"DELETE",headers:{"X-CSRF-Token":U}})).ok)throw Error("ไม่สามารถลบหน่วยสินค้าได้");o.ZP.success("ลบหน่วยสินค้าสำเร็จ"),s.push("/pos/productsUnit")}catch(e){console.error(e),o.ZP.error("ไม่สามารถลบหน่วยสินค้าได้")}}})}:void 0}),(0,i.jsx)("div",{style:{maxWidth:1e3,margin:"-60px auto 40px",padding:"0 16px",position:"relative",zIndex:10},children:m?(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"100px 0",background:"rgba(255,255,255,0.8)",borderRadius:24,backdropFilter:"blur(10px)"},children:(0,i.jsx)(c.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,i.jsxs)(x.Z,{gutter:[24,24],children:[(0,i.jsx)(h.Z,{xs:24,lg:14,xl:15,children:(0,i.jsxs)(p.Z,{bordered:!1,style:{borderRadius:24,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},styles:{body:{padding:32}},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:24},children:[(0,i.jsx)(F.Z,{style:{fontSize:20,color:"#0891B2"}}),(0,i.jsx)(w,{level:5,style:{margin:0},children:"ข้อมูลหน่วยสินค้า"})]}),(0,i.jsxs)(a.Z,{form:n,layout:"vertical",onFinish:X,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.display_name&&P(e.display_name),void 0!==e.unit_name&&I(e.unit_name),void 0!==e.is_active&&N(e.is_active)},children:[(0,i.jsx)(a.Z.Item,{name:"unit_name",label:(0,i.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"Unit Name (English)"}),rules:[{required:!0,message:"กรุณากรอกชื่อหน่วย"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,i.jsx)(g.default,{size:"large",placeholder:"e.g. Box, Kg, Liter",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,i.jsx)(a.Z.Item,{name:"display_name",label:(0,i.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"ชื่อที่แสดง (ภาษาไทย)"}),rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,i.jsx)(g.default,{size:"large",placeholder:"เช่น กล่อง, กิโลกรัม, ลิตร",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,i.jsx)("div",{style:{padding:"20px",background:"#F8FAFC",borderRadius:16,marginTop:24},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(C,{strong:!0,style:{fontSize:15,display:"block"},children:"สถานะการใช้งาน"}),(0,i.jsx)(C,{type:"secondary",style:{fontSize:13},children:"เปิดเพื่อให้แสดงในหน้าขายสินค้า"})]}),(0,i.jsx)(a.Z.Item,{name:"is_active",valuePropName:"checked",noStyle:!0,children:(0,i.jsx)(u.Z,{style:{background:T?"#10B981":void 0}})})]})}),(0,i.jsxs)("div",{style:{marginTop:32,display:"flex",gap:12},children:[(0,i.jsx)(l.ZP,{size:"large",onClick:J,style:{flex:1,borderRadius:12,height:48,fontWeight:600},children:"ยกเลิก"}),(0,i.jsx)(l.ZP,{type:"primary",htmlType:"submit",loading:b,icon:(0,i.jsx)(v.Z,{}),style:{flex:2,borderRadius:12,height:48,fontWeight:600,background:"#0891B2",boxShadow:"0 4px 12px rgba(8, 145, 178, 0.3)"},children:"บันทึกข้อมูล"})]})]})]})}),(0,i.jsx)(h.Z,{xs:24,lg:10,xl:9,children:(0,i.jsx)(R,{displayName:z,unitName:A,isActive:T})})]})})]}):(0,i.jsx)(E.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=40919)}),_N_E=e.O()}]);