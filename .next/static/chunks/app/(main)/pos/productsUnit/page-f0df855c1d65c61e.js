(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4663],{10328:function(e,t,n){Promise.resolve().then(n.bind(n,35533))},35533:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var i=n(57437),r=n(2265),s=n(82646),a=n(50742),l=n(85180),o=n(53743),c=n(34029),d=n(48651),u=n(1915),h=n(89245),p=n(96473),f=n(8900),x=n(39725),g=n(13377),y=n(26349),b=n(99376),j=n(3369),m=n(26972),v=n(24675),k=n(97235),w=n(3286),C=n(67697),S=n(73814);let I={container:{paddingBottom:100,backgroundColor:"#f8f9fc",minHeight:"100vh"},header:{background:"linear-gradient(135deg, #13c2c2 0%, #08979c 100%)",padding:"20px 20px 60px 20px",position:"relative",overflow:"hidden"},headerDecoCircle1:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:"rgba(255,255,255,0.1)"},headerDecoCircle2:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},headerContent:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},headerLeft:{display:"flex",alignItems:"center",gap:12},headerIconBox:{width:48,height:48,borderRadius:14,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)"},headerActions:{display:"flex",gap:8},statsCard:{margin:"-40px 16px 0 16px",padding:"16px",background:"white",borderRadius:20,boxShadow:"0 8px 24px rgba(0,0,0,0.08)",display:"flex",justifyContent:"space-around",position:"relative",zIndex:10},statItem:{textAlign:"center",flex:1},statNumber:{fontSize:24,fontWeight:700,display:"block"},statLabel:{fontSize:12,color:"#8c8c8c",marginTop:2},listContainer:{padding:"20px 16px 0 16px"},sectionTitle:{display:"flex",alignItems:"center",gap:8,marginBottom:16},unitCard:e=>({marginBottom:12,borderRadius:20,border:"none",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",overflow:"hidden",transition:"all 0.3s ease",background:e?"white":"linear-gradient(to right, #fafafa, white)",opacity:e?1:.7}),unitCardInner:{padding:16,display:"flex",alignItems:"center",gap:14}},{Text:z,Title:Z}=s.default,E=e=>{let{onRefresh:t,onAdd:n}=e;return(0,i.jsxs)("div",{style:I.header,children:[(0,i.jsx)("div",{style:I.headerDecoCircle1}),(0,i.jsx)("div",{style:I.headerDecoCircle2}),(0,i.jsxs)("div",{style:I.headerContent,children:[(0,i.jsxs)("div",{style:I.headerLeft,children:[(0,i.jsx)("div",{style:I.headerIconBox,children:(0,i.jsx)(u.Z,{style:{fontSize:24,color:"white"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(z,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block"},children:"จัดการข้อมูล"}),(0,i.jsx)(Z,{level:4,style:{color:"white",margin:0,fontWeight:700,letterSpacing:"0.5px"},children:"หน่วยสินค้า"})]})]}),(0,i.jsxs)("div",{style:I.headerActions,children:[(0,i.jsx)(a.ZP,{type:"text",icon:(0,i.jsx)(h.Z,{style:{color:"white"}}),onClick:t,style:{background:"rgba(255,255,255,0.2)",borderRadius:12,height:40,width:40}}),(0,i.jsx)(a.ZP,{type:"primary",icon:(0,i.jsx)(p.Z,{}),onClick:n,style:{background:"white",color:"#13c2c2",borderRadius:12,height:40,fontWeight:600,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:"เพิ่มหน่วย"})]})]})]})},R=e=>{let{totalUnits:t,activeUnits:n,inactiveUnits:r}=e;return(0,i.jsxs)("div",{style:I.statsCard,children:[(0,i.jsxs)("div",{style:I.statItem,children:[(0,i.jsx)("span",{style:{...I.statNumber,color:"#13c2c2"},children:t}),(0,i.jsx)(z,{style:I.statLabel,children:"ทั้งหมด"})]}),(0,i.jsx)("div",{style:{width:1,background:"#f0f0f0"}}),(0,i.jsxs)("div",{style:I.statItem,children:[(0,i.jsx)("span",{style:{...I.statNumber,color:"#52c41a"},children:n}),(0,i.jsx)(z,{style:I.statLabel,children:"ใช้งาน"})]}),(0,i.jsx)("div",{style:{width:1,background:"#f0f0f0"}}),(0,i.jsxs)("div",{style:I.statItem,children:[(0,i.jsx)("span",{style:{...I.statNumber,color:"#ff4d4f"},children:r}),(0,i.jsx)(z,{style:I.statLabel,children:"ไม่ใช้งาน"})]})]})},_=e=>{let{unit:t,index:n,onEdit:r,onDelete:s}=e;return(0,i.jsx)("div",{className:"unit-card",style:{...I.unitCard(t.is_active),animationDelay:"".concat(.03*n,"s")},children:(0,i.jsxs)("div",{style:I.unitCardInner,children:[(0,i.jsx)("div",{style:{width:56,height:56,borderRadius:14,background:"linear-gradient(135deg, #e6fffb 0%, #b5f5ec 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,i.jsx)(u.Z,{style:{fontSize:24,color:"#13c2c2"}})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,i.jsx)(z,{strong:!0,style:{fontSize:16,color:"#1a1a2e"},ellipsis:{tooltip:t.display_name},children:t.display_name}),t.is_active?(0,i.jsx)(f.Z,{style:{color:"#52c41a",fontSize:14}}):(0,i.jsx)(x.Z,{style:{color:"#ff4d4f",fontSize:14}})]}),(0,i.jsx)(z,{type:"secondary",style:{fontSize:13,display:"block"},ellipsis:{tooltip:t.unit_name},children:t.unit_name})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)(a.ZP,{type:"text",icon:(0,i.jsx)(g.Z,{}),onClick:e=>{e.stopPropagation(),r(t)},style:{borderRadius:10,color:"#13c2c2",background:"#e6fffb"}}),(0,i.jsx)(a.ZP,{type:"text",danger:!0,icon:(0,i.jsx)(y.Z,{}),onClick:e=>{e.stopPropagation(),s(t)},style:{borderRadius:10,background:"#fff2f0"}})]})]})})},P=e=>{let{onAdd:t}=e;return(0,i.jsx)(l.Z,{image:l.Z.PRESENTED_IMAGE_SIMPLE,description:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)(z,{type:"secondary",style:{fontSize:15},children:"ยังไม่มีหน่วยสินค้า"}),(0,i.jsx)("br",{}),(0,i.jsx)(z,{type:"secondary",style:{fontSize:13},children:"เริ่มต้นเพิ่มหน่วยแรกของคุณ"})]}),style:{padding:"60px 20px",background:"white",borderRadius:20,margin:"0 16px"},children:(0,i.jsx)(a.ZP,{type:"primary",icon:(0,i.jsx)(p.Z,{}),onClick:t,style:{background:"#13c2c2"},children:"เพิ่มหน่วยสินค้า"})})};function D(){let e=(0,b.useRouter)(),[t,n]=(0,r.useState)([]),{execute:s}=(0,m.J)(),{showLoading:a}=(0,j.x)(),{socket:l}=(0,v.s)(),{isAuthorized:h,isChecking:p}=(0,w.e)({requiredRole:"Admin"});(0,r.useEffect)(()=>{(0,k.P)()},[]),(0,r.useEffect)(()=>{let e=(0,S.t)("pos:products-units",6e5);e&&e.length>0&&n(e)},[]);let f=(0,r.useCallback)(async()=>{s(async()=>{let e=await fetch("/api/pos/productsUnit");if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||t.message||"ไม่สามารถดึงข้อมูลหน่วยสินค้าได้")}n(await e.json())},"กำลังโหลดข้อมูลหน่วยสินค้า...")},[s]);(0,r.useEffect)(()=>{h&&f()},[h,f]),(0,C.v)(l,{create:"productsUnit:create",update:"productsUnit:update",delete:"productsUnit:delete"},n),(0,r.useEffect)(()=>{t.length>0&&(0,S.v)("pos:products-units",t)},[t]);let x=()=>{a("กำลังเปิดหน้าจัดการหน่วยสินค้า..."),e.push("/pos/productsUnit/manager/add")},g=t=>{a("กำลังเปิดหน้าแก้ไขหน่วยสินค้า..."),e.push("/pos/productsUnit/manager/edit/".concat(t.id))},y=e=>{o.Z.confirm({title:"ยืนยันการลบหน่วยสินค้า",content:'คุณต้องการลบหน่วย "'.concat(e.display_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{await s(async()=>{let t=await (0,k.P)();if(!(await fetch("/api/pos/productsUnit/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบหน่วยสินค้าได้");c.ZP.success('ลบหน่วย "'.concat(e.display_name,'" สำเร็จ'))},"กำลังลบหน่วยสินค้า...")}})};if(p)return(0,i.jsxs)("div",{style:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:16},children:[(0,i.jsx)(d.Z,{size:"large"}),(0,i.jsx)(z,{type:"secondary",children:"กำลังตรวจสอบสิทธิ์การใช้งาน..."})]});if(!h)return(0,i.jsxs)("div",{style:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:16},children:[(0,i.jsx)(d.Z,{size:"large"}),(0,i.jsx)(z,{type:"danger",children:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ..."})]});let Z=t.filter(e=>e.is_active),D=t.filter(e=>!e.is_active);return(0,i.jsxs)("div",{className:"unit-page",style:I.container,children:[(0,i.jsx)("style",{children:"\n    @keyframes fadeSlideIn {\n        from {\n            opacity: 0;\n            transform: translateY(12px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n    \n    .unit-card {\n        animation: fadeSlideIn 0.4s ease both;\n    }\n    \n    .unit-card:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 8px 24px rgba(0,0,0,0.1) !important;\n    }\n    \n    .unit-card:active {\n        transform: scale(0.98);\n    }\n    \n    .unit-page *::-webkit-scrollbar {\n        width: 6px;\n    }\n    .unit-page *::-webkit-scrollbar-track {\n        background: transparent;\n    }\n    .unit-page *::-webkit-scrollbar-thumb {\n        background: #d9d9d9;\n        border-radius: 3px;\n    }\n    .unit-page *::-webkit-scrollbar-thumb:hover {\n        background: #bfbfbf;\n    }\n"}),(0,i.jsx)(E,{onRefresh:f,onAdd:x}),(0,i.jsx)(R,{totalUnits:t.length,activeUnits:Z.length,inactiveUnits:D.length}),(0,i.jsx)("div",{style:I.listContainer,children:t.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:I.sectionTitle,children:[(0,i.jsx)(u.Z,{style:{fontSize:18,color:"#13c2c2"}}),(0,i.jsx)("span",{style:{fontSize:16,fontWeight:600,color:"#1a1a2e"},children:"รายการหน่วยสินค้า"}),(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, #13c2c2 0%, #08979c 100%)",color:"white",padding:"4px 12px",borderRadius:20,fontSize:12,fontWeight:600},children:[t.length," รายการ"]})]}),t.map((e,t)=>(0,i.jsx)(_,{unit:e,index:t,onEdit:g,onDelete:y},e.id))]}):(0,i.jsx)(P,{onAdd:x})})]})}},26972:function(e,t,n){"use strict";n.d(t,{J:function(){return a}});var i=n(2265),r=n(3369),s=n(53743);let a=()=>{let{showLoading:e,hideLoading:t}=(0,r.x)();return{execute:(0,i.useCallback)(async function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"กำลังดำเนินการ...",r=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"เกิดข้อผิดพลาด");try{return e(i,"async"),await n()}catch(e){console.error("Async action error:",e),s.Z.error({title:"ข้อผิดพลาด",content:e.message||r});return}finally{t("async")}},[e,t])}}},3286:function(e,t,n){"use strict";n.d(t,{e:function(){return l}});var i=n(2265),r=n(34029),s=n(99376),a=n(14362);function l(){let{requiredRole:e="Admin",redirectUnauthenticated:t="/login",redirectUnauthorized:n="/pos",unauthorizedMessage:l="คุณไม่มีสิทธิ์เข้าถึงหน้านี้"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,s.useRouter)(),{user:c,loading:d}=(0,a.a)(),u=(0,i.useMemo)(()=>d?"checking":c?e&&c.role!==e?"unauthorized":"authorized":"unauthenticated",[c,d,e]),h=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{if("unauthenticated"===u){o.replace(t);return}"unauthorized"===u&&(h.current||(h.current=!0,r.ZP.error(l)),o.replace(n))},[u,o,t,n,l]),{status:u,isAuthorized:"authorized"===u,isChecking:"checking"===u,user:c}}},73814:function(e,t,n){"use strict";n.d(t,{t:function(){return r},v:function(){return s}});let i=()=>!0,r=(e,t)=>{if(!i())return null;try{var n;let i=window.localStorage.getItem(e);if(!i)return null;let r=JSON.parse(i);if(!(null==r?void 0:r.ts)||Date.now()-r.ts>t)return null;return null!==(n=r.data)&&void 0!==n?n:null}catch(e){return null}},s=(e,t)=>{if(i())try{let n={ts:Date.now(),data:t};window.localStorage.setItem(e,JSON.stringify(n))}catch(e){}}},97235:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var i=n(5447);let r=null,s=0,a=null;async function l(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&r&&t-s<6e5?r:(a||(a=i.O.getCsrfToken().then(e=>(r=e||"",s=Date.now(),r)).finally(()=>{a=null})),a)}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,7871,3490,2971,2117,1744],function(){return e(e.s=10328)}),_N_E=e.O()}]);