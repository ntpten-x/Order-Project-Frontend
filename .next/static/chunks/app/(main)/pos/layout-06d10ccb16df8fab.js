(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{83970:function(e,t,a){Promise.resolve().then(a.bind(a,16643))},16643:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return q}});var o=a(57437),r=a(2265),i=a(13817),n=a(8949),s=a(28006),l=a(99376),d=a(5311),c=a(62376),u=a(38434),f=a(441),p=a(5540),b=a(84588),h=a(88009),m=a(93132),x=a(29107),y=a(71891),g=a(99458),w=a(55322),k=a(39760),j=a(72285),v=a(92190),S=a(35631),C=a(50742),E=a(35713),T=a(14362),Z=a(9771),z=a(15718),P=()=>{let e=(0,l.useRouter)(),t=(0,l.usePathname)(),{user:a}=(0,T.a)(),{currentShift:i}=(0,s.S)(),[n,P]=(0,r.useState)(!1),[O,R]=(0,r.useState)(!1),D=(0,r.useMemo)(()=>[{key:"home",label:"หน้าแรก",icon:(0,o.jsx)(d.Z,{}),path:"/"},{key:"pos",label:"ขาย",icon:(0,o.jsx)(c.Z,{}),path:"/pos"},{key:"orders",label:"ออเดอร์",icon:(0,o.jsx)(u.Z,{}),path:"/pos/orders"},{key:"kitchen",label:"ครัว",icon:(0,o.jsx)(f.Z,{}),path:"/pos/kitchen"}],[]),N=(0,r.useMemo)(()=>{let e=[{key:"shift",label:"กะการทำงาน",icon:(0,o.jsx)(p.Z,{}),path:"/pos/shift"},{key:"shiftHistory",label:"ประวัติกะ",icon:(0,o.jsx)(b.Z,{}),path:"/pos/shiftHistory"}];return((null==a?void 0:a.role)==="Admin"||(null==a?void 0:a.role)==="Manager")&&e.push({key:"dashboard",label:"สรุป",icon:(0,o.jsx)(h.Z,{}),path:"/pos/dashboard"},{key:"tables",label:"โต๊ะ",icon:(0,o.jsx)(m.Z,{}),path:"/pos/tables"},{key:"delivery",label:"เดลิเวอรี่",icon:(0,o.jsx)(x.Z,{}),path:"/pos/delivery"},{key:"category",label:"หมวดหมู่",icon:(0,o.jsx)(h.Z,{}),path:"/pos/category"},{key:"products",label:"สินค้า",icon:(0,o.jsx)(c.Z,{}),path:"/pos/products"},{key:"productsUnit",label:"หน่วยสินค้า",icon:(0,o.jsx)(h.Z,{}),path:"/pos/productsUnit"},{key:"discounts",label:"ส่วนลด",icon:(0,o.jsx)(y.Z,{}),path:"/pos/discounts"},{key:"payment",label:"ชำระเงิน",icon:(0,o.jsx)(g.Z,{}),path:"/pos/paymentMethod"},{key:"settings",label:"ตั้งค่า",icon:(0,o.jsx)(w.Z,{}),path:"/pos/settings"}),e},[null==a?void 0:a.role]),_=e=>"/"===e?"/"===t:"/pos"===e?"/pos"===t||t.startsWith("/pos/channels"):t===e||t.startsWith(e+"/"),F=N.some(e=>_(e.path)),I=t=>{e.push(t),P(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Z.Z,{maxWidth:520,items:[...D.map(e=>({key:e.key,label:e.label,icon:e.icon,onClick:()=>I(e.path),active:_(e.path)})),{key:"more",label:"เพิ่มเติม",icon:(0,o.jsx)(k.Z,{}),onClick:()=>P(!0),active:n||F}]}),(0,o.jsx)(v.Z,{open:n,onClose:()=>P(!1),placement:"bottom",title:"เมนูเพิ่มเติม",zIndex:2e3,children:(0,o.jsxs)("div",{style:{paddingBottom:"calc(12px + env(safe-area-inset-bottom))"},children:[N.length>0&&(0,o.jsx)(S.Z,{dataSource:N,renderItem:e=>(0,o.jsx)(S.Z.Item,{style:{paddingInline:0},children:(0,o.jsx)(C.ZP,{type:"text",block:!0,icon:e.icon,style:{height:48,justifyContent:"flex-start"},onClick:()=>I(e.path),children:e.label})})}),i&&(0,o.jsx)(C.ZP,{danger:!0,block:!0,icon:(0,o.jsx)(E.Z,{dot:!0,status:"processing",color:"#ef4444",children:(0,o.jsx)(j.Z,{})}),style:{height:48,marginTop:8},onClick:()=>{R(!0),P(!1)},children:"ปิดกะ"})]})}),(0,o.jsx)(z.Z,{open:O,onCancel:()=>R(!1)})]})},O=a(34029),R=a(52717),D=a(20920),N=a(84859),_=a(53286),F=a(54528),I=a(86198),A=a(5447),H=a(98748);let L=e=>new Promise(t=>setTimeout(t,e)),U=()=>{let e=(0,D.L)(),[t,a]=(0,r.useState)(!1),i=(0,r.useCallback)(async()=>{if(t||0===N.x.getQueue().length)return;a(!0);let e=O.ZP.loading("กำลังซิงค์รายการที่ค้างอยู่...",0),o=0,r=0;N.x.pruneExceeded();let i=N.x.getQueue();try{let e=await A.O.getCsrfToken();for(let t of i)try{let a=N.M.backoff(t.retryCount);if(a>0&&await L(a),"CREATE_ORDER"===t.type)await _.x.create(t.payload,void 0,e);else if("UPDATE_ORDER"===t.type){let{orderId:a,data:o}=t.payload;await _.x.update(a,o,void 0,e)}else if("ADD_ITEM"===t.type){let{orderId:a,itemData:o}=t.payload;await _.x.addItem(a,o,void 0,e)}else if("UPDATE_ITEM"===t.type){let{itemId:a,itemData:o}=t.payload;await _.x.updateItem(a,o,void 0,e)}else if("DELETE_ITEM"===t.type){let{itemId:a}=t.payload;await _.x.deleteItem(a,void 0,e)}else if("PAYMENT"===t.type){let{orderId:a,paymentData:o}=t.payload;await F.U.create({...o,order_id:a},void 0,e)}else if("UPDATE_QUEUE_STATUS"===t.type){let{queueId:e,status:a}=t.payload;await I.e.updateStatus(e,{status:a},void 0)}N.x.removeFromQueue(t.id),o++}catch(e){if(t.retryCount+1>N.M.maxRetry)N.x.removeFromQueue(t.id),r++;else{let a=e instanceof Error?e.message:void 0;N.x.incrementRetry(t.id,a)}}}finally{e(),a(!1),o>0&&O.ZP.success("ซิงค์สำเร็จ ".concat(o," รายการ")),r>0&&R.ZP.error({message:"ซิงค์บางรายการไม่สำเร็จ",description:"".concat(r," รายการเกินจำนวน retry ที่กำหนด"),placement:"bottomRight",duration:3})}},[t]);return(0,r.useEffect)(()=>{e?i():R.ZP.warning({message:"ออฟไลน์",description:"รายการจะถูกเก็บเข้าคิวและซิงค์ให้อัตโนมัติเมื่อออนไลน์",icon:(0,o.jsx)(H.Z,{style:{color:"#faad14"}}),duration:2,placement:"bottomRight"})},[e,i]),null};var M=a(54343),Q=a(29827),W=a(46252),K=a(12028);let X=()=>{let{socket:e}=(0,r.useContext)(W.J),t=(0,Q.NL)();(0,r.useEffect)(()=>{if(!e)return;let a=()=>{t.invalidateQueries({queryKey:["orders"]}),t.invalidateQueries({queryKey:["ordersSummary"]})},o=()=>{a()},r=()=>{a()},i=()=>{a()};return e.on(K.b.orders.create,o),e.on(K.b.orders.update,r),e.on(K.b.orders.delete,i),e.on(K.b.payments.create,r),e.on(K.b.payments.update,r),e.on(K.b.salesOrderItem.create,r),e.on(K.b.salesOrderItem.update,r),e.on(K.b.salesOrderItem.delete,r),e.on(K.b.salesOrderDetail.create,r),e.on(K.b.salesOrderDetail.update,r),e.on(K.b.salesOrderDetail.delete,r),()=>{e.off(K.b.orders.create,o),e.off(K.b.orders.update,r),e.off(K.b.orders.delete,i),e.off(K.b.payments.create,r),e.off(K.b.payments.update,r),e.off(K.b.salesOrderItem.create,r),e.off(K.b.salesOrderItem.update,r),e.off(K.b.salesOrderItem.delete,r),e.off(K.b.salesOrderDetail.create,r),e.off(K.b.salesOrderDetail.update,r),e.off(K.b.salesOrderDetail.delete,r)}},[e,t])};function q(e){let{children:t}=e;return X(),(0,o.jsxs)(s.r,{children:[(0,o.jsx)(U,{}),(0,o.jsx)(M.Z,{}),(0,o.jsx)(n.Z,{children:(0,o.jsxs)(i.default,{style:{minHeight:"100%",background:"transparent"},children:[(0,o.jsx)(i.default.Content,{style:{background:"transparent"},children:t}),(0,o.jsx)(P,{})]})})]})}},9771:function(e,t,a){"use strict";a.d(t,{Z:function(){return f}});var o=a(57437);a(2265);var r=a(39486),i=a(2651),n=a(38616),s=a(96931),l=a(35713),d=a(50742),c=a(63362);let{Text:u}=r.default;function f(e){let{items:t,maxWidth:a=440,bottomOffset:r=c.w}=e,{token:f}=i.default.useToken(),p=!n.default.useBreakpoint().md;return(0,o.jsx)("div",{style:{position:"fixed",left:"50%",transform:"translateX(-50%)",bottom:"calc(".concat(r,"px + env(safe-area-inset-bottom))"),width:"calc(100% - 24px)",maxWidth:a,zIndex:900},"aria-label":"Bottom navigation",children:(0,o.jsx)(s.Z,{size:"small",variant:"outlined",bodyStyle:{padding:8,display:"grid",gridTemplateColumns:"repeat(".concat(t.length,", minmax(0, 1fr))"),gap:4},style:{borderRadius:p?18:22,borderColor:f.colorBorderSecondary,background:"rgba(255, 255, 255, 0.92)",backdropFilter:"blur(12px)",boxShadow:f.boxShadowSecondary},children:t.map(e=>{var t,a;let r=!!e.active,i=r?f.colorPrimary:f.colorTextSecondary,n=r?f.colorPrimary:f.colorTextSecondary,s=(0,o.jsx)("span",{style:{fontSize:22,lineHeight:1,color:i},children:e.icon}),c=e.badgeDot||(null!==(t=e.badgeCount)&&void 0!==t?t:0)>0?(0,o.jsx)(l.Z,{dot:e.badgeDot,count:e.badgeCount,size:"small",children:s}):s;return(0,o.jsxs)(d.ZP,{type:"text",disabled:e.disabled,"aria-label":null!==(a=e.ariaLabel)&&void 0!==a?a:e.label,"aria-current":r?"page":void 0,onClick:e.onClick,style:{height:p?64:68,paddingInline:0,borderRadius:16,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4,background:r?f.colorPrimaryBg:"transparent"},children:[c,(0,o.jsx)(u,{style:{fontSize:11,fontWeight:r?600:500,color:n,lineHeight:1},children:e.label})]},e.key)})})})}},63362:function(e,t,a){"use strict";a.d(t,{o:function(){return r},w:function(){return o}});let o=16,r=108},15718:function(e,t,a){"use strict";a.d(t,{Z:function(){return y}});var o=a(57437),r=a(29),i=a.n(r),n=a(2265),s=a(39486),l=a(19878),d=a(53743),c=a(33477),u=a(50742),f=a(28006),p=a(62670),b=a(71096),h=a.n(b);let{Title:m,Text:x}=s.default;function y(e){let{open:t,onCancel:a,onSuccess:r}=e,{currentShift:s,closeShift:b}=(0,f.S)(),[y,g]=(0,n.useState)(!1),[w]=l.Z.useForm(),k=async e=>{g(!0);try{await b(e.endAmount),a(),w.resetFields(),r&&r()}catch(e){}finally{g(!1)}};return(0,o.jsxs)(d.Z,{open:t,onCancel:a,title:null,centered:!0,footer:null,width:480,className:"soft-modal",styles:{body:{padding:0,borderRadius:24,overflow:"hidden",boxShadow:"0 20px 50px rgba(0,0,0,0.1)"},mask:{backdropFilter:"blur(5px)"}},children:[(0,o.jsxs)("div",{className:"jsx-513b4b5890b57a8a modal-header-close",children:[(0,o.jsx)("div",{className:"jsx-513b4b5890b57a8a icon-wrapper-close",children:(0,o.jsx)(p.Z,{style:{fontSize:32,color:"#ef4444"}})}),(0,o.jsx)(m,{level:3,style:{margin:0,color:"#1f1f1f",fontWeight:700},children:"ปิดรอบการขาย"}),(0,o.jsx)(x,{type:"secondary",style:{fontSize:16},children:"Close Shift"})]}),(0,o.jsx)("div",{style:{padding:"0 32px 32px 32px"},className:"jsx-513b4b5890b57a8a",children:s&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"jsx-513b4b5890b57a8a info-card",children:[(0,o.jsxs)("div",{className:"jsx-513b4b5890b57a8a info-row",children:[(0,o.jsx)(x,{type:"secondary",children:"เวลาเปิดกะ"}),(0,o.jsx)(x,{strong:!0,children:h()(s.open_time).format("DD/MM/YYYY HH:mm")})]}),(0,o.jsx)("div",{className:"jsx-513b4b5890b57a8a info-divider"}),(0,o.jsxs)("div",{className:"jsx-513b4b5890b57a8a info-row",children:[(0,o.jsx)(x,{type:"secondary",children:"เงินทอนเริ่มต้น"}),(0,o.jsxs)(x,{strong:!0,children:[Number(s.start_amount).toLocaleString()," บาท"]})]})]}),(0,o.jsxs)(l.Z,{form:w,layout:"vertical",onFinish:k,children:[(0,o.jsx)(l.Z.Item,{name:"endAmount",label:(0,o.jsx)("span",{style:{fontSize:16,fontWeight:500,color:"#4b5563"},className:"jsx-513b4b5890b57a8a",children:"ยอดเงินสดที่นับได้ (Cash Counted)"}),rules:[{required:!0,message:"กรุณาระบุจำนวนเงิน"}],children:(0,o.jsx)(c.Z,{style:{width:"100%",height:"80px",borderRadius:16,border:"2px solid #e5e7eb"},size:"large",min:0,precision:2,placeholder:"0.00",autoFocus:!0,controls:!1,inputMode:"decimal",className:"huge-input-close",formatter:e=>"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>null==e?void 0:e.replace(/\$\s?|(,*)/g,""),onKeyDown:e=>{if([8,46,9,27,13,190,110].includes(e.keyCode)||!0===e.ctrlKey||!0===e.metaKey||e.keyCode>=35&&e.keyCode<=39){(190===e.keyCode||110===e.keyCode)&&e.currentTarget.value.includes(".")&&e.preventDefault();return}(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}})}),(0,o.jsxs)("div",{style:{display:"flex",gap:12,marginTop:24},className:"jsx-513b4b5890b57a8a flex gap-4",children:[(0,o.jsx)(u.ZP,{block:!0,size:"large",onClick:a,disabled:y,style:{height:56,borderRadius:16,fontSize:16,fontWeight:600,background:"#f3f4f6",border:"none",color:"#4b5563"},children:"ยกเลิก"}),(0,o.jsx)(u.ZP,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:y,style:{height:56,borderRadius:16,fontSize:16,fontWeight:600,background:"#ef4444",border:"none",boxShadow:"0 4px 14px rgba(239, 68, 68, 0.4)"},children:"ยืนยันปิดกะ"})]})]})]})}),(0,o.jsx)(i(),{id:"513b4b5890b57a8a",children:".modal-header-close{background:-webkit-linear-gradient(top,#fef2f2 0%,#fff 100%);background:-moz-linear-gradient(top,#fef2f2 0%,#fff 100%);background:-o-linear-gradient(top,#fef2f2 0%,#fff 100%);background:linear-gradient(180deg,#fef2f2 0%,#fff 100%);padding:32px 24px 24px 24px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;text-align:center}.icon-wrapper-close{width:64px;height:64px;background:#fee2e2;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-bottom:8px;-webkit-box-shadow:0 4px 12px rgba(239,68,68,.15);-moz-box-shadow:0 4px 12px rgba(239,68,68,.15);box-shadow:0 4px 12px rgba(239,68,68,.15)}.info-card{background:#f8fafc;-webkit-border-radius:16px;-moz-border-radius:16px;border-radius:16px;padding:16px;margin-bottom:24px}.info-row{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.info-divider{height:1px;background:#e2e8f0;margin:12px 0}.huge-input-close input{font-size:36px!important;font-weight:700!important;text-align:center!important;color:#ef4444!important;height:100%!important}.huge-input-close:focus-within{border-color:#ef4444!important;-webkit-box-shadow:0 0 0 4px rgba(239,68,68,.1)!important;-moz-box-shadow:0 0 0 4px rgba(239,68,68,.1)!important;box-shadow:0 0 0 4px rgba(239,68,68,.1)!important}"})]})}},54343:function(e,t,a){"use strict";a.d(t,{Z:function(){return x}});var o=a(57437),r=a(29),i=a.n(r),n=a(2265),s=a(39486),l=a(19878),d=a(53743),c=a(33477),u=a(50742),f=a(28006),p=a(62670),b=a(99376);let{Title:h,Text:m}=s.default;function x(){let{open:e,onCancel:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{currentShift:a,loading:r,openShift:s}=(0,f.S)(),[x,y]=(0,n.useState)(!1),[g]=l.Z.useForm(),w=(0,b.usePathname)(),k=async e=>{y(!0);try{await s(e.startAmount)}catch(e){}finally{y(!1)}};return r?null:(0,o.jsxs)(d.Z,{open:void 0!==e?e:!r&&!a&&"/pos/shift"!==w,onCancel:t,title:null,centered:!0,closable:!1,maskClosable:!1,footer:null,width:400,className:"soft-modal",styles:{body:{padding:0,borderRadius:24,overflow:"hidden",boxShadow:"0 20px 50px rgba(0,0,0,0.1)"}},children:[(0,o.jsxs)("div",{className:"jsx-986e1bd238b3f1c5 modal-header",children:[(0,o.jsx)("div",{className:"jsx-986e1bd238b3f1c5 icon-wrapper",children:(0,o.jsx)(p.Z,{style:{fontSize:32,color:"#10b981"}})}),(0,o.jsx)(h,{level:3,style:{margin:0,color:"#1f1f1f",fontWeight:700},children:"เปิดรอบการขาย"}),(0,o.jsx)(m,{type:"secondary",style:{fontSize:16},children:"Open Shift"})]}),(0,o.jsx)("div",{style:{padding:"0 32px 32px 32px"},className:"jsx-986e1bd238b3f1c5",children:(0,o.jsxs)(l.Z,{form:g,layout:"vertical",onFinish:k,initialValues:{startAmount:0},children:[(0,o.jsx)(l.Z.Item,{name:"startAmount",label:(0,o.jsx)("span",{style:{fontSize:16,fontWeight:500,color:"#4b5563"},className:"jsx-986e1bd238b3f1c5",children:"ระบุเงินทอนเริ่มต้น (บาท)"}),rules:[{required:!0,message:"กรุณาระบุจำนวนเงิน"}],children:(0,o.jsx)(c.Z,{style:{width:"100%",height:"80px",borderRadius:16,border:"2px solid #e5e7eb"},size:"large",min:0,precision:2,placeholder:"0.00",autoFocus:!0,controls:!1,inputMode:"decimal",className:"huge-input",formatter:e=>"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>null==e?void 0:e.replace(/\$\s?|(,*)/g,""),onKeyDown:e=>{if([8,46,9,27,13,190,110].includes(e.keyCode)||!0===e.ctrlKey||!0===e.metaKey||e.keyCode>=35&&e.keyCode<=39){var t;(190===e.keyCode||110===e.keyCode)&&(null===(t=e.target.value)||void 0===t?void 0:t.includes("."))&&e.preventDefault();return}(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}})}),(0,o.jsx)(u.ZP,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:x,style:{height:56,borderRadius:16,fontSize:18,fontWeight:600,background:"#10b981",boxShadow:"0 4px 14px rgba(16, 185, 129, 0.4)",border:"none",marginTop:16},children:"ยืนยันเปิดกะ"})]})}),(0,o.jsx)(i(),{id:"986e1bd238b3f1c5",children:".soft-modal .ant-modal-content{padding:0!important}.modal-header{background:-webkit-linear-gradient(top,#f0fdf4 0%,#fff 100%);background:-moz-linear-gradient(top,#f0fdf4 0%,#fff 100%);background:-o-linear-gradient(top,#f0fdf4 0%,#fff 100%);background:linear-gradient(180deg,#f0fdf4 0%,#fff 100%);padding:40px 24px 24px 24px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;text-align:center}.icon-wrapper{width:72px;height:72px;background:#d1fae5;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-bottom:8px;-webkit-box-shadow:0 4px 12px rgba(16,185,129,.15);-moz-box-shadow:0 4px 12px rgba(16,185,129,.15);box-shadow:0 4px 12px rgba(16,185,129,.15)}.huge-input input{font-size:36px!important;font-weight:700!important;text-align:center!important;color:#10b981!important;height:100%!important}.huge-input:focus-within{border-color:#10b981!important;-webkit-box-shadow:0 0 0 4px rgba(16,185,129,.1)!important;-moz-box-shadow:0 0 0 4px rgba(16,185,129,.1)!important;box-shadow:0 0 0 4px rgba(16,185,129,.1)!important}"})]})}},28006:function(e,t,a){"use strict";a.d(t,{S:function(){return c},r:function(){return d}});var o=a(57437),r=a(2265),i=a(14362),n=a(59226),s=a(34029);let l=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,{user:a}=(0,i.a)(),[d,c]=(0,r.useState)(null),[u,f]=(0,r.useState)(!0),p=(0,r.useCallback)(async()=>{if(a)try{let e=await n.t.getCurrentShift();c(e)}catch(e){console.error("Error fetching shift:",e)}finally{f(!1)}},[a]);(0,r.useEffect)(()=>{p()},[p]);let b=async e=>{if(a)try{let t=await n.t.openShift(e);c(t),s.ZP.success("เปิดกะเรียบร้อยแล้ว")}catch(e){throw s.ZP.error(e instanceof Error?e.message:"เปิดกะไม่สำเร็จ"),e}},h=async e=>{if(a)try{await n.t.closeShift(e),c(null),s.ZP.success("ปิดกะเรียบร้อยแล้ว")}catch(e){throw s.ZP.error(e instanceof Error?e.message:"ปิดกะไม่สำเร็จ"),e}};return(0,o.jsx)(l.Provider,{value:{currentShift:d,loading:u,openShift:b,closeShift:h,refreshShift:p},children:t})},c=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useShift must be used within a ShiftProvider");return e}},20920:function(e,t,a){"use strict";a.d(t,{L:function(){return r}});var o=a(2265);function r(){let[e,t]=(0,o.useState)("undefined"==typeof navigator||navigator.onLine);return(0,o.useEffect)(()=>{let e=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[]),e}},86198:function(e,t,a){"use strict";a.d(t,{e:function(){return l}});var o=a(2913),r=a(71567),i=a(97235);let n=r.q.POS.ORDER_QUEUE,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",a={};return t&&(a["Content-Type"]=t),e&&(a.Cookie=e),a},l={getAll:async(e,t)=>{let a=new URLSearchParams;t&&a.append("status",t);let r=a.toString()?"".concat(n,"?").concat(a.toString()):n,i=(0,o.b)("GET",r),l=s(e,""),d=await fetch(i,{cache:"no-store",headers:l,credentials:"include"});if(!d.ok){var c;let e=await d.json().catch(()=>({}));throw Error((null===(c=e.error)||void 0===c?void 0:c.message)||e.message||"ไม่สามารถดึงข้อมูลคิวได้")}let u=await d.json();return u.success&&Array.isArray(u.data)?u.data:Array.isArray(u)?u:[]},addToQueue:async(e,t)=>{let a=(0,o.b)("POST",n),r=s(t),l=await (0,i.P)();l&&(r["X-CSRF-Token"]=l);let d=await fetch(a,{method:"POST",headers:r,credentials:"include",body:JSON.stringify({orderId:e.orderId,priority:e.priority||"Normal"})});if(!d.ok){var c;let e=await d.json().catch(()=>({}));throw Error((null===(c=e.error)||void 0===c?void 0:c.message)||e.message||"ไม่สามารถเพิ่มออเดอร์เข้าคิวได้")}let u=await d.json();return u.success&&u.data?u.data:u},updateStatus:async(e,t,a)=>{let r=(0,o.b)("PATCH","".concat(n,"/").concat(e,"/status")),l=s(a),d=await (0,i.P)();d&&(l["X-CSRF-Token"]=d);let c=await fetch(r,{method:"PATCH",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){var u;let e=await c.json().catch(()=>({}));throw Error((null===(u=e.error)||void 0===u?void 0:u.message)||e.message||"ไม่สามารถอัปเดตสถานะได้")}let f=await c.json();return f.success&&f.data?f.data:f},removeFromQueue:async(e,t)=>{let a=(0,o.b)("DELETE","".concat(n,"/").concat(e)),r=s(t,""),l=await (0,i.P)();l&&(r["X-CSRF-Token"]=l);let d=await fetch(a,{method:"DELETE",headers:r,credentials:"include"});if(!d.ok){var c;let e=await d.json().catch(()=>({}));throw Error((null===(c=e.error)||void 0===c?void 0:c.message)||e.message||"ไม่สามารถลบออกจากคิวได้")}},reorderQueue:async e=>{let t=(0,o.b)("POST","".concat(n,"/reorder")),a=s(e),r=await (0,i.P)();r&&(a["X-CSRF-Token"]=r);let l=await fetch(t,{method:"POST",headers:a,credentials:"include"});if(!l.ok){var d;let e=await l.json().catch(()=>({}));throw Error((null===(d=e.error)||void 0===d?void 0:d.message)||e.message||"ไม่สามารถจัดเรียงคิวใหม่ได้")}}}},54528:function(e,t,a){"use strict";a.d(t,{U:function(){return s}});var o=a(2913),r=a(98170);let i="/pos/payments",n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",a={};return t&&(a["Content-Type"]=t),e&&(a.Cookie=e),a},s={getAll:async e=>{let t=(0,o.b)("GET",i),a=n(e,""),s=await fetch(t,{cache:"no-store",headers:a});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error((0,r.i_)(e,"ไม่สามารถดึงข้อมูลการชำระเงินได้"))}return(0,r.hH)(await s.json())},getById:async(e,t)=>{let a=(0,o.b)("GET","".concat(i,"/").concat(e)),s=n(t,""),l=await fetch(a,{cache:"no-store",headers:s});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,r.i_)(e,"ไม่สามารถดึงข้อมูลการชำระเงินได้"))}return(0,r.hH)(await l.json())},create:async(e,t,a)=>{let s=(0,o.b)("POST","".concat(i)),l=n(t);a&&(l["X-CSRF-Token"]=a);let d=await fetch(s,{method:"POST",headers:l,credentials:"include",body:JSON.stringify(e)});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error((0,r.i_)(e,"ไม่สามารถสร้างรายการชำระเงินได้"))}return(0,r.hH)(await d.json())},update:async(e,t,a,s)=>{let l=(0,o.b)("PUT","".concat(i,"/").concat(e)),d=n(a);s&&(d["X-CSRF-Token"]=s);let c=await fetch(l,{method:"PUT",headers:d,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error((0,r.i_)(e,"ไม่สามารถแก้ไขรายการชำระเงินได้"))}return(0,r.hH)(await c.json())},delete:async(e,t,a)=>{let s=(0,o.b)("DELETE","".concat(i,"/").concat(e)),l=n(t,"");a&&(l["X-CSRF-Token"]=a);let d=await fetch(s,{method:"DELETE",headers:l,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error((0,r.i_)(e,"ไม่สามารถลบรายการชำระเงินได้"))}}}},59226:function(e,t,a){"use strict";a.d(t,{t:function(){return i}});var o=a(97235),r=a(98170);let i={getCurrentShift:async()=>{let e=await fetch("/api/pos/shifts/current",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(404===e.status)return null;if(!e.ok)throw Error("Failed to fetch current shift");return(0,r.hH)(await e.json())},openShift:async e=>{let t=await (0,o.P)(),a=await fetch("/api/pos/shifts/open",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":t},credentials:"include",body:JSON.stringify({start_amount:e})});if(!a.ok){var i;let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:null===(i=e.error)||void 0===i?void 0:i.message)||e.message||"Failed to open shift")}return(0,r.hH)(await a.json())},closeShift:async e=>{let t=await (0,o.P)(),a=await fetch("/api/pos/shifts/close",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":t},credentials:"include",body:JSON.stringify({end_amount:e})});if(!a.ok){var i;let e=await a.json().catch(()=>({}));throw Error((null==e?void 0:null===(i=e.error)||void 0===i?void 0:i.message)||e.message||"Failed to close shift")}return(0,r.hH)(await a.json())},getCurrentSummary:async()=>{let e=await fetch("/api/pos/shifts/current/summary",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw Error("Failed to fetch shift summary");return(0,r.hH)(await e.json())},getSummary:async e=>{let t=await fetch("/api/pos/shifts/summary/".concat(e),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!t.ok)throw Error("Failed to fetch shift summary");return(0,r.hH)(await t.json())},getHistory:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.page&&t.set("page",String(e.page)),e.limit&&t.set("limit",String(e.limit)),e.q&&t.set("q",e.q),e.status&&t.set("status",e.status),e.date_from&&t.set("date_from",e.date_from),e.date_to&&t.set("date_to",e.date_to);let a=t.toString(),o=await fetch("/api/pos/shifts/history".concat(a?"?".concat(a):""),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!o.ok){var i;let e=await o.json().catch(()=>({}));throw Error((null==e?void 0:null===(i=e.error)||void 0===i?void 0:i.message)||(null==e?void 0:e.error)||e.message||"Failed to fetch shift history")}return(0,r.hH)(await o.json())}}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,3248,2401,19,3834,9878,5713,8056,4547,5799,3817,2239,8090,6999,4899,2971,2117,1744],function(){return e(e.s=83970)}),_N_E=e.O()}]);