(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7322],{25116:function(e,n,t){Promise.resolve().then(t.bind(t,94004))},94004:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return N}});var i=t(57437),r=t(2265),a=t(29827),o=t(11713),s=t(19683),d=t(48651),l=t(80009),c=t(47451),h=t(69410),p=t(50742),x=t(96931),f=t(5540),g=t(83669),m=t(8881),u=t(29332),b=t(95159),y=t(28595),j=t(99376),v=t(46252),S=t(59226),k=t(54343),w=t(15718),C=t(25193),z=t(37410),Z=t(20148),R=t(71096),W=t.n(R);t(6729);var I=t(13257),F=t.n(I);let B={container:{paddingBottom:100,backgroundColor:t(44225).X1.background,minHeight:"100vh",fontFamily:"var(--font-sans), 'Sarabun', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif"},header:{background:"linear-gradient(135deg, #10B981 0%, #059669 100%)",padding:"16px 16px 48px 16px",position:"relative",overflow:"hidden",borderBottomLeftRadius:20,borderBottomRightRadius:20,boxShadow:"0 4px 16px rgba(16, 185, 129, 0.2)"},headerDecoCircle1:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:"rgba(255,255,255,0.1)"},headerDecoCircle2:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},headerContent:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"space-between",maxWidth:1200,margin:"0 auto"},headerLeft:{display:"flex",alignItems:"center",gap:16},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},headerTitleBox:{display:"flex",flexDirection:"column"},headerTitle:{color:"white",fontSize:24,margin:0,fontWeight:700,letterSpacing:"0.5px",lineHeight:1.2},headerSubtitle:{color:"rgba(255,255,255,0.9)",fontSize:14,display:"block"},contentContainer:{maxWidth:1200,margin:"0 auto",padding:"0 24px",position:"relative",zIndex:10},card:{borderRadius:24,border:"none",boxShadow:"0 10px 25px rgba(0,0,0,0.05)",background:"white",overflow:"hidden",height:"100%"},activeShiftCard:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",textAlign:"center",padding:"40px 24px",position:"relative",overflow:"hidden"},summaryCard:{background:"white",padding:"24px"},statisticValue:e=>({color:e,fontWeight:600}),noShiftCard:{textAlign:"center",padding:"60px 20px",background:"rgba(255,255,255,0.8)",backdropFilter:"blur(10px)",borderRadius:24,border:"1px dashed #d9d9d9"},sectionDivider:{margin:"24px 0"},trendUp:{color:"#52c41a"},trendDown:{color:"#ff4d4f"}},_="\n    @keyframes pulse {\n        0% { transform: scale(1); }\n        50% { transform: scale(1.05); }\n        100% { transform: scale(1); }\n    }\n\n    @keyframes fadeInUp {\n        from {\n            opacity: 0;\n            transform: translateY(20px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n    \n    .pulse-animation {\n        animation: pulse 2s infinite ease-in-out;\n    }\n\n    .shift-card-animate {\n        animation: fadeInUp 0.5s ease forwards;\n        opacity: 0;\n    }\n\n    .shift-card-delay-1 { animation-delay: 0.1s; }\n    .shift-card-delay-2 { animation-delay: 0.2s; }\n    \n    .shift-modal .ant-modal-content {\n        border-radius: 20px;\n        overflow: hidden;\n    }\n    \n    .shift-modal .ant-modal-header {\n        background: transparent;\n    }\n\n    .stat-card-inner {\n        transition: all 0.3s ease;\n        padding: 16px;\n        border-radius: 16px;\n        background: #f8fafc;\n    }\n    \n    .stat-card-inner:hover {\n        background: #f1f5f9;\n        transform: translateY(-2px);\n    }\n\n    /* Mobile-first responsive */\n    .shift-header-mobile {\n        flex-direction: column !important;\n        align-items: flex-start !important;\n        gap: 16px !important;\n    }\n\n    .shift-content-mobile {\n        padding: 0 16px !important;\n    }\n\n    .shift-stat-grid {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n        gap: 12px;\n    }\n\n    @media (max-width: 576px) {\n        .shift-header-mobile {\n            padding: 16px 16px 40px !important;\n        }\n\n        .shift-stat-grid {\n            grid-template-columns: 1fr;\n        }\n\n        .shift-action-btn {\n            width: 100% !important;\n            height: 52px !important;\n            font-size: 16px !important;\n        }\n\n        .shift-modal .ant-modal {\n            max-width: calc(100vw - 32px) !important;\n            margin: 16px !important;\n        }\n    }\n\n    @media (min-width: 768px) {\n        .shift-stat-grid {\n            grid-template-columns: repeat(3, 1fr);\n        }\n    }\n\n    @media (min-width: 1024px) {\n        .shift-stat-grid {\n            grid-template-columns: repeat(4, 1fr);\n        }\n    }\n\n    /* Touch-friendly */\n    .shift-action-btn {\n        -webkit-tap-highlight-color: rgba(16, 185, 129, 0.1);\n        touch-action: manipulation;\n    }\n";W().extend(F()),W().locale("th");let{Title:T,Text:D}=s.default;function N(){var e;let n=(0,j.useRouter)(),t=(0,a.NL)(),[s,R]=(0,r.useState)(!1),[I,F]=(0,r.useState)(!1),{socket:N}=(0,r.useContext)(v.J),{data:L=null,isLoading:E}=(0,o.a)({queryKey:["shiftCurrent"],queryFn:async()=>await S.t.getCurrentShift(),staleTime:2e3}),{data:H=null,isLoading:q}=(0,o.a)({queryKey:["shiftSummary",(null==L?void 0:L.id)||"none"],queryFn:async()=>await S.t.getCurrentSummary(),enabled:!!L,staleTime:2e3}),A=L?H:null;return((0,r.useEffect)(()=>{if(!N)return;let e=()=>{t.invalidateQueries({queryKey:["shiftCurrent"]}),t.invalidateQueries({queryKey:["shiftSummary"]})};return N.on("shifts:update",e),()=>{N.off("shifts:update",e)}},[N,t]),E||L&&q)?(0,i.jsxs)("div",{style:B.container,children:[(0,i.jsx)("style",{children:_}),(0,i.jsx)(Z.Z,{title:"กะการทำงาน",subtitle:"กำลังโหลดข้อมูล...",onBack:()=>n.back(),icon:(0,i.jsx)(f.Z,{style:{fontSize:20}})}),(0,i.jsx)(C.Z,{style:{display:"flex",alignItems:"center",minHeight:"70vh"},children:(0,i.jsx)("div",{style:{width:"100%",maxWidth:520,margin:"0 auto"},children:(0,i.jsx)(z.Z,{children:(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,i.jsx)(d.Z,{size:"large"})})})})})]}):(0,i.jsxs)("div",{style:B.container,children:[(0,i.jsx)("style",{children:_}),(0,i.jsx)(Z.Z,{title:"กะการทำงาน",subtitle:L?(0,i.jsx)(l.Z,{color:"success",children:"เปิดใช้งานอยู่"}):(0,i.jsx)(l.Z,{color:"warning",children:"ปิดใช้งาน"}),onBack:()=>n.back(),icon:(0,i.jsx)(f.Z,{style:{fontSize:20}})}),(0,i.jsx)(C.Z,{children:(0,i.jsx)(z.Z,{style:{background:"transparent",border:"none"},children:(0,i.jsx)("div",{style:B.contentContainer,children:(0,i.jsx)(c.Z,{gutter:[24,24],children:L?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.Z,{xs:24,lg:8,children:(0,i.jsxs)("div",{style:{...B.card,...B.activeShiftCard},children:[(0,i.jsx)("div",{style:{position:"absolute",top:-20,right:-20,width:100,height:100,background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,i.jsx)("div",{style:{position:"absolute",bottom:-10,left:-20,width:80,height:80,background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,i.jsx)(g.Z,{style:{fontSize:64,marginBottom:16,color:"white"}}),(0,i.jsx)(T,{level:3,style:{color:"white",margin:0},children:"กะกำลังทำงาน"}),(0,i.jsxs)(D,{style:{color:"rgba(255,255,255,0.85)",display:"block",marginTop:8},children:["เริ่มเมื่อ: ",W()(L.open_time).format("DD/MM/YYYY HH:mm น.")]}),(0,i.jsxs)("div",{style:{marginTop:32,background:"rgba(255,255,255,0.2)",borderRadius:16,padding:"24px 16px",backdropFilter:"blur(4px)"},children:[(0,i.jsx)(D,{style:{color:"rgba(255,255,255,0.9)",fontSize:16,fontWeight:500},children:"ระยะเวลาทำงาน"}),(0,i.jsx)(T,{level:1,style:{color:"white",margin:"4px 0 0",fontSize:40,letterSpacing:"-0.02em"},children:(()=>{if(!L)return"";let e=W().duration(W()().diff(W()(L.open_time))),n=Math.floor(e.asHours()),t=e.minutes();return"".concat(n," ชม. ").concat(t," นาที")})()})]}),(0,i.jsx)(p.ZP,{type:"primary",danger:!0,icon:(0,i.jsx)(m.Z,{}),size:"large",block:!0,onClick:()=>F(!0),style:{marginTop:32,height:56,fontSize:18,borderRadius:16,border:"none",background:"white",color:"#ef4444",fontWeight:700,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:"ปิดกะ (Close Shift)"})]})}),(0,i.jsx)(h.Z,{xs:24,lg:16,children:(0,i.jsxs)(x.Z,{style:{...B.card,...B.summaryCard},bordered:!1,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[(0,i.jsx)("div",{style:{width:48,height:48,borderRadius:14,background:"#eff6ff",display:"flex",alignItems:"center",justifyContent:"center",marginRight:16,color:"#3b82f6"},children:(0,i.jsx)(u.Z,{style:{fontSize:24}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(T,{level:4,style:{margin:0,color:"#1e293b"},children:"สรุปยอดขายปัจจุบัน"}),(0,i.jsx)(D,{type:"secondary",children:"Live Summary"})]})]}),A?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,i.jsxs)("div",{className:"stat-card",style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,i.jsx)(D,{type:"secondary",style:{fontSize:14},children:"ยอดขายรวม"}),(0,i.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:"#10b981",marginTop:4},children:["฿",Number(A.summary.total_sales).toLocaleString()]})]}),(0,i.jsxs)("div",{className:"stat-card",style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,i.jsx)(D,{type:"secondary",style:{fontSize:14},children:"กำไรสุทธิ"}),(0,i.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:"#f59e0b",marginTop:4},children:["฿",Number(A.summary.net_profit).toLocaleString()]})]}),(0,i.jsxs)("div",{className:"stat-card",style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,i.jsx)(D,{type:"secondary",style:{fontSize:14},children:"จำนวนบิล (โดยประมาณ)"}),(0,i.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#3b82f6",marginTop:4},children:Object.values(A.categories).reduce((e,n)=>e+n,0)})]})]}),(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",padding:"20px 24px",borderRadius:20,border:"1px solid #bbf7d0",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)(b.Z,{style:{fontSize:24,color:"#15803d"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)(D,{style:{color:"#166534",fontWeight:600,display:"block"},children:"เงินสดที่ต้องมีในเซฟ (Cash in Drawer)"}),(0,i.jsx)(D,{style:{color:"#166534",fontSize:13,opacity:.8},children:"เงินทอนเริ่มต้น + ยอดขายเงินสด"})]})]}),(0,i.jsxs)(D,{style:{fontSize:28,fontWeight:800,color:"#14532d"},children:["฿",(Number(A.shift_info.start_amount)+Number((null===(e=A.summary.payment_methods)||void 0===e?void 0:e["เงินสด"])||0)).toLocaleString()]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(D,{style:{fontSize:14,fontWeight:600,color:"#64748b",marginBottom:12,display:"block"},children:"แยกตามวิธีหน้าชำระ"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:12},children:Object.entries(A.summary.payment_methods||{}).map(e=>{let[n,t]=e;return(0,i.jsxs)("div",{style:{flex:"1 1 140px",padding:"12px 16px",background:"#fff",border:"1px solid #f1f5f9",borderRadius:12,boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[(0,i.jsx)(D,{style:{fontSize:12,color:"#94a3b8"},children:n}),(0,i.jsxs)("div",{style:{fontSize:16,fontWeight:600,color:"#334155"},children:["฿",Number(t).toLocaleString()]})]},n)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(D,{style:{fontSize:14,fontWeight:600,color:"#64748b",marginBottom:12,display:"block"},children:"สินค้าขายดี"}),(0,i.jsxs)("div",{style:{background:"#fff",border:"1px solid #f1f5f9",borderRadius:16,overflow:"hidden"},children:[A.top_products.slice(0,3).map((e,n)=>(0,i.jsxs)("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:n<2?"1px solid #f8fafc":"none"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)("div",{style:{width:24,height:24,borderRadius:"50%",background:0===n?"#FEF3C7":"#F1F5F9",color:0===n?"#D97706":"#64748B",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700},children:n+1}),(0,i.jsx)(D,{style:{fontWeight:500,color:"#334155"},children:e.name})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)(D,{style:{fontSize:13,color:"#64748b",marginRight:8},children:[e.quantity," ",e.unit||"ชิ้น"]}),(0,i.jsxs)(D,{style:{fontWeight:600,color:"#0f172a"},children:["฿",Number(e.revenue).toLocaleString()]})]})]},n)),0===A.top_products.length&&(0,i.jsx)("div",{style:{padding:20,textAlign:"center",color:"#94a3b8"},children:"ยังไม่มีข้อมูลการขาย"})]})]})]}):(0,i.jsxs)("div",{style:{textAlign:"center",padding:"60px 0"},children:[(0,i.jsx)(d.Z,{size:"large"}),(0,i.jsx)("div",{style:{marginTop:16,color:"#94a3b8"},children:"กำลังโหลดข้อมูลสรุป..."})]})]})})]}):(0,i.jsx)(h.Z,{xs:24,children:(0,i.jsx)(x.Z,{style:{...B.card,minHeight:500,display:"flex",alignItems:"center",justifyContent:"center",background:"white"},children:(0,i.jsxs)("div",{style:{textAlign:"center",maxWidth:480},children:[(0,i.jsx)("div",{style:{width:140,height:140,background:"linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 40px",boxShadow:"0 20px 40px rgba(249, 115, 22, 0.15)"},children:(0,i.jsx)(f.Z,{style:{fontSize:64,color:"#EA580C"}})}),(0,i.jsx)(T,{level:2,style:{marginBottom:16,color:"#1e293b"},children:"ยังไม่มีกะที่เปิดใช้งาน"}),(0,i.jsxs)(D,{type:"secondary",style:{fontSize:16,lineHeight:1.6,display:"block",marginBottom:48,color:"#64748b"},children:["ระบบจะทำการบันทึกยอดขายและเงินสดแยกตามกะการทำงาน ",(0,i.jsx)("br",{}),"กรุณาเปิดกะใหม่เพื่อเริ่มต้นการขายสินค้า"]}),(0,i.jsx)(p.ZP,{type:"primary",icon:(0,i.jsx)(y.Z,{}),size:"large",onClick:()=>R(!0),style:{background:"#10b981",borderColor:"#10b981",height:60,padding:"0 56px",borderRadius:20,fontSize:18,fontWeight:700,boxShadow:"0 12px 30px rgba(16, 185, 129, 0.25)"},children:"เปิดกะทำงาน (Open Shift)"}),(0,i.jsxs)("div",{style:{marginTop:32,fontSize:14,color:"#94a3b8",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(0,i.jsx)(b.Z,{}),"ระบบจะมีการบันทึกเวลาและผู้ทำรายการทุกครั้ง"]})]})})})})})})}),(0,i.jsx)(k.Z,{open:s,onCancel:()=>R(!1)}),(0,i.jsx)(w.Z,{open:I,onCancel:()=>F(!1),onSuccess:()=>{F(!1)}})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=25116)}),_N_E=e.O()}]);