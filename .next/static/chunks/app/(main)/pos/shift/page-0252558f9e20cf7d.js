(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7322],{25116:function(e,t,i){Promise.resolve().then(i.bind(i,94004))},94004:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return K}});var r=i(57437),n=i(2265),s=i(29827),l=i(11713),o=i(82646),a=i(50742),d=i(80009),c=i(64625),u=i(53743),x=i(47451),h=i(69410),f=i(45235),m=i(23496),p=i(48651),y=i(96931),g=i(33477),b=i(17588),j=i(5540),v=i(29332),S=i(40103),Z=i(83669),k=i(8881),_=i(20955),w=i(42318),C=i(95159),N=i(28595),z=i(99376),B=i(46252),R=i(59226),I=i(3369),T=i(71096),L=i.n(T);i(6729);var W=i(13257),q=i.n(W);let D={container:{paddingBottom:100,backgroundColor:"#f8f9fc",minHeight:"100vh",fontFamily:"'Inter', 'Sarabun', sans-serif"},header:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",padding:"24px 24px 60px 24px",position:"relative",overflow:"hidden",marginBottom:-40,borderBottomLeftRadius:30,borderBottomRightRadius:30,boxShadow:"0 10px 30px rgba(16, 185, 129, 0.2)"},headerDecoCircle1:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:"rgba(255,255,255,0.1)"},headerDecoCircle2:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},headerContent:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"space-between",maxWidth:1200,margin:"0 auto"},headerLeft:{display:"flex",alignItems:"center",gap:16},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},headerTitleBox:{display:"flex",flexDirection:"column"},headerTitle:{color:"white",fontSize:24,margin:0,fontWeight:700,letterSpacing:"0.5px",lineHeight:1.2},headerSubtitle:{color:"rgba(255,255,255,0.9)",fontSize:14,display:"block"},contentContainer:{maxWidth:1200,margin:"0 auto",padding:"0 24px",position:"relative",zIndex:10},card:{borderRadius:24,border:"none",boxShadow:"0 10px 25px rgba(0,0,0,0.05)",background:"white",overflow:"hidden",height:"100%"},activeShiftCard:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",textAlign:"center",padding:"40px 24px",position:"relative",overflow:"hidden"},summaryCard:{background:"white",padding:"24px"}};L().extend(q()),L().locale("th");let{Title:O,Text:P}=o.default,F=e=>{let{currentShift:t,onBack:i}=e;return(0,r.jsxs)("div",{style:D.header,children:[(0,r.jsx)("div",{style:D.headerDecoCircle1}),(0,r.jsx)("div",{style:D.headerDecoCircle2}),(0,r.jsxs)("div",{style:D.headerContent,children:[(0,r.jsxs)("div",{style:D.headerLeft,children:[(0,r.jsx)(a.ZP,{type:"text",icon:(0,r.jsx)(b.Z,{style:{fontSize:20,color:"white"}}),onClick:i,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",borderRadius:12}}),(0,r.jsx)("div",{style:D.headerIconBox,children:(0,r.jsx)(j.Z,{style:{fontSize:28,color:"white"}})}),(0,r.jsxs)("div",{style:D.headerTitleBox,children:[(0,r.jsx)(P,{style:D.headerSubtitle,children:"จัดการข้อมูล"}),(0,r.jsx)(O,{level:4,style:D.headerTitle,children:"กะการทำงาน (Shift)"})]})]}),(0,r.jsx)(d.Z,{color:t?"#success":"#warning",style:{fontSize:14,padding:"6px 16px",borderRadius:20,border:"none",background:"white",color:t?"#10b981":"#f59e0b",fontWeight:600,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:t?(0,r.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,r.jsx)("span",{className:"pulse-animation",style:{width:8,height:8,borderRadius:"50%",background:"#10b981"}}),"เปิดใช้งานอยู่"]}):(0,r.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,r.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:"#f59e0b"}}),"ปิดใช้งาน"]})})]})]})};function K(){var e,t,i,o,b,T;let W=(0,z.useRouter)(),{message:q}=c.Z.useApp(),{showLoading:K,hideLoading:A}=(0,I.x)(),E=(0,s.NL)(),[H,Q]=(0,n.useState)(0),[Y,M]=(0,n.useState)(0),[J,G]=(0,n.useState)(!1),[U,V]=(0,n.useState)(!1),{socket:X}=(0,n.useContext)(B.J),{data:$=null,isLoading:ee}=(0,l.a)({queryKey:["shiftCurrent"],queryFn:async()=>await R.t.getCurrentShift(),staleTime:2e3}),{data:et=null,isLoading:ei}=(0,l.a)({queryKey:["shiftSummary",(null==$?void 0:$.id)||"none"],queryFn:async()=>await R.t.getCurrentSummary(),enabled:!!$,staleTime:2e3}),er=$?et:null,en=ee||!!$&&ei;(0,n.useEffect)(()=>{if(!X)return;let e=()=>{E.invalidateQueries({queryKey:["shiftCurrent"]}),E.invalidateQueries({queryKey:["shiftSummary"]})};return X.on("shifts:update",e),()=>{X.off("shifts:update",e)}},[X,E]);let es=async()=>{if(H<0){q.error("กรุณาระบุจำนวนเงินทอนเริ่มต้น");return}try{K("กำลังเปิดกะ..."),G(!1),await R.t.openShift(H),E.invalidateQueries({queryKey:["shiftCurrent"]}),E.invalidateQueries({queryKey:["shiftSummary"]}),Q(0),q.success("เปิดกะสำเร็จ!")}catch(t){let e=t instanceof Error?t.message:"ไม่สามารถเปิดกะได้";q.error(e)}finally{A()}},el=async()=>{if(Y<0){q.error("กรุณาระบุจำนวนเงินที่นับได้");return}try{var e,t,i,n;K("กำลังปิดกะและคำนวณยอด..."),V(!1);let s=await R.t.closeShift(Y),l=await R.t.getSummary(s.id);M(0),q.success("ปิดกะสำเร็จ!"),E.invalidateQueries({queryKey:["shiftCurrent"]}),E.invalidateQueries({queryKey:["shiftSummary"]}),u.Z.info({title:"สรุปกะการทำงาน",width:600,className:"shift-modal",content:(0,r.jsxs)("div",{style:{padding:"16px 0"},children:[(0,r.jsxs)(x.Z,{gutter:[16,16],children:[(0,r.jsx)(h.Z,{span:12,children:(0,r.jsx)(f.Z,{title:"เงินเริ่มต้น",value:Number(l.shift_info.start_amount),prefix:"฿"})}),(0,r.jsx)(h.Z,{span:12,children:(0,r.jsx)(f.Z,{title:"ยอดขายรวม",value:Number(l.summary.total_sales),prefix:"฿",valueStyle:{color:"#1890ff"}})}),(0,r.jsx)(h.Z,{span:12,children:(0,r.jsx)(f.Z,{title:"กำไรสุทธิ",value:Number(l.summary.net_profit),prefix:"฿",valueStyle:{color:"#52c41a"}})}),(0,r.jsx)(h.Z,{span:12,children:(0,r.jsx)(f.Z,{title:"เงินที่ควรมี (ทั้งหมดในเซฟ)",value:Number(l.shift_info.start_amount)+Number((null===(e=l.summary.payment_methods)||void 0===e?void 0:e["เงินสด"])||0),prefix:"฿",valueStyle:{color:"#1890ff"}})}),(0,r.jsx)(h.Z,{span:12,children:(0,r.jsx)(f.Z,{title:"เงินที่นับได้จริง",value:Number(l.shift_info.end_amount),prefix:"฿",suffix:0!==Number(l.shift_info.diff_amount)&&(0,r.jsxs)("span",{style:{fontSize:"14px",marginLeft:"8px",color:Number(l.shift_info.diff_amount)>0?"#52c41a":"#ff4d4f"},children:["(",Number(l.shift_info.diff_amount)>0?"+":"",Number(l.shift_info.diff_amount).toLocaleString(),")"]})})}),(0,r.jsxs)(h.Z,{span:24,children:[(0,r.jsx)(m.Z,{style:{margin:"8px 0"}}),(0,r.jsx)(P,{strong:!0,style:{display:"block",marginBottom:8},children:"ยอดขายแยกตามวิธีชำระเงิน"}),(0,r.jsx)(x.Z,{gutter:16,children:Object.entries(l.summary.payment_methods||{}).map(e=>{let[t,i]=e;return(0,r.jsx)(h.Z,{span:8,children:(0,r.jsx)(f.Z,{title:t,value:Number(i),prefix:"฿",valueStyle:{fontSize:16,color:"เงินสด"===t?"#1890ff":"พร้อมเพย์"===t?"#722ed1":"#eb2f96"}})},t)})}),(0,r.jsx)(m.Z,{style:{margin:"8px 0"}}),(0,r.jsx)(P,{strong:!0,style:{display:"block",marginBottom:8},children:"ยอดขายแยกตามช่องทาง"}),(0,r.jsxs)(x.Z,{gutter:16,children:[(0,r.jsx)(h.Z,{span:8,children:(0,r.jsx)(f.Z,{title:"ทานที่ร้าน",value:Number((null===(t=l.summary.order_types)||void 0===t?void 0:t.DineIn)||0),prefix:"฿",valueStyle:{fontSize:16}})}),(0,r.jsx)(h.Z,{span:8,children:(0,r.jsx)(f.Z,{title:"กลับบ้าน",value:Number((null===(i=l.summary.order_types)||void 0===i?void 0:i.TakeAway)||0),prefix:"฿",valueStyle:{fontSize:16}})}),(0,r.jsx)(h.Z,{span:8,children:(0,r.jsx)(f.Z,{title:"เดลิเวอรี่",value:Number((null===(n=l.summary.order_types)||void 0===n?void 0:n.Delivery)||0),prefix:"฿",valueStyle:{fontSize:16,color:"#eb2f96"}})})]}),(0,r.jsx)(m.Z,{style:{margin:"8px 0"}})]}),(0,r.jsxs)(h.Z,{span:24,children:[(0,r.jsx)(m.Z,{}),(0,r.jsx)(f.Z,{title:"ส่วนต่าง (Short/Over)",value:Number(l.shift_info.diff_amount),prefix:Number(l.shift_info.diff_amount)>=0?(0,r.jsx)(v.Z,{}):(0,r.jsx)(S.Z,{}),suffix:"฿",valueStyle:{color:Number(l.shift_info.diff_amount)>=0?"#52c41a":"#ff4d4f"}})]})]}),(0,r.jsx)(m.Z,{plain:!0,children:"จำนวนที่ขายได้แยกตามหมวดหมู่"}),(0,r.jsx)("div",{style:{maxHeight:200,overflow:"auto"},children:Object.entries(l.categories).map(e=>{let[t,i]=e;return(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,r.jsxs)(P,{children:[t,":"]}),(0,r.jsxs)(P,{strong:!0,children:[i," ชิ้น"]})]},t)})})]})})}catch(t){let e=t instanceof Error?t.message:"ไม่สามารถปิดกะได้";q.error(e)}finally{A()}};return en?(0,r.jsx)("div",{style:{...D.container,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,r.jsx)(p.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,r.jsxs)("div",{style:D.container,children:[(0,r.jsx)("style",{children:"\n    @keyframes pulse {\n        0% { transform: scale(1); }\n        50% { transform: scale(1.05); }\n        100% { transform: scale(1); }\n    }\n    \n    .pulse-animation {\n        animation: pulse 2s infinite ease-in-out;\n    }\n    \n    .shift-modal .ant-modal-content {\n        border-radius: 20px;\n        overflow: hidden;\n    }\n    \n    .shift-modal .ant-modal-header {\n        background: transparent;\n    }\n    \n    .stat-card-inner {\n        transition: all 0.3s ease;\n        padding: 16px;\n        border-radius: 16px;\n        background: #f8fafc;\n    }\n    \n    .stat-card-inner:hover {\n        background: #f1f5f9;\n        transform: translateY(-2px);\n    }\n"}),(0,r.jsx)(F,{currentShift:$,onBack:()=>W.back()}),(0,r.jsx)("div",{style:D.contentContainer,children:(0,r.jsx)(x.Z,{gutter:[24,24],children:$?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{xs:24,lg:8,children:(0,r.jsxs)("div",{style:{...D.card,...D.activeShiftCard},children:[(0,r.jsx)("div",{style:{position:"absolute",top:-20,right:-20,width:100,height:100,background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,r.jsx)("div",{style:{position:"absolute",bottom:-10,left:-20,width:80,height:80,background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,r.jsx)(Z.Z,{style:{fontSize:64,marginBottom:16,color:"white"}}),(0,r.jsx)(O,{level:3,style:{color:"white",margin:0},children:"กะกำลังทำงาน"}),(0,r.jsxs)(P,{style:{color:"rgba(255,255,255,0.85)",display:"block",marginTop:8},children:["เริ่มเมื่อ: ",L()($.open_time).format("DD/MM/YYYY HH:mm น.")]}),(0,r.jsxs)("div",{style:{marginTop:32,background:"rgba(255,255,255,0.2)",borderRadius:16,padding:"24px 16px",backdropFilter:"blur(4px)"},children:[(0,r.jsx)(P,{style:{color:"rgba(255,255,255,0.9)",fontSize:16},children:"ระยะเวลาทำงาน"}),(0,r.jsx)(O,{level:1,style:{color:"white",margin:"4px 0 0",fontSize:36},children:(()=>{if(!$)return"";let e=L().duration(L()().diff(L()($.open_time))),t=Math.floor(e.asHours()),i=e.minutes();return"".concat(t," ชม. ").concat(i," นาที")})()})]}),(0,r.jsx)(a.ZP,{type:"primary",danger:!0,icon:(0,r.jsx)(k.Z,{}),size:"large",block:!0,onClick:()=>V(!0),style:{marginTop:32,height:50,fontSize:16,borderRadius:12,border:"none",background:"white",color:"#ff4d4f",fontWeight:600,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:"ปิดกะ (Close Shift)"})]})}),(0,r.jsx)(h.Z,{xs:24,lg:16,children:(0,r.jsxs)(y.Z,{style:{...D.card,...D.summaryCard},bordered:!1,children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[(0,r.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:"#e6f7ff",display:"flex",alignItems:"center",justifyContent:"center",marginRight:12},children:(0,r.jsx)(v.Z,{style:{color:"#1890ff",fontSize:20}})}),(0,r.jsx)(O,{level:4,style:{margin:0},children:"สรุปยอดขายปัจจุบัน (Live Summary)"})]}),er?(0,r.jsxs)(x.Z,{gutter:[16,16],children:[(0,r.jsx)(h.Z,{xs:24,sm:12,md:8,children:(0,r.jsx)("div",{className:"stat-card-inner",children:(0,r.jsx)(f.Z,{title:(0,r.jsx)("span",{style:{color:"#64748b"},children:"เงินทอนเริ่มต้น"}),value:Number(er.shift_info.start_amount),prefix:(0,r.jsx)(_.Z,{style:{color:"#1890ff"}}),suffix:"฿",precision:0,valueStyle:{fontWeight:600,color:"#1e293b"}})})}),(0,r.jsx)(h.Z,{xs:24,sm:12,md:8,children:(0,r.jsx)("div",{className:"stat-card-inner",children:(0,r.jsx)(f.Z,{title:(0,r.jsx)("span",{style:{color:"#64748b"},children:"ยอดขายรวม"}),value:Number(er.summary.total_sales),prefix:(0,r.jsx)(w.Z,{style:{color:"#10b981"}}),suffix:"฿",precision:0,valueStyle:{fontWeight:600,color:"#10b981"}})})}),(0,r.jsx)(h.Z,{xs:24,sm:12,md:8,children:(0,r.jsx)("div",{className:"stat-card-inner",children:(0,r.jsx)(f.Z,{title:(0,r.jsx)("span",{style:{color:"#64748b"},children:"กำไรโดยประมาณ"}),value:Number(er.summary.net_profit),prefix:(0,r.jsx)(v.Z,{style:{color:"#f59e0b"}}),suffix:"฿",precision:0,valueStyle:{fontWeight:600,color:"#f59e0b"}})})}),(0,r.jsx)(h.Z,{span:24,children:(0,r.jsx)(m.Z,{style:{margin:"12px 0"}})}),(0,r.jsx)(h.Z,{xs:24,sm:12,md:8,children:(0,r.jsx)(f.Z,{title:"รวมจำนวนที่ขายได้",value:Object.values(er.categories).reduce((e,t)=>(Number(e)||0)+(Number(t)||0),0),suffix:"ชิ้น",valueStyle:{fontWeight:600}})}),(0,r.jsx)(h.Z,{xs:24,sm:12,md:16,children:(0,r.jsx)("div",{style:{background:"#f0fdf4",padding:"12px 16px",borderRadius:12,border:"1px solid #bbf7d0"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsxs)(P,{style:{color:"#15803d"},children:[(0,r.jsx)(C.Z,{style:{marginRight:6}}),"เงินสดที่ต้องมีในเซฟ"]}),(0,r.jsxs)(P,{strong:!0,style:{fontSize:20,color:"#15803d"},children:["฿",(Number(er.shift_info.start_amount)+Number((null===(e=er.summary.payment_methods)||void 0===e?void 0:e["เงินสด"])||0)).toLocaleString()]})]})})}),(0,r.jsx)(h.Z,{span:24,children:(0,r.jsxs)("div",{style:{marginTop:24},children:[(0,r.jsx)(P,{strong:!0,style:{fontSize:14,color:"#64748b",display:"block",marginBottom:16},children:"ยอดขายตามวิธีชำระเงิน"}),(0,r.jsx)(x.Z,{gutter:[12,12],children:Object.entries(er.summary.payment_methods||{}).map(e=>{let[t,i]=e;return(0,r.jsx)(h.Z,{xs:12,sm:8,children:(0,r.jsxs)("div",{style:{borderLeft:"3px solid ".concat("เงินสด"===t?"#1890ff":"พร้อมเพย์"===t?"#722ed1":"#eb2f96"),paddingLeft:12},children:[(0,r.jsx)(P,{style:{fontSize:12,color:"#64748b"},children:t}),(0,r.jsxs)("div",{style:{fontSize:16,fontWeight:600,color:"#1e293b"},children:["฿",Number(i).toLocaleString()]})]})},t)})})]})}),(0,r.jsx)(h.Z,{span:24,children:(0,r.jsxs)("div",{style:{marginTop:12},children:[(0,r.jsx)(P,{strong:!0,style:{fontSize:14,color:"#64748b",display:"block",marginBottom:16},children:"สินค้าขายดี 5 อันดับแรก"}),(0,r.jsx)("div",{style:{background:"#f8fafc",borderRadius:12,padding:16},children:er.top_products.length>0?er.top_products.map((e,t)=>(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4===t?0:12,paddingBottom:4===t?0:12,borderBottom:4===t?"none":"1px solid #e2e8f0"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,r.jsx)("div",{style:{width:24,height:24,borderRadius:"50%",background:0===t?"#fef3c7":"#f1f5f9",color:0===t?"#d97706":"#64748b",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:12},children:t+1}),(0,r.jsx)(P,{strong:!0,style:{color:"#334155"},children:e.name})]}),(0,r.jsxs)("div",{style:{textAlign:"right"},children:[(0,r.jsxs)(P,{type:"secondary",style:{marginRight:12,fontSize:12},children:[e.quantity," ",e.unit||"ชิ้น"]}),(0,r.jsxs)(P,{strong:!0,style:{color:"#1e293b"},children:["฿",Number(e.revenue).toLocaleString()]})]})]},e.id)):(0,r.jsx)("div",{style:{textAlign:"center",padding:20},children:(0,r.jsx)(P,{type:"secondary",children:"ยังไม่มีข้อมูลการขาย"})})})]})})]}):(0,r.jsxs)("div",{style:{textAlign:"center",padding:"40px 0"},children:[(0,r.jsx)(p.Z,{}),(0,r.jsx)("div",{style:{marginTop:16},children:"กำลังคำนวณสรุปยอด..."})]})]})})]}):(0,r.jsx)(h.Z,{xs:24,children:(0,r.jsx)(y.Z,{style:{...D.card,minHeight:400,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{style:{textAlign:"center",maxWidth:400},children:[(0,r.jsx)("div",{style:{width:120,height:120,background:"#fff7ed",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 32px"},children:(0,r.jsx)(j.Z,{style:{fontSize:60,color:"#f97316"}})}),(0,r.jsx)(O,{level:2,style:{marginBottom:16},children:"ยังไม่มีกะที่เปิด"}),(0,r.jsx)(P,{type:"secondary",style:{fontSize:16,display:"block",marginBottom:40},children:"กรุณาเปิดกะก่อนเริ่มทำงานขาย เพื่อติดตามยอดขายและเงินสดในลิ้นชัก ระบบจะบันทึกเวลาและยอดเงินเริ่มต้น"}),(0,r.jsx)(a.ZP,{type:"primary",icon:(0,r.jsx)(N.Z,{}),size:"large",onClick:()=>G(!0),style:{background:"#10b981",borderColor:"#10b981",height:56,padding:"0 48px",borderRadius:16,fontSize:18,fontWeight:600,boxShadow:"0 10px 25px rgba(16, 185, 129, 0.3)"},children:"เปิดกะทำงาน (Open Shift)"}),(0,r.jsxs)("div",{style:{marginTop:32,fontSize:13,color:"#94a3b8"},children:[(0,r.jsx)(C.Z,{style:{marginRight:6}}),"ระบบจะทำการตรวจสอบสิทธิ์ก่อนเปิดกะ"]})]})})})})}),(0,r.jsx)(u.Z,{title:(0,r.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(N.Z,{style:{color:"#10b981",marginRight:12,fontSize:24}})," ",(0,r.jsx)("span",{style:{fontSize:20},children:"เปิดกะใหม่"})]}),open:J,onCancel:()=>G(!1),onOk:es,okText:"ยืนยันเปิดกะ",cancelText:"ยกเลิก",okButtonProps:{style:{background:"#10b981",borderColor:"#10b981",height:40},size:"large"},cancelButtonProps:{size:"large",type:"text"},width:500,centered:!0,className:"shift-modal",children:(0,r.jsxs)("div",{style:{padding:"24px 0"},children:[(0,r.jsx)(P,{style:{fontSize:16,display:"block",marginBottom:16},children:"กรุณาระบุจำนวนเงินทอนเริ่มต้นในลิ้นชัก:"}),(0,r.jsx)(g.Z,{style:{width:"100%",borderRadius:12},size:"large",min:0,step:100,autoFocus:!0,value:H,onChange:e=>Q(e||0),formatter:e=>"฿ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>Number((null==e?void 0:e.replace(/[฿\s,]/g,""))||0),placeholder:"0.00",addonBefore:(0,r.jsx)(_.Z,{})}),(0,r.jsx)("div",{style:{marginTop:16,display:"flex",gap:8},children:[1e3,2e3,3e3,5e3].map(e=>(0,r.jsxs)(d.Z,{style:{borderRadius:16,padding:"4px 12px",cursor:"pointer"},onClick:()=>Q(e),children:["฿",e.toLocaleString()]},e))})]})}),(0,r.jsx)(u.Z,{title:(0,r.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(k.Z,{style:{color:"#ef4444",marginRight:12,fontSize:24}})," ",(0,r.jsx)("span",{style:{fontSize:20},children:"ปิดกะการทำงาน"})]}),open:U,onCancel:()=>V(!1),onOk:el,okText:"ยืนยันปิดกะ",okButtonProps:{danger:!0,size:"large",style:{height:40}},cancelButtonProps:{size:"large",type:"text"},cancelText:"ยกเลิก",width:500,centered:!0,children:(0,r.jsxs)("div",{style:{padding:"24px 0 12px"},children:[(0,r.jsxs)("div",{style:{background:"#fff7ed",border:"1px solid #ffedd5",padding:16,borderRadius:12,marginBottom:24},children:[(0,r.jsx)(P,{strong:!0,style:{color:"#c2410c"},children:"คำเตือน:"})," ",(0,r.jsx)(P,{style:{color:"#9a3412"},children:"เมื่อปิดกะแล้วจะไม่สามารถทำการขายต่อได้ จนกว่าจะเปิดกะใหม่"})]}),(0,r.jsx)(P,{style:{fontSize:16,display:"block",marginBottom:16},children:"ระบุจำนวนเงินสดที่นับได้จริง (Counted Cash):"}),(0,r.jsx)(g.Z,{style:{width:"100%",borderRadius:12},size:"large",min:0,step:100,autoFocus:!0,value:Y,onChange:e=>M(e||0),formatter:e=>"฿ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>Number((null==e?void 0:e.replace(/[฿\s,]/g,""))||0),placeholder:"0.00",addonBefore:(0,r.jsx)(_.Z,{})}),er&&(0,r.jsxs)("div",{style:{marginTop:24,padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,r.jsx)(P,{type:"secondary",children:"เงินเริ่มต้นในลิ้นชัก"}),(0,r.jsxs)(P,{children:["฿",Number(er.shift_info.start_amount).toLocaleString()]})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[(0,r.jsx)(P,{type:"secondary",children:"ยอดขายเงินสดวันนี้"}),(0,r.jsxs)(P,{children:["฿",Number((null===(t=er.summary.payment_methods)||void 0===t?void 0:t["เงินสด"])||0).toLocaleString()]})]}),(0,r.jsx)(m.Z,{style:{margin:"12px 0"}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(P,{strong:!0,children:"ยอดเงินสดที่ควรมี"}),(0,r.jsxs)(P,{strong:!0,style:{color:"#1e293b",fontSize:18},children:["฿",(Number(er.shift_info.start_amount)+Number((null===(i=er.summary.payment_methods)||void 0===i?void 0:i["เงินสด"])||0)).toLocaleString()]})]}),Y>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{style:{margin:"12px 0"}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(P,{strong:!0,children:"ส่วนต่าง (Diff)"}),(0,r.jsxs)(d.Z,{color:Y-(Number(er.shift_info.start_amount)+Number((null===(o=er.summary.payment_methods)||void 0===o?void 0:o["เงินสด"])||0))>=0?"success":"error",style:{fontSize:16,padding:"4px 12px",margin:0,borderRadius:12},children:[Y-(Number(er.shift_info.start_amount)+Number((null===(b=er.summary.payment_methods)||void 0===b?void 0:b["เงินสด"])||0))>=0?"+":"",(Y-(Number(er.shift_info.start_amount)+Number((null===(T=er.summary.payment_methods)||void 0===T?void 0:T["เงินสด"])||0))).toLocaleString()," ฿"]})]})]})]})]})})]})}},46252:function(e,t,i){"use strict";i.d(t,{J:function(){return o},SocketProvider:function(){return a}});var r=i(57437),n=i(2265),s=i(68680),l=i(14362);let o=(0,n.createContext)({socket:null,isConnected:!1}),a=e=>{let{children:t}=e,[i,a]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1),{user:u}=(0,l.a)();return(0,n.useEffect)(()=>{if(!u){i&&(i.disconnect(),a(null),c(!1));return}let e=localStorage.getItem("token_ws"),t=(0,s.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:e?{token:e}:void 0});return t.on("connect",()=>{console.log("Socket Connected:",t.id),c(!0)}),t.on("disconnect",()=>{console.log("Socket Disconnected"),c(!1)}),a(t),()=>{t.disconnect()}},[u]),(0,r.jsx)(o.Provider,{value:{socket:i,isConnected:d},children:t})}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,9,8640,6931,4547,9763,2239,1713,8869,990,6011,2971,2117,1744],function(){return e(e.s=25116)}),_N_E=e.O()}]);