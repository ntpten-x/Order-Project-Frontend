(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7322],{25116:function(e,t,n){Promise.resolve().then(n.bind(n,94004))},94004:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var i=n(57437),r=n(2265),a=n(29827),o=n(11713),s=n(19683),d=n(50742),l=n(80009),c=n(48651),h=n(47451),p=n(69410),x=n(96931),f=n(17588),g=n(5540),u=n(83669),b=n(8881),m=n(29332),y=n(95159),j=n(28595),v=n(99376),S=n(46252),k=n(59226),w=n(71096),C=n.n(w);n(6729);var z=n(13257),R=n.n(z);let I={container:{paddingBottom:100,backgroundColor:n(44225).X1.background,minHeight:"100vh",fontFamily:"'Inter', 'Sarabun', -apple-system, BlinkMacSystemFont, sans-serif"},header:{background:"linear-gradient(135deg, #10B981 0%, #059669 100%)",padding:"16px 16px 48px 16px",position:"relative",overflow:"hidden",borderBottomLeftRadius:20,borderBottomRightRadius:20,boxShadow:"0 4px 16px rgba(16, 185, 129, 0.2)"},headerDecoCircle1:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:"rgba(255,255,255,0.1)"},headerDecoCircle2:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},headerContent:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"space-between",maxWidth:1200,margin:"0 auto"},headerLeft:{display:"flex",alignItems:"center",gap:16},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},headerTitleBox:{display:"flex",flexDirection:"column"},headerTitle:{color:"white",fontSize:24,margin:0,fontWeight:700,letterSpacing:"0.5px",lineHeight:1.2},headerSubtitle:{color:"rgba(255,255,255,0.9)",fontSize:14,display:"block"},contentContainer:{maxWidth:1200,margin:"0 auto",padding:"0 24px",position:"relative",zIndex:10},card:{borderRadius:24,border:"none",boxShadow:"0 10px 25px rgba(0,0,0,0.05)",background:"white",overflow:"hidden",height:"100%"},activeShiftCard:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white",textAlign:"center",padding:"40px 24px",position:"relative",overflow:"hidden"},summaryCard:{background:"white",padding:"24px"},statisticValue:e=>({color:e,fontWeight:600}),noShiftCard:{textAlign:"center",padding:"60px 20px",background:"rgba(255,255,255,0.8)",backdropFilter:"blur(10px)",borderRadius:24,border:"1px dashed #d9d9d9"},sectionDivider:{margin:"24px 0"},trendUp:{color:"#52c41a"},trendDown:{color:"#ff4d4f"}};var W=n(54343),Z=n(15718);C().extend(R()),C().locale("th");let{Title:B,Text:F}=s.default,T=e=>{let{currentShift:t,onBack:n}=e;return(0,i.jsxs)("div",{style:I.header,children:[(0,i.jsx)("div",{style:I.headerDecoCircle1}),(0,i.jsx)("div",{style:I.headerDecoCircle2}),(0,i.jsxs)("div",{style:I.headerContent,children:[(0,i.jsxs)("div",{style:I.headerLeft,children:[(0,i.jsx)(d.ZP,{type:"text",icon:(0,i.jsx)(f.Z,{style:{fontSize:20,color:"white"}}),onClick:n,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"white",borderRadius:12}}),(0,i.jsx)("div",{style:I.headerIconBox,children:(0,i.jsx)(g.Z,{style:{fontSize:28,color:"white"}})}),(0,i.jsxs)("div",{style:I.headerTitleBox,children:[(0,i.jsx)(F,{style:I.headerSubtitle,children:"จัดการข้อมูล"}),(0,i.jsx)(B,{level:4,style:I.headerTitle,children:"กะการทำงาน (Shift)"})]})]}),(0,i.jsx)(l.Z,{style:{fontSize:14,padding:"6px 16px",borderRadius:20,border:"none",background:t?"white":"rgba(255,255,255,0.9)",color:t?"#10b981":"#f59e0b",fontWeight:600,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:t?(0,i.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,i.jsx)("span",{className:"pulse-animation",style:{width:8,height:8,borderRadius:"50%",background:"#10b981"}}),"เปิดใช้งานอยู่"]}):(0,i.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,i.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:"#f59e0b"}}),"ปิดใช้งาน"]})})]})]})};function _(){var e;let t=(0,v.useRouter)(),n=(0,a.NL)(),[s,l]=(0,r.useState)(!1),[f,w]=(0,r.useState)(!1),{socket:z}=(0,r.useContext)(S.J),{data:R=null,isLoading:_}=(0,o.a)({queryKey:["shiftCurrent"],queryFn:async()=>await k.t.getCurrentShift(),staleTime:2e3}),{data:D=null,isLoading:N}=(0,o.a)({queryKey:["shiftSummary",(null==R?void 0:R.id)||"none"],queryFn:async()=>await k.t.getCurrentSummary(),enabled:!!R,staleTime:2e3}),L=R?D:null,E=_||!!R&&N;return((0,r.useEffect)(()=>{if(!z)return;let e=()=>{n.invalidateQueries({queryKey:["shiftCurrent"]}),n.invalidateQueries({queryKey:["shiftSummary"]})};return z.on("shifts:update",e),()=>{z.off("shifts:update",e)}},[z,n]),E)?(0,i.jsx)("div",{style:{...I.container,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,i.jsx)(c.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,i.jsxs)("div",{style:I.container,children:[(0,i.jsx)("style",{children:"\n    @keyframes pulse {\n        0% { transform: scale(1); }\n        50% { transform: scale(1.05); }\n        100% { transform: scale(1); }\n    }\n\n    @keyframes fadeInUp {\n        from {\n            opacity: 0;\n            transform: translateY(20px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n    \n    .pulse-animation {\n        animation: pulse 2s infinite ease-in-out;\n    }\n\n    .shift-card-animate {\n        animation: fadeInUp 0.5s ease forwards;\n        opacity: 0;\n    }\n\n    .shift-card-delay-1 { animation-delay: 0.1s; }\n    .shift-card-delay-2 { animation-delay: 0.2s; }\n    \n    .shift-modal .ant-modal-content {\n        border-radius: 20px;\n        overflow: hidden;\n    }\n    \n    .shift-modal .ant-modal-header {\n        background: transparent;\n    }\n\n    .stat-card-inner {\n        transition: all 0.3s ease;\n        padding: 16px;\n        border-radius: 16px;\n        background: #f8fafc;\n    }\n    \n    .stat-card-inner:hover {\n        background: #f1f5f9;\n        transform: translateY(-2px);\n    }\n\n    /* Mobile-first responsive */\n    .shift-header-mobile {\n        flex-direction: column !important;\n        align-items: flex-start !important;\n        gap: 16px !important;\n    }\n\n    .shift-content-mobile {\n        padding: 0 16px !important;\n    }\n\n    .shift-stat-grid {\n        display: grid;\n        grid-template-columns: repeat(2, 1fr);\n        gap: 12px;\n    }\n\n    @media (max-width: 576px) {\n        .shift-header-mobile {\n            padding: 16px 16px 40px !important;\n        }\n\n        .shift-stat-grid {\n            grid-template-columns: 1fr;\n        }\n\n        .shift-action-btn {\n            width: 100% !important;\n            height: 52px !important;\n            font-size: 16px !important;\n        }\n\n        .shift-modal .ant-modal {\n            max-width: calc(100vw - 32px) !important;\n            margin: 16px !important;\n        }\n    }\n\n    @media (min-width: 768px) {\n        .shift-stat-grid {\n            grid-template-columns: repeat(3, 1fr);\n        }\n    }\n\n    @media (min-width: 1024px) {\n        .shift-stat-grid {\n            grid-template-columns: repeat(4, 1fr);\n        }\n    }\n\n    /* Touch-friendly */\n    .shift-action-btn {\n        -webkit-tap-highlight-color: rgba(16, 185, 129, 0.1);\n        touch-action: manipulation;\n    }\n"}),(0,i.jsx)(T,{currentShift:R,onBack:()=>t.back()}),(0,i.jsx)("div",{style:I.contentContainer,children:(0,i.jsx)(h.Z,{gutter:[24,24],children:R?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{xs:24,lg:8,children:(0,i.jsxs)("div",{style:{...I.card,...I.activeShiftCard},children:[(0,i.jsx)("div",{style:{position:"absolute",top:-20,right:-20,width:100,height:100,background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,i.jsx)("div",{style:{position:"absolute",bottom:-10,left:-20,width:80,height:80,background:"rgba(255,255,255,0.1)",borderRadius:"50%"}}),(0,i.jsx)(u.Z,{style:{fontSize:64,marginBottom:16,color:"white"}}),(0,i.jsx)(B,{level:3,style:{color:"white",margin:0},children:"กะกำลังทำงาน"}),(0,i.jsxs)(F,{style:{color:"rgba(255,255,255,0.85)",display:"block",marginTop:8},children:["เริ่มเมื่อ: ",C()(R.open_time).format("DD/MM/YYYY HH:mm น.")]}),(0,i.jsxs)("div",{style:{marginTop:32,background:"rgba(255,255,255,0.2)",borderRadius:16,padding:"24px 16px",backdropFilter:"blur(4px)"},children:[(0,i.jsx)(F,{style:{color:"rgba(255,255,255,0.9)",fontSize:16,fontWeight:500},children:"ระยะเวลาทำงาน"}),(0,i.jsx)(B,{level:1,style:{color:"white",margin:"4px 0 0",fontSize:40,letterSpacing:"-0.02em"},children:(()=>{if(!R)return"";let e=C().duration(C()().diff(C()(R.open_time))),t=Math.floor(e.asHours()),n=e.minutes();return"".concat(t," ชม. ").concat(n," นาที")})()})]}),(0,i.jsx)(d.ZP,{type:"primary",danger:!0,icon:(0,i.jsx)(b.Z,{}),size:"large",block:!0,onClick:()=>w(!0),style:{marginTop:32,height:56,fontSize:18,borderRadius:16,border:"none",background:"white",color:"#ef4444",fontWeight:700,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:"ปิดกะ (Close Shift)"})]})}),(0,i.jsx)(p.Z,{xs:24,lg:16,children:(0,i.jsxs)(x.Z,{style:{...I.card,...I.summaryCard},bordered:!1,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[(0,i.jsx)("div",{style:{width:48,height:48,borderRadius:14,background:"#eff6ff",display:"flex",alignItems:"center",justifyContent:"center",marginRight:16,color:"#3b82f6"},children:(0,i.jsx)(m.Z,{style:{fontSize:24}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{level:4,style:{margin:0,color:"#1e293b"},children:"สรุปยอดขายปัจจุบัน"}),(0,i.jsx)(F,{type:"secondary",children:"Live Summary"})]})]}),L?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[(0,i.jsxs)("div",{className:"stat-card",style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,i.jsx)(F,{type:"secondary",style:{fontSize:14},children:"ยอดขายรวม"}),(0,i.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:"#10b981",marginTop:4},children:["฿",Number(L.summary.total_sales).toLocaleString()]})]}),(0,i.jsxs)("div",{className:"stat-card",style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,i.jsx)(F,{type:"secondary",style:{fontSize:14},children:"กำไรสุทธิ"}),(0,i.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:"#f59e0b",marginTop:4},children:["฿",Number(L.summary.net_profit).toLocaleString()]})]}),(0,i.jsxs)("div",{className:"stat-card",style:{padding:20,background:"#f8fafc",borderRadius:16,border:"1px solid #e2e8f0"},children:[(0,i.jsx)(F,{type:"secondary",style:{fontSize:14},children:"จำนวนบิล (โดยประมาณ)"}),(0,i.jsx)("div",{style:{fontSize:24,fontWeight:700,color:"#3b82f6",marginTop:4},children:Object.values(L.categories).reduce((e,t)=>e+t,0)})]})]}),(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",padding:"20px 24px",borderRadius:20,border:"1px solid #bbf7d0",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)(y.Z,{style:{fontSize:24,color:"#15803d"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)(F,{style:{color:"#166534",fontWeight:600,display:"block"},children:"เงินสดที่ต้องมีในเซฟ (Cash in Drawer)"}),(0,i.jsx)(F,{style:{color:"#166534",fontSize:13,opacity:.8},children:"เงินทอนเริ่มต้น + ยอดขายเงินสด"})]})]}),(0,i.jsxs)(F,{style:{fontSize:28,fontWeight:800,color:"#14532d"},children:["฿",(Number(L.shift_info.start_amount)+Number((null===(e=L.summary.payment_methods)||void 0===e?void 0:e["เงินสด"])||0)).toLocaleString()]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(F,{style:{fontSize:14,fontWeight:600,color:"#64748b",marginBottom:12,display:"block"},children:"แยกตามวิธีหน้าชำระ"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:12},children:Object.entries(L.summary.payment_methods||{}).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{style:{flex:"1 1 140px",padding:"12px 16px",background:"#fff",border:"1px solid #f1f5f9",borderRadius:12,boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[(0,i.jsx)(F,{style:{fontSize:12,color:"#94a3b8"},children:t}),(0,i.jsxs)("div",{style:{fontSize:16,fontWeight:600,color:"#334155"},children:["฿",Number(n).toLocaleString()]})]},t)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(F,{style:{fontSize:14,fontWeight:600,color:"#64748b",marginBottom:12,display:"block"},children:"สินค้าขายดี"}),(0,i.jsxs)("div",{style:{background:"#fff",border:"1px solid #f1f5f9",borderRadius:16,overflow:"hidden"},children:[L.top_products.slice(0,3).map((e,t)=>(0,i.jsxs)("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:t<2?"1px solid #f8fafc":"none"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)("div",{style:{width:24,height:24,borderRadius:"50%",background:0===t?"#FEF3C7":"#F1F5F9",color:0===t?"#D97706":"#64748B",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700},children:t+1}),(0,i.jsx)(F,{style:{fontWeight:500,color:"#334155"},children:e.name})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)(F,{style:{fontSize:13,color:"#64748b",marginRight:8},children:[e.quantity," ",e.unit||"ชิ้น"]}),(0,i.jsxs)(F,{style:{fontWeight:600,color:"#0f172a"},children:["฿",Number(e.revenue).toLocaleString()]})]})]},t)),0===L.top_products.length&&(0,i.jsx)("div",{style:{padding:20,textAlign:"center",color:"#94a3b8"},children:"ยังไม่มีข้อมูลการขาย"})]})]})]}):(0,i.jsxs)("div",{style:{textAlign:"center",padding:"60px 0"},children:[(0,i.jsx)(c.Z,{size:"large"}),(0,i.jsx)("div",{style:{marginTop:16,color:"#94a3b8"},children:"กำลังโหลดข้อมูลสรุป..."})]})]})})]}):(0,i.jsx)(p.Z,{xs:24,children:(0,i.jsx)(x.Z,{style:{...I.card,minHeight:500,display:"flex",alignItems:"center",justifyContent:"center",background:"white"},children:(0,i.jsxs)("div",{style:{textAlign:"center",maxWidth:480},children:[(0,i.jsx)("div",{style:{width:140,height:140,background:"linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 40px",boxShadow:"0 20px 40px rgba(249, 115, 22, 0.15)"},children:(0,i.jsx)(g.Z,{style:{fontSize:64,color:"#EA580C"}})}),(0,i.jsx)(B,{level:2,style:{marginBottom:16,color:"#1e293b"},children:"ยังไม่มีกะที่เปิดใช้งาน"}),(0,i.jsxs)(F,{type:"secondary",style:{fontSize:16,lineHeight:1.6,display:"block",marginBottom:48,color:"#64748b"},children:["ระบบจะทำการบันทึกยอดขายและเงินสดแยกตามกะการทำงาน ",(0,i.jsx)("br",{}),"กรุณาเปิดกะใหม่เพื่อเริ่มต้นการขายสินค้า"]}),(0,i.jsx)(d.ZP,{type:"primary",icon:(0,i.jsx)(j.Z,{}),size:"large",onClick:()=>l(!0),style:{background:"#10b981",borderColor:"#10b981",height:60,padding:"0 56px",borderRadius:20,fontSize:18,fontWeight:700,boxShadow:"0 12px 30px rgba(16, 185, 129, 0.25)"},children:"เปิดกะทำงาน (Open Shift)"}),(0,i.jsxs)("div",{style:{marginTop:32,fontSize:14,color:"#94a3b8",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(0,i.jsx)(y.Z,{}),"ระบบจะมีการบันทึกเวลาและผู้ทำรายการทุกครั้ง"]})]})})})})}),(0,i.jsx)(W.Z,{open:s,onCancel:()=>l(!1)}),(0,i.jsx)(Z.default,{open:f,onCancel:()=>w(!1),onSuccess:()=>{w(!1)}})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=25116)}),_N_E=e.O()}]);