(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9110],{16923:function(e,t,r){Promise.resolve().then(r.bind(r,76732))},29271:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},s=r(55015);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o=n.forwardRef((e,t)=>n.createElement(s.Z,i({},e,{ref:t,icon:a})))},15424:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},s=r(55015);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o=n.forwardRef((e,t)=>n.createElement(s.Z,i({},e,{ref:t,icon:a})))},67605:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},s=r(55015);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o=n.forwardRef((e,t)=>n.createElement(s.Z,i({},e,{ref:t,icon:a})))},59352:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"},s=r(55015);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o=n.forwardRef((e,t)=>n.createElement(s.Z,i({},e,{ref:t,icon:a})))},53743:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var n=r(42535),a=r(50815),s=r(74079),i=r(2265),o=r(28975),l=r(61994),c=r(93942),d=r(71744),u=r(64024),f=r(85695),m=r(90024),y=r(4065),h=(0,c.i)(e=>{let{prefixCls:t,className:r,closeIcon:n,closable:a,type:s,title:c,children:h,footer:p,...x}=e,{getPrefixCls:v}=i.useContext(d.E_),g=v(),b=t||v("modal"),j=(0,u.Z)(g),[w,k]=(0,y.ZP)(b,j),N="".concat(b,"-confirm"),S={};return S=s?{closable:null!=a&&a,title:"",footer:"",children:i.createElement(f.O,{...e,prefixCls:b,confirmPrefixCls:N,rootPrefixCls:g,content:h})}:{closable:null==a||a,title:c,footer:null!==p&&i.createElement(m.$,{...e}),children:h},i.createElement(o.s,{prefixCls:b,className:(0,l.W)(w,"".concat(b,"-pure-panel"),s&&N,s&&"".concat(N,"-").concat(s),r,k,j),...x,closeIcon:(0,m.b)(b,n),closable:a,...S})}),p=r(23248);function x(e){return(0,n.ZP)((0,n.uW)(e))}let v=s.Z;v.useModal=p.Z,v.info=function(e){return(0,n.ZP)((0,n.cw)(e))},v.success=function(e){return(0,n.ZP)((0,n.vq)(e))},v.error=function(e){return(0,n.ZP)((0,n.AQ)(e))},v.warning=x,v.warn=x,v.confirm=function(e){return(0,n.ZP)((0,n.Au)(e))},v.destroyAll=function(){for(;a.Z.length;){let e=a.Z.pop();e&&e()}},v.config=n.ai,v._InternalPanelDoNotUseOrYouWillBeFired=h;var g=v},76732:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return V}});var n=r(57437),a=r(29),s=r.n(a),i=r(2265),o=r(99376),l=r(39486),c=r(34029),d=r(80009),u=r(85180),f=r(50742),m=r(47451),y=r(69410),h=r(91652),p=r(96931),x=r(23496),v=r(17588),g=r(67605),b=r(13377),j=r(59352),w=r(70464),k=r(62376),N=r(29271),S=r(83669),Z=r(15424),z=r(53286),_=r(63836),C=r(54528),O=r(97235),E=r(7806),P=r(32446),T=r(94532),B=r(45963),I=r(49747),R=r(71096),D=r.n(R);r(6729);var L=r(61414),F=r(60300),M=r(3369),G=r(24675),H=r(67697),A=r(12028);let{Title:W,Text:q}=l.default;function V(){var e,t;let r=(0,o.useRouter)(),a=(0,o.useParams)(),[l,R]=c.ZP.useMessage(),D=Array.isArray(null==a?void 0:a.deliveryId)?a.deliveryId[0]:null==a?void 0:a.deliveryId,[V,U]=(0,i.useState)(null),[X,J]=(0,i.useState)(!0),[Q,Y]=(0,i.useState)(!0),[$,K]=(0,i.useState)(!1),{showLoading:ee,hideLoading:et}=(0,M.x)(),{socket:er}=(0,G.s)(),[en,ea]=(0,i.useState)({open:!1,type:"confirm",title:"",content:"",onOk:()=>{}}),es=()=>ea(e=>({...e,open:!1})),ei=(0,i.useCallback)(async()=>{if(D)try{J(!0),ee("กำลังโหลดข้อมูลออเดอร์...");let[e,t]=await Promise.all([z.x.getById(D),_.E.getByName("Delivery").catch(()=>null)]);if(e.status!==P.i.WaitingForPayment){r.push("/pos/channels");return}if(e.order_type!==P.m.Delivery){l.warning("รายการนี้ไม่ใช่ Order Delivery"),r.push("/pos/channels");return}U(e),Y(!!t)}catch(e){l.error("ไม่สามารถโหลดข้อมูลออเดอร์ได้")}finally{J(!1),et()}},[D,l,r,ee,et]);(0,i.useEffect)(()=>{D&&ei()},[ei,D]),(0,H.D)({socket:er,events:[A.b.orders.update,A.b.orders.delete,A.b.payments.create,A.b.payments.update,A.b.salesOrderItem.create,A.b.salesOrderItem.update,A.b.salesOrderItem.delete,A.b.salesOrderDetail.create,A.b.salesOrderDetail.update,A.b.salesOrderDetail.delete],onRefresh:()=>{D&&ei()},intervalMs:15e3,enabled:!!D});let{subtotal:eo,discount:el,vat:ec,total:ed}=(0,I.hs)(V,Number((null==V?void 0:V.total_amount)||0)),eu=(0,i.useMemo)(()=>{if(!(null==V?void 0:V.items))return[];let e=V.items.filter(e=>!(0,L.s6)(e.status));return(0,E.S)(e)},[null==V?void 0:V.items]),ef=async()=>{var e;V&&ea({open:!0,type:"confirm",title:"ยืนยันการส่งมอบสินค้า",content:(0,n.jsxs)("div",{style:{textAlign:"center"},children:[(0,n.jsxs)("div",{style:{fontSize:16,marginBottom:12},children:["คุณกำลังจะส่งมอบสินค้าให้ไรเดอร์สำหรับออเดอร์ ",(0,n.jsxs)(q,{strong:!0,children:["#",V.order_no]})]}),(0,n.jsxs)(d.Z,{color:"magenta",style:{fontSize:14,padding:"6px 16px",borderRadius:8},children:[null===(e=V.delivery)||void 0===e?void 0:e.delivery_name," ",V.delivery_code?"(".concat(V.delivery_code,")"):""]})]}),okText:"ยืนยันส่งมอบ",cancelText:"ยกเลิก",onOk:async()=>{try{ee("กำลังดำเนินการส่งมอบ..."),es();let e=await (0,O.P)(),t=await _.E.getByName("Delivery"),n={order_id:V.id,payment_method_id:null==t?void 0:t.id,amount:ed,amount_received:ed,change_amount:0,status:T.b.Success};await C.U.create(n,void 0,e),l.success("ส่งมอบสินค้าให้ไรเดอร์เรียบร้อย"),r.push("/pos/dashboard/".concat(V.id))}catch(e){l.error("เกิดข้อผิดพลาดในการส่งมอบ")}finally{et()}}})},em=async()=>{V&&ea({open:!0,type:"warning",title:"ย้อนกลับไปแก้ไขออเดอร์?",content:'สถานะออเดอร์จะถูกเปลี่ยนกลับเป็น "กำลังดำเนินการ" เพื่อให้คุณสามารถแก้ไขรายการอาหารได้ คุณแน่ใจหรือไม่?',okText:"ตกลง",cancelText:"ยกเลิก",onOk:async()=>{try{var e;ee("กำลังดำเนินการ..."),es();let t=await (0,O.P)(),n=(null===(e=V.items)||void 0===e?void 0:e.filter(e=>!(0,L.s6)(e.status)))||[];await Promise.all(n.map(e=>z.x.updateItemStatus(e.id,P.i.Served,void 0,t))),await z.x.updateStatus(V.id,P.i.Pending,t),l.success("ย้อนกลับไปแก้ไขออเดอร์เรียบร้อย"),r.push((0,L.HL)(V.id))}catch(e){l.error("ไม่สามารถเปลี่ยนสถานะออเดอร์ได้")}finally{et()}}})};return X&&!V?null:V?(0,n.jsxs)("div",{className:"delivery-page-container",children:[(0,n.jsx)(s(),{id:B.um.__hash,children:B.um}),R,(0,n.jsxs)("div",{className:"delivery-hero-mobile",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,n.jsx)(f.ZP,{type:"text",icon:(0,n.jsx)(v.Z,{style:{fontSize:18,color:"#fff"}}),style:{height:44,width:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{r.push("/pos/channels/delivery")}}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)(W,{level:4,style:{margin:0,color:"#fff",fontSize:20,fontWeight:700},children:"ส่งมอบสินค้า"}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:4,flexWrap:"wrap"},children:[(0,n.jsxs)(d.Z,{color:"rgba(255,255,255,0.2)",style:{border:"none",color:"#fff",fontSize:12},children:[(0,n.jsx)(g.Z,{style:{marginRight:4}}),"Delivery"]}),(0,n.jsxs)(q,{style:{color:"rgba(255,255,255,0.9)",fontSize:13,fontWeight:500},children:["#",V.order_no]})]})]})]}),(0,n.jsxs)("div",{className:"delivery-action-buttons",children:[(0,n.jsx)(f.ZP,{icon:(0,n.jsx)(b.Z,{}),onClick:em,className:"delivery-action-btn",style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff"},children:"แก้ไข"}),(0,n.jsx)(f.ZP,{danger:!0,onClick:()=>{V&&ea({open:!0,type:"danger",title:"ยืนยันการยกเลิกออเดอร์?",content:"การดำเนินการนี้จะยกเลิกสินค้าทุกรายการ คุณแน่ใจหรือไม่?",okText:"ยืนยันการยกเลิก",cancelText:"ยกเลิก",onOk:async()=>{try{var e;ee("กำลังดำเนินการยกเลิก..."),es();let t=await (0,O.P)(),n=(null===(e=V.items)||void 0===e?void 0:e.filter(e=>!(0,L.s6)(e.status)))||[];await Promise.all(n.map(e=>z.x.updateItemStatus(e.id,P.i.Cancelled,void 0,t))),await z.x.updateStatus(V.id,P.i.Cancelled,t),l.success("ยกเลิกออเดอร์เรียบร้อย"),r.push((0,L.d$)(V.order_type))}catch(e){l.error("ไม่สามารถยกเลิกออเดอร์ได้")}finally{et()}}})},className:"delivery-action-btn",children:"ยกเลิก"})]})]}),(0,n.jsx)("div",{style:{padding:"16px",maxWidth:1200,margin:"0 auto"},children:(0,n.jsxs)(m.Z,{gutter:[20,20],children:[(0,n.jsxs)(y.Z,{xs:24,lg:12,children:[(0,n.jsxs)("div",{className:"delivery-order-summary",children:[(0,n.jsxs)("div",{onClick:()=>K(!$),className:"delivery-summary-header",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(q,{strong:!0,style:{fontSize:16,color:"#be185d"},children:"รายการอาหาร"}),(0,n.jsxs)(q,{type:"secondary",style:{marginLeft:8},children:["(",eu.length," รายการ)"]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,n.jsx)(q,{strong:!0,style:{fontSize:18,color:"#EC4899"},children:(0,L.xG)(eo)}),$?(0,n.jsx)(j.Z,{style:{color:"#be185d"}}):(0,n.jsx)(w.Z,{style:{color:"#be185d"}})]})]}),(0,n.jsx)("div",{className:"delivery-summary-content ".concat($?"expanded":""),children:(0,n.jsx)("div",{className:"delivery-summary-items",children:eu.map((e,t)=>{var r,a;return(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:14,paddingBottom:14,borderBottom:"1px solid ".concat(B.QF.borderLight)},children:[(0,n.jsxs)("div",{style:{display:"flex",gap:12,flex:1,minWidth:0},children:[(0,n.jsx)(h.Z,{shape:"square",size:52,src:null===(r=e.product)||void 0===r?void 0:r.img_url,icon:(0,n.jsx)(k.Z,{}),style:{backgroundColor:"#fdf2f8",flexShrink:0,borderRadius:12,border:"1px solid #fce7f3"}}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)(q,{strong:!0,style:{display:"block",fontSize:15},ellipsis:!0,children:null===(a=e.product)||void 0===a?void 0:a.display_name}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:4},children:[(0,n.jsx)(q,{type:"secondary",style:{fontSize:13},children:(0,L.xG)(e.price)}),(0,n.jsxs)(d.Z,{color:"magenta",style:{margin:0,fontSize:11,padding:"0 8px",borderRadius:6},children:["x",e.quantity]})]}),e.notes&&(0,n.jsxs)(q,{style:{display:"block",fontSize:12,fontStyle:"italic",color:"#f43f5e",marginTop:4},children:["* ",e.notes]}),e.details&&e.details.length>0&&(0,n.jsx)("div",{style:{marginTop:4},children:e.details.map((e,t)=>(0,n.jsxs)(q,{style:{color:"#10b981",fontSize:11,display:"block"},children:["+ ",e.detail_name," ",Number(e.extra_price)>0?"(+".concat(Number(e.extra_price),")"):""]},t))})]})]}),(0,n.jsx)(q,{strong:!0,style:{fontSize:15,color:"#1f2937"},children:(0,L.xG)(Number(e.total_price||Number(e.price)*e.quantity))})]},t)})})})]}),(0,n.jsxs)(p.Z,{style:{borderRadius:20,marginBottom:16,border:"1px solid #fce7f3"},styles:{body:{padding:20}},children:[(0,n.jsxs)(m.Z,{justify:"space-between",style:{marginBottom:10},children:[(0,n.jsx)(q,{type:"secondary",children:"ยอดรวม"}),(0,n.jsx)(q,{children:(0,L.xG)(eo)})]}),el>0&&(0,n.jsxs)(m.Z,{justify:"space-between",style:{marginBottom:10},children:[(0,n.jsx)(q,{type:"success",children:"ส่วนลด"}),(0,n.jsxs)(q,{type:"success",children:["-",(0,L.xG)(el)]})]}),ec>0&&(0,n.jsxs)(m.Z,{justify:"space-between",style:{marginBottom:10},children:[(0,n.jsx)(q,{type:"secondary",children:"VAT (7%)"}),(0,n.jsx)(q,{children:(0,L.xG)(ec)})]}),(0,n.jsx)(x.Z,{style:{margin:"14px 0",borderColor:"#fce7f3"}}),(0,n.jsxs)(m.Z,{justify:"space-between",align:"middle",children:[(0,n.jsx)(W,{level:5,style:{margin:0,color:"#374151"},children:"ยอดสุทธิ"}),(0,n.jsx)(W,{level:3,style:{color:"#EC4899",margin:0},children:(0,L.xG)(ed)})]})]}),(0,n.jsxs)("div",{style:{display:"block"},className:"delivery-info-card",children:[(0,n.jsxs)("div",{className:"delivery-info-row",children:[(0,n.jsx)("span",{className:"delivery-info-label",children:"ผู้ให้บริการ"}),(0,n.jsx)("span",{className:"delivery-info-value",children:(null===(e=V.delivery)||void 0===e?void 0:e.delivery_name)||"-"})]}),(0,n.jsxs)("div",{className:"delivery-info-row",children:[(0,n.jsx)("span",{className:"delivery-info-label",children:"รหัสออเดอร์ไรเดอร์"}),(0,n.jsx)("span",{className:"delivery-info-value",children:V.delivery_code||"-"})]}),(0,n.jsxs)("div",{className:"delivery-info-row",children:[(0,n.jsx)("span",{className:"delivery-info-label",children:"เลขที่ออเดอร์ POS"}),(0,n.jsx)("span",{className:"delivery-info-value",children:V.order_no})]})]})]}),(0,n.jsx)(y.Z,{xs:24,lg:12,children:(0,n.jsxs)("div",{className:"delivery-rider-section",children:[(0,n.jsx)("div",{className:"delivery-rider-icon-wrapper",children:(0,n.jsx)(g.Z,{className:"delivery-rider-icon"})}),(0,n.jsx)("div",{className:"delivery-rider-title",children:"พร้อมสำหรับการจัดส่ง"}),(0,n.jsxs)("div",{className:"delivery-rider-subtitle",children:["ตรวจสอบความถูกต้องของรายการอาหารและเครื่องดื่ม",(0,n.jsx)("br",{}),"ก่อนส่งมอบให้ไรเดอร์"]}),(0,n.jsxs)("div",{className:"delivery-provider-badge",children:[(0,n.jsx)("span",{className:"delivery-provider-name",children:(null===(t=V.delivery)||void 0===t?void 0:t.delivery_name)||"ไม่ระบุ"}),V.delivery_code&&(0,n.jsx)("span",{className:"delivery-code-badge",children:V.delivery_code})]}),!Q&&(0,n.jsxs)("div",{className:"delivery-warning-card",children:[(0,n.jsx)("div",{className:"delivery-warning-icon",children:(0,n.jsx)(N.Z,{})}),(0,n.jsxs)("div",{className:"delivery-warning-text",children:[(0,n.jsx)("strong",{children:"ไม่พบวิธีการชำระเงิน 'Delivery'"}),(0,n.jsx)("br",{}),"กรุณาเพิ่มวิธีการชำระเงินชื่อ 'Delivery' ในเมนูตั้งค่า เพื่อให้สามารถส่งมอบสินค้าได้"]})]}),(0,n.jsx)(f.ZP,{type:"primary",size:"large",block:!0,className:"delivery-confirm-btn",onClick:ef,disabled:!Q,icon:(0,n.jsx)(S.Z,{}),children:"ส่งมอบสินค้าให้ไรเดอร์"}),(0,n.jsxs)("div",{className:"delivery-info-note",children:[(0,n.jsx)(Z.Z,{style:{color:"#9ca3af"}}),(0,n.jsx)("span",{className:"delivery-info-note-text",children:"เมื่อกดแล้ว ระบบจะบันทึกยอดขายและปิดออเดอร์นี้"})]})]})})]})}),(0,n.jsx)(F.Z,{open:en.open,type:en.type,title:en.title,content:en.content,okText:en.okText,cancelText:en.cancelText,onOk:en.onOk,onCancel:es})]}):(0,n.jsx)(u.Z,{description:"ไม่พบข้อมูลออเดอร์"})}D().locale("th")},60300:function(e,t,r){"use strict";var n=r(57437),a=r(29),s=r.n(a);r(2265);var i=r(39486),o=r(47213),l=r(53743),c=r(50742),d=r(54537),u=r(15516),f=r(8900),m=r(55726),y=r(91619);let{Title:h,Text:p}=i.default;t.Z=e=>{let{open:t,type:r="confirm",title:a,content:i,okText:x="ยืนยัน",cancelText:v="ยกเลิก",onOk:g,onCancel:b,loading:j=!1,icon:w}=e,k=()=>{switch(r){case"danger":return"#ff4d4f";case"warning":return"#faad14";case"success":return"#52c41a";default:return"#1890ff"}},N=k();return(0,n.jsx)(o.ZP,{theme:{components:{Modal:{contentBg:"#ffffff",headerBg:"#ffffff",borderRadiusLG:24},Button:{borderRadius:12,controlHeightLG:48,fontSizeLG:16,fontWeight:600}}},children:(0,n.jsxs)(l.Z,{open:t,onCancel:b,footer:null,centered:!0,width:360,closable:!1,styles:{mask:{backdropFilter:"blur(8px)",background:"rgba(0, 0, 0, 0.25)"}},className:"soft-confirm-modal",children:[(0,n.jsxs)("div",{style:{padding:"32px 24px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},className:"jsx-14a62d28233e1b8c",children:[(0,n.jsx)("div",{style:{marginBottom:20,width:80,height:80,borderRadius:"40%",backgroundColor:"".concat(N,"15"),display:"flex",alignItems:"center",justifyContent:"center",animation:"float 3s ease-in-out infinite"},className:"jsx-14a62d28233e1b8c",children:(()=>{if(w)return w;let e={fontSize:48,color:k()};switch(r){case"danger":return(0,n.jsx)(d.Z,{style:e});case"warning":return(0,n.jsx)(u.Z,{style:e});case"success":return(0,n.jsx)(f.Z,{style:e});case"info":return(0,n.jsx)(m.Z,{style:e});default:return(0,n.jsx)(y.Z,{style:e})}})()}),(0,n.jsx)(h,{level:4,style:{marginBottom:12,fontWeight:700,color:"#1f1f1f"},children:a}),(0,n.jsx)("div",{style:{marginBottom:32,width:"100%"},className:"jsx-14a62d28233e1b8c",children:"string"==typeof i?(0,n.jsx)(p,{type:"secondary",style:{fontSize:16,lineHeight:1.6},children:i}):i}),(0,n.jsxs)("div",{style:{width:"100%",display:"flex",gap:12,flexDirection:"row"},className:"jsx-14a62d28233e1b8c",children:[(0,n.jsx)(c.ZP,{block:!0,size:"large",onClick:b,disabled:j,style:{border:"none",background:"#f5f5f5",color:"#595959",boxShadow:"none"},className:"hover-scale",children:v}),(0,n.jsx)(c.ZP,{block:!0,type:"primary",size:"large",onClick:g,loading:j,style:{background:N,border:"none",boxShadow:"0 8px 20px ".concat(N,"40")},className:"hover-scale",children:x})]})]}),(0,n.jsx)(s(),{id:"14a62d28233e1b8c",children:"@-webkit-keyframes float{0%{-webkit-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-5px);transform:translatey(-5px)}100%{-webkit-transform:translatey(0px);transform:translatey(0px)}}@-moz-keyframes float{0%{-moz-transform:translatey(0px);transform:translatey(0px)}50%{-moz-transform:translatey(-5px);transform:translatey(-5px)}100%{-moz-transform:translatey(0px);transform:translatey(0px)}}@-o-keyframes float{0%{-o-transform:translatey(0px);transform:translatey(0px)}50%{-o-transform:translatey(-5px);transform:translatey(-5px)}100%{-o-transform:translatey(0px);transform:translatey(0px)}}@keyframes float{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-5px);-moz-transform:translatey(-5px);-o-transform:translatey(-5px);transform:translatey(-5px)}100%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}}.hover-scale{-webkit-transition:-webkit-transform.2s cubic-bezier(.34,1.56,.64,1);-moz-transition:-moz-transform.2s cubic-bezier(.34,1.56,.64,1);-o-transition:-o-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-webkit-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-moz-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-o-transform.2s cubic-bezier(.34,1.56,.64,1);transition:transform.2s cubic-bezier(.34,1.56,.64,1)}.hover-scale:active{-webkit-transform:scale(.96);-moz-transform:scale(.96);-ms-transform:scale(.96);-o-transform:scale(.96);transform:scale(.96)}@media(max-width:480px){.soft-confirm-modal .ant-modal-content{-webkit-border-radius:20px!important;-moz-border-radius:20px!important;border-radius:20px!important}}.soft-confirm-modal .ant-modal-content{-webkit-box-shadow:0 20px 50px rgba(0,0,0,.1)!important;-moz-box-shadow:0 20px 50px rgba(0,0,0,.1)!important;box-shadow:0 20px 50px rgba(0,0,0,.1)!important;padding:0!important}"})]})})}},63836:function(e,t,r){"use strict";r.d(t,{E:function(){return l}});var n=r(2913),a=r(71567),s=r(98170);let i=a.q.POS.PAYMENT_METHODS,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},l={getAll:async(e,t)=>{let r=(0,n.b)("GET",i),a=new URLSearchParams(t||"");a.has("page")||a.set("page","1"),a.has("limit")||a.set("limit","200");let l=a.toString();l&&(r+="?".concat(l));let c=o(e,""),d=await fetch(r,{cache:"no-store",headers:c,credentials:"include"});if(!d.ok){var u;let e=await d.json().catch(()=>({}));throw Error((null==e?void 0:null===(u=e.error)||void 0===u?void 0:u.message)||e.error||e.message||"Failed to fetch payment methods")}return(0,s.XO)(await d.json())},getById:async(e,t)=>{let r=(0,n.b)("GET","".concat(i,"/").concat(e)),a=o(t,""),l=await fetch(r,{cache:"no-store",headers:a,credentials:"include"});if(!l.ok){var c;let e=await l.json().catch(()=>({}));throw Error((null==e?void 0:null===(c=e.error)||void 0===c?void 0:c.message)||e.error||e.message||"Failed to fetch payment method")}return(0,s.hH)(await l.json())},getByName:async(e,t)=>{let r=(0,n.b)("GET","".concat(i,"/getByName/").concat(e)),a=o(t,""),l=await fetch(r,{cache:"no-store",headers:a,credentials:"include"});if(!l.ok){var c;let e=await l.json().catch(()=>({}));throw Error((null==e?void 0:null===(c=e.error)||void 0===c?void 0:c.message)||e.error||e.message||"Failed to fetch payment method")}return(0,s.hH)(await l.json())},create:async(e,t,r)=>{let a=(0,n.b)("POST","".concat(i)),l=o(t);r&&(l["X-CSRF-Token"]=r);let c=await fetch(a,{method:"POST",headers:l,credentials:"include",body:JSON.stringify(e)});if(!c.ok){var d;let e=await c.json().catch(()=>({}));throw Error((null==e?void 0:null===(d=e.error)||void 0===d?void 0:d.message)||e.error||e.message||"Failed to create payment method")}return(0,s.hH)(await c.json())},update:async(e,t,r,a)=>{let l=(0,n.b)("PUT","".concat(i,"/").concat(e)),c=o(r);a&&(c["X-CSRF-Token"]=a);let d=await fetch(l,{method:"PUT",headers:c,credentials:"include",body:JSON.stringify(t)});if(!d.ok){var u;let e=await d.json().catch(()=>({}));throw Error((null==e?void 0:null===(u=e.error)||void 0===u?void 0:u.message)||e.error||e.message||"Failed to update payment method")}return(0,s.hH)(await d.json())},delete:async(e,t,r)=>{let a=(0,n.b)("DELETE","".concat(i,"/").concat(e)),s=o(t,"");r&&(s["X-CSRF-Token"]=r);let l=await fetch(a,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){var c;let e=await l.json().catch(()=>({}));throw Error((null==e?void 0:null===(c=e.error)||void 0===c?void 0:c.message)||e.error||e.message||"Failed to delete payment method")}}}},54528:function(e,t,r){"use strict";r.d(t,{U:function(){return o}});var n=r(2913),a=r(98170);let s="/pos/payments",i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},o={getAll:async e=>{let t=(0,n.b)("GET",s),r=i(e,""),o=await fetch(t,{cache:"no-store",headers:r});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error((0,a.i_)(e,"ไม่สามารถดึงข้อมูลการชำระเงินได้"))}return(0,a.hH)(await o.json())},getById:async(e,t)=>{let r=(0,n.b)("GET","".concat(s,"/").concat(e)),o=i(t,""),l=await fetch(r,{cache:"no-store",headers:o});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,a.i_)(e,"ไม่สามารถดึงข้อมูลการชำระเงินได้"))}return(0,a.hH)(await l.json())},create:async(e,t,r)=>{let o=(0,n.b)("POST","".concat(s)),l=i(t);r&&(l["X-CSRF-Token"]=r);let c=await fetch(o,{method:"POST",headers:l,credentials:"include",body:JSON.stringify(e)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error((0,a.i_)(e,"ไม่สามารถสร้างรายการชำระเงินได้"))}return(0,a.hH)(await c.json())},update:async(e,t,r,o)=>{let l=(0,n.b)("PUT","".concat(s,"/").concat(e)),c=i(r);o&&(c["X-CSRF-Token"]=o);let d=await fetch(l,{method:"PUT",headers:c,credentials:"include",body:JSON.stringify(t)});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error((0,a.i_)(e,"ไม่สามารถแก้ไขรายการชำระเงินได้"))}return(0,a.hH)(await d.json())},delete:async(e,t,r)=>{let o=(0,n.b)("DELETE","".concat(s,"/").concat(e)),l=i(t,"");r&&(l["X-CSRF-Token"]=r);let c=await fetch(o,{method:"DELETE",headers:l,credentials:"include"});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error((0,a.i_)(e,"ไม่สามารถลบรายการชำระเงินได้"))}}}},94532:function(e,t,r){"use strict";var n,a;r.d(t,{b:function(){return n}}),(a=n||(n={})).Pending="Pending",a.Success="Success",a.Failed="Failed"},7806:function(e,t,r){"use strict";r.d(t,{S:function(){return n}});let n=e=>{if(!(null==e?void 0:e.length))return[];let t=new Map;for(let u of e){var r,n,a,s,i,o,l,c,d;let e=(null===(r=u.details)||void 0===r?void 0:r.length)?JSON.stringify(u.details.map(e=>({n:e.detail_name,p:e.extra_price})).sort((e,t)=>e.n.localeCompare(t.n))):"[]",f=(null!==(a=u.notes)&&void 0!==a?a:"").trim().toLowerCase(),m=String(null!==(s=u.status)&&void 0!==s?s:""),y=null!==(o=null!==(i=null===(n=u.product)||void 0===n?void 0:n.id)&&void 0!==i?i:u.product_id)&&void 0!==o?o:"unknown",h="".concat(y,"|").concat(e,"|").concat(f,"|").concat(m),p=t.get(h);if(p){p.quantity+=Number(u.quantity),p.total_price+=Number(null!==(l=u.total_price)&&void 0!==l?l:0),p.originalItems.push(u);continue}let x={...u,id:String(null!==(c=null==u?void 0:u.id)&&void 0!==c?c:h),quantity:Number(u.quantity),total_price:Number(null!==(d=u.total_price)&&void 0!==d?d:0),originalItems:[u]};t.set(h,x)}return Array.from(t.values())}},49747:function(e,t,r){"use strict";r.d(t,{Od:function(){return s},T_:function(){return c},VX:function(){return i},cc:function(){return a},hs:function(){return n},si:function(){return o},wv:function(){return l}});let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return{subtotal:0,discount:0,vat:0,total:0,change:0};let r=Number(e.sub_total||0),n=Number(e.discount_amount||0),a=Number(e.vat||0),s=Number(e.total_amount||0);return{subtotal:r,discount:n,vat:a,total:s,change:Math.max(0,t-s)}},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.toLowerCase(),n=t.toLowerCase();return r.includes("cash")||n.includes("สด")},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.toLowerCase(),n=t.toLowerCase();return r.includes("qr")||r.includes("prompt")||n.includes("qr")||n.includes("พร้อมเพย์")},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!s(e,t)||!!(null==r?void 0:r.promptpay_number)},o=[20,50,100,500,1e3],l=()=>"/pos/channels",c=e=>"/pos/orders/".concat(e)},97235:function(e,t,r){"use strict";r.d(t,{P:function(){return o}});var n=r(5447);let a=null,s=0,i=null;async function o(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&a&&t-s<6e5?a:(i||(i=n.O.getCsrfToken().then(e=>(a=e||"",s=Date.now(),a)).finally(()=>{i=null})),i)}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,3248,2401,9,19,4221,1652,8090,8627,9385,4191,6320,2971,2117,1744],function(){return e(e.s=16923)}),_N_E=e.O()}]);