(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3368,3490],{48492:function(e,t,n){Promise.resolve().then(n.bind(n,36699))},36699:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return et}});var r=n(57437),o=n(2265),a=n(99376),i=n(82646),s=n(34029),l=n(85180),c=n(50742),d=n(80009),u=n(47451),h=n(69410),f=n(96931),p=n(91652),m=n(23496),y=n(93834),g=n(51653),x=n(33477),b=n(17588),j=n(13377),v=n(62376),w=n(62670),S=n(86955),k=n(99458),T=n(55322),E=n(13429),C=n(35398),_=n(14621),P=n.n(_),O=n(53286),R=n(63836),A=n(2913);let Z=n(71567).q.POS.DISCOUNTS,B=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},D={getAll:async(e,t)=>{let n=(0,A.b)("GET",Z),r=new URLSearchParams(t||"");r.toString()&&(n+="?".concat(r.toString()));let o=B(e,""),a=await fetch(n,{cache:"no-store",headers:o,credentials:"include"});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลส่วนลดได้")}return a.json()}};var I=n(54528),N=n(66290),L=n(19135),z=n(97235),U=n(32446),F=n(34962),G=n(69477),q=n(94532),M=n(69602),W=n(49747),H=n(71096),X=n.n(H);n(6729);var J=n(61414),Y=n(60300),K=n(3369),Q=n(24675),V=n(67697);let{Title:$,Text:ee}=i.default;function et(){var e,t,n;let i=(0,a.useRouter)(),_=(0,a.useParams)(),[A,Z]=s.ZP.useMessage(),B=Array.isArray(null==_?void 0:_.paymentId)?_.paymentId[0]:null==_?void 0:_.paymentId,[H,X]=(0,o.useState)(null),[et,en]=(0,o.useState)(!0),[er,eo]=(0,o.useState)([]),[ea,ei]=(0,o.useState)([]),[es,el]=(0,o.useState)(null),[ec,ed]=(0,o.useState)(null),[eu,eh]=(0,o.useState)(0),[ef,ep]=(0,o.useState)(null),{showLoading:em,hideLoading:ey}=(0,K.x)(),{socket:eg}=(0,Q.s)(),[ex,eb]=(0,o.useState)({open:!1,type:"confirm",title:"",content:"",onOk:()=>{}}),ej=()=>eb(e=>({...e,open:!1})),ev=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(B)try{e||(en(!0),em("กำลังโหลดข้อมูลการชำระเงิน..."));let t=await L.n.getProfile().catch(()=>null),[n,r,o]=await Promise.all([O.x.getById(B),R.E.getAll(),D.getAll()]);if([U.i.Paid,U.i.Cancelled].includes(n.status)){i.push("/pos/channels");return}X(n);let a=(r.data||[]).filter(e=>n.order_type===U.m.Delivery||"Delivery"!==e.payment_method_name);eo(a),ei(o),el(t),n.discount&&ep(n.discount),n&&eh(Number(n.total_amount))}catch(t){e||A.error("ไม่สามารถโหลดข้อมูลการชำระเงินได้")}finally{e||(en(!1),ey())}},[A,B,i,em,ey]);(0,o.useEffect)(()=>{B&&ev(!1)},[ev,B]),(0,V.D)({socket:eg,events:["orders:update","orders:delete","payments:create","payments:update"],onRefresh:()=>{B&&ev(!0)},intervalMs:15e3,enabled:!!B});let{subtotal:ew,discount:eS,vat:ek,total:eT,change:eE}=(0,W.hs)(H,eu),eC=async e=>{if(H)try{em("กำลังอัปเดตส่วนลด...");let t=await (0,z.P)(),n=await O.x.update(H.id,{discount_id:e||null},void 0,t);if(X(n),e){let t=ea.find(t=>t.id===e);t&&(ep(t),A.success('ใช้ส่วนลด "'.concat(t.display_name,'" เรียบร้อย')))}else ep(null),A.info("ยกเลิกการใช้ส่วนลด");eh(Number(n.total_amount))}catch(e){A.error("ไม่สามารถบันทึกส่วนลดได้")}finally{ey()}},e_=async()=>{if(!ec){A.error("กรุณาเลือกวิธีการชำระเงิน");return}if(eu<eT){A.error("ยอดเงินที่รับต้องมากกว่าหรือเท่ากับยอดชำระ");return}let e=er.find(e=>e.id===ec),t=(null==e?void 0:e.display_name)||"ไม่ระบุ";eb({open:!0,type:"success",title:"ยืนยันการชำระเงิน",content:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsxs)("div",{style:{fontSize:16,marginBottom:8},children:["วิธีการชำระเงิน: ",(0,r.jsx)(ee,{strong:!0,children:t})]}),(0,r.jsxs)("div",{style:{fontSize:24,fontWeight:700,color:M.U.primary},children:["ยอดสุทธิ ",(0,J.xG)(eT)]}),eE>0&&(0,r.jsxs)("div",{style:{color:M.U.success,fontSize:18,marginTop:4},children:["เงินทอน ",(0,J.xG)(eE)]})]}),okText:"ยืนยัน",cancelText:"ยกเลิก",onOk:async()=>{try{em("กำลังดำเนินการชำระเงิน..."),ej();let e=await (0,z.P)(),t={order_id:H.id,payment_method_id:ec,amount:eT,amount_received:eu,change_amount:eE,status:q.b.Success};await I.U.create(t,void 0,e),await O.x.updateStatus(H.id,U.i.Paid,e),H.table_id&&await N.$.update(H.table_id,{status:F.c.Available},void 0,e),A.success("ชำระเงินเรียบร้อย"),i.push("/pos/dashboard/".concat(H.id))}catch(e){A.error("การชำระเงินล้มเหลว")}finally{ey()}}})},eP=async()=>{H&&eb({open:!0,type:"warning",title:"ย้อนกลับไปแก้ไขออเดอร์?",content:'สถานะออเดอร์จะถูกเปลี่ยนกลับเป็น "กำลังดำเนินการ" เพื่อให้คุณสามารถแก้ไขรายการอาหารได้ คุณแน่ใจหรือไม่?',okText:"ตกลง",cancelText:"ยกเลิก",onOk:async()=>{try{var e;em("กำลังดำเนินการ..."),ej();let t=await (0,z.P)(),n=(null===(e=H.items)||void 0===e?void 0:e.filter(e=>e.status!==U.i.Cancelled))||[];await Promise.all(n.map(e=>O.x.updateItemStatus(e.id,U.i.Served,void 0,t))),await O.x.updateStatus(H.id,U.i.Pending,t),A.success("ย้อนกลับไปแก้ไขออเดอร์เรียบร้อย"),i.push((0,W.T_)(H.id))}catch(e){A.error("ไม่สามารถเปลี่ยนสถานะออเดอร์ได้")}finally{ey()}}})};return et&&!H?null:H?(0,r.jsxs)("div",{style:M.q.container,children:[Z,(0,r.jsx)("div",{style:M.q.heroSection,children:(0,r.jsx)("div",{style:M.q.contentWrapper,children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:16},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16},children:[(0,r.jsx)(c.ZP,{type:"text",icon:(0,r.jsx)(b.Z,{style:{fontSize:20}}),style:{color:"#fff",padding:0,height:"auto",marginTop:4},onClick:()=>{(null==H?void 0:H.order_type)===U.m.DineIn?i.push("/pos/channels/dine-in"):(null==H?void 0:H.order_type)===U.m.TakeAway?i.push("/pos/channels/takeaway"):(null==H?void 0:H.order_type)===U.m.Delivery?i.push("/pos/channels/delivery"):i.back()}}),(0,r.jsxs)("div",{children:[(0,r.jsx)($,{level:3,style:M.q.pageTitle,children:"ชำระเงิน"}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8,flexWrap:"wrap"},children:[(0,r.jsxs)(d.Z,{color:"blue",style:{borderRadius:4,border:"none"},children:[(0,J.mz)(H.order_type)," ",(0,J.jN)(H)]}),(0,r.jsx)(d.Z,{color:(0,J.OY)(H.status),style:{borderRadius:4,border:"none"},children:(0,J.d7)(H.status)}),(0,r.jsxs)(ee,{style:{color:"rgba(255,255,255,0.85)",fontSize:13},children:["#",H.order_no]})]})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,r.jsx)(c.ZP,{icon:(0,r.jsx)(j.Z,{}),onClick:eP,style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff"},children:"แก้ไขออเดอร์"}),(0,r.jsx)(c.ZP,{danger:!0,onClick:()=>{H&&eb({open:!0,type:"danger",title:"ยืนยันการยกเลิกออเดอร์?",content:"การดำเนินการนี้จะยกเลิกสินค้าทุกรายการและคืนสถานะโต๊ะ (หากมี) คุณแน่ใจหรือไม่?",okText:"ยืนยันการยกเลิก",cancelText:"ยกเลิก",onOk:async()=>{try{var e;em("กำลังดำเนินการยกเลิก..."),ej();let t=await (0,z.P)(),n=(null===(e=H.items)||void 0===e?void 0:e.filter(e=>e.status!==U.i.Cancelled))||[];await Promise.all(n.map(e=>O.x.updateItemStatus(e.id,U.i.Cancelled,void 0,t))),await O.x.updateStatus(H.id,U.i.Cancelled,t),H.table_id&&await N.$.update(H.table_id,{status:F.c.Available},void 0,t),A.success("ยกเลิกออเดอร์เรียบร้อย"),i.push((0,W.wv)())}catch(e){A.error("ไม่สามารถยกเลิกออเดอร์ได้")}finally{ey()}}})},children:"ยกเลิกออเดอร์"})]})]})})}),(0,r.jsx)("div",{style:{...M.q.contentWrapper,marginTop:-30,paddingBottom:40},children:(0,r.jsxs)(u.Z,{gutter:[24,24],children:[(0,r.jsx)(h.Z,{xs:24,lg:14,children:(0,r.jsxs)(f.Z,{style:M.q.card,bodyStyle:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,r.jsx)($,{level:4,style:{marginBottom:16,marginTop:0},children:"รายการสรุป (Order Summary)"}),(0,r.jsx)("div",{style:{flex:1,overflowY:"auto",paddingRight:8,minHeight:300,maxHeight:500},children:null===(e=H.items)||void 0===e?void 0:e.filter(e=>e.status!==U.i.Cancelled).map((e,t)=>{var n,o;return(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16,paddingBottom:16,borderBottom:"1px solid ".concat(M.U.borderLight)},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:12,flex:1,minWidth:0},children:[(0,r.jsx)(p.Z,{shape:"square",size:50,src:null===(n=e.product)||void 0===n?void 0:n.img_url,icon:(0,r.jsx)(v.Z,{}),style:{backgroundColor:M.U.backgroundSecondary,flexShrink:0,borderRadius:8}}),(0,r.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,r.jsx)(ee,{strong:!0,style:{display:"block"},ellipsis:!0,children:null===(o=e.product)||void 0===o?void 0:o.display_name}),(0,r.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,r.jsx)(ee,{type:"secondary",style:{fontSize:13},children:(0,J.xG)(e.price)}),(0,r.jsxs)(d.Z,{style:{margin:0,fontSize:11},children:["x",e.quantity]})]}),e.notes&&(0,r.jsxs)(ee,{style:{display:"block",fontSize:12,fontStyle:"italic",color:"#ef4444",marginTop:2},children:["* ",e.notes]}),e.details&&e.details.length>0&&(0,r.jsx)("div",{style:{marginTop:2,display:"flex",flexDirection:"column",gap:0},children:e.details.map((e,t)=>(0,r.jsx)("div",{children:(0,r.jsxs)(ee,{style:{color:"#10b981",fontSize:12},children:["+ ",e.detail_name," ",Number(e.extra_price)>0?"(+".concat(Number(e.extra_price),")"):""]})},t))})]})]}),(0,r.jsx)(ee,{strong:!0,children:(0,J.xG)(Number(e.total_price||Number(e.price)*e.quantity))})]},t)})}),(0,r.jsxs)("div",{style:M.q.summaryBox,children:[(0,r.jsxs)(u.Z,{justify:"space-between",style:{marginBottom:8},children:[(0,r.jsx)(ee,{type:"secondary",children:"ยอดรวม (Subtotal)"}),(0,r.jsx)(ee,{children:(0,J.xG)(ew)})]}),eS>0&&(0,r.jsxs)(u.Z,{justify:"space-between",style:{marginBottom:8,color:M.U.success},children:[(0,r.jsx)(ee,{type:"success",children:"ส่วนลด (Discount)"}),(0,r.jsxs)(ee,{type:"success",children:["-",(0,J.xG)(eS)]})]}),ek>0&&(0,r.jsxs)(u.Z,{justify:"space-between",style:{marginBottom:8},children:[(0,r.jsx)(ee,{type:"secondary",children:"VAT (7%)"}),(0,r.jsx)(ee,{children:(0,J.xG)(ek)})]}),(0,r.jsx)(m.Z,{style:{margin:"12px 0"}}),(0,r.jsxs)(u.Z,{justify:"space-between",align:"middle",children:[(0,r.jsx)($,{level:4,style:{margin:0},children:"ยอดสุทธิ (Total)"}),(0,r.jsx)($,{level:3,style:{color:M.U.primary,margin:0},children:(0,J.xG)(eT)})]})]})]})}),(0,r.jsxs)(h.Z,{xs:24,lg:10,children:[(0,r.jsxs)(f.Z,{style:{...M.q.card,marginBottom:12},bodyStyle:{padding:"12px 16px"},children:[(0,r.jsx)(ee,{strong:!0,style:{display:"block",marginBottom:8,fontSize:13},children:"ส่วนลด (Discount)"}),(0,r.jsx)(y.default,{placeholder:"เลือกส่วนลด (Select Discount)",style:{width:"100%"},allowClear:!0,size:"large",value:ef?ef.id:void 0,onChange:eC,children:ea.filter(e=>e.is_active).map(e=>(0,r.jsxs)(y.default.Option,{value:e.id,children:[e.display_name," (",e.discount_type===G.L.Percentage?"".concat(e.discount_amount,"%"):"-".concat(e.discount_amount,"฿"),")"]},e.id))})]}),(0,r.jsx)(f.Z,{style:M.q.card,children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,r.jsx)(ee,{strong:!0,style:{fontSize:16},children:"วิธีการชำระเงิน (Payment Method)"}),0===er.length?(0,r.jsx)(g.Z,{message:"ยังไม่มีวิธีการชำระเงิน",description:"กรุณาเพิ่มวิธีการชำระเงินในเมนูตั้งค่าก่อนทำรายการ",type:"warning",showIcon:!0,style:{marginTop:16}}):(0,r.jsx)(u.Z,{gutter:[12,12],children:er.map(e=>{let t=ec===e.id;return(0,r.jsx)(h.Z,{span:12,children:(0,r.jsxs)("div",{onClick:()=>{ed(e.id),(0,W.Od)(e.payment_method_name,e.display_name)?eh(eT):(0,W.cc)(e.payment_method_name,e.display_name)?eh(0):eh(eT)},style:{...M.q.methodCard,...t?M.q.methodCardSelected:{}},children:[(0,r.jsx)("div",{style:{fontSize:24,marginBottom:8,color:t?M.U.primary:"#595959"},children:(0,W.cc)(e.payment_method_name,e.display_name)?(0,r.jsx)(w.Z,{}):(0,W.Od)(e.payment_method_name,e.display_name)?(0,r.jsx)(S.Z,{}):(0,r.jsx)(k.Z,{})}),(0,r.jsx)(ee,{strong:!0,style:{color:t?M.U.primary:void 0},children:e.display_name})]})},e.id)})}),ec&&(0,r.jsxs)("div",{style:{animation:"fadeIn 0.5s"},children:[(0,r.jsx)(m.Z,{style:{margin:"16px 0"}}),(()=>{let e=er.find(e=>e.id===ec),t=(0,W.cc)(null==e?void 0:e.payment_method_name,null==e?void 0:e.display_name);if((0,W.Od)(null==e?void 0:e.payment_method_name,null==e?void 0:e.display_name)){if(!(null==es?void 0:es.promptpay_number))return(0,r.jsxs)("div",{style:{textAlign:"center",padding:"16px 0"},children:[(0,r.jsx)("div",{style:{color:"#ff4d4f",marginBottom:12,fontWeight:500},children:"กรุณาตั้งค่าเบอร์ PromptPay ในระบบก่อน (Shop Profile)"}),(0,r.jsx)(c.ZP,{type:"primary",danger:!0,ghost:!0,icon:(0,r.jsx)(T.Z,{}),onClick:()=>i.push("/pos/settings"),children:"ไปตั้งค่าที่ Shop Profile"})]});let e=P()(es.promptpay_number,{amount:eT});return(0,r.jsxs)("div",{style:M.q.qrArea,children:[(0,r.jsx)(ee,{style:{display:"block",marginBottom:16,fontSize:16},children:"สแกน QR เพื่อชำระเงิน"}),(0,r.jsx)("div",{style:{background:"white",padding:12,display:"inline-block",borderRadius:8},children:(0,r.jsx)(C.t,{value:e,size:180,level:"L",includeMargin:!0})}),(0,r.jsx)("div",{style:{marginTop:16},children:(0,r.jsx)($,{level:3,style:{color:M.U.primary,margin:0},children:(0,J.xG)(eT)})}),(0,r.jsxs)(ee,{type:"secondary",style:{display:"block",marginTop:8},children:[es.promptpay_number,es.promptpay_name&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),"(",es.promptpay_name,")"]})]})]})}return t?(0,r.jsxs)("div",{style:M.q.inputArea,children:[(0,r.jsx)(ee,{style:{display:"block",marginBottom:8},children:"รับเงินมา (Received)"}),(0,r.jsx)(x.Z,{style:{width:"100%",fontSize:24,padding:8,borderRadius:8,marginBottom:12},size:"large",min:0,value:eu,onChange:e=>eh(e||0),formatter:e=>"฿ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>Number(e.replace(/฿\s?|(,*)/g,"")),onFocus:e=>e.target.select(),autoFocus:!0,controls:!1,inputMode:"decimal",onKeyDown:e=>{["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","Escape",".",",","0","1","2","3","4","5","6","7","8","9"].includes(e.key)||e.ctrlKey||e.metaKey||e.preventDefault()}}),(0,r.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginBottom:16},children:[(0,r.jsx)(c.ZP,{onClick:()=>eh(eT),type:"primary",ghost:!0,size:"small",children:"พอดี"}),W.si.map(e=>(0,r.jsxs)(c.ZP,{onClick:()=>eh(e),size:"small",children:["฿",e]},e)),(0,r.jsx)(c.ZP,{icon:(0,r.jsx)(E.Z,{}),onClick:()=>eh(0),danger:!0,size:"small"})]}),(0,r.jsx)(m.Z,{style:{margin:"12px 0"}}),(0,r.jsxs)(u.Z,{justify:"space-between",align:"middle",style:{background:eE>=0?"#f6ffed":"#fff1f0",padding:12,borderRadius:8,border:"1px solid ".concat(eE>=0?"#b7eb8f":"#ffa39e")},children:[(0,r.jsx)(ee,{style:{fontSize:16},children:"เงินทอน (Change)"}),(0,r.jsx)(ee,{strong:!0,style:{fontSize:24,color:eE>=0?M.U.success:M.U.cancelled},children:(0,J.xG)(Math.max(0,eE))})]})]}):(0,r.jsxs)("div",{style:{textAlign:"center",padding:20},children:[(0,r.jsx)(ee,{type:"secondary",children:"ตรวจสอบยอดเงินและชำระผ่านช่องทางที่เลือก"}),(0,r.jsx)("div",{style:{marginTop:16},children:(0,r.jsx)(x.Z,{style:{width:"100%",fontSize:24},value:eu,onChange:e=>eh(e||0),formatter:e=>"฿ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>Number(e.replace(/฿\s?|(,*)/g,"")),controls:!1,inputMode:"decimal",onKeyDown:e=>{["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","Escape",".",",","0","1","2","3","4","5","6","7","8","9"].includes(e.key)||e.ctrlKey||e.metaKey||e.preventDefault()}})})]})})()]}),(0,r.jsxs)(c.ZP,{type:"primary",size:"large",block:!0,style:{height:56,fontSize:18,marginTop:8,background:M.U.success,border:"1px solid ".concat(M.U.success),fontWeight:700},onClick:e_,disabled:!ec||eu<eT||!(0,W.VX)(null===(t=er.find(e=>e.id===ec))||void 0===t?void 0:t.payment_method_name,null===(n=er.find(e=>e.id===ec))||void 0===n?void 0:n.display_name,es),children:["ยืนยันการชำระเงิน",eu>=eT&&" (".concat((0,J.xG)(eT),")")]})]})})]})]})}),(0,r.jsx)(Y.Z,{open:ex.open,type:ex.type,title:ex.title,content:ex.content,okText:ex.okText,cancelText:ex.cancelText,onOk:ex.onOk,onCancel:ej})]}):(0,r.jsx)(l.Z,{description:"ไม่พบข้อมูลออเดอร์"})}X().locale("th")},60300:function(e,t,n){"use strict";var r=n(57437),o=n(29),a=n.n(o);n(2265);var i=n(82646),s=n(53743),l=n(50742),c=n(29271),d=n(35291),u=n(83669),h=n(15424),f=n(67187);let{Title:p,Text:m}=i.default;t.Z=e=>{let{open:t,type:n="confirm",title:o,content:i,okText:y="ยืนยัน",cancelText:g="ยกเลิก",onOk:x,onCancel:b,loading:j=!1,icon:v}=e,w=()=>{switch(n){case"danger":return"#ef4444";case"warning":return"#f59e0b";case"success":return"#10b981";default:return"#3b82f6"}},S=w();return(0,r.jsxs)(s.Z,{open:t,onCancel:b,footer:null,centered:!0,width:400,closable:!1,styles:{body:{padding:"32px 24px"},mask:{backdropFilter:"blur(4px)",backgroundColor:"rgba(0,0,0,0.45)"}},className:"modern-confirm-modal",children:[(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},className:"jsx-a93d1526d5312985",children:[(0,r.jsx)("div",{style:{marginBottom:20,padding:20,borderRadius:"50%",backgroundColor:"".concat(S,"10"),display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-a93d1526d5312985",children:(()=>{if(v)return v;let e={fontSize:42,color:w()};switch(n){case"danger":return(0,r.jsx)(c.Z,{style:e});case"warning":return(0,r.jsx)(d.Z,{style:e});case"success":return(0,r.jsx)(u.Z,{style:e});case"info":return(0,r.jsx)(h.Z,{style:e});default:return(0,r.jsx)(f.Z,{style:e})}})()}),(0,r.jsx)(p,{level:4,style:{marginBottom:12,fontWeight:700},children:o}),(0,r.jsx)("div",{style:{marginBottom:32},className:"jsx-a93d1526d5312985",children:"string"==typeof i?(0,r.jsx)(m,{type:"secondary",style:{fontSize:15},children:i}):i}),(0,r.jsxs)("div",{style:{width:"100%",display:"flex",gap:12},className:"jsx-a93d1526d5312985",children:[(0,r.jsx)(l.ZP,{block:!0,size:"large",onClick:b,disabled:j,style:{borderRadius:12,height:48,fontWeight:600,border:"1px solid #e2e8f0"},children:g}),(0,r.jsx)(l.ZP,{block:!0,type:"primary",size:"large",onClick:x,loading:j,style:{borderRadius:12,height:48,fontWeight:600,background:S,border:"1px solid ".concat(S),boxShadow:"0 4px 12px ".concat(S,"40")},children:y})]})]}),(0,r.jsx)(a(),{id:"a93d1526d5312985",children:".modern-confirm-modal .ant-modal-content{-webkit-border-radius:20px!important;-moz-border-radius:20px!important;border-radius:20px!important;-webkit-box-shadow:0 10px 30px rgba(0,0,0,.15)!important;-moz-box-shadow:0 10px 30px rgba(0,0,0,.15)!important;box-shadow:0 10px 30px rgba(0,0,0,.15)!important;overflow:hidden}"})]})}},71567:function(e,t,n){"use strict";n.d(t,{q:function(){return o},v:function(){return r}});let r="/api",o={AUTH:{LOGIN:"/auth/login",ME:"/auth/me",CSRF:"/csrf"},POS:{PRODUCTS:"/pos/products",ORDERS:"/pos/orders",TABLES:"/pos/tables",DISCOUNTS:"/pos/discounts",DELIVERY:"/pos/delivery",PAYMENT_METHODS:"/pos/paymentMethod",PAYMENTS:"/pos/payments",CATEGORY:"/pos/category",SHIFTS:{BASE:"/pos/shifts",CURRENT:"/pos/shifts/current",OPEN:"/pos/shifts/open",CLOSE:"/pos/shifts/close"},DASHBOARD:{SALES:"/pos/dashboard/sales",TOP_ITEMS:"/pos/dashboard/top-items"},CHANNELS:{STATS:"/pos/orders/stats"},SHOP_PROFILE:"/pos/shopProfile",SALES_ORDER_ITEMS:"/pos/salesOrderItem",SALES_ORDER_DETAILS:"/pos/salesOrderDetail",PRODUCTS_UNIT:"/pos/productsUnit",PAYMENT_DETAILS:"/pos/paymentDetails",BRANCH:"/branches"}}},14362:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return u},a:function(){return h}});var r=n(57437),o=n(2265),a=n(99376),i=n(5447),s=n(84859),l=n(48651),c=n(3369);let d=(0,o.createContext)(void 0),u=e=>{let{children:t}=e,[n,u]=(0,o.useState)(null),[h,f]=(0,o.useState)(!0),p=(0,a.useRouter)(),m=(0,a.usePathname)(),y=async()=>{try{let e="";e=localStorage.getItem("token_ws")||"";let t=await i.O.getMe(e);u(t)}catch(e){u(null)}finally{f(!1)}};(0,o.useEffect)(()=>{y()},[]);let{showLoading:g,hideLoading:x}=(0,c.x)();(0,o.useEffect)(()=>{h||n||"/login"===m||p.push("/login")},[n,h,m,p]);let b=async e=>{try{g("กำลังเข้าสู่ระบบ...");let t=await i.O.getCsrfToken(),{token:n,...r}=await i.O.login(e,t);n&&localStorage.setItem("token_ws",n),u(r),p.push("/")}catch(e){throw e}finally{x()}},j=async()=>{try{g("กำลังออกจากระบบ...");let e="";e=localStorage.getItem("token_ws")||"",await i.O.logout(e),localStorage.removeItem("token_ws"),s.x.clearQueue(),u(null),p.push("/login")}catch(e){console.error("Logout error:",e)}finally{x()}};return h?(0,r.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-white",children:(0,r.jsx)(l.Z,{size:"large"})}):n||"/login"===m?(0,r.jsx)(d.Provider,{value:{user:n,loading:h,login:b,logout:j,checkAuth:y},children:t}):null},h=()=>{let e=(0,o.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},46252:function(e,t,n){"use strict";n.d(t,{J:function(){return s},SocketProvider:function(){return l}});var r=n(57437),o=n(2265),a=n(68680),i=n(14362);let s=(0,o.createContext)({socket:null,isConnected:!1}),l=e=>{let{children:t}=e,[n,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(!1),{user:u}=(0,i.a)();return(0,o.useEffect)(()=>{if(!u){n&&(n.disconnect(),l(null),d(!1));return}let e=localStorage.getItem("token_ws"),t=(0,a.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:e?{token:e}:void 0});return t.on("connect",()=>{console.log("Socket Connected:",t.id),d(!0)}),t.on("disconnect",()=>{console.log("Socket Disconnected"),d(!1)}),l(t),()=>{t.disconnect()}},[u]),(0,r.jsx)(s.Provider,{value:{socket:n,isConnected:c},children:t})}},3369:function(e,t,n){"use strict";n.d(t,{GlobalLoadingProvider:function(){return l},O:function(){return d},x:function(){return c}});var r=n(57437),o=n(2265),a=n(48651);let i=(0,o.createContext)(void 0),s=(0,o.createContext)(void 0),l=e=>{let{children:t}=e,[n,l]=(0,o.useState)({}),[c,d]=(0,o.useState)(void 0),u=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";l(e=>({...e,[t]:(e[t]||0)+1})),e&&d(e)},[]),h=(0,o.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";l(t=>{if(!t[e])return t;let n={...t};return n[e]-=1,n[e]<=0&&delete n[e],n})},[]),f=(0,o.useCallback)(()=>{l({}),d(void 0)},[]),p=Object.keys(n).length>0,m=(0,o.useMemo)(()=>({isLoading:p,loadingMessage:c}),[p,c]),y=(0,o.useMemo)(()=>({showLoading:u,hideLoading:h,resetLoading:f}),[u,h,f]);return(0,r.jsx)(s.Provider,{value:y,children:(0,r.jsxs)(i.Provider,{value:m,children:[t,p&&(0,r.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center pointer-events-auto bg-black/10 backdrop-blur-[1px]",children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,background:"rgba(255, 255, 255, 0.9)",padding:"20px 40px",borderRadius:12,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[(0,r.jsx)(a.Z,{size:"large"}),c&&(0,r.jsx)("div",{style:{fontSize:14,color:"#1f1f1f",fontWeight:500},children:c})]})})]})})};function c(){let e=(0,o.useContext)(i),t=(0,o.useContext)(s);if(!e||!t)throw Error("useGlobalLoading must be used within a GlobalLoadingProvider");return(0,o.useMemo)(()=>({...e,...t}),[e,t])}function d(){let e=(0,o.useContext)(s);if(!e)throw Error("useGlobalLoadingDispatch must be used within a GlobalLoadingProvider");return e}},24675:function(e,t,n){"use strict";n.d(t,{s:function(){return a}});var r=n(2265),o=n(46252);let a=()=>(0,r.useContext)(o.J)},2913:function(e,t,n){"use strict";function r(e,t){return({GET:"".concat(o.API_BASE_URL).concat(t),POST:"".concat(o.API_BASE_URL).concat(t),PUT:"".concat(o.API_BASE_URL).concat(t),DELETE:"".concat(o.API_BASE_URL).concat(t),PATCH:"".concat(o.API_BASE_URL).concat(t)})[e]}n.d(t,{b:function(){return r}});let o={get API_BASE_URL(){return"/api"}}},5447:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});var r=n(71567),o=n(2913);let a={login:async(e,t,n)=>{try{let a=(0,o.b)("POST",r.q.AUTH.LOGIN),i={"Content-Type":"application/json"};t&&(i["X-CSRF-Token"]=t),n&&(i.Cookie=n);let s=await fetch(a,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(e)});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.message||e.detail||"เข้าสู่ระบบไม่สำเร็จ")}let l=await s.json();return{...l.user,token:l.token}}catch(e){throw Error(e.message||"เข้าสู่ระบบไม่สำเร็จ")}},logout:async(e,t,n)=>{try{let r=(0,o.b)("POST","/auth/logout"),a={"Content-Type":"application/json"};e&&(a.Authorization="Bearer ".concat(e)),t&&(a["X-CSRF-Token"]=t),n&&(a.Cookie=n),await fetch(r,{method:"POST",headers:a,credentials:"include"})}catch(e){console.error("Logout failed",e)}},getMe:async e=>{try{let t=(0,o.b)("GET",r.q.AUTH.ME),n=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include",cache:"no-store"});if(!n.ok)throw Error("Unauthorized");return await n.json()}catch(e){throw e}},async getCsrfToken(){try{let e=await fetch("".concat(r.v).concat(r.q.AUTH.CSRF),{credentials:"include"});if(!e.ok)return"";return(await e.json()).csrfToken}catch(e){return console.error("Failed to fetch CSRF token",e),""}}}},84859:function(e,t,n){"use strict";n.d(t,{M:function(){return s},x:function(){return i}});let r="pos_offline_queue",o=()=>{let e=localStorage.getItem(r);return e?JSON.parse(e):[]},a=e=>{localStorage.setItem(r,JSON.stringify(e))},i={addToQueue:(e,t)=>{let n=o(),r={id:"offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,payload:t,timestamp:Date.now(),retryCount:0};return a([...n,r]),r},getQueue:()=>o(),removeFromQueue:e=>{a(o().filter(t=>t.id!==e))},incrementRetry:(e,t)=>{a(o().map(n=>n.id===e?{...n,retryCount:n.retryCount+1,lastError:t}:n))},clearQueue:()=>{localStorage.removeItem(r)},pruneExceeded:()=>{a(o().filter(e=>e.retryCount<=5))}},s={maxRetry:5,backoff:e=>Math.min(3e4,2e3*e)}},63836:function(e,t,n){"use strict";n.d(t,{E:function(){return i}});var r=n(2913);let o=n(71567).q.POS.PAYMENT_METHODS,a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},i={getAll:async(e,t)=>{let n=(0,r.b)("GET",o),i=new URLSearchParams(t||"");i.has("page")||i.set("page","1"),i.has("limit")||i.set("limit","200");let s=i.toString();s&&(n+="?".concat(s));let l=a(e,""),c=await fetch(n,{cache:"no-store",headers:l,credentials:"include"});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch payment methods")}return c.json()},getById:async(e,t)=>{let n=(0,r.b)("GET","".concat(o,"/").concat(e)),i=a(t,""),s=await fetch(n,{cache:"no-store",headers:i,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch payment method")}return s.json()},getByName:async(e,t)=>{let n=(0,r.b)("GET","".concat(o,"/getByName/").concat(e)),i=a(t,""),s=await fetch(n,{cache:"no-store",headers:i,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch payment method")}return s.json()},create:async(e,t,n)=>{let i=(0,r.b)("POST","".concat(o)),s=a(t);n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"POST",headers:s,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to create payment method")}return l.json()},update:async(e,t,n,i)=>{let s=(0,r.b)("PUT","".concat(o,"/").concat(e)),l=a(n);i&&(l["X-CSRF-Token"]=i);let c=await fetch(s,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to update payment method")}return c.json()},delete:async(e,t,n)=>{let i=(0,r.b)("DELETE","".concat(o,"/").concat(e)),s=a(t,"");n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to delete payment method")}}}},54528:function(e,t,n){"use strict";n.d(t,{U:function(){return i}});var r=n(2913);let o="/pos/payments",a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},i={getAll:async e=>{let t=(0,r.b)("GET",o),n=a(e,""),i=await fetch(t,{cache:"no-store",headers:n});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลการชำระเงินได้")}return i.json()},getById:async(e,t)=>{let n=(0,r.b)("GET","".concat(o,"/").concat(e)),i=a(t,""),s=await fetch(n,{cache:"no-store",headers:i});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลการชำระเงินได้")}return s.json()},create:async(e,t,n)=>{let i=(0,r.b)("POST","".concat(o)),s=a(t);n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"POST",headers:s,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างรายการชำระเงินได้")}return l.json()},update:async(e,t,n,i)=>{let s=(0,r.b)("PUT","".concat(o,"/").concat(e)),l=a(n);i&&(l["X-CSRF-Token"]=i);let c=await fetch(s,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถแก้ไขรายการชำระเงินได้")}return c.json()},delete:async(e,t,n)=>{let i=(0,r.b)("DELETE","".concat(o,"/").concat(e)),s=a(t,"");n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถลบรายการชำระเงินได้")}}}},19135:function(e,t,n){"use strict";n.d(t,{n:function(){return i}});var r=n(2913);let o="/pos/shopProfile",a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},i={getProfile:async e=>{let t=(0,r.b)("GET",o),n=a(e,""),i=await fetch(t,{cache:"no-store",headers:n,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลร้านค้าได้")}return i.json()},updateProfile:async(e,t,n)=>{let i=(0,r.b)("PUT",o),s=a(t);n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"PUT",headers:s,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตข้อมูลร้านค้าได้")}return l.json()}}},66290:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});var r=n(2913);let o=n(71567).q.POS.TABLES,a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},i={getAll:async(e,t)=>{let n=(0,r.b)("GET",o),i=new URLSearchParams(t||"");i.has("page")||i.set("page","1"),i.has("limit")||i.set("limit","200");let s=i.toString();s&&(n+="?".concat(s));let l=a(e,""),c=await fetch(n,{cache:"no-store",headers:l,credentials:"include"});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return c.json()},getById:async(e,t)=>{let n=(0,r.b)("GET","".concat(o,"/").concat(e)),i=a(t,""),s=await fetch(n,{cache:"no-store",headers:i,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return s.json()},getByName:async(e,t)=>{let n=(0,r.b)("GET","".concat(o,"/getByName/").concat(e)),i=a(t,""),s=await fetch(n,{cache:"no-store",headers:i,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return s.json()},create:async(e,t,n)=>{let i=(0,r.b)("POST","".concat(o)),s=a(t);n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"POST",headers:s,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to create table")}return l.json()},update:async(e,t,n,i)=>{let s=(0,r.b)("PUT","".concat(o,"/").concat(e)),l=a(n);i&&(l["X-CSRF-Token"]=i);let c=await fetch(s,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to update table")}return c.json()},delete:async(e,t,n)=>{let i=(0,r.b)("DELETE","".concat(o,"/").concat(e)),s=a(t,"");n&&(s["X-CSRF-Token"]=n);let l=await fetch(i,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to delete table")}}}},69602:function(e,t,n){"use strict";n.d(t,{U:function(){return r},q:function(){return o}});let r={...n(1165).mv,cash:"#10b981",qr:"#1d4ed8",creditCard:"#f59e0b",totalCardBg:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)",summaryBg:"#fafafa"},o={container:{minHeight:"100vh",background:r.background,fontFamily:"'Inter', 'Sarabun', sans-serif"},heroSection:{background:"linear-gradient(135deg, #1890ff 0%, #096dd9 100%)",padding:"32px 24px 70px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(24, 144, 255, 0.25)",marginBottom:-40,zIndex:1,overflow:"hidden"},contentWrapper:{maxWidth:1200,margin:"0 auto",position:"relative",zIndex:10},pageTitle:{margin:0,color:"#fff",fontSize:"clamp(20px, 5vw, 28px)",fontWeight:700},pageSubtitle:{color:"rgba(255,255,255,0.85)",fontSize:14},card:{borderRadius:12,overflow:"hidden",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.05)",height:"100%",display:"flex",flexDirection:"column"},methodCard:{borderWidth:2,borderStyle:"solid",borderColor:"#f0f0f0",borderRadius:12,padding:16,textAlign:"center",cursor:"pointer",background:"#fff",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},methodCardSelected:{borderColor:r.primary,background:"#eff6ff",transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.15)"},inputArea:{background:"#f8fafc",padding:20,borderRadius:12,border:"1px solid ".concat(r.border)},qrArea:{textAlign:"center",background:"#fff",padding:24,borderRadius:16,border:"1px dashed ".concat(r.primary),boxShadow:"0 4px 20px rgba(0,0,0,0.05)"},summaryBox:{marginTop:"auto",background:r.backgroundSecondary,padding:16,borderRadius:12}}},69477:function(e,t,n){"use strict";var r,o;n.d(t,{L:function(){return r}}),(o=r||(r={})).Fixed="Fixed",o.Percentage="Percentage"},94532:function(e,t,n){"use strict";var r,o;n.d(t,{b:function(){return r}}),(o=r||(r={})).Pending="Pending",o.Success="Success",o.Failed="Failed"},49747:function(e,t,n){"use strict";n.d(t,{Od:function(){return a},T_:function(){return c},VX:function(){return i},cc:function(){return o},hs:function(){return r},si:function(){return s},wv:function(){return l}});let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return{subtotal:0,discount:0,vat:0,total:0,change:0};let n=Number(e.sub_total||0),r=Number(e.discount_amount||0),o=Number(e.vat||0),a=Number(e.total_amount||0);return{subtotal:n,discount:r,vat:o,total:a,change:Math.max(0,t-a)}},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.toLowerCase(),r=t.toLowerCase();return n.includes("cash")||r.includes("สด")},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.toLowerCase(),r=t.toLowerCase();return n.includes("qr")||n.includes("prompt")||r.includes("qr")||r.includes("พร้อมเพย์")},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!a(e,t)||!!(null==n?void 0:n.promptpay_number)},s=[20,50,100,500,1e3],l=()=>"/pos/channels",c=e=>"/pos/orders/".concat(e)},97235:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var r=n(5447);let o=null,a=0,i=null;async function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&o&&t-a<6e5?o:(i||(i=r.O.getCsrfToken().then(e=>(o=e||"",a=Date.now(),o)).finally(()=>{i=null})),i)}},67697:function(e,t,n){"use strict";n.d(t,{D:function(){return i},v:function(){return a}});var r=n(2265);let o=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){var t;if("id"in e&&e.id)return e.id;if("data"in e&&(null===(t=e.data)||void 0===t?void 0:t.id))return e.data.id}};function a(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e.id,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>!0;(0,r.useEffect)(()=>{if(!e)return;let r=e=>{if(!i(e))return;let t=a(e);n(n=>n.some(e=>a(e)===t)?n:[...n,e])},s=e=>{let t=a(e);n(n=>i(e)?n.some(e=>a(e)===t)?n.map(n=>a(n)===t?e:n):[...n,e]:n.filter(e=>a(e)!==t))},l=e=>{let t=o(e);t&&n(e=>e.filter(e=>a(e)!==t))};return e.on(t.create,r),e.on(t.update,s),e.on(t.delete,l),()=>{e.off(t.create,r),e.off(t.update,s),e.off(t.delete,l)}},[e,t.create,t.update,t.delete,a,n,i])}function i(e){let{socket:t,events:n=[],onRefresh:o,intervalMs:a,enabled:i=!0,debounceMs:s}=e;(0,r.useEffect)(()=>{if(!i||!t||0===n.length)return;let e=null,r=()=>{if(!s||s<=0){o();return}e&&clearTimeout(e),e=setTimeout(()=>{e=null,o()},s)};return n.forEach(e=>t.on(e,r)),()=>{e&&clearTimeout(e),n.forEach(e=>t.off(e,r))}},[i,t,n,o,s]),(0,r.useEffect)(()=>{if(!i||!a)return;let e=setInterval(o,a);return()=>clearInterval(e)},[i,a,o])}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,9,5496,3834,8640,6931,19,1652,4547,779,4520,9753,4191,2971,2117,1744],function(){return e(e.s=48492)}),_N_E=e.O()}]);