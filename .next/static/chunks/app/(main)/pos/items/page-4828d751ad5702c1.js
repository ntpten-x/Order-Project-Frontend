(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5392],{3196:function(e,t,r){Promise.resolve().then(r.bind(r,78989))},78989:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return H}});var s=r(57437),i=r(29),l=r.n(i),a=r(2265),n=r(99376),d=r(19683),c=r(50742),o=r(47451),m=r(69410),y=r(96931),u=r(50337),x=r(80009),h=r(24783),j=r(23496),p=r(91652),f=r(62376),g=r(52539),v=r(67605),F=r(83669),Z=r(15883),b=r(25193),_=r(37410),N=r(20148),k=r(2786),w=r(53286),A=r(32446),T=r(45963),D=r(61414),P=r(3369),z=r(24675),I=r(67697),O=r(71096),S=r.n(O);r(6729);var C=r(21652),R=r.n(C);let{Text:E}=d.default;function H(){let e=(0,n.useRouter)(),[t,r]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),{showLoading:O,hideLoading:C}=(0,P.O)(),{socket:H}=(0,z.s)(),L=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e&&(O("กำลังโหลดรายการรอชำระเงิน..."),d(!0));let t=[A.i.WaitingForPayment].join(","),s=(await w.x.getAll(void 0,1,100,t)).data.map(e=>({order:e,items:e.items||[],totalAmount:e.total_amount}));s.sort((e,t)=>S()(t.order.create_date).unix()-S()(e.order.create_date).unix()),r(e=>R()(e,s)?e:s)}catch(e){}finally{e&&(d(!1),C())}},[O,C]);(0,a.useEffect)(()=>{L(!0)},[L]),(0,I.D)({socket:H,events:["orders:update","orders:create","orders:delete"],onRefresh:()=>L(!1),intervalMs:15e3,debounceMs:1e3});let q=(e,t)=>{switch(e){case A.m.DineIn:return"โต๊ะ ".concat((null==t?void 0:t.table_name)||"N/A");case A.m.TakeAway:return"สั่งกลับบ้าน";case A.m.Delivery:return"เดลิเวอรี่";default:return e||"N/A"}},G=e=>{switch(e){case A.m.DineIn:return(0,s.jsx)(f.Z,{});case A.m.TakeAway:return(0,s.jsx)(g.Z,{});case A.m.Delivery:return(0,s.jsx)(v.Z,{});default:return(0,s.jsx)(f.Z,{})}},B=(t,r)=>{if(!t)return;O("กำลังไปหน้าชำระเงิน...");let s=r===A.m.Delivery?"/pos/items/delivery/".concat(t):"/pos/items/payment/".concat(t);e.push(s)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{id:T.um.__hash,children:T.um}),(0,s.jsxs)("div",{style:T.F4.container,children:[(0,s.jsx)(N.Z,{title:"รายการรอชำระเงิน",subtitle:"Waiting For Payment Orders",onBack:()=>e.back(),icon:(0,s.jsx)(F.Z,{style:{fontSize:20}}),actions:(0,s.jsx)(c.ZP,{onClick:()=>L(!0),loading:i,children:"รีเฟรช"})}),(0,s.jsx)(b.Z,{children:(0,s.jsx)(_.Z,{children:i?(0,s.jsx)(o.Z,{gutter:[16,16],children:Array.from({length:6}).map((e,t)=>(0,s.jsx)(m.Z,{xs:24,sm:12,lg:8,children:(0,s.jsx)(y.Z,{style:T.F4.card,children:(0,s.jsx)(u.Z,{active:!0,paragraph:{rows:3}})})},"skeleton-".concat(t)))}):0===t.length?(0,s.jsx)(k.Z,{title:"ไม่มีรายการรอชำระเงิน"}):(0,s.jsx)(o.Z,{gutter:[16,16],children:t.map((e,t)=>(0,s.jsx)(m.Z,{xs:24,sm:12,lg:8,children:(0,s.jsxs)(y.Z,{hoverable:!0,className:"items-card-mobile items-card-animate items-card-delay-".concat(t%3+1),style:T.F4.card,bodyStyle:{flex:1,display:"flex",flexDirection:"column"},children:[(0,s.jsxs)("div",{style:T.F4.cardHeader,className:"items-card-header-mobile",children:[(0,s.jsxs)("div",{style:T.F4.cardHeaderLeft,children:[(0,s.jsx)(x.Z,{color:"geekblue",style:T.F4.cardTimeTag,children:S()(e.order.create_date).format("HH:mm")}),(0,s.jsxs)("div",{style:T.F4.cardOrderInfo,children:[G(e.order.order_type),(0,s.jsx)(E,{strong:!0,style:{fontSize:16},children:q(e.order.order_type,e.order.table)})]}),(0,s.jsxs)(h.Z,{size:4,orientation:"vertical",style:{marginTop:4},children:[(0,s.jsxs)(E,{type:"secondary",style:T.F4.cardOrderNo,children:["#",e.order.order_no]}),e.order.created_by_id&&(0,s.jsxs)(E,{type:"secondary",style:{fontSize:11},children:[(0,s.jsx)(Z.Z,{style:{marginRight:4}}),e.order.created_by_id]})]})]}),(0,s.jsx)(E,{strong:!0,style:T.F4.cardTotal,className:"items-card-total-mobile",children:(0,D.xG)(e.totalAmount)})]}),(0,s.jsx)(j.Z,{style:{margin:"12px 0"}}),(0,s.jsx)("div",{style:T.F4.itemsList,children:e.items.map((e,t)=>{var r,i;return(0,s.jsxs)("div",{style:T.F4.itemRow,className:"items-item-row-mobile",children:[(0,s.jsxs)("div",{style:T.F4.itemLeft,className:"items-item-left-mobile",children:[(null===(r=e.product)||void 0===r?void 0:r.img_url)?(0,s.jsx)(p.Z,{shape:"square",size:40,src:e.product.img_url,style:T.F4.itemImage}):(0,s.jsx)("div",{style:T.F4.itemImagePlaceholder,children:(0,s.jsx)(f.Z,{style:{color:T.QF.textLight}})}),(0,s.jsxs)("div",{style:T.F4.itemInfo,children:[(0,s.jsxs)("div",{style:T.F4.itemNameRow,children:[(0,s.jsxs)(x.Z,{style:T.F4.itemQuantityTag,children:["x",e.quantity]}),(0,s.jsx)(E,{strong:!0,style:T.F4.itemName,ellipsis:!0,children:null===(i=e.product)||void 0===i?void 0:i.display_name})]}),(0,s.jsx)(E,{type:"secondary",style:T.F4.itemPrice,children:(0,D.xG)(e.price)}),e.notes&&(0,s.jsxs)(E,{type:"secondary",style:T.F4.itemNotes,children:["* ",e.notes]})]})]}),(0,s.jsx)(E,{strong:!0,style:T.F4.itemTotal,className:"items-item-total-mobile",children:(0,D.xG)(Number(e.total_price||Number(e.price)*e.quantity))})]},t)})}),(0,s.jsx)(j.Z,{style:{margin:"12px 0"}}),(0,s.jsx)(c.ZP,{type:"primary",block:!0,size:"large",style:T.F4.paymentButton,className:"items-payment-button-mobile",onClick:()=>B(e.order.id,e.order.order_type),children:"ชำระเงิน"})]})},e.order.id))})})})]})]})}S().locale("th")}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=3196)}),_N_E=e.O()}]);