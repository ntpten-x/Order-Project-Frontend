(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5392],{3196:function(e,t,s){Promise.resolve().then(s.bind(s,78989))},78989:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var r=s(57437),i=s(29),l=s.n(i),a=s(2265),n=s(99376),d=s(19683),c=s(50742),o=s(47451),m=s(69410),y=s(96931),x=s(50337),u=s(85180),h=s(80009),p=s(24783),j=s(23496),b=s(91652),g=s(62376),f=s(52539),v=s(67605),F=s(17588),Z=s(83669),_=s(15883),N=s(53286),k=s(32446),w=s(45963),T=s(61414),A=s(3369),I=s(24675),S=s(67697),C=s(71096),D=s.n(C);s(6729);var P=s(21652),z=s.n(P);let{Title:O,Text:R}=d.default;function E(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),{showLoading:C,hideLoading:P}=(0,A.O)(),{socket:E}=(0,I.s)(),H=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e&&(C("กำลังโหลดรายการรอชำระเงิน..."),d(!0));let t=[k.i.WaitingForPayment].join(","),r=(await N.x.getAll(void 0,1,100,t)).data.map(e=>({order:e,items:e.items||[],totalAmount:e.total_amount}));r.sort((e,t)=>D()(t.order.create_date).unix()-D()(e.order.create_date).unix()),s(e=>z()(e,r)?e:r)}catch(e){}finally{e&&(d(!1),P())}},[C,P]);(0,a.useEffect)(()=>{H(!0)},[H]),(0,S.D)({socket:E,events:["orders:update","orders:create","orders:delete"],onRefresh:()=>H(!1),intervalMs:15e3,debounceMs:1e3});let L=(e,t)=>{switch(e){case k.m.DineIn:return"โต๊ะ ".concat((null==t?void 0:t.table_name)||"N/A");case k.m.TakeAway:return"สั่งกลับบ้าน";case k.m.Delivery:return"เดลิเวอรี่";default:return e||"N/A"}},W=e=>{switch(e){case k.m.DineIn:return(0,r.jsx)(g.Z,{});case k.m.TakeAway:return(0,r.jsx)(f.Z,{});case k.m.Delivery:return(0,r.jsx)(v.Z,{});default:return(0,r.jsx)(g.Z,{})}},q=(t,s)=>{if(!t)return;C("กำลังไปหน้าชำระเงิน...");let r=s===k.m.Delivery?"/pos/items/delivery/".concat(t):"/pos/items/payment/".concat(t);e.push(r)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{id:w.um.__hash,children:w.um}),(0,r.jsxs)("div",{style:w.F4.container,children:[(0,r.jsx)("header",{style:w.F4.heroSection,role:"banner",className:"items-hero-mobile",children:(0,r.jsx)("div",{style:{...w.F4.contentWrapper,padding:"0 16px"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:14},children:[(0,r.jsx)(c.ZP,{type:"text",icon:(0,r.jsx)(F.Z,{}),onClick:()=>e.back(),style:w.F4.backButton,className:"items-back-button-mobile scale-hover","aria-label":"กลับ"}),(0,r.jsx)("div",{style:{width:52,height:52,borderRadius:16,background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)(Z.Z,{style:{fontSize:26,color:"#fff"}})}),(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)(O,{level:3,style:w.F4.pageTitle,className:"items-title-mobile",children:"รายการรอชำระเงิน"}),(0,r.jsx)(R,{style:w.F4.pageSubtitle,className:"items-subtitle-mobile",children:"Waiting For Payment Orders"})]})]})})}),(0,r.jsx)("div",{style:{...w.F4.contentWrapper,marginTop:-32,padding:"0 16px"},className:"items-content-mobile",children:i?(0,r.jsx)(o.Z,{gutter:[16,16],children:Array.from({length:6}).map((e,t)=>(0,r.jsx)(m.Z,{xs:24,sm:12,lg:8,children:(0,r.jsx)(y.Z,{style:w.F4.card,children:(0,r.jsx)(x.Z,{active:!0,paragraph:{rows:3}})})},"skeleton-".concat(t)))}):0===t.length?(0,r.jsx)(y.Z,{style:w.F4.emptyCard,children:(0,r.jsx)(u.Z,{description:"ไม่มีรายการรอชำระเงิน"})}):(0,r.jsx)(o.Z,{gutter:[16,16],children:t.map((e,t)=>(0,r.jsx)(m.Z,{xs:24,sm:12,lg:8,children:(0,r.jsxs)(y.Z,{hoverable:!0,className:"items-card-mobile items-card-animate items-card-delay-".concat(t%3+1),style:w.F4.card,bodyStyle:{flex:1,display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("div",{style:w.F4.cardHeader,className:"items-card-header-mobile",children:[(0,r.jsxs)("div",{style:w.F4.cardHeaderLeft,children:[(0,r.jsx)(h.Z,{color:"geekblue",style:w.F4.cardTimeTag,children:D()(e.order.create_date).format("HH:mm")}),(0,r.jsxs)("div",{style:w.F4.cardOrderInfo,children:[W(e.order.order_type),(0,r.jsx)(R,{strong:!0,style:{fontSize:16},children:L(e.order.order_type,e.order.table)})]}),(0,r.jsxs)(p.Z,{size:4,orientation:"vertical",style:{marginTop:4},children:[(0,r.jsxs)(R,{type:"secondary",style:w.F4.cardOrderNo,children:["#",e.order.order_no]}),e.order.created_by_id&&(0,r.jsxs)(R,{type:"secondary",style:{fontSize:11},children:[(0,r.jsx)(_.Z,{style:{marginRight:4}}),e.order.created_by_id]})]})]}),(0,r.jsx)(R,{strong:!0,style:w.F4.cardTotal,className:"items-card-total-mobile",children:(0,T.xG)(e.totalAmount)})]}),(0,r.jsx)(j.Z,{style:{margin:"12px 0"}}),(0,r.jsx)("div",{style:w.F4.itemsList,children:e.items.map((e,t)=>{var s,i;return(0,r.jsxs)("div",{style:w.F4.itemRow,className:"items-item-row-mobile",children:[(0,r.jsxs)("div",{style:w.F4.itemLeft,className:"items-item-left-mobile",children:[(null===(s=e.product)||void 0===s?void 0:s.img_url)?(0,r.jsx)(b.Z,{shape:"square",size:40,src:e.product.img_url,style:w.F4.itemImage}):(0,r.jsx)("div",{style:w.F4.itemImagePlaceholder,children:(0,r.jsx)(g.Z,{style:{color:w.QF.textLight}})}),(0,r.jsxs)("div",{style:w.F4.itemInfo,children:[(0,r.jsxs)("div",{style:w.F4.itemNameRow,children:[(0,r.jsxs)(h.Z,{style:w.F4.itemQuantityTag,children:["x",e.quantity]}),(0,r.jsx)(R,{strong:!0,style:w.F4.itemName,ellipsis:!0,children:null===(i=e.product)||void 0===i?void 0:i.display_name})]}),(0,r.jsx)(R,{type:"secondary",style:w.F4.itemPrice,children:(0,T.xG)(e.price)}),e.notes&&(0,r.jsxs)(R,{type:"secondary",style:w.F4.itemNotes,children:["* ",e.notes]})]})]}),(0,r.jsx)(R,{strong:!0,style:w.F4.itemTotal,className:"items-item-total-mobile",children:(0,T.xG)(Number(e.total_price||Number(e.price)*e.quantity))})]},t)})}),(0,r.jsx)(j.Z,{style:{margin:"12px 0"}}),(0,r.jsx)(c.ZP,{type:"primary",block:!0,size:"large",style:w.F4.paymentButton,className:"items-payment-button-mobile",onClick:()=>q(e.order.id,e.order.order_type),children:"ชำระเงิน"})]})},e.order.id))})})]})]})}D().locale("th")}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=3196)}),_N_E=e.O()}]);