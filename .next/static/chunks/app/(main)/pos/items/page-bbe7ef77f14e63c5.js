(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5392],{3196:function(e,t,r){Promise.resolve().then(r.bind(r,78989))},78989:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var i=r(57437),s=r(29),a=r.n(s),n=r(2265),l=r(99376),d=r(39486),c=r(50742),o=r(47451),u=r(69410),m=r(96931),x=r(50337),y=r(80009),h=r(24783),p=r(23496),g=r(91652),j=r(62376),f=r(52539),b=r(67605),v=r(83669),Z=r(15883),F=r(25193),_=r(37410),k=r(20148),w=r(2786),N=r(53286),P=r(32446),T=r(45963),H=r(61414),D=r(3369),R=r(24675),O=r(67697),B=r(12028),I=r(71096),S=r.n(I);r(6729);var z=r(21652),A=r.n(z);let{Text:C}=d.default;function M(){let e=(0,l.useRouter)(),[t,r]=(0,n.useState)([]),[s,d]=(0,n.useState)(!0),{showLoading:I,hideLoading:z}=(0,D.O)(),{socket:M}=(0,R.s)(),W=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e&&(I("กำลังโหลดรายการรอชำระเงิน..."),d(!0));let t=[P.i.WaitingForPayment].join(","),i=(await N.x.getAll(void 0,1,100,t)).data.map(e=>({order:e,items:e.items||[],totalAmount:e.total_amount}));i.sort((e,t)=>S()(t.order.create_date).unix()-S()(e.order.create_date).unix()),r(e=>A()(e,i)?e:i)}catch(e){}finally{e&&(d(!1),z())}},[I,z]);(0,n.useEffect)(()=>{W(!0)},[W]),(0,O.D)({socket:M,events:[B.b.orders.update,B.b.orders.create,B.b.orders.delete,B.b.salesOrderItem.create,B.b.salesOrderItem.update,B.b.salesOrderItem.delete,B.b.salesOrderDetail.create,B.b.salesOrderDetail.update,B.b.salesOrderDetail.delete],onRefresh:()=>W(!1),intervalMs:15e3,debounceMs:1e3});let G=(e,t)=>{switch(e){case P.m.DineIn:return"โต๊ะ ".concat((null==t?void 0:t.table_name)||"N/A");case P.m.TakeAway:return"สั่งกลับบ้าน";case P.m.Delivery:return"เดลิเวอรี่";default:return e||"N/A"}},L=e=>{switch(e){case P.m.DineIn:return(0,i.jsx)(j.Z,{});case P.m.TakeAway:return(0,i.jsx)(f.Z,{});case P.m.Delivery:return(0,i.jsx)(b.Z,{});default:return(0,i.jsx)(j.Z,{})}},X=(t,r)=>{if(!t)return;I("กำลังไปหน้าชำระเงิน...");let i=r===P.m.Delivery?"/pos/items/delivery/".concat(t):"/pos/items/payment/".concat(t);e.push(i)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a(),{id:T.um.__hash,children:T.um}),(0,i.jsxs)("div",{style:T.F4.container,children:[(0,i.jsx)(k.Z,{title:"รายการรอชำระเงิน",subtitle:"Waiting For Payment Orders",onBack:()=>e.back(),icon:(0,i.jsx)(v.Z,{style:{fontSize:20}}),actions:(0,i.jsx)(c.ZP,{onClick:()=>W(!0),loading:s,children:"รีเฟรช"})}),(0,i.jsx)(F.Z,{children:(0,i.jsx)(_.Z,{children:s?(0,i.jsx)(o.Z,{gutter:[16,16],children:Array.from({length:6}).map((e,t)=>(0,i.jsx)(u.Z,{xs:24,sm:12,lg:8,children:(0,i.jsx)(m.Z,{style:T.F4.card,children:(0,i.jsx)(x.Z,{active:!0,paragraph:{rows:3}})})},"skeleton-".concat(t)))}):0===t.length?(0,i.jsx)(w.Z,{title:"ไม่มีรายการรอชำระเงิน"}):(0,i.jsx)(o.Z,{gutter:[16,16],children:t.map((e,t)=>(0,i.jsx)(u.Z,{xs:24,sm:12,lg:8,children:(0,i.jsxs)(m.Z,{hoverable:!0,className:"items-card-mobile items-card-animate items-card-delay-".concat(t%3+1),style:T.F4.card,bodyStyle:{flex:1,display:"flex",flexDirection:"column"},children:[(0,i.jsxs)("div",{style:T.F4.cardHeader,className:"items-card-header-mobile",children:[(0,i.jsxs)("div",{style:T.F4.cardHeaderLeft,children:[(0,i.jsx)(y.Z,{color:"geekblue",style:T.F4.cardTimeTag,children:S()(e.order.create_date).format("HH:mm")}),(0,i.jsxs)("div",{style:T.F4.cardOrderInfo,children:[L(e.order.order_type),(0,i.jsx)(C,{strong:!0,style:{fontSize:16},children:G(e.order.order_type,e.order.table)})]}),(0,i.jsxs)(h.Z,{size:4,orientation:"vertical",style:{marginTop:4},children:[(0,i.jsxs)(C,{type:"secondary",style:T.F4.cardOrderNo,children:["#",e.order.order_no]}),e.order.created_by_id&&(0,i.jsxs)(C,{type:"secondary",style:{fontSize:11},children:[(0,i.jsx)(Z.Z,{style:{marginRight:4}}),e.order.created_by_id]})]})]}),(0,i.jsx)(C,{strong:!0,style:T.F4.cardTotal,className:"items-card-total-mobile",children:(0,H.xG)(e.totalAmount)})]}),(0,i.jsx)(p.Z,{style:{margin:"12px 0"}}),(0,i.jsx)("div",{style:T.F4.itemsList,children:e.items.map((e,t)=>{var r,s;return(0,i.jsxs)("div",{style:T.F4.itemRow,className:"items-item-row-mobile",children:[(0,i.jsxs)("div",{style:T.F4.itemLeft,className:"items-item-left-mobile",children:[(null===(r=e.product)||void 0===r?void 0:r.img_url)?(0,i.jsx)(g.Z,{shape:"square",size:40,src:e.product.img_url,style:T.F4.itemImage}):(0,i.jsx)("div",{style:T.F4.itemImagePlaceholder,children:(0,i.jsx)(j.Z,{style:{color:T.QF.textLight}})}),(0,i.jsxs)("div",{style:T.F4.itemInfo,children:[(0,i.jsxs)("div",{style:T.F4.itemNameRow,children:[(0,i.jsxs)(y.Z,{style:T.F4.itemQuantityTag,children:["x",e.quantity]}),(0,i.jsx)(C,{strong:!0,style:T.F4.itemName,ellipsis:!0,children:null===(s=e.product)||void 0===s?void 0:s.display_name})]}),(0,i.jsx)(C,{type:"secondary",style:T.F4.itemPrice,children:(0,H.xG)(e.price)}),e.notes&&(0,i.jsxs)(C,{type:"secondary",style:T.F4.itemNotes,children:["* ",e.notes]})]})]}),(0,i.jsx)(C,{strong:!0,style:T.F4.itemTotal,className:"items-item-total-mobile",children:(0,H.xG)(Number(e.total_price||Number(e.price)*e.quantity))})]},t)})}),(0,i.jsx)(p.Z,{style:{margin:"12px 0"}}),(0,i.jsx)(c.ZP,{type:"primary",block:!0,size:"large",style:T.F4.paymentButton,className:"items-payment-button-mobile",onClick:()=>X(e.order.id,e.order.order_type),children:"ชำระเงิน"})]})},e.order.id))})})})]})]})}S().locale("th")},25193:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var i=r(57437);r(2265);var s=r(38616),a=r(87530);function n(e){let{children:t,maxWidth:r=a.H.pageMaxWidth,style:n}=e,l=s.default.useBreakpoint().md?a.H.pagePaddingXDesktop:a.H.pagePaddingXMobile;return(0,i.jsx)("div",{style:{width:"100%",maxWidth:r,margin:"0 auto",padding:"".concat(a.H.pagePaddingY,"px ").concat(l,"px"),...n},children:t})}},20148:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var i=r(57437);r(2265);var s=r(17588),a=r(2651),n=r(38616),l=r(10868),d=r(50742),c=r(39486),o=r(87530);function u(e){let{title:t,subtitle:r,icon:u,onBack:m,actions:x,style:y}=e,{token:h}=a.default.useToken(),p=n.default.useBreakpoint().md?o.H.pagePaddingXDesktop:o.H.pagePaddingXMobile;return(0,i.jsx)("div",{style:{padding:"".concat(o.H.pagePaddingY,"px ").concat(p,"px"),background:h.colorBgContainer,borderBottom:"1px solid ".concat(h.colorBorderSecondary),...y},children:(0,i.jsxs)(l.Z,{align:"center",justify:"space-between",wrap:"wrap",gap:12,style:{maxWidth:o.H.pageMaxWidth,margin:"0 auto"},children:[(0,i.jsxs)(l.Z,{align:"center",gap:12,style:{minWidth:0},children:[m&&(0,i.jsx)(d.ZP,{type:"text","aria-label":"ย้อนกลับ",icon:(0,i.jsx)(s.Z,{}),onClick:m,style:{borderRadius:12,width:44,height:44}}),u&&(0,i.jsx)("div",{style:{width:44,height:44,borderRadius:14,display:"grid",placeItems:"center",background:h.colorFillTertiary,color:h.colorText},children:u}),(0,i.jsxs)("div",{style:{minWidth:0},children:[(0,i.jsx)(c.default.Title,{level:4,style:{margin:0},children:t}),r&&(0,i.jsx)(c.default.Text,{type:"secondary",children:r})]})]}),x&&(0,i.jsx)(l.Z,{gap:8,wrap:"wrap",children:x})]})})}},37410:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var i=r(57437);r(2265);var s=r(2651),a=r(96931),n=r(10868),l=r(39486),d=r(87530);function c(e){let{title:t,extra:r,children:c,style:o}=e,{token:u}=s.default.useToken();return(0,i.jsx)(a.Z,{size:"small",variant:"outlined",style:{borderRadius:d.H.cardRadiusLG,...o},styles:{header:t?{borderBottomColor:u.colorBorderSecondary}:{display:"none"}},title:t?(0,i.jsxs)(n.Z,{align:"center",justify:"space-between",gap:12,children:[(0,i.jsx)(l.default.Text,{strong:!0,children:t}),r]}):void 0,children:c})}},2786:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var i=r(57437);r(2265);var s=r(96931),a=r(85180),n=r(39486),l=r(87530);function d(e){let{title:t="ไม่มีข้อมูล",description:r,action:d,image:c}=e;return(0,i.jsx)(s.Z,{size:"small",variant:"outlined",style:{borderRadius:l.H.cardRadiusLG},bodyStyle:{padding:20},children:(0,i.jsx)(a.Z,{image:c,description:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,i.jsx)(n.default.Text,{strong:!0,children:t}),r?(0,i.jsx)(n.default.Text,{type:"secondary",children:r}):null]}),children:d})})}},87530:function(e,t,r){"use strict";r.d(t,{H:function(){return i}});let i={pageMaxWidth:1200,pagePaddingXMobile:16,pagePaddingXDesktop:24,pagePaddingY:16,sectionGap:16,cardRadius:16,cardRadiusLG:20,cardShadow:"0 10px 24px rgba(15, 23, 42, 0.08)",surfaceBg:"#ffffff",surfaceBorder:"#e2e8f0"}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,2401,9,19,9845,4221,1652,5531,7051,9385,4191,6320,2971,2117,1744],function(){return e(e.s=3196)}),_N_E=e.O()}]);