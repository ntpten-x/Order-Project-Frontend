(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{14468:function(e,t,r){Promise.resolve().then(r.bind(r,42569))},42569:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return A}});var n=r(57437),a=r(29),o=r.n(a),i=r(2265),l=r(99376),s=r(39486),c=r(24783),d=r(80009),u=r(50742),m=r(47451),p=r(69410),f=r(52539),y=r(96473),b=r(5540),h=r(25193),v=r(37410),_=r(20148),g=r(2786),x=r(32446),w=r(44225),j=r(11777),k=r(25369),S=r(252),Z=r(61414),E=r(3369),T=r(33203),N=r(71096),C=r.n(N),D=r(45721),P=r.n(D);r(6729);let{Text:I}=s.default;function A(){let e=(0,l.useRouter)(),{showLoading:t,hideLoading:r}=(0,E.x)(),{orders:a,isLoading:s}=(0,T.w)({orderType:x.m.TakeAway}),N=(0,i.useMemo)(()=>(0,S.Do)(a),[a]);(0,i.useEffect)(()=>{s?t("กำลังโหลดออเดอร์..."):r()},[s,t,r]);let D=()=>{e.push("/pos/channels/takeaway/buying")},P=t=>{let r=(0,Z.M9)(t);e.push(r)},A=e=>{switch(e){case"available":return"success";case"occupied":return"orange";case"waitingForPayment":return"blue";default:return"default"}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.c,{}),(0,n.jsx)(o(),{id:j.N5.__hash,children:j.N5}),(0,n.jsx)(o(),{id:"41c2403baab2f8cd",children:".order-card-hover{-webkit-transition:all.3s cubic-bezier(.4,0,.2,1)!important;-moz-transition:all.3s cubic-bezier(.4,0,.2,1)!important;-o-transition:all.3s cubic-bezier(.4,0,.2,1)!important;transition:all.3s cubic-bezier(.4,0,.2,1)!important}.order-card-hover:hover{-webkit-transform:translatey(-4px)!important;-moz-transform:translatey(-4px)!important;-ms-transform:translatey(-4px)!important;-o-transform:translatey(-4px)!important;transform:translatey(-4px)!important;-webkit-box-shadow:0 12px 28px rgba(0,0,0,.1)!important;-moz-box-shadow:0 12px 28px rgba(0,0,0,.1)!important;box-shadow:0 12px 28px rgba(0,0,0,.1)!important}.order-card-hover:active{-webkit-transform:translatey(-2px)scale(.99)!important;-moz-transform:translatey(-2px)scale(.99)!important;-ms-transform:translatey(-2px)scale(.99)!important;-o-transform:translatey(-2px)scale(.99)!important;transform:translatey(-2px)scale(.99)!important}@media(hover:none){.order-card-hover:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.order-card-hover:hover{-webkit-transform:none!important;-moz-transform:none!important;-ms-transform:none!important;-o-transform:none!important;transform:none!important}}.back-button-hover:hover{background:rgba(255,255,255,.28)!important;-webkit-transform:translatex(-2px);-moz-transform:translatex(-2px);-ms-transform:translatex(-2px);-o-transform:translatex(-2px);transform:translatex(-2px)}.add-button-hover:hover{-webkit-transform:translatey(-2px)!important;-moz-transform:translatey(-2px)!important;-ms-transform:translatey(-2px)!important;-o-transform:translatey(-2px)!important;transform:translatey(-2px)!important;-webkit-box-shadow:0 12px 24px rgba(82,196,26,.35)!important;-moz-box-shadow:0 12px 24px rgba(82,196,26,.35)!important;box-shadow:0 12px 24px rgba(82,196,26,.35)!important}.add-button-hover:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.hide-on-mobile{display:inline!important}.show-on-mobile-inline{display:none!important}@media(max-width:768px){.hide-on-mobile{display:none!important}.show-on-mobile-inline{display:inline!important}}"}),(0,n.jsxs)("div",{style:w.Np.container,className:"jsx-41c2403baab2f8cd",children:[(0,n.jsx)(_.Z,{title:"สั่งกลับบ้าน",subtitle:(0,n.jsxs)(c.Z,{size:8,wrap:!0,children:[(0,n.jsxs)(d.Z,{children:["ทั้งหมด ",N.total]}),(0,n.jsxs)(d.Z,{color:"orange",children:["กำลังปรุง ",N.cooking]})]}),onBack:()=>{e.push("/pos/channels")},icon:(0,n.jsx)(f.Z,{style:{fontSize:20}}),actions:(0,n.jsx)(u.ZP,{type:"primary",icon:(0,n.jsx)(y.Z,{}),onClick:D,children:"เพิ่มออเดอร์"})}),(0,n.jsx)(h.Z,{children:(0,n.jsx)(v.Z,{title:"ออเดอร์",children:a.length>0?(0,n.jsx)(m.Z,{gutter:[16,16],children:a.map((e,t)=>{var r;let a=(0,S.Yx)(e),o=w.ax[a],i=e.order_no.split("-").pop();return(0,n.jsx)(p.Z,{xs:24,sm:12,md:8,lg:6,xl:6,className:"takeaway-order-col-mobile",children:(0,n.jsxs)("article",{style:{...j.yy.orderCard,border:"1.5px solid ".concat(o.border)},onClick:()=>P(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),P(e))},role:"button",tabIndex:0,"aria-label":"ออเดอร์ #".concat(i," - ").concat((0,S.NE)(e.status)),className:"jsx-41c2403baab2f8cd "+"order-card-hover takeaway-order-card table-card-animate table-card-delay-".concat(t%6+1),children:[(0,n.jsxs)("div",{style:{...j.yy.orderCardHeader,background:o.light},className:"jsx-41c2403baab2f8cd",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},className:"jsx-41c2403baab2f8cd",children:[(0,n.jsx)("div",{style:{width:40,height:40,borderRadius:12,background:"".concat(o.primary,"20"),display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-41c2403baab2f8cd",children:(0,n.jsx)(f.Z,{style:{color:o.primary,fontSize:20}})}),(0,n.jsxs)(I,{strong:!0,style:{fontSize:18,color:"#1E293B"},children:["#",i]})]}),(0,n.jsx)(d.Z,{color:A(a),style:{borderRadius:8,margin:0,fontWeight:600,border:"none",padding:"4px 12px"},children:(0,S.NE)(e.status)})]}),(0,n.jsx)("div",{style:j.yy.orderCardContent,className:"jsx-41c2403baab2f8cd",children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},className:"jsx-41c2403baab2f8cd",children:[(0,n.jsxs)("div",{className:"jsx-41c2403baab2f8cd",children:[(0,n.jsx)(I,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"รายการสินค้า"}),(0,n.jsxs)(I,{strong:!0,style:{fontSize:16},children:[e.items_count||0," รายการ"]})]}),(0,n.jsxs)("div",{style:{textAlign:"right"},className:"jsx-41c2403baab2f8cd",children:[(0,n.jsx)(I,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"ยอดรวม"}),(0,n.jsxs)(I,{strong:!0,style:{fontSize:20,color:o.primary},children:["฿",null===(r=e.total_amount)||void 0===r?void 0:r.toLocaleString()]})]})]})}),(0,n.jsxs)("div",{style:j.yy.orderCardFooter,className:"jsx-41c2403baab2f8cd",children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},className:"jsx-41c2403baab2f8cd",children:[(0,n.jsx)(b.Z,{style:{fontSize:12,color:"#94A3B8"}}),(0,n.jsx)(I,{type:"secondary",style:{fontSize:12},children:C()(e.create_date).fromNow()})]}),(0,n.jsx)(d.Z,{style:{margin:0,borderRadius:6,background:w.hS.takeaway.light,color:w.hS.takeaway.primary,border:"1px solid ".concat(w.hS.takeaway.border),fontSize:11,fontWeight:600},children:"Take Away"})]})]})},e.id)})}):(0,n.jsx)(g.Z,{title:"ไม่มีออเดอร์ในขณะนี้",description:"เริ่มรับออเดอร์สั่งกลับบ้านโดยกดปุ่ม “เพิ่มออเดอร์”",action:(0,n.jsx)(u.ZP,{type:"primary",icon:(0,n.jsx)(y.Z,{}),onClick:D,children:"สร้างออเดอร์ใหม่"})})})})]})]})}C().extend(P()),C().locale("th")},2786:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(57437);r(2265);var a=r(96931),o=r(85180),i=r(39486),l=r(87530);function s(e){let{title:t="ไม่มีข้อมูล",description:r,action:s,image:c}=e;return(0,n.jsx)(a.Z,{size:"small",variant:"outlined",style:{borderRadius:l.H.cardRadiusLG},bodyStyle:{padding:20},children:(0,n.jsx)(o.Z,{image:c,description:(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,n.jsx)(i.default.Text,{strong:!0,children:t}),r?(0,n.jsx)(i.default.Text,{type:"secondary",children:r}):null]}),children:s})})}},24675:function(e,t,r){"use strict";r.d(t,{s:function(){return o}});var n=r(2265),a=r(46252);let o=()=>(0,n.useContext)(a.J)},53286:function(e,t,r){"use strict";r.d(t,{x:function(){return g}});var n=r(20019),a=r(2913),o=r(71567),i=r(32446);let l=n.Ryn({id:n.Z_8(),username:n.Z_8()}).partial().nullable(),s=n.Ryn({id:n.Z_8(),display_name:n.Z_8()}).partial().nullable(),c=n.Ryn({id:n.Z_8(),display_name:n.Z_8(),img_url:n.Z_8().nullable(),price:n.oQ2.number(),category:s.optional()}).partial().nullable(),d=n.Ryn({id:n.Z_8().optional(),detail_name:n.Z_8(),extra_price:n.oQ2.number()}).partial(),u=n.Ryn({id:n.Z_8(),order_id:n.Z_8(),product_id:n.Z_8(),product_name:n.Z_8().optional(),quantity:n.oQ2.number(),price:n.oQ2.number(),total_price:n.oQ2.number(),discount_amount:n.oQ2.number().optional().default(0),notes:n.Z_8().nullable().optional(),status:n.jbo(i.i).optional(),product:c.optional(),details:n.IXX(d).optional()}),m=n.Ryn({id:n.Z_8(),order_no:n.Z_8(),order_type:n.jbo(i.m),table_id:n.Z_8().nullable().optional(),delivery_id:n.Z_8().nullable().optional(),delivery_code:n.Z_8().nullable().optional(),sub_total:n.oQ2.number(),discount_id:n.Z_8().nullable().optional(),discount_amount:n.oQ2.number(),vat:n.oQ2.number(),total_amount:n.oQ2.number(),received_amount:n.oQ2.number(),change_amount:n.oQ2.number(),status:n.jbo(i.i),created_by_id:n.Z_8().nullable().optional(),create_date:n.Z_8(),update_date:n.Z_8(),items:n.IXX(u).optional(),created_by:l.optional(),table:n.YjB().optional(),delivery:n.YjB().optional(),discount:n.YjB().optional(),payments:n.IXX(n.YjB()).optional()}),p=n.Ryn({data:n.IXX(m),total:n.oQ2.number(),page:n.oQ2.number(),last_page:n.oQ2.number().optional()}),f=n.Ryn({table_name:n.Z_8().nullable().optional(),delivery_name:n.Z_8().nullable().optional()}).partial().nullable(),y=n.Ryn({id:n.Z_8(),order_no:n.Z_8(),order_type:n.jbo(i.m),status:n.jbo(i.i),create_date:n.Z_8(),total_amount:n.oQ2.number(),delivery_code:n.Z_8().nullable().optional(),table_id:n.Z_8().nullable().optional(),delivery_id:n.Z_8().nullable().optional(),table:f.optional(),delivery:f.optional(),items_summary:n.IMB(n.Z_8(),n.oQ2.number()).optional(),items_count:n.oQ2.number().optional()}),b=n.Ryn({data:n.IXX(y),total:n.oQ2.number(),page:n.oQ2.number(),last_page:n.oQ2.number().optional()});var h=r(98170);let v=o.q.POS.ORDERS,_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},g={getAll:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:t.toString(),limit:r.toString(),...o&&{status:o},...i&&{type:i},...l&&{q:l}}),c="".concat(v,"?").concat(s.toString()),d=(0,a.b)("GET",c),u=_(e,""),m=await fetch(d,{cache:"no-store",headers:u,credentials:"include"});if(!m.ok){let e=await m.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let f=await m.json();try{return p.parse((0,h.XO)(f))}catch(e){throw console.error("Zod Validation Error in ordersService.getAll:",e),e instanceof n.jmq&&console.error("Zod Issues:",e.issues),e}},getAllSummary:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:t.toString(),limit:r.toString(),...o&&{status:o},...i&&{type:i},...l&&{q:l}}),c="".concat(v,"/summary?").concat(s.toString()),d=(0,a.b)("GET",c),u=_(e,""),m=await fetch(d,{cache:"no-store",headers:u,credentials:"include"});if(!m.ok){let e=await m.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let p=await m.json();try{return b.parse((0,h.XO)(p))}catch(e){throw console.error("Zod Validation Error in ordersService.getAllSummary:",e),e instanceof n.jmq&&console.error("Zod Issues:",e.issues),e}},getStats:async e=>{let t=(0,a.b)("GET",o.q.POS.CHANNELS.STATS),r=_(e,""),n=await fetch(t,{cache:"no-store",headers:r,credentials:"include"});if(!n.ok){let e=await n.text();console.error("Order Stats Backend Error:",e);let t=await JSON.parse(e).catch(()=>({}));throw Error((0,h.i_)(t,"ไม่สามารถดึงข้อมูลสถิติได้"))}let i=await n.json();return(0,h.hH)(i)},getById:async(e,t)=>{let r=(0,a.b)("GET","".concat(v,"/").concat(e)),o=_(t,""),i=await fetch(r,{cache:"no-store",headers:o,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let l=await i.json();try{let e=(0,h.hH)(l);if(Array.isArray(e)){if(0===e.length)throw Error("Order not found");return m.parse(e[0])}return m.parse(e)}catch(e){throw console.error("Zod Validation Error in ordersService.getById:",e),e instanceof n.jmq&&console.error("Zod Issues:",e.issues),e}},create:async(e,t,r)=>{let n=(0,a.b)("POST","".concat(v)),o=_(t);r&&(o["X-CSRF-Token"]=r);let i=await fetch(n,{method:"POST",headers:o,credentials:"include",body:JSON.stringify(e)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถสร้างออเดอร์ได้"))}return(0,h.hH)(await i.json())},update:async(e,t,r,n)=>{let o=(0,a.b)("PUT","".concat(v,"/").concat(e)),i=_(r);n&&(i["X-CSRF-Token"]=n);let l=await fetch(o,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถแก้ไขออเดอร์ได้"))}return(0,h.hH)(await l.json())},delete:async(e,t,r)=>{let n=(0,a.b)("DELETE","".concat(v,"/").concat(e)),o=_(t,"");r&&(o["X-CSRF-Token"]=r);let i=await fetch(n,{method:"DELETE",headers:o,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถลบออเดอร์ได้"))}},updateItemStatus:async(e,t,r,n)=>{let o=(0,a.b)("PATCH","".concat(v,"/items/").concat(e,"/status")),i=_(r);n&&(i["X-CSRF-Token"]=n);let l=await fetch(o,{method:"PATCH",headers:i,credentials:"include",body:JSON.stringify({status:t})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถอัปเดตสถานะรายการได้"))}},getItems:async(e,t)=>{let r=(0,a.b)("GET","".concat(v,"/items").concat(e?"?status=".concat(e):"")),n=_(t,""),o=await fetch(r,{cache:"no-store",headers:n,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลรายการได้"))}let i=(0,h.hH)(await o.json());if(Array.isArray(i))return i;if(i&&"object"==typeof i&&"data"in i){let e=i.data;if(Array.isArray(e))return e}return i},addItem:async(e,t,r,n)=>{let o=(0,a.b)("POST","".concat(v,"/").concat(e,"/items")),i=_(r);n&&(i["X-CSRF-Token"]=n);let l=await fetch(o,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถเพิ่มรายการได้"))}return(0,h.hH)(await l.json())},updateItem:async(e,t,r,n)=>{let o=(0,a.b)("PUT","".concat(v,"/items/").concat(e)),i=_(r,"application/json");n&&(i["X-CSRF-Token"]=n);let l=await fetch(o,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถแก้ไขรายการได้"))}return(0,h.hH)(await l.json())},deleteItem:async(e,t,r)=>{let n=(0,a.b)("DELETE","".concat(v,"/items/").concat(e)),o=_(t,"");r&&(o["X-CSRF-Token"]=r);let i=await fetch(n,{method:"DELETE",headers:o,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถลบรายการได้"))}return(0,h.hH)(await i.json())},updateStatus:async(e,t,r)=>{let n={"Content-Type":"application/json"};r&&(n["X-CSRF-Token"]=r);let o=(0,a.b)("PUT","".concat(v,"/").concat(e));if(!(await fetch(o,{method:"PUT",headers:n,body:JSON.stringify({status:t}),credentials:"include"})).ok)throw Error("Failed to update status")}}},34962:function(e,t,r){"use strict";var n,a;r.d(t,{c:function(){return n}}),(a=n||(n={})).Available="Available",a.Unavailable="Unavailable"},252:function(e,t,r){"use strict";r.d(t,{NE:function(){return c},Th:function(){return l},Do:function(){return d},Yx:function(){return u},Zu:function(){return m},Oi:function(){return s},W9:function(){return o},Tf:function(){return i}});var n=r(34962),a=r(32446);function o(e){let t={total:e.length,available:0,occupied:0,inactive:0};return e.forEach(e=>{e.is_active?e.status===n.c.Available?t.available++:t.occupied++:t.inactive++}),t}function i(e){return[...e].sort((e,t)=>{let r=parseInt(e.table_name.replace(/\D/g,"")),n=parseInt(t.table_name.replace(/\D/g,""));return isNaN(r)||isNaN(n)?e.table_name.localeCompare(t.table_name):r-n})}function l(e){return e.filter(e=>e.is_active)}function s(e){return e.is_active?"WaitingForPayment"===e.active_order_status?"waitingForPayment":e.status===n.c.Available?"available":"occupied":"inactive"}function c(e){return e?({Pending:"กำลังดำเนินการ",Cooking:"กำลังปรุง",Served:"เสิร์ฟแล้ว",WaitingForOrder:"รอรับออเดอร์",WaitingForPayment:"รอชำระเงิน",Paid:"ชำระเงินแล้ว",Completed:"เสร็จสมบูรณ์",Cancelled:"ยกเลิก"})[e]||e:""}function d(e){return e.reduce((e,t)=>(e.total++,t.status===a.i.Pending&&e.pending++,t.status===a.i.Cooking&&e.cooking++,t.status===a.i.Served&&e.served++,e),{total:0,pending:0,cooking:0,served:0})}function u(e){switch(e.status){case a.i.Pending:case a.i.Cooking:return"occupied";case a.i.Served:return"waitingForPayment";case a.i.Paid:return"available";default:return"inactive"}}let m=e=>{switch(e){case a.m.DineIn:case"DineIn":return"/pos/channels/dine-in";case a.m.TakeAway:case"TakeAway":return"/pos/channels/takeaway";case a.m.Delivery:case"Delivery":return"/pos/channels/delivery";default:return"/pos/orders"}}},61414:function(e,t,r){"use strict";r.d(t,{EO:function(){return x},Gs:function(){return c},HL:function(){return w},M9:function(){return j},Nz:function(){return b},OY:function(){return i},Rr:function(){return _},Wl:function(){return o},d$:function(){return k},d7:function(){return s},iN:function(){return m},jN:function(){return y},ku:function(){return v},mz:function(){return d},qO:function(){return u},s6:function(){return l},xG:function(){return f},yj:function(){return g},zP:function(){return p},zf:function(){return S}});var n=r(32446),a=r(34962);let o=e=>{var t,r;if(e.status===a.c.Available)return"/pos/channels/dine-in/".concat(e.id);let o=e.active_order_id||(null===(t=e.active_order)||void 0===t?void 0:t.id),i=e.active_order_status||(null===(r=e.active_order)||void 0===r?void 0:r.status);return o?i===n.i.WaitingForPayment?"/pos/items/payment/".concat(o):"/pos/orders/".concat(o):"/pos/channels/dine-in/".concat(e.id)},i=e=>{switch(e){case n.i.Pending:return"orange";case n.i.Cooking:return"blue";case n.i.Served:return"green";case n.i.Paid:return"cyan";case n.i.Cancelled:return"red";case n.i.WaitingForPayment:return"gold";default:if("cancelled"===String(null!=e?e:"").trim().toLowerCase())return"red";return"default"}},l=e=>"cancelled"===String(null!=e?e:"").trim().toLowerCase(),s=(e,t)=>{switch(e){case n.i.Pending:return"กำลังดำเนินการ";case n.i.Cooking:return"กำลังปรุง";case n.i.Served:if("TakeAway"===t||"Delivery"===t)return"ทำแล้ว";return"เสิร์ฟแล้ว";case n.i.Paid:return"ชำระเงินแล้ว";case n.i.Completed:return"สำเร็จ";case n.i.Cancelled:return"ยกเลิก";case n.i.WaitingForPayment:return"รอชำระเงิน";default:if(l(e))return"ยกเลิก";return e}},c=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},d=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},u=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",m=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",p=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",f=e=>{let t="string"==typeof e?parseFloat(e):e;return"฿".concat(Number(t).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2}))},y=e=>{var t,r;return"DineIn"===e.order_type?(null===(t=e.table)||void 0===t?void 0:t.table_name)||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||(null===(r=e.delivery)||void 0===r?void 0:r.delivery_name)||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A"},b=e=>(null!=e?e:[]).filter(e=>!l(e.status)),h=e=>(null!=e?e:[]).reduce((e,t)=>e+(Number(t.extra_price)||0),0),v=(e,t,r)=>((Number(e)||0)+h(r))*t,_=e=>b(e).reduce((e,t)=>{var r,n;let a=(null===(n=t.product)||void 0===n?void 0:null===(r=n.category)||void 0===r?void 0:r.display_name)||"ไม่ระบุหมวด";return e[a]=(e[a]||0)+(t.quantity||0),e},{}),g=e=>b(e).reduce((e,t)=>e+Number(t.total_price||0),0),x=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",w=e=>"/pos/orders/".concat(e),j=e=>e.status===n.i.WaitingForPayment?e.order_type===n.m.Delivery?"/pos/items/delivery/".concat(e.id):"/pos/items/payment/".concat(e.id):"/pos/orders/".concat(e.id),k=e=>e===n.m.Delivery?"/pos/channels/delivery":e===n.m.TakeAway?"/pos/channels/takeaway":e===n.m.DineIn?"/pos/channels/dine-in":"/pos/channels",S=(e,t,r,a)=>({order_no:a.orderNo||"ORD-".concat(Date.now()),order_type:t,sub_total:r.subTotal,discount_amount:r.discountAmount,vat:0,total_amount:r.totalAmount,received_amount:0,change_amount:0,status:n.i.Pending,discount_id:a.discountId||null,payment_method_id:null,table_id:a.tableId||null,delivery_id:a.deliveryId||null,delivery_code:a.deliveryCode||null,items:e.map(e=>{var r;let a=t===n.m.Delivery?Number(null!==(r=e.product.price_delivery)&&void 0!==r?r:e.product.price):Number(e.product.price),o=(a+(e.details||[]).reduce((e,t)=>e+Number(t.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:a,total_price:o,discount_amount:0,notes:e.notes||"",status:n.i.Cooking,details:e.details||[]}})})},33203:function(e,t,r){"use strict";r.d(t,{w:function(){return y}});var n=r(2265),a=r(53286),o=r(32446),i=r(24675),l=r(67697),s=r(21652),c=r.n(s),d=r(12028);let u=new Set([o.i.Paid,o.i.Completed,o.i.Cancelled]),m=[o.i.Pending,o.i.Cooking,o.i.Served,o.i.WaitingForPayment].join(","),p=[d.b.orders.create,d.b.orders.update,d.b.orders.delete,d.b.payments.create,d.b.payments.update,d.b.salesOrderItem.create,d.b.salesOrderItem.update,d.b.salesOrderItem.delete,d.b.salesOrderDetail.create,d.b.salesOrderDetail.update,d.b.salesOrderDetail.delete],f=(e,t)=>e.filter(e=>e.order_type===t&&!u.has(e.status));function y(e){let{orderType:t,limit:r=100,page:o=1,statusFilter:s=m,enabled:d=!0,refreshIntervalMs:u=15e3,events:y=p}=e,{socket:b}=(0,i.s)(),[h,v]=(0,n.useState)([]),[_,g]=(0,n.useState)(!0),x=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(d){e||g(!0);try{let e=await a.x.getAllSummary(void 0,o,r,s,t),n=f(e.data||[],t);v(e=>c()(e,n)?e:n)}catch(e){}finally{e||g(!1)}}},[d,r,t,o,s]);return(0,n.useEffect)(()=>{d&&x(!1)},[d,x,s]),(0,l.D)({socket:b,events:y,onRefresh:()=>x(!0),intervalMs:u,enabled:d,debounceMs:800}),{orders:h,isLoading:_,refresh:x}}},67697:function(e,t,r){"use strict";r.d(t,{D:function(){return i},v:function(){return o}});var n=r(2265);let a=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){var t;if("id"in e&&e.id)return e.id;if("data"in e&&(null===(t=e.data)||void 0===t?void 0:t.id))return e.data.id}};function o(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e.id,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>!0;(0,n.useEffect)(()=>{if(!e)return;let n=e=>{if(!i(e))return;let t=o(e);r(r=>r.some(e=>o(e)===t)?r:[...r,e])},l=e=>{let t=o(e);r(r=>i(e)?r.some(e=>o(e)===t)?r.map(r=>o(r)===t?e:r):[...r,e]:r.filter(e=>o(e)!==t))},s=e=>{let t=a(e);t&&r(e=>e.filter(e=>o(e)!==t))};return e.on(t.create,n),e.on(t.update,l),e.on(t.delete,s),()=>{e.off(t.create,n),e.off(t.update,l),e.off(t.delete,s)}},[e,t.create,t.update,t.delete,o,r,i])}function i(e){let{socket:t,events:r=[],onRefresh:a,intervalMs:o,enabled:i=!0,debounceMs:l}=e;(0,n.useEffect)(()=>{if(!i||!t||0===r.length)return;let e=null,n=()=>{if(!l||l<=0){a();return}e&&clearTimeout(e),e=setTimeout(()=>{e=null,a()},l)};return r.forEach(e=>t.on(e,n)),()=>{e&&clearTimeout(e),r.forEach(e=>t.off(e,n))}},[i,t,r,a,l]),(0,n.useEffect)(()=>{if(!i||!o)return;let e=setInterval(a,o);return()=>clearInterval(e)},[i,o,a])}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,2401,9,19,9845,4221,5531,5512,9385,563,2971,2117,1744],function(){return e(e.s=14468)}),_N_E=e.O()}]);