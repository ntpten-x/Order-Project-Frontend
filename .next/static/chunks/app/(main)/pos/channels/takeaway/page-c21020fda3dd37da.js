(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{14468:function(e,t,n){Promise.resolve().then(n.bind(n,42569))},42569:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var r=n(57437),a=n(29),o=n.n(a),i=n(2265),l=n(99376),s=n(39486),c=n(24783),d=n(80009),u=n(50742),m=n(47451),p=n(69410),f=n(52539),y=n(96473),b=n(5540),h=n(25193),v=n(37410),_=n(20148),g=n(2786),x=n(32446),w=n(44225),j=n(11777),k=n(25369),S=n(252),Z=n(61414),E=n(3369),T=n(33203),N=n(71096),C=n.n(N),D=n(45721),P=n.n(D);n(6729);let{Text:I}=s.default;function A(){let e=(0,l.useRouter)(),{showLoading:t,hideLoading:n}=(0,E.x)(),{orders:a,isLoading:s}=(0,T.w)({orderType:x.m.TakeAway}),N=(0,i.useMemo)(()=>(0,S.Do)(a),[a]);(0,i.useEffect)(()=>{s?t("กำลังโหลดออเดอร์..."):n()},[s,t,n]);let D=()=>{e.push("/pos/channels/takeaway/buying")},P=t=>{let n=(0,Z.M9)(t);e.push(n)},A=e=>{switch(e){case"available":return"success";case"occupied":return"orange";case"waitingForPayment":return"blue";default:return"default"}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.c,{}),(0,r.jsx)(o(),{id:j.N5.__hash,children:j.N5}),(0,r.jsx)(o(),{id:"41c2403baab2f8cd",children:".order-card-hover{-webkit-transition:all.3s cubic-bezier(.4,0,.2,1)!important;-moz-transition:all.3s cubic-bezier(.4,0,.2,1)!important;-o-transition:all.3s cubic-bezier(.4,0,.2,1)!important;transition:all.3s cubic-bezier(.4,0,.2,1)!important}.order-card-hover:hover{-webkit-transform:translatey(-4px)!important;-moz-transform:translatey(-4px)!important;-ms-transform:translatey(-4px)!important;-o-transform:translatey(-4px)!important;transform:translatey(-4px)!important;-webkit-box-shadow:0 12px 28px rgba(0,0,0,.1)!important;-moz-box-shadow:0 12px 28px rgba(0,0,0,.1)!important;box-shadow:0 12px 28px rgba(0,0,0,.1)!important}.order-card-hover:active{-webkit-transform:translatey(-2px)scale(.99)!important;-moz-transform:translatey(-2px)scale(.99)!important;-ms-transform:translatey(-2px)scale(.99)!important;-o-transform:translatey(-2px)scale(.99)!important;transform:translatey(-2px)scale(.99)!important}@media(hover:none){.order-card-hover:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.order-card-hover:hover{-webkit-transform:none!important;-moz-transform:none!important;-ms-transform:none!important;-o-transform:none!important;transform:none!important}}.back-button-hover:hover{background:rgba(255,255,255,.28)!important;-webkit-transform:translatex(-2px);-moz-transform:translatex(-2px);-ms-transform:translatex(-2px);-o-transform:translatex(-2px);transform:translatex(-2px)}.add-button-hover:hover{-webkit-transform:translatey(-2px)!important;-moz-transform:translatey(-2px)!important;-ms-transform:translatey(-2px)!important;-o-transform:translatey(-2px)!important;transform:translatey(-2px)!important;-webkit-box-shadow:0 12px 24px rgba(82,196,26,.35)!important;-moz-box-shadow:0 12px 24px rgba(82,196,26,.35)!important;box-shadow:0 12px 24px rgba(82,196,26,.35)!important}.add-button-hover:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.hide-on-mobile{display:inline!important}.show-on-mobile-inline{display:none!important}@media(max-width:768px){.hide-on-mobile{display:none!important}.show-on-mobile-inline{display:inline!important}}"}),(0,r.jsxs)("div",{style:w.Np.container,className:"jsx-41c2403baab2f8cd",children:[(0,r.jsx)(_.Z,{title:"สั่งกลับบ้าน",subtitle:(0,r.jsxs)(c.Z,{size:8,wrap:!0,children:[(0,r.jsxs)(d.Z,{children:["ทั้งหมด ",N.total]}),(0,r.jsxs)(d.Z,{color:"orange",children:["กำลังปรุง ",N.cooking]})]}),onBack:()=>{e.push("/pos/channels")},icon:(0,r.jsx)(f.Z,{style:{fontSize:20}}),actions:(0,r.jsx)(u.ZP,{type:"primary",icon:(0,r.jsx)(y.Z,{}),onClick:D,children:"เพิ่มออเดอร์"})}),(0,r.jsx)(h.Z,{children:(0,r.jsx)(v.Z,{title:"ออเดอร์",children:a.length>0?(0,r.jsx)(m.Z,{gutter:[16,16],children:a.map((e,t)=>{var n;let a=(0,S.Yx)(e),o=w.ax[a],i=e.order_no.split("-").pop();return(0,r.jsx)(p.Z,{xs:24,sm:12,md:8,lg:6,xl:6,className:"takeaway-order-col-mobile",children:(0,r.jsxs)("article",{style:{...j.yy.orderCard,border:"1.5px solid ".concat(o.border)},onClick:()=>P(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),P(e))},role:"button",tabIndex:0,"aria-label":"ออเดอร์ #".concat(i," - ").concat((0,S.NE)(e.status)),className:"jsx-41c2403baab2f8cd "+"order-card-hover takeaway-order-card table-card-animate table-card-delay-".concat(t%6+1),children:[(0,r.jsxs)("div",{style:{...j.yy.orderCardHeader,background:o.light},className:"jsx-41c2403baab2f8cd",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},className:"jsx-41c2403baab2f8cd",children:[(0,r.jsx)("div",{style:{width:40,height:40,borderRadius:12,background:"".concat(o.primary,"20"),display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-41c2403baab2f8cd",children:(0,r.jsx)(f.Z,{style:{color:o.primary,fontSize:20}})}),(0,r.jsxs)(I,{strong:!0,style:{fontSize:18,color:"#1E293B"},children:["#",i]})]}),(0,r.jsx)(d.Z,{color:A(a),style:{borderRadius:8,margin:0,fontWeight:600,border:"none",padding:"4px 12px"},children:(0,S.NE)(e.status)})]}),(0,r.jsx)("div",{style:j.yy.orderCardContent,className:"jsx-41c2403baab2f8cd",children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},className:"jsx-41c2403baab2f8cd",children:[(0,r.jsxs)("div",{className:"jsx-41c2403baab2f8cd",children:[(0,r.jsx)(I,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"รายการสินค้า"}),(0,r.jsxs)(I,{strong:!0,style:{fontSize:16},children:[e.items_count||0," รายการ"]})]}),(0,r.jsxs)("div",{style:{textAlign:"right"},className:"jsx-41c2403baab2f8cd",children:[(0,r.jsx)(I,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"ยอดรวม"}),(0,r.jsxs)(I,{strong:!0,style:{fontSize:20,color:o.primary},children:["฿",null===(n=e.total_amount)||void 0===n?void 0:n.toLocaleString()]})]})]})}),(0,r.jsxs)("div",{style:j.yy.orderCardFooter,className:"jsx-41c2403baab2f8cd",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},className:"jsx-41c2403baab2f8cd",children:[(0,r.jsx)(b.Z,{style:{fontSize:12,color:"#94A3B8"}}),(0,r.jsx)(I,{type:"secondary",style:{fontSize:12},children:C()(e.create_date).fromNow()})]}),(0,r.jsx)(d.Z,{style:{margin:0,borderRadius:6,background:w.hS.takeaway.light,color:w.hS.takeaway.primary,border:"1px solid ".concat(w.hS.takeaway.border),fontSize:11,fontWeight:600},children:"Take Away"})]})]})},e.id)})}):(0,r.jsx)(g.Z,{title:"ไม่มีออเดอร์ในขณะนี้",description:"เริ่มรับออเดอร์สั่งกลับบ้านโดยกดปุ่ม “เพิ่มออเดอร์”",action:(0,r.jsx)(u.ZP,{type:"primary",icon:(0,r.jsx)(y.Z,{}),onClick:D,children:"สร้างออเดอร์ใหม่"})})})})]})]})}C().extend(P()),C().locale("th")},2786:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(57437);n(2265);var a=n(96931),o=n(85180),i=n(39486),l=n(87530);function s(e){let{title:t="ไม่มีข้อมูล",description:n,action:s,image:c}=e;return(0,r.jsx)(a.Z,{size:"small",variant:"outlined",style:{borderRadius:l.H.cardRadiusLG},bodyStyle:{padding:20},children:(0,r.jsx)(o.Z,{image:c,description:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,r.jsx)(i.default.Text,{strong:!0,children:t}),n?(0,r.jsx)(i.default.Text,{type:"secondary",children:n}):null]}),children:s})})}},24675:function(e,t,n){"use strict";n.d(t,{s:function(){return o}});var r=n(2265),a=n(46252);let o=()=>(0,r.useContext)(a.J)},53286:function(e,t,n){"use strict";n.d(t,{x:function(){return g}});var r=n(20019),a=n(2913),o=n(71567),i=n(32446);let l=r.Ryn({id:r.Z_8(),username:r.Z_8()}).partial().nullable(),s=r.Ryn({id:r.Z_8(),display_name:r.Z_8()}).partial().nullable(),c=r.Ryn({id:r.Z_8(),display_name:r.Z_8(),img_url:r.Z_8().nullable(),price:r.oQ2.number(),category:s.optional()}).partial().nullable(),d=r.Ryn({id:r.Z_8().optional(),detail_name:r.Z_8(),extra_price:r.oQ2.number()}).partial(),u=r.Ryn({id:r.Z_8(),order_id:r.Z_8(),product_id:r.Z_8(),product_name:r.Z_8().optional(),quantity:r.oQ2.number(),price:r.oQ2.number(),total_price:r.oQ2.number(),discount_amount:r.oQ2.number().optional().default(0),notes:r.Z_8().nullable().optional(),status:r.jbo(i.i).optional(),product:c.optional(),details:r.IXX(d).optional()}),m=r.Ryn({id:r.Z_8(),order_no:r.Z_8(),order_type:r.jbo(i.m),table_id:r.Z_8().nullable().optional(),delivery_id:r.Z_8().nullable().optional(),delivery_code:r.Z_8().nullable().optional(),sub_total:r.oQ2.number(),discount_id:r.Z_8().nullable().optional(),discount_amount:r.oQ2.number(),vat:r.oQ2.number(),total_amount:r.oQ2.number(),received_amount:r.oQ2.number(),change_amount:r.oQ2.number(),status:r.jbo(i.i),created_by_id:r.Z_8().nullable().optional(),create_date:r.Z_8(),update_date:r.Z_8(),items:r.IXX(u).optional(),created_by:l.optional(),table:r.YjB().optional(),delivery:r.YjB().optional(),discount:r.YjB().optional(),payments:r.IXX(r.YjB()).optional()}),p=r.Ryn({data:r.IXX(m),total:r.oQ2.number(),page:r.oQ2.number(),last_page:r.oQ2.number().optional()}),f=r.Ryn({table_name:r.Z_8().nullable().optional(),delivery_name:r.Z_8().nullable().optional()}).partial().nullable(),y=r.Ryn({id:r.Z_8(),order_no:r.Z_8(),order_type:r.jbo(i.m),status:r.jbo(i.i),create_date:r.Z_8(),total_amount:r.oQ2.number(),delivery_code:r.Z_8().nullable().optional(),table_id:r.Z_8().nullable().optional(),delivery_id:r.Z_8().nullable().optional(),table:f.optional(),delivery:f.optional(),items_summary:r.IMB(r.Z_8(),r.oQ2.number()).optional(),items_count:r.oQ2.number().optional()}),b=r.Ryn({data:r.IXX(y),total:r.oQ2.number(),page:r.oQ2.number(),last_page:r.oQ2.number().optional()});var h=n(98170);let v=o.q.POS.ORDERS,_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},g={getAll:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:t.toString(),limit:n.toString(),...o&&{status:o},...i&&{type:i},...l&&{q:l}}),c="".concat(v,"?").concat(s.toString()),d=(0,a.b)("GET",c),u=_(e,""),m=await fetch(d,{cache:"no-store",headers:u,credentials:"include"});if(!m.ok){let e=await m.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let f=await m.json();try{return p.parse((0,h.XO)(f))}catch(e){throw console.error("Zod Validation Error in ordersService.getAll:",e),e instanceof r.jmq&&console.error("Zod Issues:",e.issues),e}},getAllSummary:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:t.toString(),limit:n.toString(),...o&&{status:o},...i&&{type:i},...l&&{q:l}}),c="".concat(v,"/summary?").concat(s.toString()),d=(0,a.b)("GET",c),u=_(e,""),m=await fetch(d,{cache:"no-store",headers:u,credentials:"include"});if(!m.ok){let e=await m.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let p=await m.json();try{return b.parse((0,h.XO)(p))}catch(e){throw console.error("Zod Validation Error in ordersService.getAllSummary:",e),e instanceof r.jmq&&console.error("Zod Issues:",e.issues),e}},getStats:async e=>{let t=(0,a.b)("GET",o.q.POS.CHANNELS.STATS),n=_(e,""),r=await fetch(t,{cache:"no-store",headers:n,credentials:"include"});if(!r.ok){let e=await r.text();console.error("Order Stats Backend Error:",e);let t=await JSON.parse(e).catch(()=>({}));throw Error((0,h.i_)(t,"ไม่สามารถดึงข้อมูลสถิติได้"))}let i=await r.json();return(0,h.hH)(i)},getById:async(e,t)=>{let n=(0,a.b)("GET","".concat(v,"/").concat(e)),o=_(t,""),i=await fetch(n,{cache:"no-store",headers:o,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let l=await i.json();try{let e=(0,h.hH)(l);if(Array.isArray(e)){if(0===e.length)throw Error("Order not found");return m.parse(e[0])}return m.parse(e)}catch(e){throw console.error("Zod Validation Error in ordersService.getById:",e),e instanceof r.jmq&&console.error("Zod Issues:",e.issues),e}},create:async(e,t,n)=>{let r=(0,a.b)("POST","".concat(v)),o=_(t);n&&(o["X-CSRF-Token"]=n);let i=await fetch(r,{method:"POST",headers:o,credentials:"include",body:JSON.stringify(e)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถสร้างออเดอร์ได้"))}return(0,h.hH)(await i.json())},update:async(e,t,n,r)=>{let o=(0,a.b)("PUT","".concat(v,"/").concat(e)),i=_(n);r&&(i["X-CSRF-Token"]=r);let l=await fetch(o,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถแก้ไขออเดอร์ได้"))}return(0,h.hH)(await l.json())},delete:async(e,t,n)=>{let r=(0,a.b)("DELETE","".concat(v,"/").concat(e)),o=_(t,"");n&&(o["X-CSRF-Token"]=n);let i=await fetch(r,{method:"DELETE",headers:o,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถลบออเดอร์ได้"))}},updateItemStatus:async(e,t,n,r)=>{let o=(0,a.b)("PATCH","".concat(v,"/items/").concat(e,"/status")),i=_(n);r&&(i["X-CSRF-Token"]=r);let l=await fetch(o,{method:"PATCH",headers:i,credentials:"include",body:JSON.stringify({status:t})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถอัปเดตสถานะรายการได้"))}},getItems:async(e,t)=>{let n=(0,a.b)("GET","".concat(v,"/items").concat(e?"?status=".concat(e):"")),r=_(t,""),o=await fetch(n,{cache:"no-store",headers:r,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถดึงข้อมูลรายการได้"))}let i=(0,h.hH)(await o.json());if(Array.isArray(i))return i;if(i&&"object"==typeof i&&"data"in i){let e=i.data;if(Array.isArray(e))return e}return i},addItem:async(e,t,n,r)=>{let o=(0,a.b)("POST","".concat(v,"/").concat(e,"/items")),i=_(n);r&&(i["X-CSRF-Token"]=r);let l=await fetch(o,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถเพิ่มรายการได้"))}return(0,h.hH)(await l.json())},updateItem:async(e,t,n,r)=>{let o=(0,a.b)("PUT","".concat(v,"/items/").concat(e)),i=_(n,"application/json");r&&(i["X-CSRF-Token"]=r);let l=await fetch(o,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถแก้ไขรายการได้"))}return(0,h.hH)(await l.json())},deleteItem:async(e,t,n)=>{let r=(0,a.b)("DELETE","".concat(v,"/items/").concat(e)),o=_(t,"");n&&(o["X-CSRF-Token"]=n);let i=await fetch(r,{method:"DELETE",headers:o,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,h.i_)(e,"ไม่สามารถลบรายการได้"))}return(0,h.hH)(await i.json())},updateStatus:async(e,t,n)=>{let r={"Content-Type":"application/json"};n&&(r["X-CSRF-Token"]=n);let o=(0,a.b)("PUT","".concat(v,"/").concat(e));if(!(await fetch(o,{method:"PUT",headers:r,body:JSON.stringify({status:t}),credentials:"include"})).ok)throw Error("Failed to update status")}}},34962:function(e,t,n){"use strict";var r,a;n.d(t,{c:function(){return r}}),(a=r||(r={})).Available="Available",a.Unavailable="Unavailable"},252:function(e,t,n){"use strict";n.d(t,{NE:function(){return c},Th:function(){return l},Do:function(){return d},Yx:function(){return u},Zu:function(){return m},Oi:function(){return s},W9:function(){return o},Tf:function(){return i}});var r=n(34962),a=n(32446);function o(e){let t={total:e.length,available:0,occupied:0,inactive:0};return e.forEach(e=>{e.is_active?e.status===r.c.Available?t.available++:t.occupied++:t.inactive++}),t}function i(e){return[...e].sort((e,t)=>{let n=parseInt(e.table_name.replace(/\D/g,"")),r=parseInt(t.table_name.replace(/\D/g,""));return isNaN(n)||isNaN(r)?e.table_name.localeCompare(t.table_name):n-r})}function l(e){return e.filter(e=>e.is_active)}function s(e){return e.is_active?"WaitingForPayment"===e.active_order_status?"waitingForPayment":e.status===r.c.Available?"available":"occupied":"inactive"}function c(e){return e?({Pending:"กำลังดำเนินการ",Cooking:"กำลังปรุง",Served:"เสิร์ฟแล้ว",WaitingForOrder:"รอรับออเดอร์",WaitingForPayment:"รอชำระเงิน",Paid:"ชำระเงินแล้ว",Completed:"เสร็จสมบูรณ์",Cancelled:"ยกเลิก"})[e]||e:""}function d(e){return e.reduce((e,t)=>(e.total++,t.status===a.i.Pending&&e.pending++,t.status===a.i.Cooking&&e.cooking++,t.status===a.i.Served&&e.served++,e),{total:0,pending:0,cooking:0,served:0})}function u(e){switch(e.status){case a.i.Pending:case a.i.Cooking:return"occupied";case a.i.Served:return"waitingForPayment";case a.i.Paid:return"available";default:return"inactive"}}let m=e=>{switch(e){case a.m.DineIn:case"DineIn":return"/pos/channels/dine-in";case a.m.TakeAway:case"TakeAway":return"/pos/channels/takeaway";case a.m.Delivery:case"Delivery":return"/pos/channels/delivery";default:return"/pos/orders"}}},61414:function(e,t,n){"use strict";n.d(t,{EO:function(){return g},Gs:function(){return s},HL:function(){return x},M9:function(){return w},Nz:function(){return y},OY:function(){return i},Rr:function(){return v},Wl:function(){return o},d$:function(){return j},d7:function(){return l},iN:function(){return u},jN:function(){return f},ku:function(){return h},mz:function(){return c},qO:function(){return d},xG:function(){return p},yj:function(){return _},zP:function(){return m},zf:function(){return k}});var r=n(32446),a=n(34962);let o=e=>{var t,n;if(e.status===a.c.Available)return"/pos/channels/dine-in/".concat(e.id);let o=e.active_order_id||(null===(t=e.active_order)||void 0===t?void 0:t.id),i=e.active_order_status||(null===(n=e.active_order)||void 0===n?void 0:n.status);return o?i===r.i.WaitingForPayment?"/pos/items/payment/".concat(o):"/pos/orders/".concat(o):"/pos/channels/dine-in/".concat(e.id)},i=e=>{switch(e){case r.i.Pending:return"orange";case r.i.Cooking:return"blue";case r.i.Served:return"green";case r.i.Paid:return"cyan";case r.i.Cancelled:return"red";case r.i.WaitingForPayment:return"gold";default:return"default"}},l=(e,t)=>{switch(e){case r.i.Pending:return"กำลังดำเนินการ";case r.i.Cooking:return"กำลังปรุง";case r.i.Served:if("TakeAway"===t||"Delivery"===t)return"ทำแล้ว";return"เสิร์ฟแล้ว";case r.i.Paid:return"ชำระเงินแล้ว";case r.i.Completed:return"สำเร็จ";case r.i.Cancelled:return"ยกเลิก";case r.i.WaitingForPayment:return"รอชำระเงิน";default:return e}},s=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},c=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},d=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",u=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",m=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",p=e=>{let t="string"==typeof e?parseFloat(e):e;return"฿".concat(Number(t).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2}))},f=e=>{var t,n;return"DineIn"===e.order_type?(null===(t=e.table)||void 0===t?void 0:t.table_name)||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||(null===(n=e.delivery)||void 0===n?void 0:n.delivery_name)||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A"},y=e=>(null!=e?e:[]).filter(e=>e.status!==r.i.Cancelled),b=e=>(null!=e?e:[]).reduce((e,t)=>e+(Number(t.extra_price)||0),0),h=(e,t,n)=>((Number(e)||0)+b(n))*t,v=e=>y(e).reduce((e,t)=>{var n,r;let a=(null===(r=t.product)||void 0===r?void 0:null===(n=r.category)||void 0===n?void 0:n.display_name)||"ไม่ระบุหมวด";return e[a]=(e[a]||0)+(t.quantity||0),e},{}),_=e=>y(e).reduce((e,t)=>e+Number(t.total_price||0),0),g=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",x=e=>"/pos/orders/".concat(e),w=e=>e.status===r.i.WaitingForPayment?e.order_type===r.m.Delivery?"/pos/items/delivery/".concat(e.id):"/pos/items/payment/".concat(e.id):"/pos/orders/".concat(e.id),j=e=>e===r.m.Delivery?"/pos/channels/delivery":e===r.m.TakeAway?"/pos/channels/takeaway":e===r.m.DineIn?"/pos/channels/dine-in":"/pos/channels",k=(e,t,n,a)=>({order_no:a.orderNo||"ORD-".concat(Date.now()),order_type:t,sub_total:n.subTotal,discount_amount:n.discountAmount,vat:0,total_amount:n.totalAmount,received_amount:0,change_amount:0,status:r.i.Pending,discount_id:a.discountId||null,payment_method_id:null,table_id:a.tableId||null,delivery_id:a.deliveryId||null,delivery_code:a.deliveryCode||null,items:e.map(e=>{var n;let a=t===r.m.Delivery?Number(null!==(n=e.product.price_delivery)&&void 0!==n?n:e.product.price):Number(e.product.price),o=(a+(e.details||[]).reduce((e,t)=>e+Number(t.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:a,total_price:o,discount_amount:0,notes:e.notes||"",status:r.i.Cooking,details:e.details||[]}})})},33203:function(e,t,n){"use strict";n.d(t,{w:function(){return y}});var r=n(2265),a=n(53286),o=n(32446),i=n(24675),l=n(67697),s=n(21652),c=n.n(s),d=n(12028);let u=new Set([o.i.Paid,o.i.Completed,o.i.Cancelled]),m=[o.i.Pending,o.i.Cooking,o.i.Served,o.i.WaitingForPayment].join(","),p=[d.b.orders.create,d.b.orders.update,d.b.orders.delete,d.b.payments.create,d.b.payments.update,d.b.salesOrderItem.create,d.b.salesOrderItem.update,d.b.salesOrderItem.delete,d.b.salesOrderDetail.create,d.b.salesOrderDetail.update,d.b.salesOrderDetail.delete],f=(e,t)=>e.filter(e=>e.order_type===t&&!u.has(e.status));function y(e){let{orderType:t,limit:n=100,page:o=1,statusFilter:s=m,enabled:d=!0,refreshIntervalMs:u=15e3,events:y=p}=e,{socket:b}=(0,i.s)(),[h,v]=(0,r.useState)([]),[_,g]=(0,r.useState)(!0),x=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(d){e||g(!0);try{let e=await a.x.getAllSummary(void 0,o,n,s,t),r=f(e.data||[],t);v(e=>c()(e,r)?e:r)}catch(e){}finally{e||g(!1)}}},[d,n,t,o,s]);return(0,r.useEffect)(()=>{d&&x(!1)},[d,x,s]),(0,l.D)({socket:b,events:y,onRefresh:()=>x(!0),intervalMs:u,enabled:d,debounceMs:800}),{orders:h,isLoading:_,refresh:x}}},67697:function(e,t,n){"use strict";n.d(t,{D:function(){return i},v:function(){return o}});var r=n(2265);let a=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){var t;if("id"in e&&e.id)return e.id;if("data"in e&&(null===(t=e.data)||void 0===t?void 0:t.id))return e.data.id}};function o(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e.id,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>!0;(0,r.useEffect)(()=>{if(!e)return;let r=e=>{if(!i(e))return;let t=o(e);n(n=>n.some(e=>o(e)===t)?n:[...n,e])},l=e=>{let t=o(e);n(n=>i(e)?n.some(e=>o(e)===t)?n.map(n=>o(n)===t?e:n):[...n,e]:n.filter(e=>o(e)!==t))},s=e=>{let t=a(e);t&&n(e=>e.filter(e=>o(e)!==t))};return e.on(t.create,r),e.on(t.update,l),e.on(t.delete,s),()=>{e.off(t.create,r),e.off(t.update,l),e.off(t.delete,s)}},[e,t.create,t.update,t.delete,o,n,i])}function i(e){let{socket:t,events:n=[],onRefresh:a,intervalMs:o,enabled:i=!0,debounceMs:l}=e;(0,r.useEffect)(()=>{if(!i||!t||0===n.length)return;let e=null,r=()=>{if(!l||l<=0){a();return}e&&clearTimeout(e),e=setTimeout(()=>{e=null,a()},l)};return n.forEach(e=>t.on(e,r)),()=>{e&&clearTimeout(e),n.forEach(e=>t.off(e,r))}},[i,t,n,a,l]),(0,r.useEffect)(()=>{if(!i||!o)return;let e=setInterval(a,o);return()=>clearInterval(e)},[i,o,a])}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,2401,9,19,9845,4221,5531,5512,9385,563,2971,2117,1744],function(){return e(e.s=14468)}),_N_E=e.O()}]);