(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2851],{2727:function(e,t,n){Promise.resolve().then(n.bind(n,5727))},67605:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2265),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},a=n(55015);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var u=r.forwardRef((e,t)=>r.createElement(a.Z,o({},e,{ref:t,icon:i})))},5727:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(57437),i=n(2265),a=n(99376),o=n(34029),u=n(67605),c=n(8949),d=n(53286),s=n(61414),l=n(252),f=n(32446),y=n(3369),v=n(77961),p=n(97235);function m(e){let{providerId:t,deliveryCode:n}=e,{showLoading:m,hideLoading:_}=(0,y.x)(),[h,g]=(0,i.useState)(""),b=(0,a.useRouter)();(0,i.useEffect)(()=>{(async()=>{m();let e=await (0,p.P)();e&&g(e),_()})()},[m,_]);let{cartItems:D,clearCart:w,getSubtotal:k,getDiscountAmount:I,getFinalPrice:C,selectedDiscount:P,setOrderMode:N,setReferenceId:z,setReferenceCode:A}=(0,c.j)();(0,i.useEffect)(()=>{N("DELIVERY"),z(t),A(n)},[t,n,N,z,A]);let O=async()=>{m();try{let e=(0,s.zf)(D,f.m.Delivery,{subTotal:k(),discountAmount:I(),totalAmount:C()},{discountId:null==P?void 0:P.id,deliveryId:t,deliveryCode:n});await d.x.create(e,void 0,h),o.ZP.success("สร้างออเดอร์เรียบร้อยแล้ว"),w(),b.push((0,l.Zu)(f.m.Delivery))}catch(e){o.ZP.error(e instanceof Error?e.message:"ไม่สามารถทำรายการได้")}finally{_()}};return(0,r.jsx)(v.Z,{title:"เดริเวอรี่ (Delivery)",subtitle:"เดลิเวอรี่ ".concat(n),icon:(0,r.jsx)(u.Z,{style:{fontSize:28}}),onConfirmOrder:O})}function _(e){let{params:t,searchParams:n}=e;return(0,r.jsx)(m,{providerId:t.providerId,deliveryCode:n.code})}},61414:function(e,t,n){"use strict";n.d(t,{EO:function(){return b},Gs:function(){return c},HL:function(){return D},M9:function(){return w},Nz:function(){return p},OY:function(){return o},Rr:function(){return h},Wl:function(){return a},d$:function(){return k},d7:function(){return u},iN:function(){return l},jN:function(){return v},ku:function(){return _},mz:function(){return d},qO:function(){return s},xG:function(){return y},yj:function(){return g},zP:function(){return f},zf:function(){return I}});var r=n(32446),i=n(34962);let a=e=>{var t,n;if(e.status===i.c.Available)return"/pos/channels/dine-in/".concat(e.id);let a=e.active_order_id||(null===(t=e.active_order)||void 0===t?void 0:t.id),o=e.active_order_status||(null===(n=e.active_order)||void 0===n?void 0:n.status);return a?o===r.i.WaitingForPayment?"/pos/items/payment/".concat(a):"/pos/orders/".concat(a):"/pos/channels/dine-in/".concat(e.id)},o=e=>{switch(e){case r.i.Pending:return"orange";case r.i.Cooking:return"blue";case r.i.Served:return"green";case r.i.Paid:return"cyan";case r.i.Cancelled:return"red";case r.i.WaitingForPayment:return"gold";default:return"default"}},u=(e,t)=>{switch(e){case r.i.Pending:return"กำลังดำเนินการ";case r.i.Cooking:return"กำลังปรุง";case r.i.Served:if("TakeAway"===t||"Delivery"===t)return"ทำแล้ว";return"เสิร์ฟแล้ว";case r.i.Paid:return"ชำระเงินแล้ว";case r.i.Completed:return"สำเร็จ";case r.i.Cancelled:return"ยกเลิก";case r.i.WaitingForPayment:return"รอชำระเงิน";default:return e}},c=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},d=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},s=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",l=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",f=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",y=e=>{let t="string"==typeof e?parseFloat(e):e;return"฿".concat(Number(t).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2}))},v=e=>{var t,n;return"DineIn"===e.order_type?(null===(t=e.table)||void 0===t?void 0:t.table_name)||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||(null===(n=e.delivery)||void 0===n?void 0:n.delivery_name)||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A"},p=e=>(null!=e?e:[]).filter(e=>e.status!==r.i.Cancelled),m=e=>(null!=e?e:[]).reduce((e,t)=>e+(Number(t.extra_price)||0),0),_=(e,t,n)=>((Number(e)||0)+m(n))*t,h=e=>p(e).reduce((e,t)=>{var n,r;let i=(null===(r=t.product)||void 0===r?void 0:null===(n=r.category)||void 0===n?void 0:n.display_name)||"ไม่ระบุหมวด";return e[i]=(e[i]||0)+(t.quantity||0),e},{}),g=e=>p(e).reduce((e,t)=>e+Number(t.total_price||0),0),b=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",D=e=>"/pos/orders/".concat(e),w=e=>e.status===r.i.WaitingForPayment?e.order_type===r.m.Delivery?"/pos/items/delivery/".concat(e.id):"/pos/items/payment/".concat(e.id):"/pos/orders/".concat(e.id),k=e=>e===r.m.Delivery?"/pos/channels/delivery":e===r.m.TakeAway?"/pos/channels/takeaway":e===r.m.DineIn?"/pos/channels/dine-in":"/pos/channels",I=(e,t,n,i)=>({order_no:i.orderNo||"ORD-".concat(Date.now()),order_type:t,sub_total:n.subTotal,discount_amount:n.discountAmount,vat:0,total_amount:n.totalAmount,received_amount:0,change_amount:0,status:r.i.Pending,discount_id:i.discountId||null,payment_method_id:null,table_id:i.tableId||null,delivery_id:i.deliveryId||null,delivery_code:i.deliveryCode||null,items:e.map(e=>{let t=Number(e.product.price),n=(t+(e.details||[]).reduce((e,t)=>e+Number(t.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:t,total_price:n,discount_amount:0,notes:e.notes||"",status:r.i.Cooking,details:e.details||[]}})})}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,9,5616,8589,5496,3834,19,8056,4547,9763,5713,9356,5799,3680,5101,2971,2117,1744],function(){return e(e.s=2727)}),_N_E=e.O()}]);