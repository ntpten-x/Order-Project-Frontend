(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1966],{93106:function(e,t,a){Promise.resolve().then(a.bind(a,88560))},88560:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var n=a(57437),o=a(29),r=a.n(o),i=a(2265),l=a(99376),c=a(39486),s=a(47451),d=a(69410),u=a(62376),h=a(52539),p=a(67605),b=a(44225),y=a(11777),m=a(25369),_=a(29827),f=a(11713),w=a(46252),j=a(53286),g=a(12028),v=a(3369),S=a(42785),E=a(25193),Z=a(37410),k=a(20148);let{Title:T,Text:x}=c.default;function C(){var e,t,a;let o=(0,l.useRouter)(),{showLoading:c,hideLoading:C}=(0,v.x)(),{stats:N,isLoading:R}=function(){let{socket:e}=(0,i.useContext)(w.J),t=(0,_.NL)(),{data:a,error:n,isLoading:o}=(0,f.a)({queryKey:["channelStats"],queryFn:async()=>await j.x.getStats(),staleTime:2e3,refetchOnReconnect:!0});return(0,i.useEffect)(()=>{if(!e)return;let a=()=>{t.invalidateQueries({queryKey:["channelStats"]})};return e.on(g.b.orders.create,a),e.on(g.b.orders.update,a),e.on(g.b.orders.delete,a),()=>{e.off(g.b.orders.create,a),e.off(g.b.orders.update,a),e.off(g.b.orders.delete,a)}},[e,t]),{stats:a,isLoading:o,isError:n}}();(0,S.DR)(),(0,i.useEffect)(()=>{o.prefetch("/pos/channels/dine-in"),o.prefetch("/pos/channels/takeaway"),o.prefetch("/pos/channels/delivery")},[o]),i.useEffect(()=>{R?c():C()},[R,c,C]);let I=[{id:"dine-in",title:"หน้าร้าน",subtitle:"Dine In",description:"รับออเดอร์ลูกค้าที่มานั่งทานที่ร้าน",icon:u.Z,colors:b.hS.dineIn,path:"/pos/channels/dine-in",count:null!==(e=null==N?void 0:N.dineIn)&&void 0!==e?e:0},{id:"takeaway",title:"สั่งกลับบ้าน",subtitle:"Take Away",description:"รับออเดอร์ลูกค้าที่สั่งกลับบ้าน",icon:h.Z,colors:b.hS.takeaway,path:"/pos/channels/takeaway",count:null!==(t=null==N?void 0:N.takeaway)&&void 0!==t?t:0},{id:"delivery",title:"เดลิเวอรี่",subtitle:"Delivery",description:"รับออเดอร์จัดส่งถึงบ้านลูกค้า",icon:p.Z,colors:b.hS.delivery,path:"/pos/channels/delivery",count:null!==(a=null==N?void 0:N.delivery)&&void 0!==a?a:0}],Q=e=>{o.push(e)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.Z,{title:"ช่องทางขาย",subtitle:"เลือกช่องทางขาย"}),(0,n.jsx)(E.Z,{children:(0,n.jsxs)(Z.Z,{children:[(0,n.jsx)(m.c,{}),(0,n.jsx)(r(),{id:y.N5.__hash,children:y.N5}),(0,n.jsx)("div",{style:y.jr.channelsContainer,children:(0,n.jsx)("main",{style:y.jr.channelsCardsContainer,role:"main",className:"channels-cards-container-mobile",children:(0,n.jsx)(s.Z,{gutter:[20,20],justify:"center",children:I.map((e,t)=>{var a;let o=e.icon,r=e.count>0;return(0,n.jsx)(d.Z,{xs:24,sm:24,md:12,lg:8,children:(0,n.jsx)("article",{style:y.jr.channelCard,onClick:()=>Q(e.path),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),Q(e.path))},role:"button",tabIndex:0,"aria-label":"".concat(e.title," - ").concat(e.subtitle,". ").concat(r?"".concat(e.count," ออเดอร์กำลังดำเนินการ"):"ไม่มีออเดอร์"),className:"channel-card-hover fade-in-up card-delay-".concat(t+1),children:(0,n.jsxs)("div",{style:y.jr.channelCardInner,className:"channels-card-inner-mobile",children:[(0,n.jsxs)("div",{style:{...y.jr.channelIconWrapper,background:e.colors.light,border:"2px solid ".concat(e.colors.border)},className:"icon-wrapper channels-icon-wrapper-mobile",children:[(0,n.jsx)("div",{style:{...y.jr.channelDecorativeGlow,background:e.colors.gradient},className:"decorative-glow"}),(0,n.jsx)(o,{style:{...y.jr.channelIcon,color:e.colors.primary},"aria-hidden":"true",className:"channels-channel-icon-mobile"})]}),(0,n.jsx)(T,{level:2,style:y.jr.channelCardTitle,className:"channels-card-title-mobile",children:e.title}),(0,n.jsx)(x,{style:y.jr.channelCardSubtitle,className:"channels-card-subtitle-mobile",children:e.subtitle}),(0,n.jsxs)("div",{style:{...y.jr.channelStatsBadge,background:r?e.colors.light:"#F8FAFC",color:r?e.colors.primary:"#94A3B8",border:"1.5px solid ".concat(r?e.colors.border:"#E2E8F0")},"aria-live":"polite",className:"channels-stats-badge-mobile",children:[r&&(0,n.jsx)("span",{style:{...y.jr.channelActiveIndicator,background:e.colors.primary,boxShadow:"0 0 0 2px ".concat(e.colors.light)},"aria-hidden":"true",className:"pulse-animation"}),(0,n.jsx)("span",{style:{fontWeight:600},children:0===(a=e.count)?"ว่าง":1===a?"1 ออเดอร์":"".concat(a," ออเดอร์")})]})]})})},e.id)})})})})]})})]})}},53286:function(e,t,a){"use strict";a.d(t,{x:function(){return j}});var n=a(20019),o=a(2913),r=a(71567),i=a(32446);let l=n.Ryn({id:n.Z_8(),username:n.Z_8()}).partial().nullable(),c=n.Ryn({id:n.Z_8(),display_name:n.Z_8()}).partial().nullable(),s=n.Ryn({id:n.Z_8(),display_name:n.Z_8(),img_url:n.Z_8().nullable(),price:n.oQ2.number(),category:c.optional()}).partial().nullable(),d=n.Ryn({id:n.Z_8().optional(),detail_name:n.Z_8(),extra_price:n.oQ2.number()}).partial(),u=n.Ryn({id:n.Z_8(),order_id:n.Z_8(),product_id:n.Z_8(),product_name:n.Z_8().optional(),quantity:n.oQ2.number(),price:n.oQ2.number(),total_price:n.oQ2.number(),discount_amount:n.oQ2.number().optional().default(0),notes:n.Z_8().nullable().optional(),status:n.jbo(i.i).optional(),product:s.optional(),details:n.IXX(d).optional()}),h=n.Ryn({id:n.Z_8(),order_no:n.Z_8(),order_type:n.jbo(i.m),table_id:n.Z_8().nullable().optional(),delivery_id:n.Z_8().nullable().optional(),delivery_code:n.Z_8().nullable().optional(),sub_total:n.oQ2.number(),discount_id:n.Z_8().nullable().optional(),discount_amount:n.oQ2.number(),vat:n.oQ2.number(),total_amount:n.oQ2.number(),received_amount:n.oQ2.number(),change_amount:n.oQ2.number(),status:n.jbo(i.i),created_by_id:n.Z_8().nullable().optional(),create_date:n.Z_8(),update_date:n.Z_8(),items:n.IXX(u).optional(),created_by:l.optional(),table:n.YjB().optional(),delivery:n.YjB().optional(),discount:n.YjB().optional(),payments:n.IXX(n.YjB()).optional()}),p=n.Ryn({data:n.IXX(h),total:n.oQ2.number(),page:n.oQ2.number(),last_page:n.oQ2.number().optional()}),b=n.Ryn({table_name:n.Z_8().nullable().optional(),delivery_name:n.Z_8().nullable().optional()}).partial().nullable(),y=n.Ryn({id:n.Z_8(),order_no:n.Z_8(),order_type:n.jbo(i.m),status:n.jbo(i.i),create_date:n.Z_8(),total_amount:n.oQ2.number(),delivery_code:n.Z_8().nullable().optional(),table_id:n.Z_8().nullable().optional(),delivery_id:n.Z_8().nullable().optional(),table:b.optional(),delivery:b.optional(),items_summary:n.IMB(n.Z_8(),n.oQ2.number()).optional(),items_count:n.oQ2.number().optional()}),m=n.Ryn({data:n.IXX(y),total:n.oQ2.number(),page:n.oQ2.number(),last_page:n.oQ2.number().optional()});var _=a(98170);let f=r.q.POS.ORDERS,w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",a={};return t&&(a["Content-Type"]=t),e&&(a.Cookie=e),a},j={getAll:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,c=new URLSearchParams({page:t.toString(),limit:a.toString(),...r&&{status:r},...i&&{type:i},...l&&{q:l}}),s="".concat(f,"?").concat(c.toString()),d=(0,o.b)("GET",s),u=w(e,""),h=await fetch(d,{cache:"no-store",headers:u,credentials:"include"});if(!h.ok){let e=await h.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let b=await h.json();try{return p.parse((0,_.XO)(b))}catch(e){throw console.error("Zod Validation Error in ordersService.getAll:",e),e instanceof n.jmq&&console.error("Zod Issues:",e.issues),e}},getAllSummary:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0,c=new URLSearchParams({page:t.toString(),limit:a.toString(),...r&&{status:r},...i&&{type:i},...l&&{q:l}}),s="".concat(f,"/summary?").concat(c.toString()),d=(0,o.b)("GET",s),u=w(e,""),h=await fetch(d,{cache:"no-store",headers:u,credentials:"include"});if(!h.ok){let e=await h.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let p=await h.json();try{return m.parse((0,_.XO)(p))}catch(e){throw console.error("Zod Validation Error in ordersService.getAllSummary:",e),e instanceof n.jmq&&console.error("Zod Issues:",e.issues),e}},getStats:async e=>{let t=(0,o.b)("GET",r.q.POS.CHANNELS.STATS),a=w(e,""),n=await fetch(t,{cache:"no-store",headers:a,credentials:"include"});if(!n.ok){let e=await n.text();console.error("Order Stats Backend Error:",e);let t=await JSON.parse(e).catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถดึงข้อมูลสถิติได้"))}let i=await n.json();return(0,_.hH)(i)},getById:async(e,t)=>{let a=(0,o.b)("GET","".concat(f,"/").concat(e)),r=w(t,""),i=await fetch(a,{cache:"no-store",headers:r,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let l=await i.json();try{let e=(0,_.hH)(l);if(Array.isArray(e)){if(0===e.length)throw Error("Order not found");return h.parse(e[0])}return h.parse(e)}catch(e){throw console.error("Zod Validation Error in ordersService.getById:",e),e instanceof n.jmq&&console.error("Zod Issues:",e.issues),e}},create:async(e,t,a)=>{let n=(0,o.b)("POST","".concat(f)),r=w(t);a&&(r["X-CSRF-Token"]=a);let i=await fetch(n,{method:"POST",headers:r,credentials:"include",body:JSON.stringify(e)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถสร้างออเดอร์ได้"))}return(0,_.hH)(await i.json())},update:async(e,t,a,n)=>{let r=(0,o.b)("PUT","".concat(f,"/").concat(e)),i=w(a);n&&(i["X-CSRF-Token"]=n);let l=await fetch(r,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถแก้ไขออเดอร์ได้"))}return(0,_.hH)(await l.json())},delete:async(e,t,a)=>{let n=(0,o.b)("DELETE","".concat(f,"/").concat(e)),r=w(t,"");a&&(r["X-CSRF-Token"]=a);let i=await fetch(n,{method:"DELETE",headers:r,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถลบออเดอร์ได้"))}},updateItemStatus:async(e,t,a,n)=>{let r=(0,o.b)("PATCH","".concat(f,"/items/").concat(e,"/status")),i=w(a);n&&(i["X-CSRF-Token"]=n);let l=await fetch(r,{method:"PATCH",headers:i,credentials:"include",body:JSON.stringify({status:t})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถอัปเดตสถานะรายการได้"))}},getItems:async(e,t)=>{let a=(0,o.b)("GET","".concat(f,"/items").concat(e?"?status=".concat(e):"")),n=w(t,""),r=await fetch(a,{cache:"no-store",headers:n,credentials:"include"});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถดึงข้อมูลรายการได้"))}let i=(0,_.hH)(await r.json());if(Array.isArray(i))return i;if(i&&"object"==typeof i&&"data"in i){let e=i.data;if(Array.isArray(e))return e}return i},addItem:async(e,t,a,n)=>{let r=(0,o.b)("POST","".concat(f,"/").concat(e,"/items")),i=w(a);n&&(i["X-CSRF-Token"]=n);let l=await fetch(r,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถเพิ่มรายการได้"))}return(0,_.hH)(await l.json())},updateItem:async(e,t,a,n)=>{let r=(0,o.b)("PUT","".concat(f,"/items/").concat(e)),i=w(a,"application/json");n&&(i["X-CSRF-Token"]=n);let l=await fetch(r,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(t)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถแก้ไขรายการได้"))}return(0,_.hH)(await l.json())},deleteItem:async(e,t,a)=>{let n=(0,o.b)("DELETE","".concat(f,"/items/").concat(e)),r=w(t,"");a&&(r["X-CSRF-Token"]=a);let i=await fetch(n,{method:"DELETE",headers:r,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถลบรายการได้"))}return(0,_.hH)(await i.json())},updateStatus:async(e,t,a)=>{let n={"Content-Type":"application/json"};a&&(n["X-CSRF-Token"]=a);let r=(0,o.b)("PUT","".concat(f,"/").concat(e));if(!(await fetch(r,{method:"PUT",headers:n,body:JSON.stringify({status:t}),credentials:"include"})).ok)throw Error("Failed to update status")}}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,2401,19,4221,9763,1713,3381,9385,563,2785,2971,2117,1744],function(){return e(e.s=93106)}),_N_E=e.O()}]);