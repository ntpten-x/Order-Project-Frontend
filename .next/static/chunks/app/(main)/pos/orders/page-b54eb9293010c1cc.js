(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4900],{62121:function(e,t,r){Promise.resolve().then(r.bind(r,23191))},23191:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Y}});var l=r(57437),n=r(29),a=r.n(n),s=r(42785),i=r(2265),o=r(60283),d=r(38616),c=r(80009),y=r(23496),u=r(50742),x=r(24783),m=r(88589),g=r(96931),h=r(35631),p=r(6520),j=r(63680),f=r(89245),v=r(5540),b=r(99376),Z=r(32446),_=r(61414),k=r(1165),S=r(12093),w=r(11713),L=r(45345),C=r(53286),z=r(71096),D=r.n(z);r(6729);var N=r(25193),P=r(37410),B=r(20148),H=r(2786),I=r(73179);function R(e){let{emptyTitle:t="ไม่มีข้อมูล",emptyDescription:r,emptyAction:n,emptyImage:a,scroll:s,locale:i,pagination:o,...d}=e;return(0,l.jsx)(I.Z,{...d,scroll:{x:"max-content",...s},pagination:void 0===o?{size:"small"}:o,locale:{...i,emptyText:(0,l.jsx)("div",{style:{padding:16},children:(0,l.jsx)(H.Z,{title:t,description:r,action:n,image:a})})}})}var W=r(30290),E=r(36799);let{Text:T}=o.default,{useBreakpoint:A}=d.default;function Y(){let e=(0,b.useRouter)(),t=!A().md;(0,s.yV)();let[r,n]=(0,i.useState)(1),[o,d]=(0,i.useState)(""),z=(0,S.c)(o.trim(),400);(0,i.useEffect)(()=>{n(1)},[z]);let{orders:I,total:Y,isLoading:G,isFetching:O,isError:F,refetch:M}=function(e){let{page:t=1,limit:r=50,status:l,type:n,query:a}=e,{data:s,error:i,isLoading:o,isFetching:d,refetch:c}=(0,w.a)({queryKey:["ordersSummary",t,r,l||"all",n||"all",a||""],queryFn:async()=>await C.x.getAllSummary(void 0,t,r,l,n,a),placeholderData:L.Wk,staleTime:3e3});return{orders:(null==s?void 0:s.data)||[],total:(null==s?void 0:s.total)||0,currentPage:(null==s?void 0:s.page)||t,lastPage:(null==s?void 0:s.last_page)||1,isLoading:o,isFetching:d,isError:i,refetch:c}}({page:r,limit:10,status:"Pending,Cooking,Served,WaitingForPayment",query:z||void 0}),q=(0,i.useMemo)(()=>{let e=I.filter(e=>e.status===Z.i.Pending).length;return{pending:e,cooking:I.filter(e=>e.status===Z.i.Cooking).length,waitingPayment:I.filter(e=>e.status===Z.i.WaitingForPayment).length,sumAmount:I.reduce((e,t)=>e+Number(t.total_amount||0),0)}},[I]),K=[{title:"เลขที่ออเดอร์",dataIndex:"order_no",key:"order_no",align:"center",render:e=>(0,l.jsx)(T,{strong:!0,style:{whiteSpace:"nowrap"},children:e})},{title:"วันเวลา",dataIndex:"create_date",key:"date",align:"center",render:e=>(0,l.jsxs)("div",{style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(T,{children:D()(e).format("DD MMM YYYY")}),(0,l.jsx)("br",{}),(0,l.jsx)(T,{type:"secondary",style:{fontSize:12},children:D()(e).format("HH:mm")})]})},{title:"ประเภท",dataIndex:"order_type",key:"type",align:"center",render:e=>(0,l.jsx)(c.Z,{color:(0,_.Gs)(e),style:{margin:0},children:(0,_.mz)(e)})},{title:"โต๊ะ / รหัสอ้างอิง",key:"reference",align:"center",render:(e,t)=>{let r=(0,_.jN)(t),n="default";return t.order_type===Z.m.DineIn&&(n="cyan"),t.order_type===Z.m.Delivery&&(n="orange"),(0,l.jsx)(c.Z,{color:n,style:{margin:0},children:r})}},{title:"รายละเอียดรายการ",key:"items_summary",width:200,align:"center",render:(e,t)=>{let r=t.items_summary||{},n=t.items_count||0,a=Object.entries(r);return 0===n?(0,l.jsx)(T,{type:"secondary",children:"-"}):(0,l.jsxs)("div",{style:{fontSize:13,lineHeight:"1.6",textAlign:"left",display:"inline-block",minWidth:140},children:[a.length>0?(0,l.jsxs)(l.Fragment,{children:[a.map(e=>{let[t,r]=e;return(0,l.jsxs)("div",{style:k.L2.summaryRow,children:[(0,l.jsx)(T,{type:"secondary",children:t}),(0,l.jsxs)(T,{strong:!0,children:[r," รายการ"]})]},t)}),(0,l.jsx)(y.Z,{style:{margin:"4px 0"}})]}):null,(0,l.jsxs)("div",{style:k.L2.summaryRowBold,children:[(0,l.jsx)(T,{strong:!0,children:"รวม"}),(0,l.jsxs)(T,{strong:!0,style:{color:k.mv.primary},children:[n," รายการ"]})]})]})}},{title:"ยอดรวม",dataIndex:"total_amount",key:"total",align:"center",render:e=>(0,l.jsx)(T,{strong:!0,style:{whiteSpace:"nowrap"},children:(0,_.xG)(e)})},{title:"สถานะ",dataIndex:"status",key:"status",align:"center",render:e=>(0,l.jsx)(c.Z,{color:(0,_.OY)(e),style:{margin:0},children:(0,_.d7)(e)})},{title:"จัดการ",key:"action",align:"center",render:(t,r)=>(0,l.jsx)(u.ZP,{type:"primary",icon:(0,l.jsx)(p.Z,{}),onClick:()=>e.push("/pos/orders/".concat(r.id)),style:{whiteSpace:"nowrap"},children:"ดูรายละเอียด"})}];if(F)return(0,l.jsxs)("div",{style:{...k.L2.container,background:"radial-gradient(circle at 20% 10%, rgba(99,102,241,0.06), transparent 26%), radial-gradient(circle at 80% 0%, rgba(16,185,129,0.05), transparent 20%), #f8fafc",minHeight:"100vh"},children:[(0,l.jsx)(B.Z,{title:"ออเดอร์",subtitle:"มอนิเตอร์ทุกช่องทาง • เน้นงานที่ต้องเร่งก่อน",onBack:()=>e.push("/pos"),icon:(0,l.jsx)(j.Z,{style:{fontSize:20}}),actions:(0,l.jsx)(x.Z,{size:8,wrap:!0,children:(0,l.jsx)(u.ZP,{icon:(0,l.jsx)(f.Z,{}),onClick:()=>M(),children:(0,E.t)("orders.loading")})})}),(0,l.jsx)(N.Z,{children:(0,l.jsx)(P.Z,{children:(0,l.jsx)(W.Z,{status:"error",title:(0,E.t)("orders.error"),onRetry:()=>M()})})})]});let V=G&&0===I.length&&!O;return(0,l.jsxs)("div",{style:{...k.L2.container,background:"radial-gradient(circle at 20% 10%, rgba(99,102,241,0.06), transparent 26%), radial-gradient(circle at 80% 0%, rgba(16,185,129,0.05), transparent 20%), #f8fafc",minHeight:"100vh"},children:[(0,l.jsx)(a(),{id:k.$k.__hash,children:k.$k}),(0,l.jsx)(B.Z,{title:"ออเดอร์",subtitle:"มอนิเตอร์ทุกช่องทาง • เน้นงานที่ต้องเร่งก่อน",onBack:()=>e.push("/pos"),icon:(0,l.jsx)(j.Z,{style:{fontSize:20}}),actions:(0,l.jsxs)(x.Z,{size:8,wrap:!0,children:[(0,l.jsx)(m.default,{allowClear:!0,placeholder:"ค้นหาเลขที่ออเดอร์ โต๊ะ หรือรหัสอ้างอิง",value:o,onChange:e=>d(e.target.value),style:{minWidth:t?200:280}}),(0,l.jsx)(u.ZP,{icon:(0,l.jsx)(f.Z,{}),onClick:()=>M(),children:"รีเฟรช"})]})}),(0,l.jsx)(N.Z,{children:(0,l.jsx)(P.Z,{children:V?(0,l.jsx)(W.Z,{status:"loading",title:(0,E.t)("orders.loading")}):(0,l.jsxs)("main",{style:k.L2.contentWrapper,className:"orders-content-wrapper",children:[(0,l.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:20},children:[{label:"รอทำ",value:q.pending,color:"#f59e0b",bg:"#fffbeb"},{label:"กำลังทำ",value:q.cooking,color:"#0ea5e9",bg:"#e0f2fe"},{label:"รอชำระ",value:q.waitingPayment,color:"#6366f1",bg:"#eef2ff"},{label:"ยอดต่อหน้า",value:(0,_.xG)(q.sumAmount),color:"#0f172a",bg:"#e2e8f0"}].map(e=>(0,l.jsxs)("div",{style:{background:e.bg,borderRadius:16,padding:"14px 16px",border:"1px solid rgba(148,163,184,0.3)",boxShadow:"0 10px 20px rgba(15, 23, 42, 0.06)",display:"flex",flexDirection:"column",gap:6},children:[(0,l.jsx)(T,{style:{color:"#475569",fontWeight:600},children:e.label}),(0,l.jsx)(T,{strong:!0,style:{color:e.color,fontSize:22},children:e.value})]},e.label))}),(0,l.jsx)(g.Z,{bordered:!1,style:{borderRadius:20,boxShadow:k.mv.cardShadow,border:"1px solid rgba(226, 232, 240, 0.8)"},styles:{body:k.L2.cardBody},children:t?(0,l.jsx)(h.Z,{loading:G,dataSource:I,locale:{emptyText:(0,l.jsx)("div",{style:{padding:12},children:(0,l.jsx)(H.Z,{title:"ไม่พบรายการออเดอร์"})})},renderItem:t=>{let r=t.items_count||0;return(0,l.jsxs)("article",{style:{...k.L2.orderCard,marginBottom:14,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:"1px solid #e2e8f0",boxShadow:"0 10px 30px rgba(15,23,42,0.06)"},onClick:()=>e.push("/pos/orders/".concat(t.id)),role:"button",tabIndex:0,"aria-label":"ออเดอร์ ".concat(t.order_no),onKeyDown:r=>"Enter"===r.key&&e.push("/pos/orders/".concat(t.id)),className:"orders-card fade-in",children:[(0,l.jsxs)("div",{style:k.L2.cardHeader,className:"orders-card-header",children:[(0,l.jsxs)("div",{style:k.L2.cardHeaderLeft,children:[(0,l.jsxs)(T,{strong:!0,style:{fontSize:17,color:k.mv.text},children:["#",t.order_no]}),(0,l.jsx)(c.Z,{color:(0,_.OY)(t.status),style:{margin:0,borderRadius:8,fontWeight:600},children:(0,_.d7)(t.status)})]}),(0,l.jsx)(c.Z,{color:(0,_.Gs)(t.order_type),style:{borderRadius:8,fontWeight:600},children:(0,_.mz)(t.order_type)})]}),(0,l.jsxs)("div",{style:k.L2.cardBody,className:"orders-card-body",children:[(0,l.jsxs)("div",{style:k.L2.refSection,children:[t.order_type===Z.m.DineIn&&t.table&&(0,l.jsxs)("div",{style:k.L2.refValue,className:"orders-ref-value",children:["\uD83E\uDE91 โต๊ะ ",t.table.table_name]}),(t.order_type===Z.m.Delivery||t.order_type===Z.m.TakeAway)&&(0,l.jsxs)("div",{style:k.L2.refValue,className:"orders-ref-value",children:["\uD83D\uDCCB ",t.delivery_code?"Ref: ".concat(t.delivery_code):"-"]})]}),(0,l.jsxs)("div",{style:k.L2.itemsSummary,children:[(0,l.jsxs)("div",{style:k.L2.metaSection,children:[(0,l.jsx)(j.Z,{style:{color:k.mv.primary}}),(0,l.jsxs)(T,{strong:!0,style:{color:k.mv.text},children:[r," รายการ"]})]}),(0,l.jsxs)("div",{style:k.L2.metaSection,children:[(0,l.jsx)(v.Z,{style:{color:k.mv.textSecondary}}),(0,l.jsx)(T,{style:{color:k.mv.textSecondary},children:D()(t.create_date).format("HH:mm น.")})]})]}),(0,l.jsxs)("div",{style:k.L2.totalSection,children:[(0,l.jsx)(T,{style:k.L2.totalLabel,children:"ยอดรวม"}),(0,l.jsx)("div",{style:k.L2.totalAmount,className:"orders-total-amount",children:(0,_.xG)(Number(t.total_amount))})]}),(0,l.jsx)(u.ZP,{type:"primary",ghost:!0,icon:(0,l.jsx)(p.Z,{}),style:k.L2.actionButton,className:"scale-hover",children:"ดูรายละเอียด"})]})]})},pagination:{current:r,pageSize:10,total:Y,onChange:e=>n(e),size:"small",style:{textAlign:"center",marginTop:16}}}):(0,l.jsx)(R,{columns:K,dataSource:I,loading:G,rowKey:"id",virtual:!0,scroll:{y:600},pagination:{current:r,pageSize:10,total:Y,onChange:e=>n(e),showTotal:e=>"ทั้งหมด ".concat(e," รายการ")},emptyTitle:"ไม่พบรายการออเดอร์"})})]})})})]})}D().locale("th")}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=62121)}),_N_E=e.O()}]);