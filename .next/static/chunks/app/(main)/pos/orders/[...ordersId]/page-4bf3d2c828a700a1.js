(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1304,9385],{8118:function(e,t,r){Promise.resolve().then(r.bind(r,536))},536:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ej}});var a=r(57437),i=r(29),n=r.n(i),o=r(2265),s=r(99376),l=r(7806),d=r(39486),c=r(34029),u=r(85180),h=r(24783),p=r(80009),m=r(89970),y=r(50742),g=r(47451),f=r(69410),x=r(96931),v=r(4156),b=r(2297),j=r(23496),k=r(62376),S=r(15424),w=r(9738),_=r(13377),C=r(26349),P=r(49638),T=r(52539),Z=r(67605),A=r(1915),E=r(89245),z=r(96473),N=r(83669),R=r(53286),O=r(97235),B=r(66290),I=r(32446),L=r(34962),D=r(1165),q=r(61414),H=r(71096),F=r.n(H);r(6729);var U=r(33145),M=r(64625),W=r(53743),G=r(88589),Q=r(33477),X=r(17588),J=r(29436),Y=r(40312),$=r(22623),K=r(2838),V=r(47799),ee=r(3369);let{Text:et,Title:er}=d.default,ea=e=>{var t;let{isOpen:r,onClose:i,onAddItem:s,orderType:l}=e,{message:d}=M.Z.useApp(),[c,h]=(0,o.useState)([]),[p,m]=(0,o.useState)([]),[g,f]=(0,o.useState)([]),[x,v]=(0,o.useState)(null),[b,k]=(0,o.useState)(""),{showLoading:S,hideLoading:w}=(0,ee.x)(),[_,T]=(0,o.useState)(null),[Z,A]=(0,o.useState)(1),[E,N]=(0,o.useState)(""),[R,O]=(0,o.useState)([]),B=(0,o.useCallback)(async()=>{try{S("กำลังโหลดข้อมูลสินค้า...");let[e,t]=await Promise.all([V.R.findAll(1,100),K.G.findAll()]);h(e.data),m(e.data),f(Array.isArray(t)?t:[])}catch(e){d.error("ไม่สามารถโหลดข้อมูลได้")}finally{w()}},[S,w,d]),L=(0,o.useCallback)(()=>{A(1),N(""),O([]),T(null),k("")},[]);(0,o.useEffect)(()=>{r&&(B(),L())},[B,r,L]);let H=e=>{v(e),F(b,e)},F=(e,t)=>{let r=c;t&&(r=r.filter(e=>e.category_id===t)),e&&(r=r.filter(t=>t.display_name.toLowerCase().includes(e.toLowerCase()))),m(r)},ea=e=>{T(e),A(1),N(""),O([])},ei=(e,t,r)=>{O(a=>a.map(a=>{if(a.id!==e)return a;if("price"===t){let e="number"==typeof r?r:Number(r)||0;return{...a,price:e}}return{...a,name:String(r)}}))},en=e=>{O(t=>t.filter(t=>t.id!==e))},eo=async()=>{if(_)try{S("กำลังเพิ่มรายการ...");let e=R.filter(e=>""!==e.name.trim()).map(e=>({detail_name:e.name,extra_price:e.price}));await s(_,Z,E,e),d.success("เพิ่มรายการเรียบร้อย"),i(),T(null)}catch(e){}finally{w()}};return(0,a.jsxs)(W.Z,{className:"mobile-fullscreen-modal",title:null,open:r,onCancel:i,footer:null,width:850,destroyOnHidden:!0,centered:!0,styles:{body:{padding:0,display:"flex",flexDirection:"column",height:"90vh",maxHeight:"90vh",overflow:"hidden",borderRadius:16}},children:[(0,a.jsx)(n(),{id:D.$k.__hash,children:D.$k}),(0,a.jsxs)("div",{style:{...D.il.modalHeader,flexShrink:0},className:"modal-header",children:[_?(0,a.jsx)(y.ZP,{type:"text",icon:(0,a.jsx)(X.Z,{}),onClick:()=>T(null),"aria-label":"กลับ",style:{height:44,width:44,borderRadius:12,background:D._A.backgroundSecondary,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid ".concat(D._A.border)},className:"scale-hover"}):(0,a.jsx)(y.ZP,{type:"text",icon:(0,a.jsx)(P.Z,{}),onClick:i,"aria-label":"ปิด",style:{height:44,width:44,borderRadius:12,background:D._A.backgroundSecondary,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid ".concat(D._A.border)},className:"scale-hover"}),(0,a.jsx)(et,{strong:!0,style:{fontSize:18,flex:1,color:D._A.text,lineHeight:1.4},children:_?"ระบุรายละเอียด":"เลือกสินค้า"})]}),_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"20px",display:"flex",flexDirection:"column"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[(0,a.jsxs)("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},className:"product-info-section",children:[_.img_url?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(U.default,{src:_.img_url,alt:_.display_name,width:100,height:100,style:{objectFit:"cover",borderRadius:12,flexShrink:0}})}):(0,a.jsx)("div",{style:{width:100,height:100,background:D._A.backgroundSecondary,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,a.jsx)(Y.Z,{style:{fontSize:32,opacity:.2}})}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsx)(er,{level:4,style:{margin:"0 0 6px 0",fontSize:20,lineHeight:1.3},children:_.display_name}),(0,a.jsxs)(et,{style:{fontSize:20,fontWeight:700,color:D._A.primary,lineHeight:1.2},children:["฿",Number(l===I.m.Delivery&&null!==(t=_.price_delivery)&&void 0!==t?t:_.price).toLocaleString()]})]})]}),(0,a.jsx)(j.Z,{style:{margin:"0"}}),(0,a.jsxs)("div",{children:[(0,a.jsx)(et,{strong:!0,style:{display:"block",marginBottom:14,fontSize:16,color:D._A.text},children:"จำนวน"}),(0,a.jsxs)("div",{style:D.il.quantityControl,className:"quantity-control",children:[(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)($.Z,{}),onClick:()=>A(e=>Math.max(1,e-1)),disabled:Z<=1,style:{...D.il.quantityButton,background:D._A.white,color:D._A.primary,border:"2px solid ".concat(D._A.primary)},className:"scale-hover quantity-button"}),(0,a.jsx)("div",{style:D.il.quantityDisplay,className:"quantity-display",children:Z}),(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)(z.Z,{}),onClick:()=>A(e=>e+1),style:{...D.il.quantityButton,background:"linear-gradient(135deg, ".concat(D._A.primary," 0%, ").concat(D._A.primaryDark," 100%)"),border:"none"},className:"scale-hover quantity-button"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,a.jsx)(et,{strong:!0,style:{fontSize:16},children:"ตัวเลือกเพิ่มเติม (Optional)"}),(0,a.jsx)(y.ZP,{size:"small",type:"dashed",onClick:()=>{O(e=>[...e,{id:Date.now(),name:"",price:0}])},icon:(0,a.jsx)(z.Z,{}),children:"เพิ่ม"})]}),R.map(e=>(0,a.jsxs)("div",{style:D.m4.detailItemRow,className:"detail-item-row",children:[(0,a.jsx)(G.default,{placeholder:"ไข่ดาว, พิเศษ...",value:e.name,onChange:t=>ei(e.id,"name",t.target.value),style:{flex:1,borderRadius:10,height:44,fontSize:15}}),(0,a.jsx)(Q.Z,{placeholder:"0.00",value:e.price,onChange:t=>ei(e.id,"price",t||0),style:{width:110,borderRadius:10,height:44,fontSize:15},inputMode:"decimal",controls:!1,min:0,precision:2,formatter:e=>"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),onKeyDown:t=>{/^[0-9]$/.test(t.key)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","."].includes(t.key)||t.preventDefault(),"."===t.key&&e.price.toString().includes(".")&&t.preventDefault()}}),(0,a.jsx)(y.ZP,{type:"text",danger:!0,icon:(0,a.jsx)(C.Z,{}),onClick:()=>en(e.id),style:{width:44,height:44,borderRadius:10},className:"scale-hover"})]},e.id))]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(et,{strong:!0,style:{display:"block",marginBottom:10,fontSize:16,color:D._A.text},children:"หมายเหตุ"}),(0,a.jsx)(G.default.TextArea,{rows:3,value:E,onChange:e=>N(e.target.value),placeholder:"เช่น ไม่ใส่ผัก, เผ็ดน้อย...",style:{borderRadius:12,fontSize:15,padding:"12px 14px",lineHeight:1.5}})]}),(0,a.jsx)("div",{style:{height:10}})]})}),(0,a.jsxs)("div",{style:{marginTop:0},children:[(0,a.jsxs)("div",{style:{...D.il.priceCard,margin:"0 20px",borderRadius:"12px 12px 0 0",borderBottom:"none"},children:[(0,a.jsx)(et,{strong:!0,style:{fontSize:16,color:D._A.text},children:"ยอดรวมรายการนี้"}),(0,a.jsx)(er,{level:4,style:{margin:0,color:D._A.priceTotal,fontSize:24},children:(0,q.xG)((()=>{var e;if(!_)return 0;let t=l===I.m.Delivery&&null!==(e=_.price_delivery)&&void 0!==e?e:_.price,r=R.map(e=>({detail_name:e.name,extra_price:e.price}));return(0,q.ku)(t,Z,r)})())})]}),(0,a.jsxs)("div",{style:{...D.il.actionButtons,flexShrink:0},className:"action-buttons",children:[(0,a.jsx)(y.ZP,{onClick:()=>T(null),style:D.il.secondaryButton,className:"scale-hover secondary-button",children:"ย้อนกลับ"}),(0,a.jsx)(y.ZP,{type:"primary",onClick:eo,icon:(0,a.jsx)(z.Z,{}),style:D.il.primaryButton,className:"scale-hover primary-button",children:"เพิ่มลงออเดอร์"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{...D.m4.searchBar,paddingBottom:8,flexShrink:0},children:[(0,a.jsx)(G.default,{placeholder:"ค้นหาสินค้าหรือรหัส...",prefix:(0,a.jsx)(J.Z,{style:{color:D._A.textSecondary}}),value:b,onChange:e=>{let t=e.target.value;k(t),F(t,x)},allowClear:!0,style:{...D.m4.searchInput,marginBottom:12}}),(0,a.jsxs)("div",{style:{display:"flex",overflowX:"auto",gap:8,paddingBottom:4,scrollBehavior:"smooth",scrollbarWidth:"none",msOverflowStyle:"none"},className:"hide-scrollbar",children:[(0,a.jsx)(y.ZP,{size:"middle",type:null===x?"primary":"default",onClick:()=>H(null),style:{borderRadius:20,minWidth:70,border:null===x?"none":"1px solid ".concat(D._A.border)},children:"ทั้งหมด"}),g.map(e=>(0,a.jsx)(y.ZP,{size:"middle",type:x===e.id?"primary":"default",onClick:()=>H(e.id),style:{borderRadius:20,border:x===e.id?"none":"1px solid ".concat(D._A.border)},children:e.display_name||e.category_name},e.id))]})]}),(0,a.jsxs)("div",{style:{flex:1,overflowY:"auto",paddingBottom:20},className:"order-detail-content",children:[(0,a.jsx)("div",{style:D.m4.productGrid,className:"product-grid",children:p.map(e=>(0,a.jsxs)("div",{style:D.m4.productCard,onClick:()=>ea(e),className:"product-card-hoverable scale-in",children:[(0,a.jsx)("div",{style:{position:"relative",width:"100%",height:130,background:D._A.backgroundSecondary},children:e.img_url?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(U.default,{alt:e.display_name,src:e.img_url,fill:!0,style:{objectFit:"cover",borderRadius:"12px 12px 0 0"},sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"})}):(0,a.jsx)("div",{style:D.m4.productPlaceholder,children:(0,a.jsx)(Y.Z,{style:{fontSize:28,opacity:.3}})})}),(0,a.jsxs)("div",{style:D.m4.productInfo,className:"product-info",children:[(0,a.jsx)("div",{style:{...D.m4.productName},className:"product-name",children:e.display_name}),(0,a.jsx)(et,{style:{...D.m4.productPrice},className:"product-price",children:(0,q.xG)(e.price)})]})]},e.id))}),0===p.length&&(0,a.jsx)(u.Z,{description:"ไม่พบสินค้าที่คุณต้องการ",style:{marginTop:60,padding:"40px 20px"}})]})]})]})};var ei=r(78355);let{Text:en,Title:eo}=d.default,{TextArea:es}=G.default,el=["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","."],ed=e=>{var t,r,i,n,s,l;let{item:d,isOpen:u,onClose:m,onSave:g}=e,[f,x]=(0,o.useState)(1),[v,b]=(0,o.useState)(""),[k,w]=(0,o.useState)([]),_=(0,o.useRef)(null),{showLoading:T,hideLoading:Z}=(0,ee.O)();(0,o.useEffect)(()=>{if(d&&u){let e=d.id;e!==_.current&&(x(d.quantity),b(d.notes||""),w(d.details?[...d.details.map(e=>({detail_name:e.detail_name,extra_price:e.extra_price}))]:[]),_.current=e)}},[d,u]),(0,o.useEffect)(()=>{u||(_.current=null,x(1),b(""),w([]))},[u]);let A=(0,o.useCallback)(async()=>{if(d)try{T("กำลังบันทึกการเปลี่ยนแปลง...");let e=k.filter(e=>e.detail_name&&""!==e.detail_name.trim());await g(d.id,f,v,e)}catch(e){c.ZP.error("บันทึกการเปลี่ยนแปลงไม่สำเร็จ")}finally{Z()}},[d,f,v,k,g,T,Z]),E=(0,o.useCallback)(()=>{x(e=>e+1)},[]),N=(0,o.useCallback)(()=>{x(e=>Math.max(1,e-1))},[]),R=(0,o.useCallback)(()=>{w(e=>[...e,{detail_name:"",extra_price:0}])},[]),O=(0,o.useCallback)(e=>{w(t=>t.filter((t,r)=>r!==e))},[]),B=(0,o.useCallback)((e,t,r)=>{w(a=>{let i=[...a];return i[e]={...i[e],[t]:r},i})},[]);return d?(0,a.jsxs)(W.Z,{className:"mobile-fullscreen-modal",title:null,open:u,onCancel:m,footer:null,width:500,destroyOnHidden:!0,centered:!0,closable:!1,styles:{body:{padding:0,display:"flex",flexDirection:"column",height:"80vh",maxHeight:"80vh",overflow:"hidden",borderRadius:16}},children:[(0,a.jsxs)("div",{style:{...D.il.modalHeader,flexShrink:0},className:"modal-header",children:[(0,a.jsx)(en,{strong:!0,style:{fontSize:18,flex:1,color:D._A.text,lineHeight:1.4},children:"แก้ไขรายการสินค้า"}),(0,a.jsx)(y.ZP,{type:"text",icon:(0,a.jsx)(P.Z,{}),onClick:m,"aria-label":"ปิด",style:{height:44,width:44,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:12,color:D._A.textSecondary,background:D._A.backgroundSecondary,border:"1px solid ".concat(D._A.border)},className:"scale-hover"})]}),(0,a.jsxs)("div",{style:{flex:1,overflowY:"auto",padding:"20px"},children:[(0,a.jsxs)("div",{style:{display:"flex",gap:16,marginBottom:24,alignItems:"center",background:D._A.backgroundSecondary,padding:16,borderRadius:16},children:[(0,a.jsx)("div",{style:{flexShrink:0},children:(null===(t=d.product)||void 0===t?void 0:t.img_url)?(0,a.jsx)(U.default,{src:d.product.img_url,alt:null!==(l=null===(r=d.product)||void 0===r?void 0:r.display_name)&&void 0!==l?l:"สินค้า",width:80,height:80,style:{borderRadius:14,objectFit:"cover",border:"1px solid ".concat(D._A.borderLight)}}):(0,a.jsx)("div",{style:{width:80,height:80,borderRadius:14,background:"linear-gradient(135deg, ".concat(D._A.primaryLight," 0%, #DBEAFE 100%)"),display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(S.Z,{style:{fontSize:28,color:D._A.primary,opacity:.5}})})}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsx)(eo,{level:5,style:{margin:0,fontSize:18,color:D._A.text},children:(null===(i=d.product)||void 0===i?void 0:i.display_name)||"ไม่มีข้อมูลสินค้า"}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6},children:[(null===(s=d.product)||void 0===s?void 0:null===(n=s.category)||void 0===n?void 0:n.display_name)&&(0,a.jsx)(p.Z,{color:"cyan",style:{fontSize:11,margin:0,borderRadius:6,fontWeight:500},children:d.product.category.display_name}),(0,a.jsx)(en,{style:{fontSize:16,fontWeight:600,color:D._A.primary},children:(0,q.xG)(d.price)})]})]})]}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[(0,a.jsx)(en,{strong:!0,style:{fontSize:16,color:D._A.text},children:"ตัวเลือกเพิ่มเติม (Topping)"}),(0,a.jsx)(y.ZP,{type:"text",icon:(0,a.jsx)(z.Z,{style:{fontSize:12}}),onClick:R,style:{borderRadius:12,background:D._A.primaryLight,color:D._A.primary,fontWeight:600,fontSize:13,height:36,padding:"0 16px",border:"1px solid ".concat(D._A.primary,"30"),display:"flex",alignItems:"center",justifyContent:"center"},className:"scale-hover",children:"เพิ่มตัวเลือก"})]}),0===k.length?(0,a.jsx)("div",{style:{textAlign:"center",padding:"16px",background:D._A.backgroundSecondary,borderRadius:12,border:"1px dashed ".concat(D._A.border)},children:(0,a.jsx)(en,{type:"secondary",style:{fontSize:13},children:"ยังไม่มีตัวเลือกเพิ่มเติม"})}):(0,a.jsx)(h.Z,{direction:"vertical",style:{width:"100%"},size:12,children:k.map((e,t)=>(0,a.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center",padding:"12px 14px",background:D._A.backgroundSecondary,borderRadius:12,border:"1px solid ".concat(D._A.border)},children:[(0,a.jsx)(G.default,{placeholder:"ชื่อตัวเลือก",value:e.detail_name,onChange:e=>B(t,"detail_name",e.target.value),style:{flex:2,borderRadius:10,height:44,fontSize:15}}),(0,a.jsx)(Q.Z,{placeholder:"ราคาเพิ่ม",value:e.extra_price,onChange:e=>B(t,"extra_price",e||0),style:{flex:1,borderRadius:10,height:44,fontSize:15},inputMode:"decimal",controls:!1,min:0,precision:2,formatter:e=>"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),onKeyDown:t=>{/^[0-9]$/.test(t.key)||el.includes(t.key)||t.preventDefault(),"."===t.key&&e.extra_price.toString().includes(".")&&t.preventDefault()}}),(0,a.jsx)(y.ZP,{danger:!0,type:"text",icon:(0,a.jsx)(C.Z,{}),onClick:()=>O(t),style:{color:D._A.danger,borderRadius:10,width:44,height:44},className:"scale-hover"})]},t))})]}),(0,a.jsx)(j.Z,{style:{margin:"0 0 20px 0"}}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)(en,{strong:!0,style:{display:"block",marginBottom:14,fontSize:16,color:D._A.text},children:"จำนวน"}),(0,a.jsxs)("div",{style:D.il.quantityControl,className:"quantity-control",children:[(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)($.Z,{}),onClick:N,disabled:f<=1,style:{...D.il.quantityButton,background:D._A.white,color:D._A.primary,border:"2px solid ".concat(D._A.primary)},className:"scale-hover quantity-button"}),(0,a.jsx)("div",{style:D.il.quantityDisplay,className:"quantity-display",children:f}),(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)(z.Z,{}),onClick:E,style:{...D.il.quantityButton,background:"linear-gradient(135deg, ".concat(D._A.primary," 0%, ").concat(D._A.primaryDark," 100%)"),border:"none"},className:"scale-hover quantity-button"})]})]}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)(en,{strong:!0,style:{display:"block",marginBottom:10,fontSize:16,color:D._A.text},children:"หมายเหตุ / ความต้องการเพิ่มเติม"}),(0,a.jsx)(es,{value:v,onChange:e=>b(e.target.value),placeholder:"เช่น ไม่หวาน, แยกน้ำ, ไม่ใส่ผัก...",rows:3,style:{borderRadius:12,padding:"12px 14px",fontSize:15,lineHeight:1.5}})]}),(0,a.jsxs)("div",{style:{...D.il.priceCard,marginBottom:0},children:[(0,a.jsx)(en,{strong:!0,style:{fontSize:16,color:D._A.text},children:"ราคารวมทั้งหมด"}),(0,a.jsxs)(eo,{level:4,style:{margin:0,color:D._A.priceTotal,fontSize:22},children:["฿",(0,q.ku)(Number(d.price),f,k).toLocaleString()]})]})]}),(0,a.jsxs)("div",{style:{...D.il.actionButtons,flexShrink:0},className:"action-buttons",children:[(0,a.jsx)(y.ZP,{onClick:m,style:D.il.secondaryButton,className:"scale-hover secondary-button",children:"ยกเลิก"}),(0,a.jsx)(y.ZP,{type:"primary",onClick:A,icon:(0,a.jsx)(ei.Z,{}),style:D.il.primaryButton,className:"scale-hover primary-button",children:"บันทึกการเปลี่ยนแปลง"})]})]},(null==d?void 0:d.id)||"edit-modal"):null};var ec=r(60300),eu=r(20920),eh=r(84859),ep=r(24675),em=r(67697),ey=r(12028),eg=r(88444),ef=r(5325),ex=r(20148);let{Title:ev,Text:eb}=d.default;function ej(){var e,t,r,i,d;let H=(0,s.useRouter)(),U=(0,s.useParams)(),M=Array.isArray(null==U?void 0:U.ordersId)?U.ordersId[0]:null==U?void 0:U.ordersId,[W,G]=(0,o.useState)(null),[Q,X]=(0,o.useState)(!0),[J,Y]=(0,o.useState)(!1),{showLoading:$,hideLoading:K}=(0,ee.x)(),{socket:V}=(0,ep.s)(),et=(0,eu.L)(),{queue:er,addToQueue:ei,removeFromQueue:en,isLoading:eo}=(0,eg.G)(),es=W?er.find(e=>e.order_id===W.id):null,[el,ej]=(0,o.useState)([]),[ek,eS]=(0,o.useState)(!1),[ew,e_]=(0,o.useState)(null),[eC,eP]=(0,o.useState)(!1),[eT,eZ]=(0,o.useState)({open:!1,type:"confirm",title:"",content:"",onOk:()=>{}}),eA=()=>eZ(e=>({...e,open:!1})),eE=(0,o.useCallback)(async e=>{try{X(!0),$("กำลังโหลดข้อมูลออเดอร์...");let t=await R.x.getById(e);if([I.i.Paid,I.i.Cancelled,I.i.WaitingForPayment].includes(t.status)){let e=(0,q.EO)(t);H.push(e);return}G(t)}catch(e){c.ZP.error("ไม่สามารถโหลดข้อมูลออเดอร์ได้")}finally{X(!1),K()}},[H,$,K]);(0,o.useEffect)(()=>{M&&eE(M)},[M,eE]),(0,em.D)({socket:V,events:[ey.b.orders.update,ey.b.orders.delete,ey.b.orders.create,ey.b.payments.create,ey.b.payments.update,ey.b.salesOrderItem.create,ey.b.salesOrderItem.update,ey.b.salesOrderItem.delete,ey.b.salesOrderDetail.create,ey.b.salesOrderDetail.update,ey.b.salesOrderDetail.delete],onRefresh:()=>{M&&eE(M)},intervalMs:15e3,enabled:!!M});let ez=(0,o.useMemo)(()=>{var e;return(null==W?void 0:null===(e=W.items)||void 0===e?void 0:e.filter(e=>e.status===I.i.Pending||e.status===I.i.Cooking))||[]},[null==W?void 0:W.items]),eN=(0,o.useMemo)(()=>{var e;return((null==W?void 0:null===(e=W.items)||void 0===e?void 0:e.filter(e=>e.status===I.i.Served||e.status===I.i.Cancelled||e.status===I.i.WaitingForPayment))||[]).sort((e,t)=>e.status===I.i.Cancelled&&t.status!==I.i.Cancelled?1:e.status!==I.i.Cancelled&&t.status===I.i.Cancelled?-1:0)},[null==W?void 0:W.items]),eR=(0,o.useMemo)(()=>(0,l.S)(ez),[ez]),eO=(0,o.useMemo)(()=>(0,l.S)(eN),[eN]),eB=(0,o.useMemo)(()=>(0,q.Nz)(null==W?void 0:W.items),[null==W?void 0:W.items]),eI=(0,o.useMemo)(()=>(0,l.S)(eB),[eB]),eL=(0,q.yj)(null==W?void 0:W.items),eD=0===ez.length&&((null==W?void 0:null===(e=W.items)||void 0===e?void 0:e.length)||0)>0,eq=eR.length>12,eH=eO.length>12,eF=async e=>{try{var t;Y(!0),$("กำลังดำเนินการเสิร์ฟ...");let r=await (0,O.P)(),a=eR.find(t=>t.id===e),i=(null==a?void 0:null===(t=a.originalItems)||void 0===t?void 0:t.map(e=>e.id))||[e];await Promise.all(i.map(e=>R.x.updateItemStatus(e,I.i.Served,void 0,r))),c.ZP.success("เสิร์ฟรายการเรียบร้อย"),eE(M)}catch(e){c.ZP.error("เกิดข้อผิดพลาดในการเสิร์ฟ")}finally{Y(!1),K()}},eU=async()=>{if(0!==el.length)try{Y(!0),$("กำลังดำเนินการเสิร์ฟ ".concat(el.length," รายการ (รวมกลุ่ม)..."));let e=await (0,O.P)(),t=el.flatMap(e=>{var t;let r=eR.find(t=>t.id===e);return(null==r?void 0:null===(t=r.originalItems)||void 0===t?void 0:t.map(e=>e.id))||[e.toString()]});await Promise.all(t.map(t=>R.x.updateItemStatus(t,I.i.Served,void 0,e))),c.ZP.success("เสิร์ฟรายการที่เลือกเรียบร้อย"),ej([]),eE(M)}catch(e){c.ZP.error("เกิดข้อผิดพลาดในการเสิร์ฟ")}finally{Y(!1),K()}},eM=async()=>{if(0===el.length)return;let e=el.flatMap(e=>{var t;let r=eR.find(t=>t.id===e);return(null==r?void 0:null===(t=r.originalItems)||void 0===t?void 0:t.map(e=>e.id))||[e.toString()]});eZ({open:!0,type:"danger",title:"ยืนยันการยกเลิก",content:"คุณต้องการยกเลิก ".concat(e.length," รายการที่เลือกใช่หรือไม่?"),okText:"ยืนยันยกเลิก",cancelText:"ไม่ยกเลิก",onOk:async()=>{try{Y(!0),$("กำลังดำเนินการยกเลิก..."),eA();let t=await (0,O.P)();await Promise.all(e.map(e=>R.x.updateItemStatus(e,I.i.Cancelled,void 0,t))),c.ZP.success("ยกเลิกรายการที่เลือกเรียบร้อย"),ej([]),eE(M)}catch(e){c.ZP.error("เกิดข้อผิดพลาดในการยกเลิก")}finally{Y(!1),K()}}})},eW=async e=>{try{var t;Y(!0),$("กำลังย้อนกลับสถานะ...");let r=await (0,O.P)(),a=eO.find(t=>t.id===e),i=(null==a?void 0:null===(t=a.originalItems)||void 0===t?void 0:t.map(e=>e.id))||[e];await Promise.all(i.map(e=>R.x.updateItemStatus(e,I.i.Cooking,void 0,r))),c.ZP.success("ยกเลิกการเสิร์ฟ (กลับไปปรุง)"),eE(M)}finally{Y(!1),K()}},eG=async e=>{eZ({open:!0,type:"danger",title:"ยืนยันการลบ",content:"คุณต้องการลบรายการสินค้านี้ใช่หรือไม่?",okText:"ลบ",cancelText:"ยกเลิก",onOk:async()=>{try{var t;Y(!0),$("กำลังลบรายการ..."),eA();let r=await (0,O.P)(),a=eR.find(t=>t.id===e),i=(null==a?void 0:null===(t=a.originalItems)||void 0===t?void 0:t.map(e=>e.id))||[e];await Promise.all(i.map(e=>R.x.deleteItem(e,void 0,r))),c.ZP.success("ลบรายการเรียบร้อย (".concat(i.length," รายการ)")),eE(M)}catch(e){c.ZP.error("ไม่สามารถลบรายการได้")}finally{Y(!1),K()}}})},eQ=async function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];try{Y(!0),$("กำลังบันทึกข้อมูล...");let i=await (0,O.P)();if(!t||t<1)throw c.ZP.error("จำนวนต้องมากกว่า 0"),Error("Invalid quantity");let n={quantity:Number(t),notes:String(r||""),details:Array.isArray(a)?a.map(e=>({detail_name:String(e.detail_name||""),extra_price:Number(e.extra_price||0)})):[]};await R.x.updateItem(e,n,void 0,i),c.ZP.success("แก้ไขรายการเรียบร้อย"),eS(!1),e_(null),eS(!1),e_(null),await new Promise(e=>setTimeout(e,600)),await eE(M),setTimeout(async()=>{var r;let a=await R.x.getById(M),i=null==a?void 0:null===(r=a.items)||void 0===r?void 0:r.find(t=>t.id===e);i&&(i.quantity===t?G(a):setTimeout(async()=>{await eE(M)},1e3))},500)}catch(e){throw c.ZP.error("ไม่สามารถแก้ไขรายการได้"),e}finally{Y(!1),K()}},eX=e=>{e_(e),eS(!0)},eJ=async function(e,t,r){var a;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=(null==W?void 0:W.order_type)===I.m.Delivery?Number(null!==(a=e.price_delivery)&&void 0!==a?a:e.price):Number(e.price),o=(n+i.reduce((e,t)=>e+t.extra_price,0))*t;if(!et){eh.x.addToQueue("ADD_ITEM",{orderId:M,itemData:{product_id:e.id,quantity:t,price:n,notes:r,discount_amount:0,total_price:o,details:i}}),c.ZP.warning("บันทึกข้อมูลแบบ Offline แล้ว"),eE(M);return}try{Y(!0),$("กำลังเพิ่มสินค้า...");let a=await (0,O.P)();await R.x.addItem(M,{product_id:e.id,quantity:t,price:n,notes:r,discount_amount:0,total_price:o,details:i,status:I.i.Cooking},void 0,a),c.ZP.success("เพิ่มสินค้าเรียบร้อย"),eE(M)}catch(e){throw c.ZP.error("เพิ่มสินค้าไม่สำเร็จ"),e}finally{Y(!1),K()}},eY=async()=>{let e=(null==W?void 0:W.order_type)===I.m.Delivery;eZ({open:!0,type:"success",title:e?"ยืนยันจัดออเดอร์เสร็จสิ้น":"ยืนยันการ".concat((0,q.qO)(null==W?void 0:W.order_type),"ทั้งหมด"),content:e?"จัดเตรียมอาหารเรียบร้อยแล้ว ต้องการส่งมอบให้ไรเดอร์หรือไม่?":"รายการทั้งหมดเสร็จสิ้นแล้ว ต้องการเข้าสู่ขั้นตอนการชำระเงินหรือไม่?",okText:"ยืนยัน",cancelText:"ยกเลิก",onOk:async()=>{try{Y(!0),$("กำลังยืนยันรายการ..."),eA();let e=await (0,O.P)();if(await R.x.updateStatus(M,I.i.WaitingForPayment,e),c.ZP.success("ยืนยันออเดอร์เรียบร้อย"),W){let e=(0,q.EO)(W);H.push(e)}else H.push("/pos/orders")}catch(e){c.ZP.error("เกิดข้อผิดพลาดในการยืนยัน")}finally{Y(!1),K()}}})};if(Q&&!W)return null;if(!W)return(0,a.jsx)(u.Z,{description:"ไม่พบข้อมูล"});let e$=[{title:"",key:"image",width:70,align:"center",render:(e,t)=>{var r,i,n;return(null===(r=t.product)||void 0===r?void 0:r.img_url)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{src:t.product.img_url,alt:null!==(n=null===(i=t.product)||void 0===i?void 0:i.display_name)&&void 0!==n?n:"สินค้า",style:D.B9.productThumb})}):(0,a.jsx)("div",{style:D.B9.productThumbPlaceholder,children:(0,a.jsx)(k.Z,{})})}},{title:"รายการ",key:"product",align:"center",render:(e,t)=>{var r;return(0,a.jsxs)(h.Z,{orientation:"vertical",size:2,align:"center",children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:15,lineHeight:"1.2"},children:null===(r=t.product)||void 0===r?void 0:r.display_name}),t.details&&t.details.length>0&&(0,a.jsx)("div",{style:{fontSize:13,color:D._A.served,textAlign:"center"},children:t.details.map((e,t)=>(0,a.jsxs)("div",{style:{lineHeight:"1.4"},children:["+ ",e.detail_name]},t))}),t.notes&&(0,a.jsxs)(eb,{style:{fontSize:13,color:D._A.cancelled},children:[(0,a.jsx)(S.Z,{})," ",t.notes]})]})}},{title:"หมวดหมู่",key:"category",width:120,align:"center",render:(e,t)=>{var r,i;return(0,a.jsx)(h.Z,{orientation:"vertical",size:0,align:"center",children:(null===(i=t.product)||void 0===i?void 0:null===(r=i.category)||void 0===r?void 0:r.display_name)?(0,a.jsx)(p.Z,{color:"cyan",style:D.B9.categoryTag,children:t.product.category.display_name}):"-"})}},{title:"ราคา",key:"price",width:110,align:"center",render:(e,t)=>(0,a.jsxs)(h.Z,{orientation:"vertical",size:0,align:"center",children:[(0,a.jsxs)(eb,{style:{...D.B9.priceTag,fontSize:18},children:["฿",Number(t.price).toLocaleString()]}),t.details&&t.details.length>0&&t.details.map((e,t)=>(0,a.jsxs)(eb,{style:{fontSize:13,color:D._A.priceTotal,display:"block",lineHeight:"1.4"},children:["+ ฿",Number(e.extra_price).toLocaleString()]},t))]})},{title:"สถานะ",dataIndex:"status",key:"status",width:120,align:"center",render:e=>(0,a.jsx)(p.Z,{color:e===I.i.Pending?"orange":e===I.i.Cooking?"blue":"green",children:(0,q.d7)(e,W.order_type)})},{title:"จำนวน",dataIndex:"quantity",key:"quantity",width:80,align:"center",render:e=>(0,a.jsxs)(eb,{strong:!0,style:{fontSize:16},children:["x",e]})},{title:"จัดการ",key:"actions",width:130,align:"right",render:(e,t)=>(0,a.jsxs)(h.Z,{children:[(0,a.jsx)(m.Z,{title:(0,q.qO)(W.order_type),children:(0,a.jsxs)(y.ZP,{type:"primary",onClick:()=>eF(t.id),style:{background:D._A.served,borderColor:D._A.served,height:"auto",padding:"4px 8px",display:"flex",flexDirection:"column",alignItems:"center",gap:2,minWidth:60,borderRadius:10},children:[(0,a.jsx)(w.Z,{style:{fontSize:16}}),(0,a.jsx)("span",{style:{fontSize:10,fontWeight:700},children:(0,q.qO)(W.order_type)})]})}),(0,a.jsx)(m.Z,{title:"แก้ไข",children:(0,a.jsx)(y.ZP,{type:"text",icon:(0,a.jsx)(_.Z,{}),onClick:()=>eX(t)})}),(0,a.jsx)(m.Z,{title:"ลบ",children:(0,a.jsx)(y.ZP,{type:"text",danger:!0,icon:(0,a.jsx)(C.Z,{}),onClick:()=>eG(t.id)})})]})}],eK=[{title:"",key:"image",width:70,align:"center",render:(e,t)=>{var r,i,n;return(null===(r=t.product)||void 0===r?void 0:r.img_url)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{src:t.product.img_url,alt:null!==(n=null===(i=t.product)||void 0===i?void 0:i.display_name)&&void 0!==n?n:"สินค้า",style:{...D.B9.productThumb,opacity:.7}})}):(0,a.jsx)("div",{style:D.B9.productThumbPlaceholder,children:(0,a.jsx)(k.Z,{})})}},{title:"รายการ",key:"product",align:"center",render:(e,t)=>{var r;return(0,a.jsxs)(h.Z,{orientation:"vertical",size:2,align:"center",children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:15,lineHeight:"1.2",textDecoration:t.status===I.i.Cancelled?"line-through":"none",color:t.status===I.i.Cancelled?D._A.textLight:D._A.text},children:null===(r=t.product)||void 0===r?void 0:r.display_name}),t.details&&t.details.length>0&&(0,a.jsx)("div",{style:{fontSize:12,color:D._A.served,opacity:.7,textAlign:"center"},children:t.details.map((e,t)=>(0,a.jsxs)("div",{style:{lineHeight:"1.4"},children:["+ ",e.detail_name]},t))}),t.notes&&(0,a.jsxs)(eb,{style:{fontSize:12,opacity:.7,color:D._A.cancelled},children:[(0,a.jsx)(S.Z,{})," ",t.notes]})]})}},{title:"หมวดหมู่",key:"category",width:120,align:"center",render:(e,t)=>{var r,i;return(0,a.jsx)(h.Z,{orientation:"vertical",size:0,align:"center",children:(null===(i=t.product)||void 0===i?void 0:null===(r=i.category)||void 0===r?void 0:r.display_name)?(0,a.jsx)(p.Z,{color:"cyan",style:{...D.B9.categoryTag,opacity:.7},children:t.product.category.display_name}):"-"})}},{title:"ราคา",key:"price",width:110,align:"center",render:(e,t)=>(0,a.jsxs)(h.Z,{orientation:"vertical",size:0,align:"center",children:[(0,a.jsxs)(eb,{style:{...D.B9.priceTag,opacity:.7},children:["฿",Number(t.price).toLocaleString()]}),t.details&&t.details.length>0&&t.details.map((e,t)=>(0,a.jsxs)(eb,{style:{fontSize:11,opacity:.7,color:D._A.priceTotal,display:"block",lineHeight:"1.4"},children:["+ ฿",Number(e.extra_price).toLocaleString()]},t))]})},{title:"ราคารวม",key:"total",width:120,align:"center",render:(e,t)=>(0,a.jsxs)(eb,{strong:!0,style:{color:t.status===I.i.Cancelled?D._A.textLight:D._A.priceTotal,fontSize:16,textDecoration:t.status===I.i.Cancelled?"line-through":"none"},children:["฿",Number(t.total_price).toLocaleString()]})},{title:"สถานะ",dataIndex:"status",key:"status",width:120,align:"center",render:e=>(0,a.jsx)(p.Z,{color:(0,q.OY)(e),children:(0,q.d7)(e,W.order_type)})},{title:"จำนวน",dataIndex:"quantity",key:"quantity",width:80,align:"center",render:e=>(0,a.jsxs)(eb,{strong:!0,style:{fontSize:16},children:["x",e]})},{title:"จัดการ",key:"actions",width:130,align:"right",render:(e,t)=>t.status===I.i.Served?(0,a.jsx)(y.ZP,{size:"small",className:"unserve-button",style:D.B9.unserveButton,icon:(0,a.jsx)(P.Z,{}),onClick:()=>eW(t.id),children:W.order_type===I.m.DineIn?"ยกเลิกเสิร์ฟ":"ยกเลิกปรุงเสร็จ"}):null}];return(0,a.jsxs)("div",{style:D.B9.container,className:"order-detail-page",children:[(0,a.jsx)(n(),{id:D.$k.__hash,children:D.$k}),(0,a.jsx)(ex.Z,{title:null!==(d=null==W?void 0:W.order_no)&&void 0!==d?d:"รายละเอียดออเดอร์",subtitle:W?(0,a.jsxs)(h.Z,{size:8,wrap:!0,children:[(0,a.jsx)(p.Z,{icon:W.order_type===I.m.DineIn?(0,a.jsx)(k.Z,{style:{fontSize:10}}):W.order_type===I.m.TakeAway?(0,a.jsx)(T.Z,{style:{fontSize:10}}):(0,a.jsx)(Z.Z,{style:{fontSize:10}}),style:{...D.B9.channelBadge,background:(0,q.Gs)(W.order_type)+"15",color:(0,q.Gs)(W.order_type)},children:(0,q.mz)(W.order_type)}),(0,a.jsx)(eb,{type:"secondary",style:{fontSize:12},children:F()(W.create_date).format("HH:mm | D MMM YY")}),(0,a.jsx)(p.Z,{color:(0,q.OY)(W.status),style:{margin:0,borderRadius:8,fontWeight:600},children:(0,q.d7)(W.status,W.order_type)}),W.order_type===I.m.DineIn&&(null===(t=W.table)||void 0===t?void 0:t.table_name)&&(0,a.jsxs)(p.Z,{color:"blue",style:{margin:0,borderRadius:8,fontWeight:600},children:["โต๊ะ: ",W.table.table_name]}),W.order_type===I.m.Delivery&&(W.delivery_code||(null===(r=W.delivery)||void 0===r?void 0:r.delivery_name))&&(0,a.jsx)(p.Z,{color:"purple",style:{margin:0,borderRadius:8,fontWeight:600},children:W.delivery_code?"รหัส: ".concat(W.delivery_code):null===(i=W.delivery)||void 0===i?void 0:i.delivery_name}),es&&(0,a.jsxs)(p.Z,{color:es.status===ef.l.Pending?"orange":es.status===ef.l.Processing?"blue":es.status===ef.l.Completed?"green":"red",style:{margin:0,borderRadius:8,fontWeight:600},children:["คิว #",es.queue_position]})]}):void 0,onBack:()=>{(null==W?void 0:W.order_type)===I.m.DineIn?H.push("/pos/channels/dine-in"):H.back()},icon:(0,a.jsx)(A.Z,{style:{fontSize:20}}),actions:(0,a.jsx)(y.ZP,{icon:(0,a.jsx)(E.Z,{}),onClick:()=>M&&eE(M),loading:J||Q,children:"รีเฟรช"})}),W&&W.status!==I.i.Cancelled&&W.status!==I.i.Completed&&(0,a.jsx)("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"flex-end",gap:8,background:D._A.backgroundSecondary,borderBottom:"1px solid ".concat(D._A.border)},children:es?(0,a.jsx)(y.ZP,{danger:!0,icon:(0,a.jsx)(C.Z,{}),onClick:()=>{en(es.id)},loading:eo,size:"middle",style:{borderRadius:10,height:36,fontWeight:500,fontSize:13},className:"scale-hover queue-action-button",children:"ลบออกจากคิว"}):(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)(A.Z,{}),onClick:()=>{ei({orderId:W.id,priority:ef.t.Normal})},loading:eo,size:"middle",style:{borderRadius:10,height:36,fontWeight:500,fontSize:13,background:"linear-gradient(135deg, ".concat(D._A.primary," 0%, ").concat(D._A.primaryDark," 100%)"),border:"none",boxShadow:"0 2px 8px ".concat(D._A.primary,"25")},className:"scale-hover queue-action-button",children:"เพิ่มเข้าคิว"})}),(0,a.jsx)("main",{style:D.B9.contentWrapper,className:"order-detail-content",children:(0,a.jsxs)(g.Z,{gutter:[20,20],children:[(0,a.jsxs)(f.Z,{xs:24,lg:16,children:[(0,a.jsx)(x.Z,{className:"order-detail-card fade-in",style:D.B9.card,title:(0,a.jsxs)("div",{className:"card-header-wrapper",children:[(0,a.jsxs)("div",{className:"card-header-top-row",children:[(0,a.jsxs)("div",{className:"card-header-left",children:[(0,a.jsx)("div",{style:D.B9.masterCheckboxWrapper,children:(0,a.jsx)(v.Z,{indeterminate:el.length>0&&el.length<ez.length,checked:ez.length>0&&el.length===ez.length,onChange:e=>{e.target.checked?ej(ez.map(e=>e.id)):ej([])},style:D.B9.masterCheckbox})}),(0,a.jsxs)(eb,{strong:!0,style:D.Qo.sectionTitle,className:"section-title-text",children:["กำลังทำอาหาร (",ez.length,")"]})]}),(0,a.jsx)("div",{className:"card-header-right",children:(0,a.jsxs)("div",{className:"header-actions-container",children:[(0,a.jsx)(y.ZP,{icon:(0,a.jsx)(E.Z,{}),onClick:()=>eE(M),size:"small",style:D.B9.actionButtonSecondary,className:"header-action-btn",title:"รีเฟรช"}),(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)(z.Z,{}),onClick:()=>eP(!0),size:"small",style:D.B9.actionButtonPrimary,className:"header-action-btn",children:(0,a.jsx)("span",{children:"เพิ่ม"})})]})})]}),el.length>0&&(0,a.jsxs)("div",{className:"bulk-actions-container",children:[(0,a.jsx)(y.ZP,{danger:!0,icon:(0,a.jsx)(C.Z,{}),onClick:eM,size:"small",className:"bulk-action-btn",children:(0,a.jsxs)("span",{children:["ยกเลิก (",el.length,")"]})}),(0,a.jsx)(y.ZP,{type:"primary",icon:(0,a.jsx)(w.Z,{}),onClick:eU,loading:J,size:"small",style:{background:D._A.served,borderColor:D._A.served},className:"bulk-action-btn",children:(0,a.jsxs)("span",{children:[(0,q.qO)(W.order_type)," (",el.length,")"]})})]})]}),children:ez.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"order-detail-table-desktop",children:(0,a.jsx)(b.Z,{dataSource:eR,columns:e$,rowKey:"id",virtual:eq,scroll:eq?{y:420}:void 0,pagination:!1,size:"middle",className:"order-items-table",rowSelection:{selectedRowKeys:el,onChange:e=>{ej(e)},hideSelectAll:!0}})}),(0,a.jsx)("div",{className:"order-detail-cards-mobile",children:eR.map(e=>{var t,r,i,n,o,s;return(0,a.jsxs)("div",{style:{...D.B9.itemCard,...D.B9.itemCardActive},className:"order-item-card scale-in",children:[(0,a.jsxs)("div",{style:{display:"flex",gap:10,marginBottom:10},children:[(0,a.jsx)("div",{style:{flexShrink:0},children:(null===(t=e.product)||void 0===t?void 0:t.img_url)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{src:e.product.img_url,alt:null!==(s=null===(r=e.product)||void 0===r?void 0:r.display_name)&&void 0!==s?s:"สินค้า",style:{...D.B9.productThumb,width:56,height:56,borderRadius:10}})}):(0,a.jsx)("div",{style:{...D.B9.productThumbPlaceholder,width:56,height:56,borderRadius:10},children:(0,a.jsx)(k.Z,{style:{fontSize:20}})})}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsx)(v.Z,{checked:el.includes(e.id),onChange:t=>{ej(t.target.checked?[...el,e.id]:el.filter(t=>t!==e.id))},children:(0,a.jsx)(eb,{strong:!0,style:{fontSize:17,lineHeight:1.5},children:null===(i=e.product)||void 0===i?void 0:i.display_name})}),(0,a.jsx)("div",{style:{paddingLeft:24,marginTop:2},children:(null===(o=e.product)||void 0===o?void 0:null===(n=o.category)||void 0===n?void 0:n.display_name)&&(0,a.jsx)(p.Z,{color:"cyan",style:{...D.B9.categoryTag,fontSize:9},children:e.product.category.display_name})})]}),(0,a.jsxs)(eb,{strong:!0,style:{fontSize:19,color:D._A.primary,marginLeft:8,lineHeight:1.4},children:["x",e.quantity]})]}),(0,a.jsxs)("div",{style:{paddingLeft:24,marginTop:2},children:[e.details&&e.details.length>0&&(0,a.jsx)("div",{style:{fontSize:13,color:D._A.served,marginBottom:4,lineHeight:1.4},children:e.details.map(e=>"".concat(e.detail_name," (+ ฿").concat(Number(e.extra_price).toLocaleString(),")")).join(", ")}),(0,a.jsx)(h.Z,{orientation:"vertical",size:2,children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsxs)(eb,{style:{...D.B9.priceTag,fontSize:15},children:["฿",Number(e.price).toLocaleString()]}),(0,a.jsxs)(eb,{strong:!0,style:{color:D._A.priceTotal,fontSize:16},children:["รวม ฿",Number(e.total_price).toLocaleString()]})]})}),e.notes&&(0,a.jsx)("div",{style:{marginTop:4},children:(0,a.jsxs)(eb,{style:{fontSize:13,color:D._A.cancelled,lineHeight:1.4},children:[(0,a.jsx)(S.Z,{style:{fontSize:13}})," ",e.notes]})})]})]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",borderTop:"1px solid ".concat(D._A.border),paddingTop:10,gap:6,marginTop:10},children:[(0,a.jsx)(y.ZP,{size:"small",type:"text",danger:!0,icon:(0,a.jsx)(C.Z,{}),onClick:()=>eG(e.id),style:{height:34,borderRadius:8,fontSize:13,padding:"0 12px",fontWeight:500},className:"scale-hover",children:"ลบ"}),(0,a.jsx)(y.ZP,{size:"small",type:"text",icon:(0,a.jsx)(_.Z,{}),onClick:()=>eX(e),style:{height:34,borderRadius:8,fontSize:13,padding:"0 12px",fontWeight:500},className:"scale-hover",children:"แก้ไข"}),(0,a.jsxs)(y.ZP,{size:"small",type:"primary",onClick:()=>eF(e.id),style:{background:D._A.served,borderColor:D._A.served,height:34,padding:"0 14px",borderRadius:8,fontSize:13,fontWeight:600},className:"scale-hover",children:[(0,a.jsx)(w.Z,{style:{fontSize:13,marginRight:4}}),(0,q.qO)(W.order_type)]})]})]},e.id)})})]}):(0,a.jsxs)("div",{style:D.B9.emptyState,children:[(0,a.jsx)(N.Z,{className:"empty-state-icon"}),(0,a.jsx)(eb,{className:"empty-state-text",children:"ไม่มีรายการที่กำลังรอ"})]})}),(0,a.jsx)(x.Z,{className:"order-detail-card fade-in",style:D.B9.card,title:(0,a.jsxs)(eb,{strong:!0,style:{...D.Qo.sectionTitle,color:D._A.textSecondary},children:[(0,q.zP)(W.order_type)," (",eN.length,")"]}),children:eN.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"order-detail-table-desktop",children:(0,a.jsx)(b.Z,{dataSource:eO,columns:eK,rowKey:"id",virtual:eH,scroll:eH?{y:360}:void 0,pagination:!1,size:"small",className:"order-items-table",rowClassName:e=>e.status===I.i.Cancelled?"row-cancelled":""})}),(0,a.jsx)("div",{className:"order-detail-cards-mobile",children:eO.map(e=>{var t,r,i,n,o,s;return(0,a.jsxs)("div",{style:{...D.B9.itemCard,...D.B9.itemCardServed,backgroundColor:e.status===I.i.Cancelled?D._A.cancelledLight:D._A.white,borderColor:e.status===I.i.Cancelled?D._A.cancelled+"30":D._A.border,position:"relative"},children:[(0,a.jsx)("div",{style:{position:"absolute",top:10,right:10},children:(0,a.jsx)(p.Z,{color:(0,q.OY)(e.status),style:{margin:0,fontSize:10,padding:"2px 8px",borderRadius:6,lineHeight:1.2},children:(0,q.d7)(e.status,W.order_type)})}),(0,a.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,a.jsx)("div",{style:{flexShrink:0},children:(null===(t=e.product)||void 0===t?void 0:t.img_url)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{src:e.product.img_url,alt:null!==(s=null===(r=e.product)||void 0===r?void 0:r.display_name)&&void 0!==s?s:"สินค้า",style:{...D.B9.productThumb,width:52,height:52,borderRadius:10,opacity:.7}})}):(0,a.jsx)("div",{style:{...D.B9.productThumbPlaceholder,width:52,height:52,borderRadius:10},children:(0,a.jsx)(k.Z,{style:{fontSize:18}})})}),(0,a.jsx)("div",{style:{flex:1,minWidth:0,paddingRight:50},children:(0,a.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:16,textDecoration:e.status===I.i.Cancelled?"line-through":"none",color:e.status===I.i.Cancelled?D._A.textLight:D._A.text,lineHeight:1.5},children:null===(i=e.product)||void 0===i?void 0:i.display_name}),(0,a.jsx)("div",{style:{marginTop:2},children:(null===(o=e.product)||void 0===o?void 0:null===(n=o.category)||void 0===n?void 0:n.display_name)&&(0,a.jsx)(p.Z,{color:"cyan",style:{...D.B9.categoryTag,fontSize:9},children:e.product.category.display_name})}),e.details&&e.details.length>0&&(0,a.jsx)("div",{style:{fontSize:13,color:D._A.served,opacity:.7,marginBottom:4,lineHeight:1.4},children:e.details.map(e=>"".concat(e.detail_name," (+ ฿").concat(Number(e.extra_price).toLocaleString(),")")).join(", ")}),(0,a.jsx)(h.Z,{orientation:"vertical",size:2,style:{marginTop:4,width:"100%"},children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(eb,{style:{...D.B9.priceTag,fontSize:14,opacity:.7},children:["฿",Number(e.price).toLocaleString()]}),(0,a.jsxs)(eb,{strong:!0,style:{marginLeft:8,color:D._A.textSecondary,opacity:.7,fontSize:15},children:["รวม ฿",Number(e.total_price).toLocaleString()]})]}),(0,a.jsxs)(eb,{strong:!0,style:{color:D._A.textSecondary,fontSize:15},children:["x",e.quantity]})]})}),e.notes&&(0,a.jsx)("div",{style:{marginTop:4},children:(0,a.jsxs)(eb,{style:{fontSize:13,opacity:.7,color:D._A.cancelled,lineHeight:1.4},children:[(0,a.jsx)(S.Z,{style:{fontSize:13}})," ",e.notes]})})]})})})]}),e.status===I.i.Served&&(0,a.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10,paddingTop:10,borderTop:"1px solid ".concat(D._A.border)},children:(0,a.jsx)(y.ZP,{size:"small",className:"unserve-button",style:{...D.B9.unserveButton,height:34,fontSize:13,padding:"0 14px",borderRadius:8,fontWeight:500},icon:(0,a.jsx)(P.Z,{style:{fontSize:13}}),onClick:()=>eW(e.id),children:(null==W?void 0:W.order_type)===I.m.DineIn?"ยกเลิกเสิร์ฟ":"ยกเลิกปรุงเสร็จ"})})]},e.id)})})]}):(0,a.jsx)("div",{style:{textAlign:"center",padding:"20px 0"},children:(0,a.jsx)(eb,{type:"secondary",children:"ยังไม่มีรายการที่ดำเนินการแล้ว"})})})]}),(0,a.jsx)(f.Z,{xs:24,lg:8,children:(0,a.jsxs)(x.Z,{className:"order-detail-card summary-card",style:D.B9.summaryCard,children:[(0,a.jsx)(ev,{level:5,style:{marginBottom:16,fontSize:18,fontWeight:600},children:"สรุปการสั่งซื้อ"}),(0,a.jsxs)("div",{style:{...D.B9.summaryList,background:"white"},children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:15,marginBottom:10,display:"block",color:D._A.textSecondary},children:"รายการสินค้า"}),eI.map((e,t)=>{var r,i,n;return(0,a.jsxs)("div",{style:D.B9.summaryItemRow,children:[(null===(r=e.product)||void 0===r?void 0:r.img_url)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("img",{src:e.product.img_url,alt:(null===(i=e.product)||void 0===i?void 0:i.display_name)||"สินค้า",style:D.B9.summaryItemImage})}):(0,a.jsx)("div",{style:{...D.B9.summaryItemImage,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8fafc"},children:(0,a.jsx)(k.Z,{style:{fontSize:16,color:"#bfbfbf"}})}),(0,a.jsxs)("div",{style:D.B9.summaryItemContent,children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:15,flex:1,lineHeight:1.4},children:null===(n=e.product)||void 0===n?void 0:n.display_name}),(0,a.jsxs)(eb,{strong:!0,style:{fontSize:15,color:D._A.primary,lineHeight:1.4},children:["฿",Number(e.total_price).toLocaleString()]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:4},children:[(0,a.jsxs)(eb,{type:"secondary",style:{fontSize:13,lineHeight:1.4},children:["จำนวน : ",e.quantity]}),(0,a.jsxs)(eb,{type:"secondary",style:{fontSize:13,lineHeight:1.4},children:["ราคา : ",Number(e.price).toLocaleString()]})]}),e.details&&e.details.length>0&&(0,a.jsxs)("div",{style:D.B9.summaryDetailText,children:[(0,a.jsx)(z.Z,{style:{fontSize:10}})," ",e.details.map(e=>"".concat(e.detail_name," (+").concat(Number(e.extra_price).toLocaleString(),")")).join(", ")]}),e.notes&&(0,a.jsxs)("div",{style:{...D.B9.summaryDetailText,color:D._A.cancelled,fontStyle:"italic"},children:["โน้ต: ",e.notes]})]})]},e.id||t)})]}),(0,a.jsxs)("div",{style:D.B9.summaryList,children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:15,marginBottom:10,display:"block",color:D._A.textSecondary},children:"แยกตามหมวดหมู่"}),Object.entries((0,q.Rr)((null==W?void 0:W.items)||[])).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{style:D.B9.summaryRow,children:[(0,a.jsx)(eb,{type:"secondary",style:{fontSize:14,lineHeight:1.4},children:t}),(0,a.jsxs)(eb,{strong:!0,style:{fontSize:14,lineHeight:1.4},children:[String(r)," รายการ"]})]},t)}),(0,a.jsx)(j.Z,{style:{margin:"10px 0"}}),(0,a.jsxs)("div",{style:D.B9.summaryRow,children:[(0,a.jsx)(eb,{type:"secondary",style:{fontSize:14,lineHeight:1.4},children:"จำนวนรายการทั้งหมด"}),(0,a.jsxs)(eb,{strong:!0,style:{fontSize:14,lineHeight:1.4},children:[eB.length," รายการ"]})]})]}),(0,a.jsx)("div",{style:{padding:"0 4px"},children:(0,a.jsxs)("div",{style:D.B9.summaryMainRow,children:[(0,a.jsx)(eb,{strong:!0,style:{fontSize:20,lineHeight:1.3},children:"ยอดรวมทั้งสิ้น"}),(0,a.jsxs)(eb,{strong:!0,style:{fontSize:28,color:D._A.primary,lineHeight:1.2},children:["฿",eL.toLocaleString()]})]})}),eD&&(0,a.jsx)(y.ZP,{type:"primary",block:!0,size:"large",onClick:eY,style:{marginTop:16,height:48,borderRadius:10,fontWeight:600,fontSize:16,background:"linear-gradient(135deg, ".concat(D._A.served," 0%, #059669 100%)"),border:"none",boxShadow:"0 4px 12px ".concat(D._A.served,"25")},className:"scale-hover",children:(0,q.iN)(W.order_type)}),(0,a.jsx)(y.ZP,{danger:!0,block:!0,size:"large",onClick:()=>{W&&eZ({open:!0,type:"danger",title:"ยืนยันการยกเลิกออเดอร์?",content:"การดำเนินการนี้จะยกเลิกสินค้าทุกรายการและคืนสถานะโต๊ะ (หากมี) คุณแน่ใจหรือไม่?",okText:"ยืนยันการยกเลิก",cancelText:"ยกเลิก",onOk:async()=>{try{var e;Y(!0),$("กำลังดำเนินการยกเลิก..."),eA();let t=await (0,O.P)(),r=(null===(e=W.items)||void 0===e?void 0:e.filter(e=>e.status!==I.i.Cancelled))||[];await Promise.all(r.map(e=>R.x.updateItemStatus(e.id,I.i.Cancelled,void 0,t))),await R.x.updateStatus(W.id,I.i.Cancelled,t),W.table_id&&await B.$.update(W.table_id,{status:L.c.Available},void 0,t),c.ZP.success("ยกเลิกออเดอร์เรียบร้อย"),H.push((0,q.d$)(W.order_type))}catch(e){c.ZP.error("ไม่สามารถยกเลิกออเดอร์ได้")}finally{Y(!1),K()}}})},style:{marginTop:12,height:44,borderRadius:10,fontWeight:500,fontSize:15,border:"1px solid ".concat(D._A.danger)},disabled:J,className:"scale-hover",children:"ยกเลิกออเดอร์"})]})})]})}),(0,a.jsx)(ea,{isOpen:eC,onClose:()=>eP(!1),onAddItem:eJ,orderType:null==W?void 0:W.order_type}),ek&&ew&&(0,a.jsx)(ed,{item:ew,isOpen:ek,onClose:()=>{eS(!1),e_(null)},onSave:eQ},"edit-modal-".concat(ew.id)),(0,a.jsx)(ec.Z,{open:eT.open,type:eT.type,title:eT.title,content:eT.content,okText:eT.okText,cancelText:eT.cancelText,onOk:eT.onOk,onCancel:eA,loading:J})]})}F().locale("th")},60300:function(e,t,r){"use strict";var a=r(57437),i=r(29),n=r.n(i);r(2265);var o=r(39486),s=r(47213),l=r(53743),d=r(50742),c=r(54537),u=r(15516),h=r(8900),p=r(55726),m=r(91619);let{Title:y,Text:g}=o.default;t.Z=e=>{let{open:t,type:r="confirm",title:i,content:o,okText:f="ยืนยัน",cancelText:x="ยกเลิก",onOk:v,onCancel:b,loading:j=!1,icon:k}=e,S=()=>{switch(r){case"danger":return"#ff4d4f";case"warning":return"#faad14";case"success":return"#52c41a";default:return"#1890ff"}},w=S();return(0,a.jsx)(s.ZP,{theme:{components:{Modal:{contentBg:"#ffffff",headerBg:"#ffffff",borderRadiusLG:24},Button:{borderRadius:12,controlHeightLG:48,fontSizeLG:16,fontWeight:600}}},children:(0,a.jsxs)(l.Z,{open:t,onCancel:b,footer:null,centered:!0,width:360,closable:!1,styles:{mask:{backdropFilter:"blur(8px)",background:"rgba(0, 0, 0, 0.25)"}},className:"soft-confirm-modal",children:[(0,a.jsxs)("div",{style:{padding:"32px 24px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},className:"jsx-14a62d28233e1b8c",children:[(0,a.jsx)("div",{style:{marginBottom:20,width:80,height:80,borderRadius:"40%",backgroundColor:"".concat(w,"15"),display:"flex",alignItems:"center",justifyContent:"center",animation:"float 3s ease-in-out infinite"},className:"jsx-14a62d28233e1b8c",children:(()=>{if(k)return k;let e={fontSize:48,color:S()};switch(r){case"danger":return(0,a.jsx)(c.Z,{style:e});case"warning":return(0,a.jsx)(u.Z,{style:e});case"success":return(0,a.jsx)(h.Z,{style:e});case"info":return(0,a.jsx)(p.Z,{style:e});default:return(0,a.jsx)(m.Z,{style:e})}})()}),(0,a.jsx)(y,{level:4,style:{marginBottom:12,fontWeight:700,color:"#1f1f1f"},children:i}),(0,a.jsx)("div",{style:{marginBottom:32,width:"100%"},className:"jsx-14a62d28233e1b8c",children:"string"==typeof o?(0,a.jsx)(g,{type:"secondary",style:{fontSize:16,lineHeight:1.6},children:o}):o}),(0,a.jsxs)("div",{style:{width:"100%",display:"flex",gap:12,flexDirection:"row"},className:"jsx-14a62d28233e1b8c",children:[(0,a.jsx)(d.ZP,{block:!0,size:"large",onClick:b,disabled:j,style:{border:"none",background:"#f5f5f5",color:"#595959",boxShadow:"none"},className:"hover-scale",children:x}),(0,a.jsx)(d.ZP,{block:!0,type:"primary",size:"large",onClick:v,loading:j,style:{background:w,border:"none",boxShadow:"0 8px 20px ".concat(w,"40")},className:"hover-scale",children:f})]})]}),(0,a.jsx)(n(),{id:"14a62d28233e1b8c",children:"@-webkit-keyframes float{0%{-webkit-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-5px);transform:translatey(-5px)}100%{-webkit-transform:translatey(0px);transform:translatey(0px)}}@-moz-keyframes float{0%{-moz-transform:translatey(0px);transform:translatey(0px)}50%{-moz-transform:translatey(-5px);transform:translatey(-5px)}100%{-moz-transform:translatey(0px);transform:translatey(0px)}}@-o-keyframes float{0%{-o-transform:translatey(0px);transform:translatey(0px)}50%{-o-transform:translatey(-5px);transform:translatey(-5px)}100%{-o-transform:translatey(0px);transform:translatey(0px)}}@keyframes float{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-5px);-moz-transform:translatey(-5px);-o-transform:translatey(-5px);transform:translatey(-5px)}100%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}}.hover-scale{-webkit-transition:-webkit-transform.2s cubic-bezier(.34,1.56,.64,1);-moz-transition:-moz-transform.2s cubic-bezier(.34,1.56,.64,1);-o-transition:-o-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-webkit-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-moz-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-o-transform.2s cubic-bezier(.34,1.56,.64,1);transition:transform.2s cubic-bezier(.34,1.56,.64,1)}.hover-scale:active{-webkit-transform:scale(.96);-moz-transform:scale(.96);-ms-transform:scale(.96);-o-transform:scale(.96);transform:scale(.96)}@media(max-width:480px){.soft-confirm-modal .ant-modal-content{-webkit-border-radius:20px!important;-moz-border-radius:20px!important;border-radius:20px!important}}.soft-confirm-modal .ant-modal-content{-webkit-box-shadow:0 20px 50px rgba(0,0,0,.1)!important;-moz-box-shadow:0 20px 50px rgba(0,0,0,.1)!important;box-shadow:0 20px 50px rgba(0,0,0,.1)!important;padding:0!important}"})]})})}},20148:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var a=r(57437);r(2265);var i=r(17588),n=r(2651),o=r(38616),s=r(10868),l=r(50742),d=r(39486),c=r(87530);function u(e){let{title:t,subtitle:r,icon:u,onBack:h,actions:p,style:m}=e,{token:y}=n.default.useToken(),g=o.default.useBreakpoint().md?c.H.pagePaddingXDesktop:c.H.pagePaddingXMobile;return(0,a.jsx)("div",{style:{padding:"".concat(c.H.pagePaddingY,"px ").concat(g,"px"),background:y.colorBgContainer,borderBottom:"1px solid ".concat(y.colorBorderSecondary),...m},children:(0,a.jsxs)(s.Z,{align:"center",justify:"space-between",wrap:"wrap",gap:12,style:{maxWidth:c.H.pageMaxWidth,margin:"0 auto"},children:[(0,a.jsxs)(s.Z,{align:"center",gap:12,style:{minWidth:0},children:[h&&(0,a.jsx)(l.ZP,{type:"text","aria-label":"ย้อนกลับ",icon:(0,a.jsx)(i.Z,{}),onClick:h,style:{borderRadius:12,width:44,height:44}}),u&&(0,a.jsx)("div",{style:{width:44,height:44,borderRadius:14,display:"grid",placeItems:"center",background:y.colorFillTertiary,color:y.colorText},children:u}),(0,a.jsxs)("div",{style:{minWidth:0},children:[(0,a.jsx)(d.default.Title,{level:4,style:{margin:0},children:t}),r&&(0,a.jsx)(d.default.Text,{type:"secondary",children:r})]})]}),p&&(0,a.jsx)(s.Z,{gap:8,wrap:"wrap",children:p})]})})}},87530:function(e,t,r){"use strict";r.d(t,{H:function(){return a}});let a={pageMaxWidth:1200,pagePaddingXMobile:16,pagePaddingXDesktop:24,pagePaddingY:16,sectionGap:16,cardRadius:16,cardRadiusLG:20,cardShadow:"0 10px 24px rgba(15, 23, 42, 0.08)",surfaceBg:"#ffffff",surfaceBorder:"#e2e8f0"}},71567:function(e,t,r){"use strict";r.d(t,{q:function(){return i},v:function(){return a}});let a="/api",i={AUTH:{LOGIN:"/auth/login",LOGOUT:"/auth/logout",ME:"/auth/me",CSRF:"/csrf",SWITCH_BRANCH:"/auth/switch-branch"},AUDIT:{LOGS:"/audit/logs"},POS:{PRODUCTS:"/pos/products",ORDERS:"/pos/orders",TABLES:"/pos/tables",DISCOUNTS:"/pos/discounts",DELIVERY:"/pos/delivery",PAYMENT_METHODS:"/pos/paymentMethod",PAYMENTS:"/pos/payments",CATEGORY:"/pos/category",SHIFTS:{BASE:"/pos/shifts",CURRENT:"/pos/shifts/current",OPEN:"/pos/shifts/open",CLOSE:"/pos/shifts/close"},DASHBOARD:{SALES:"/pos/dashboard/sales",TOP_ITEMS:"/pos/dashboard/top-items"},CHANNELS:{STATS:"/pos/orders/stats"},SHOP_PROFILE:"/pos/shopProfile",SALES_ORDER_ITEMS:"/pos/salesOrderItem",SALES_ORDER_DETAILS:"/pos/salesOrderDetail",PRODUCTS_UNIT:"/pos/productsUnit",PAYMENT_DETAILS:"/pos/paymentDetails",BRANCH:"/branches",ORDER_QUEUE:"/pos/queue"}}},14362:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return h},a:function(){return p}});var a=r(57437),i=r(2265),n=r(99376),o=r(5447),s=r(84859),l=r(48651),d=r(3369),c=r(36799);let u=(0,i.createContext)(void 0),h=e=>{let{children:t}=e,[r,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(!0),y=(0,n.useRouter)(),g=(0,n.usePathname)(),f=async()=>{try{let e=await o.O.getMe();h(e)}catch(e){h(null)}finally{m(!1)}};(0,i.useEffect)(()=>{f()},[]);let{showLoading:x,hideLoading:v}=(0,d.x)();(0,i.useEffect)(()=>{p||r||"/login"===g||y.push("/login")},[r,p,g,y]);let b=async e=>{try{x((0,c.t)("auth.loadingLogin"));let t=await o.O.getCsrfToken(),{token:r,...a}=await o.O.login(e,t);h(a),y.push("/")}catch(e){throw e}finally{v()}},j=async()=>{try{x((0,c.t)("auth.loadingLogout")),await o.O.logout(),s.x.clearQueue(),h(null),y.push("/login")}catch(e){console.error("Logout error:",e)}finally{v()}};return p?(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"#ffffff"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",padding:"24px",background:"#ffffff",borderRadius:"20px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)(l.Z,{size:"large"}),(0,a.jsx)("div",{style:{color:"#64748b",fontSize:"14px",fontWeight:500},children:"กำลังตรวจสอบสิทธิ์..."})]})}):r||"/login"===g?(0,a.jsx)(u.Provider,{value:{user:r,loading:p,login:b,logout:j,checkAuth:f},children:t}):null},p=()=>{let e=(0,i.useContext)(u);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},46252:function(e,t,r){"use strict";r.d(t,{J:function(){return l},SocketProvider:function(){return d}});var a=r(57437),i=r(2265),n=r(68680),o=r(34029),s=r(14362);let l=(0,i.createContext)({socket:null,isConnected:!1}),d=e=>{let{children:t}=e,[r,d]=(0,i.useState)(null),[c,u]=(0,i.useState)(!1),h=(0,i.useRef)(!1),{user:p}=(0,s.a)();return(0,i.useEffect)(()=>{var e;if(!p){r&&(r.disconnect(),d(null),u(!1));return}let t=(null===(e=p.branch)||void 0===e?void 0:e.id)||p.branch_id||null,a=(0,n.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:{userId:p.id,branchId:t},reconnection:!0,reconnectionAttempts:5,reconnectionDelay:800,reconnectionDelayMax:8e3});return a.on("connect",()=>{console.log("Socket Connected:",a.id),u(!0),h.current=!1,o.ZP.success({content:"เชื่อมต่อเรียลไทม์แล้ว",key:"socket-status",duration:1.5})}),a.on("disconnect",()=>{console.log("Socket Disconnected"),u(!1),h.current||(h.current=!0,o.ZP.warning({content:"การเชื่อมต่อเรียลไทม์หลุด กำลังพยายามเชื่อมต่อใหม่...",key:"socket-status",duration:2}))}),a.io.on("reconnect_attempt",e=>{console.log("Socket reconnect attempt",e),u(!1)}),a.io.on("reconnect_failed",()=>{console.log("Socket reconnect failed"),o.ZP.error({content:"เชื่อมต่อเรียลไทม์ไม่สำเร็จ",key:"socket-status",duration:2})}),d(a),()=>{a.disconnect()}},[null==p?void 0:p.id]),(0,a.jsx)(l.Provider,{value:{socket:r,isConnected:c},children:t})}},3369:function(e,t,r){"use strict";r.d(t,{GlobalLoadingProvider:function(){return l},O:function(){return c},x:function(){return d}});var a=r(57437),i=r(2265),n=r(48651);let o=(0,i.createContext)(void 0),s=(0,i.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,i.useState)({}),[d,c]=(0,i.useState)(void 0),u=(0,i.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";l(e=>({...e,[t]:(e[t]||0)+1})),e&&c(e)},[]),h=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";l(t=>{if(!t[e])return t;let r={...t};return r[e]-=1,r[e]<=0&&delete r[e],r})},[]),p=(0,i.useCallback)(()=>{l({}),c(void 0)},[]),m=Object.keys(r).length>0,y=(0,i.useMemo)(()=>({isLoading:m,loadingMessage:d}),[m,d]),g=(0,i.useMemo)(()=>({showLoading:u,hideLoading:h,resetLoading:p}),[u,h,p]);return(0,a.jsx)(s.Provider,{value:g,children:(0,a.jsxs)(o.Provider,{value:y,children:[t,m&&(0,a.jsx)("div",{role:"status","aria-live":"polite",className:"global-loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:13e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(6px)",WebkitBackdropFilter:"blur(6px)",transition:"opacity 0.25s ease"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16,background:"rgba(255, 255, 255, 0.95)",padding:"28px 40px",borderRadius:20,boxShadow:"0 10px 32px rgba(15, 23, 42, 0.14)",border:"1px solid rgba(148, 163, 184, 0.35)",minWidth:240,textAlign:"center"},children:[(0,a.jsx)(n.Z,{size:"large"}),d&&(0,a.jsx)("div",{style:{fontSize:16,color:"#334155",fontWeight:600,letterSpacing:"0.01em"},children:d})]})})]})})};function d(){let e=(0,i.useContext)(o),t=(0,i.useContext)(s);if(!e||!t)throw Error("useGlobalLoading must be used within a GlobalLoadingProvider");return(0,i.useMemo)(()=>({...e,...t}),[e,t])}function c(){let e=(0,i.useContext)(s);if(!e)throw Error("useGlobalLoadingDispatch must be used within a GlobalLoadingProvider");return e}},88444:function(e,t,r){"use strict";r.d(t,{G:function(){return h}});var a=r(29827),i=r(11713),n=r(21770),o=r(2265),s=r(46252),l=r(86198),d=r(34029),c=r(12028),u=r(36799);function h(e){let{socket:t}=(0,o.useContext)(s.J),r=(0,a.NL)(),h=["orderQueue",e||"all"],{data:p=[],isLoading:m,error:y,refetch:g}=(0,i.a)({queryKey:h,queryFn:async()=>await l.e.getAll(void 0,e),staleTime:2e3});(0,o.useEffect)(()=>{if(!t)return;let a=(e,t)=>{let r=e.findIndex(e=>e.id===t.id);if(-1===r)return[t,...e];let a=e.slice();return a[r]=t,a},i=(e,t)=>e.filter(e=>e.id!==t),n=e=>{let t={Urgent:4,High:3,Normal:2,Low:1};return e.slice().sort((e,r)=>{let a=(t[r.priority]||0)-(t[e.priority]||0);return 0!==a?a:(e.queue_position||0)-(r.queue_position||0)})},o=e=>{r.getQueriesData({queryKey:["orderQueue"]}).forEach(t=>{let[a,i]=t;i&&r.setQueryData(a,e(i,a))})},s=e=>{o((t,r)=>{let i=r[1];return"all"!==i&&i&&e.status!==i?t:n(a(t,e))})},l=e=>{o((t,r)=>{let o=r[1],s="all"===o||!o||e.status===o,l=i(t,e.id);return s?n(a(l,e)):l})},d=e=>{o(t=>i(t,e.id))},u=t=>{var a;if(!(null==t?void 0:null===(a=t.updates)||void 0===a?void 0:a.length)){r.invalidateQueries({queryKey:["orderQueue",e||"all"],exact:!0});return}let i=new Map(t.updates.map(e=>[e.id,e]));o(e=>n(e.map(e=>{let t=i.get(e.id);return t?{...e,queue_position:t.queue_position,...t.priority?{priority:t.priority}:{}}:e})))};return t.on(c.b.orderQueue.added,s),t.on(c.b.orderQueue.updated,l),t.on(c.b.orderQueue.removed,d),t.on(c.b.orderQueue.reordered,u),()=>{t.off(c.b.orderQueue.added,s),t.off(c.b.orderQueue.updated,l),t.off(c.b.orderQueue.removed,d),t.off(c.b.orderQueue.reordered,u)}},[t,r,e]);let f=(0,n.D)({mutationFn:e=>l.e.addToQueue(e),onSuccess:()=>{r.invalidateQueries({queryKey:h,exact:!0}),d.ZP.success((0,u.t)("queue.addSuccess"))},onError:e=>{d.ZP.error(e.message||(0,u.t)("queue.addError"))}}),x=(0,n.D)({mutationFn:e=>{let{id:t,data:r}=e;return l.e.updateStatus(t,r)},onSuccess:()=>{r.invalidateQueries({queryKey:h,exact:!0}),d.ZP.success((0,u.t)("queue.updateStatusSuccess"))},onError:e=>{d.ZP.error(e.message||(0,u.t)("queue.updateStatusError"))}}),v=(0,n.D)({mutationFn:e=>l.e.removeFromQueue(e),onSuccess:()=>{r.invalidateQueries({queryKey:h,exact:!0}),d.ZP.success((0,u.t)("queue.removeSuccess"))},onError:e=>{d.ZP.error(e.message||(0,u.t)("queue.removeError"))}}),b=(0,n.D)({mutationFn:()=>l.e.reorderQueue(),onSuccess:()=>{r.invalidateQueries({queryKey:h,exact:!0}),d.ZP.success((0,u.t)("queue.reorderSuccess"))},onError:e=>{d.ZP.error(e.message||(0,u.t)("queue.reorderError"))}});return{queue:p,isLoading:m,error:y,refetch:g,addToQueue:f.mutate,updateStatus:x.mutate,removeFromQueue:v.mutate,reorderQueue:b.mutate,isAdding:f.isPending,isUpdating:x.isPending,isRemoving:v.isPending,isReordering:b.isPending}}},20920:function(e,t,r){"use strict";r.d(t,{L:function(){return i}});var a=r(2265);function i(){let[e,t]=(0,a.useState)("undefined"==typeof navigator||navigator.onLine);return(0,a.useEffect)(()=>{let e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e),window.addEventListener("offline",r),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}},[]),e}},24675:function(e,t,r){"use strict";r.d(t,{s:function(){return n}});var a=r(2265),i=r(46252);let n=()=>(0,a.useContext)(i.J)},2913:function(e,t,r){"use strict";function a(e,t){return({GET:"".concat(i.API_BASE_URL).concat(t),POST:"".concat(i.API_BASE_URL).concat(t),PUT:"".concat(i.API_BASE_URL).concat(t),DELETE:"".concat(i.API_BASE_URL).concat(t),PATCH:"".concat(i.API_BASE_URL).concat(t)})[e]}r.d(t,{b:function(){return a}});let i={get API_BASE_URL(){return"/api"}}},5447:function(e,t,r){"use strict";r.d(t,{O:function(){return o}});var a=r(71567),i=r(2913),n=r(98170);let o={login:async(e,t,r)=>{try{let s=(0,i.b)("POST",a.q.AUTH.LOGIN),l={"Content-Type":"application/json"};t&&(l["X-CSRF-Token"]=t),r&&(l.Cookie=r);let d=await fetch(s,{method:"POST",headers:l,credentials:"include",body:JSON.stringify(e)});if(!d.ok){var o;let e=await d.json().catch(()=>({})),t=(null==e?void 0:null===(o=e.error)||void 0===o?void 0:o.message)||e.message||e.detail||"Login failed";throw Error(t)}let c=(0,n.hH)(await d.json());return{...c.user,token:c.token}}catch(e){throw Error(e.message||"เข้าสู่ระบบไม่สำเร็จ")}},logout:async(e,t,r)=>{try{let n=(0,i.b)("POST",a.q.AUTH.LOGOUT),o={"Content-Type":"application/json"};e&&(o.Authorization="Bearer ".concat(e)),t&&(o["X-CSRF-Token"]=t),r&&(o.Cookie=r),await fetch(n,{method:"POST",headers:o,credentials:"include"})}catch(e){console.error("Logout failed",e)}},switchBranch:async(e,t,r)=>{let o=(0,i.b)("POST",a.q.AUTH.SWITCH_BRANCH),s={"Content-Type":"application/json"};t&&(s["X-CSRF-Token"]=t),r&&(s.Cookie=r);let l=await fetch(o,{method:"POST",headers:s,credentials:"include",body:JSON.stringify({branch_id:e})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to switch branch"))}return(0,n.hH)(await l.json())},getMe:async e=>{try{let t=(0,i.b)("GET",a.q.AUTH.ME),r={"Content-Type":"application/json"};e&&(r.Authorization="Bearer ".concat(e));let o=await fetch(t,{method:"GET",headers:r,credentials:"include",cache:"no-store"});if(!o.ok)throw Error("Unauthorized");return(0,n.hH)(await o.json())}catch(e){throw e}},async getCsrfToken(){try{let e=await fetch("".concat(a.v).concat(a.q.AUTH.CSRF),{credentials:"include"});if(!e.ok){let t=await e.json().catch(()=>({}));return console.error("CSRF token fetch failed:",e.status,t),""}let t=await e.json();if(t.success&&t.csrfToken||t.csrfToken)return t.csrfToken;return""}catch(e){return console.error("Failed to fetch CSRF token",e),""}}}},2838:function(e,t,r){"use strict";r.d(t,{G:function(){return o}});var a=r(2913),i=r(98170);let n="/pos/category",o={findAll:async(e,t)=>{let r=(0,a.b)("GET",n);t&&(r+="?".concat(t.toString()));let o={};e&&(o.Cookie=e);let s=await fetch(r,{cache:"no-store",credentials:"include",headers:o});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error((0,i.i_)(e,"Failed to fetch categories"))}let l=await s.json(),d=(0,i.hH)(l);if(Array.isArray(d))return d;throw Error("Invalid categories response format")},findOne:async(e,t)=>{let r=(0,a.b)("GET","".concat(n,"/").concat(e)),o={};t&&(o.Cookie=t);let s=await fetch(r,{cache:"no-store",credentials:"include",headers:o});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error((0,i.i_)(e,"Failed to fetch category"))}return(0,i.hH)(await s.json())},findOneByName:async(e,t)=>{let r=(0,a.b)("GET","".concat(n,"/name/").concat(e)),o={};t&&(o.Cookie=t);let s=await fetch(r,{cache:"no-store",credentials:"include",headers:o});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error((0,i.i_)(e,"Failed to fetch category by name"))}return(0,i.hH)(await s.json())},create:async(e,t,r)=>{let o=(0,a.b)("POST",n),s={"Content-Type":"application/json"};t&&(s.Cookie=t),r&&(s["X-CSRF-Token"]=r);let l=await fetch(o,{method:"POST",headers:s,body:JSON.stringify(e),credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,i.i_)(e,"Failed to create category"))}return(0,i.hH)(await l.json())},update:async(e,t,r,o)=>{let s=(0,a.b)("PUT","".concat(n,"/").concat(e)),l={"Content-Type":"application/json"};r&&(l.Cookie=r),o&&(l["X-CSRF-Token"]=o);let d=await fetch(s,{method:"PUT",headers:l,body:JSON.stringify(t),credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error((0,i.i_)(e,"Failed to update category"))}return(0,i.hH)(await d.json())},delete:async(e,t,r)=>{let o=(0,a.b)("DELETE","".concat(n,"/").concat(e)),s={};t&&(s.Cookie=t),r&&(s["X-CSRF-Token"]=r);let l=await fetch(o,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,i.i_)(e,"Failed to delete category"))}}}},84859:function(e,t,r){"use strict";r.d(t,{M:function(){return l},x:function(){return s}});let a="pos_offline_queue",i=()=>{let e=localStorage.getItem(a);return e?JSON.parse(e):[]},n=e=>{let t=Date.now();return e.filter(e=>t-e.timestamp<=6048e5)},o=e=>{localStorage.setItem(a,JSON.stringify(e))},s={addToQueue:(e,t)=>{let r=n(i()),a={id:"offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,payload:t,timestamp:Date.now(),retryCount:0};return o([...r,a]),a},getQueue:()=>i(),removeFromQueue:e=>{o(i().filter(t=>t.id!==e))},incrementRetry:(e,t)=>{o(i().map(r=>r.id===e?{...r,retryCount:r.retryCount+1,lastError:t}:r))},clearQueue:()=>{localStorage.removeItem(a)},pruneExceeded:()=>{o(n(i()).filter(e=>e.retryCount<=5))}},l={maxRetry:5,backoff:e=>Math.min(3e4,2e3*e)}},86198:function(e,t,r){"use strict";r.d(t,{e:function(){return l}});var a=r(2913),i=r(71567),n=r(97235);let o=i.q.POS.ORDER_QUEUE,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},l={getAll:async(e,t)=>{let r=new URLSearchParams;t&&r.append("status",t);let i=r.toString()?"".concat(o,"?").concat(r.toString()):o,n=(0,a.b)("GET",i),l=s(e,""),d=await fetch(n,{cache:"no-store",headers:l,credentials:"include"});if(!d.ok){var c;let e=await d.json().catch(()=>({}));throw Error((null===(c=e.error)||void 0===c?void 0:c.message)||e.message||"ไม่สามารถดึงข้อมูลคิวได้")}let u=await d.json();return u.success&&Array.isArray(u.data)?u.data:Array.isArray(u)?u:[]},addToQueue:async(e,t)=>{let r=(0,a.b)("POST",o),i=s(t),l=await (0,n.P)();l&&(i["X-CSRF-Token"]=l);let d=await fetch(r,{method:"POST",headers:i,credentials:"include",body:JSON.stringify({orderId:e.orderId,priority:e.priority||"Normal"})});if(!d.ok){var c;let e=await d.json().catch(()=>({}));throw Error((null===(c=e.error)||void 0===c?void 0:c.message)||e.message||"ไม่สามารถเพิ่มออเดอร์เข้าคิวได้")}let u=await d.json();return u.success&&u.data?u.data:u},updateStatus:async(e,t,r)=>{let i=(0,a.b)("PATCH","".concat(o,"/").concat(e,"/status")),l=s(r),d=await (0,n.P)();d&&(l["X-CSRF-Token"]=d);let c=await fetch(i,{method:"PATCH",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){var u;let e=await c.json().catch(()=>({}));throw Error((null===(u=e.error)||void 0===u?void 0:u.message)||e.message||"ไม่สามารถอัปเดตสถานะได้")}let h=await c.json();return h.success&&h.data?h.data:h},removeFromQueue:async(e,t)=>{let r=(0,a.b)("DELETE","".concat(o,"/").concat(e)),i=s(t,""),l=await (0,n.P)();l&&(i["X-CSRF-Token"]=l);let d=await fetch(r,{method:"DELETE",headers:i,credentials:"include"});if(!d.ok){var c;let e=await d.json().catch(()=>({}));throw Error((null===(c=e.error)||void 0===c?void 0:c.message)||e.message||"ไม่สามารถลบออกจากคิวได้")}},reorderQueue:async e=>{let t=(0,a.b)("POST","".concat(o,"/reorder")),r=s(e),i=await (0,n.P)();i&&(r["X-CSRF-Token"]=i);let l=await fetch(t,{method:"POST",headers:r,credentials:"include"});if(!l.ok){var d;let e=await l.json().catch(()=>({}));throw Error((null===(d=e.error)||void 0===d?void 0:d.message)||e.message||"ไม่สามารถจัดเรียงคิวใหม่ได้")}}}},47799:function(e,t,r){"use strict";r.d(t,{R:function(){return c}});var a=r(2913),i=r(71567),n=r(20019);let o=n.Ryn({id:n.Z_8(),product_name:n.Z_8(),display_name:n.Z_8(),description:n.Z_8().optional().or(n.Z_8()),price:n.Rxh().or(n.Z_8().transform(e=>Number(e))),price_delivery:n.Rxh().or(n.Z_8().transform(e=>Number(e))).optional(),category_id:n.Z_8(),unit_id:n.Z_8(),img_url:n.Z_8().nullable().optional(),create_date:n.Z_8().or(n.hTZ()).transform(e=>new Date(e)),update_date:n.Z_8().or(n.hTZ()).transform(e=>new Date(e)),is_active:n.O72().optional().default(!0),category:n.YjB().optional(),unit:n.YjB().optional()}).transform(e=>{var t;return{...e,price_delivery:null!==(t=e.price_delivery)&&void 0!==t?t:e.price}}),s=n.Ryn({data:n.IXX(o),total:n.Rxh(),page:n.Rxh(),last_page:n.Rxh()});var l=r(98170);let d=i.q.POS.PRODUCTS,c={findAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,n=(0,a.b)("GET",d),o=new URLSearchParams(i||"");o.append("page",e.toString()),o.append("limit",t.toString()),n+="?".concat(o.toString());let c={};r&&(c.Cookie=r);let u=await fetch(n,{cache:"no-store",credentials:"include",headers:c});if(!u.ok){let e=await u.json().catch(()=>({}));throw Error((0,l.i_)(e,"Failed to fetch products"))}let h=await u.json(),p=(0,l.XO)(h);return s.parse(p)},findOne:async(e,t)=>{let r=(0,a.b)("GET","".concat(d,"/").concat(e)),i={};t&&(i.Cookie=t);let n=await fetch(r,{cache:"no-store",credentials:"include",headers:i});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((0,l.i_)(e,"Failed to fetch product"))}let s=await n.json();return o.parse((0,l.hH)(s))},findOneByName:async(e,t)=>{let r=(0,a.b)("GET","".concat(d,"/name/").concat(e)),i={};t&&(i.Cookie=t);let n=await fetch(r,{cache:"no-store",credentials:"include",headers:i});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((0,l.i_)(e,"Failed to fetch product by name"))}let s=await n.json();return o.parse((0,l.hH)(s))},create:async(e,t,r)=>{let i=(0,a.b)("POST",d),n={"Content-Type":"application/json"};t&&(n.Cookie=t),r&&(n["X-CSRF-Token"]=r);let o=await fetch(i,{method:"POST",headers:n,body:JSON.stringify(e),credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error((0,l.i_)(e,"Failed to create product"))}let s=await o.json();return(0,l.hH)(s)},update:async(e,t,r,i)=>{let n=(0,a.b)("PUT","".concat(d,"/").concat(e)),o={"Content-Type":"application/json"};r&&(o.Cookie=r),i&&(o["X-CSRF-Token"]=i);let s=await fetch(n,{method:"PUT",headers:o,body:JSON.stringify(t),credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error((0,l.i_)(e,"Failed to update product"))}let c=await s.json();return(0,l.hH)(c)},delete:async(e,t,r)=>{let i=(0,a.b)("DELETE","".concat(d,"/").concat(e)),n={};t&&(n.Cookie=t),r&&(n["X-CSRF-Token"]=r);let o=await fetch(i,{method:"DELETE",headers:n,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error((0,l.i_)(e,"Failed to delete product"))}}}},66290:function(e,t,r){"use strict";r.d(t,{$:function(){return l}});var a=r(2913),i=r(71567),n=r(98170);let o=i.q.POS.TABLES,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},l={getAll:async(e,t)=>{let r=(0,a.b)("GET",o),i=new URLSearchParams(t||"");i.has("page")||i.set("page","1"),i.has("limit")||i.set("limit","200");let l=i.toString();l&&(r+="?".concat(l));let d=s(e,""),c=await fetch(r,{cache:"no-store",headers:d,credentials:"include"});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to fetch tables"))}return(0,n.XO)(await c.json())},getById:async(e,t)=>{let r=(0,a.b)("GET","".concat(o,"/").concat(e)),i=s(t,""),l=await fetch(r,{cache:"no-store",headers:i,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to fetch tables"))}return(0,n.hH)(await l.json())},getByName:async(e,t)=>{let r=(0,a.b)("GET","".concat(o,"/getByName/").concat(e)),i=s(t,""),l=await fetch(r,{cache:"no-store",headers:i,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to fetch tables"))}return(0,n.hH)(await l.json())},create:async(e,t,r)=>{let i=(0,a.b)("POST","".concat(o)),l=s(t);r&&(l["X-CSRF-Token"]=r);let d=await fetch(i,{method:"POST",headers:l,credentials:"include",body:JSON.stringify(e)});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to create table"))}return(0,n.hH)(await d.json())},update:async(e,t,r,i)=>{let l=(0,a.b)("PUT","".concat(o,"/").concat(e)),d=s(r);i&&(d["X-CSRF-Token"]=i);let c=await fetch(l,{method:"PUT",headers:d,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to update table"))}return(0,n.hH)(await c.json())},delete:async(e,t,r)=>{let i=(0,a.b)("DELETE","".concat(o,"/").concat(e)),l=s(t,"");r&&(l["X-CSRF-Token"]=r);let d=await fetch(i,{method:"DELETE",headers:l,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error((0,n.i_)(e,"Failed to delete table"))}}}},5325:function(e,t,r){"use strict";var a,i,n,o;r.d(t,{l:function(){return a},t:function(){return i}}),(n=a||(a={})).Pending="Pending",n.Processing="Processing",n.Completed="Completed",n.Cancelled="Cancelled",(o=i||(i={})).Low="Low",o.Normal="Normal",o.High="High",o.Urgent="Urgent"},98170:function(e,t,r){"use strict";function a(e){return!!e&&"object"==typeof e}function i(e){return e&&"object"==typeof e&&"success"in e&&!0===e.success&&"data"in e?e.data:e}function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Request failed";if("string"==typeof e)return e;if(!a(e))return t;if(!1===e.success){let t=e.error;if(a(t)&&"string"==typeof t.message&&t.message.trim())return t.message}if("error"in e){let t=e.error;if("string"==typeof t&&t.trim())return t;if(a(t)&&"string"==typeof t.message&&t.message.trim())return t.message}return"string"==typeof e.message&&e.message.trim()?e.message:t}function o(e){if(e&&"object"==typeof e&&"success"in e&&!0===e.success&&Array.isArray(e.data)){var t,r,a,i;let n="number"==typeof(null===(t=e.meta)||void 0===t?void 0:t.total)?e.meta.total:e.data.length,o="number"==typeof(null===(r=e.meta)||void 0===r?void 0:r.page)?e.meta.page:1,s="number"==typeof(null===(a=e.meta)||void 0===a?void 0:a.limit)?e.meta.limit:50,l="number"==typeof(null===(i=e.meta)||void 0===i?void 0:i.totalPages)?e.meta.totalPages:Math.max(Math.ceil(n/Math.max(s,1)),1);return{data:e.data,total:n,page:o,last_page:l}}return e}r.d(t,{XO:function(){return o},hH:function(){return i},i_:function(){return n}})},36799:function(e,t,r){"use strict";r.d(t,{t:function(){return i}});var a=JSON.parse('{"auth.loadingLogin":"กำลังเข้าสู่ระบบ...","auth.loadingLogout":"กำลังออกจากระบบ...","network.loading":"กำลังดึงข้อมูล...","network.offline":"ไม่มีการเชื่อมต่ออินเทอร์เน็ต แอปกำลังทำงานแบบออฟไลน์","network.newVersion":"มีเวอร์ชันใหม่พร้อมใช้งาน กดรีเฟรชเพื่ออัปเดต","delivery.loadingOrders":"กำลังโหลดออเดอร์...","delivery.selectProvider":"เลือกผู้ให้บริการ (Delivery Provider)","delivery.selectProviderPlaceholder":"เลือกผู้ให้บริการ","delivery.orderCode":"รหัสเดลิเวอรี่ / Order Code","delivery.enterOrderCode":"ระบุรหัสออเดอร์ (เช่น 123)","delivery.createOrder":"เปิดออเดอร์เดลิเวอรี่","delivery.createOrderSubtitle":"กรอกข้อมูลเพื่อสร้างออเดอร์ใหม่","delivery.noProviders":"ยังไม่มีผู้ให้บริการเดลิเวอรี่","delivery.retry":"ลองใหม่","delivery.noOrders":"ไม่มีออเดอร์เดลิเวอรี่","delivery.addOrder":"เพิ่มออเดอร์","delivery.createNewOrder":"สร้างออเดอร์ใหม่","orders.loading":"กำลังโหลดข้อมูลออเดอร์...","orders.error":"โหลดข้อมูลออเดอร์ไม่สำเร็จ","orders.empty":"ไม่พบรายการออเดอร์","orders.searchPlaceholder":"ค้นหาเลขที่ออเดอร์ โต๊ะ หรือรหัสอ้างอิง","queue.loading":"กำลังโหลดคิว...","queue.error":"โหลดคิวไม่สำเร็จ","queue.empty":"ยังไม่มีออเดอร์ในคิว","queue.refresh":"รีเฟรช","queue.reorder":"จัดเรียง","queue.filter":"กรองสถานะ","queue.pending":"รอ","queue.processing":"กำลังดำเนินการ","queue.completed":"เสร็จสิ้น","queue.cancelled":"ยกเลิก","queue.priority.low":"ต่ำ","queue.priority.normal":"ปกติ","queue.priority.high":"สูง","queue.priority.urgent":"ด่วน","queue.updateStatusSuccess":"อัปเดตสถานะสำเร็จ","queue.updateStatusError":"อัปเดตสถานะไม่สำเร็จ","queue.addSuccess":"เพิ่มเข้าคิวสำเร็จ","queue.addError":"เพิ่มเข้าคิวไม่สำเร็จ","queue.removeSuccess":"ลบออกจากคิวสำเร็จ","queue.removeError":"ลบออกจากคิวไม่สำเร็จ","queue.reorderSuccess":"จัดเรียงคิวใหม่สำเร็จ","queue.reorderError":"จัดเรียงคิวใหม่ไม่สำเร็จ","stock.loading":"กำลังโหลดคำสั่งซื้อสต๊อก...","stock.error":"โหลดข้อมูลสต๊อกไม่สำเร็จ","stock.empty":"ยังไม่มีคำสั่งซื้อสต๊อก","stock.title":"คำสั่งซื้อสต๊อก","stock.subtitleCount":"{{count}} คำสั่งซื้อ","stock.totalItems":"จำนวนรายการรวม","stock.createdBy":"ผู้สร้าง","stock.items":"รายการ","stock.status":"สถานะ","stock.createdAt":"วันที่สร้าง","stock.actions":"จัดการ","stock.view":"ดู","stock.buy":"ซื้อ","stock.edit":"แก้ไข","stock.cancel":"ยกเลิก","stock.emptyAction":"ไปหน้าหลัก","stock.status.pending":"รอดำเนินการ","stock.status.completed":"เสร็จสิ้น","stock.status.cancelled":"ยกเลิก","stock.itemsLabel":"รายการ","stock.statusLabel":"สถานะ","users.title":"ผู้ใช้","users.subtitle":"{{count}} คน","users.add":"เพิ่มผู้ใช้","users.refresh":"รีเฟรช","users.empty":"ยังไม่มีผู้ใช้","users.noPermission":"คุณไม่มีสิทธิ์เข้าถึงหน้านี้","users.headerTitle":"จัดการผู้ใช้","users.headerSubtitle":"จัดการสิทธิ์และสถานะผู้ใช้ทั้งหมด","users.stats.total":"ผู้ใช้ทั้งหมด","users.stats.active":"เปิดใช้งาน/ใช้งานได้","users.stats.online":"กำลังใช้งาน","users.card.edit":"แก้ไข","users.card.delete":"ลบ","users.card.active":"เปิดใช้งาน","users.card.inactive":"ปิดใช้งาน","users.card.canUse":"อนุญาตใช้งาน","users.card.cannotUse":"ไม่อนุญาต","users.card.lastLogin":"เข้าสู่ระบบล่าสุด","page.retry":"ลองอีกครั้ง","page.empty":"ไม่มีข้อมูล","page.error":"เกิดข้อผิดพลาด","kitchen.soundBlocked":"เบราว์เซอร์บล็อกเสียงแจ้งเตือน","kitchen.soundOff":"ปิดเสียงแจ้งเตือน","kitchen.soundOn":"เปิดเสียงแจ้งเตือน","dashboard.title":"ภาพรวมยอดขาย","dashboard.subtitle":"สรุปยอดขายทุกช่องทาง","dashboard.reload":"รีเฟรช","dashboard.loading":"กำลังโหลดข้อมูล...","dashboard.totalSales":"ยอดขายรวม","dashboard.orders":"{{count}} ออเดอร์","dashboard.discount":"ส่วนลด ฿{{amount}}","dashboard.channel.dineIn":"ทานที่ร้าน","dashboard.channel.takeAway":"กลับบ้าน","dashboard.channel.delivery":"เดลิเวอรี่","dashboard.topProducts":"สินค้าขายดี","dashboard.topProducts.empty":"ยังไม่มีข้อมูลสินค้า","dashboard.recentOrders":"ออเดอร์ล่าสุด","dashboard.recentOrders.empty":"ยังไม่มีออเดอร์","dashboard.viewDetails":"ดูรายละเอียด","dashboard.dailySales":"ยอดขายรายวัน","dashboard.dailySales.date":"วันที่","dashboard.dailySales.orders":"ออเดอร์","dashboard.dailySales.sales":"ยอดขาย","dashboard.export.pdf":"PDF","dashboard.export.excel":"Excel","dashboard.exportPDF.loading":"กำลังสร้าง PDF...","dashboard.exportPDF.success":"ส่งออก PDF สำเร็จ","dashboard.exportPDF.error":"เกิดข้อผิดพลาดในการส่งออก PDF","dashboard.exportExcel.loading":"กำลังสร้าง Excel...","dashboard.exportExcel.success":"ส่งออก Excel สำเร็จ","dashboard.exportExcel.error":"เกิดข้อผิดพลาดในการส่งออก Excel","dashboard.paymentMethod":"\uD83D\uDCB3 {{method}}","branch.loading":"กำลังดึงข้อมูลสาขา...","branch.noPermission":"คุณไม่มีสิทธิ์เข้าถึงหน้าสาขา","branch.delete.title":"ยืนยันลบสาขา","branch.delete.content":"ต้องการลบสาขา \\"{{name}}\\" หรือไม่?","branch.delete.ok":"ลบ","branch.delete.cancel":"ยกเลิก","branch.delete.success":"ลบสาขา \\"{{name}}\\" แล้ว","branch.delete.error":"ไม่สามารถลบสาขาได้","branch.switch.success":"สลับไปยังสาขา \\"{{name}}\\" แล้ว","branch.switch.loading":"กำลังสลับสาขา...","branch.page.title":"สาขา","branch.page.subtitle":"{{count}} สาขา","branch.hero.title":"จัดการสาขา","branch.hero.subtitle":"ดูแลข้อมูลสาขาทั้งหมดในระบบ","branch.actions.refresh":"รีเฟรช","branch.actions.add":"เพิ่มสาขา","branch.section.listTitle":"สาขาทั้งหมด","branch.section.countTag":"{{filtered}} / {{total}} สาขา","branch.empty.filtered.title":"ไม่พบสาขาที่ค้นหา","branch.empty.filtered.description":"ลองลบตัวกรองหรือค้นหาด้วยคำอื่น เช่น ชื่อ รหัสสาขา ที่อยู่ หรือเบอร์โทร","branch.empty.default.title":"ยังไม่มีสาขา","branch.empty.default.description":"เพิ่มสาขาแรกเพื่อเริ่มใช้งาน POS ได้เลย","branch.empty.reset":"ล้างตัวกรอง","branch.empty.add":"เพิ่มสาขาใหม่","branch.stats.total":"สาขาทั้งหมด","branch.stats.active":"เปิดใช้งาน","branch.stats.inactive":"ปิดการใช้งาน","branch.card.switch":"สลับ","branch.card.edit":"แก้ไข","branch.card.delete":"ลบ","branch.card.switchTooltip":"สลับไปสาขานี้","branch.card.editTooltip":"แก้ไขข้อมูลสาขา","branch.card.deleteTooltip":"ลบสาขา","branch.card.addressFallback":"ไม่มีที่อยู่","branch.card.phoneFallback":"ไม่มีหมายเลขโทรศัพท์","branch.card.active":"เปิดใช้งานอยู่","branch.card.inactive":"ปิดใช้งานอยู่","branch.card.taxId":"เลขประจำตัวผู้เสียภาษี","branch.search.placeholder":"ค้นหาสาขา (ชื่อ รหัส ที่อยู่ หรือเบอร์โทร)","branch.search.filter.all":"ทั้งหมด","branch.search.filter.active":"เปิดใช้งาน","branch.search.filter.inactive":"ปิดใช้งาน","branch.search.result":"พบ {{count}} จาก {{total}} สาขา","branch.form.loadError":"ไม่สามารถดึงข้อมูลสาขาได้","branch.form.updateSuccess":"อัปเดตสาขาสำเร็จ","branch.form.createSuccess":"สร้างสาขาสำเร็จ","branch.form.saveError":"เกิดข้อผิดพลาดในการบันทึกข้อมูลสาขา","branch.form.deleteTitle":"ยืนยันการลบสาขา","branch.form.deleteContent":"คุณต้องการลบสาขานี้หรือไม่?","branch.form.deleteSuccess":"ลบสาขาสำเร็จ","branch.form.deleteError":"ไม่สามารถลบสาขาได้","branch.form.titleEdit":"แก้ไขสาขา","branch.form.titleCreate":"เพิ่มสาขา","branch.form.subtitle":"ข้อมูลสาขาสำหรับระบบ POS","branch.form.fields.nameLabel":"ชื่อสาขา *","branch.form.fields.nameRequired":"กรุณากรอกชื่อสาขา","branch.form.fields.namePlaceholder":"ระบุชื่อสาขา","branch.form.fields.codeLabel":"รหัสสาขา *","branch.form.fields.codeRequired":"กรุณากรอกรหัสสาขา","branch.form.fields.codePattern":"รหัสสาขาต้องเป็นตัวอักษรภาษาอังกฤษหรือตัวเลข","branch.form.fields.codePlaceholder":"เช่น B001","branch.form.fields.addressLabel":"ที่อยู่","branch.form.fields.addressPlaceholder":"ที่อยู่สาขา","branch.form.fields.phoneLabel":"เบอร์โทรศัพท์","branch.form.fields.phonePlaceholder":"02xxxxxxx","branch.form.fields.taxIdLabel":"เลขประจำตัวผู้เสียภาษี (Tax ID)","branch.form.fields.taxIdPlaceholder":"ระบุเลขผู้เสียภาษี","branch.form.fields.statusLabel":"สถานะ","branch.form.back":"ยกเลิก","branch.form.submitEdit":"บันทึกการแก้ไข","branch.form.submitCreate":"สร้างสาขา","users.manage.loadRolesError":"ไม่สามารถดึงข้อมูลบทบาทได้","users.manage.loadBranchesError":"ไม่สามารถดึงข้อมูลสาขาได้","users.manage.loadUserError":"ไม่สามารถดึงข้อมูลผู้ใช้ได้","users.manage.updateSuccess":"อัปเดตผู้ใช้สำเร็จ","users.manage.createSuccess":"สร้างผู้ใช้สำเร็จ","users.manage.saveErrorUpdate":"ไม่สามารถอัปเดตผู้ใช้ได้","users.manage.saveErrorCreate":"ไม่สามารถสร้างผู้ใช้ได้","users.manage.deleteSuccess":"ลบผู้ใช้สำเร็จ","users.manage.deleteError":"ไม่สามารถลบผู้ใช้ได้","users.manage.deleteTitle":"ลบผู้ใช้","users.manage.deleteDescription":"คุณต้องการลบผู้ใช้หรือไม่?","users.manage.deleteOk":"ใช่","users.manage.deleteCancel":"ยกเลิก","users.manage.deleteButton":"ลบผู้ใช้","users.manage.backToList":"กลับไปหน้าผู้ใช้","users.manage.headingEdit":"แก้ไขผู้ใช้","users.manage.headingCreate":"เพิ่มผู้ใช้","users.manage.form.usernameLabel":"ชื่อผู้ใช้","users.manage.form.usernameRequired":"กรุณากรอกชื่อผู้ใช้","users.manage.form.usernamePattern":"กรุณากรอกภาษาอังกฤษ ตัวเลข หรืออักขระพิเศษ (- _ @ .)","users.manage.form.usernamePlaceholder":"กรุณากรอกชื่อผู้ใช้","users.manage.form.nameLabel":"ชื่อ-นามสกุล / ชื่อเล่น","users.manage.form.nameRequired":"กรุณากรอกชื่อ-นามสกุล หรือ ชื่อเล่น","users.manage.form.namePlaceholder":"ระบุชื่อ (เช่น สมชาย หรือ น้องบี)","users.manage.form.passwordLabel":"รหัสผ่าน","users.manage.form.passwordLabelEdit":"รหัสผ่านใหม่ (ปล่อยว่างเพื่อไม่เปลี่ยนรหัสผ่าน)","users.manage.form.passwordRequired":"กรุณากรอกรหัสผ่าน","users.manage.form.passwordPattern":"กรุณากรอกภาษาอังกฤษ ตัวเลข หรืออักขระพิเศษเท่านั้น","users.manage.form.passwordPlaceholder":"กรุณากรอกรหัสผ่าน","users.manage.form.roleLabel":"บทบาท","users.manage.form.roleRequired":"กรุณาเลือกบทบาท","users.manage.form.rolePlaceholder":"เลือกบทบาท","users.manage.form.roleModalTitle":"เลือกบทบาท","users.manage.form.branchLabel":"สาขา","users.manage.form.branchRequired":"กรุณาเลือกสาขา","users.manage.form.branchPlaceholder":"เลือกสาขา","users.manage.form.branchModalTitle":"เลือกสาขา","users.manage.form.activeLabel":"สถานะ (Active)","users.manage.form.useLabel":"การใช้งาน (In Use)","users.manage.cancel":"ยกเลิก","users.manage.updateSubmit":"อัปเดตผู้ใช้","users.manage.createSubmit":"สร้างผู้ใช้","stock.ingredients.loading":"กำลังโหลดข้อมูลวัตถุดิบ...","stock.ingredients.loadError":"ไม่สามารถดึงข้อมูลวัตถุดิบได้","stock.ingredients.noPermission":"คุณไม่มีสิทธิ์เข้าถึงหน้านี้","stock.ingredients.deleteTitle":"ยืนยันการลบวัตถุดิบ","stock.ingredients.deleteContent":"คุณต้องการลบวัตถุดิบ \\"{{name}}\\" หรือไม่?","stock.ingredients.deleteSuccess":"ลบวัตถุดิบ \\"{{name}}\\" สำเร็จ","stock.ingredients.deleteError":"ไม่สามารถลบวัตถุดิบได้","stock.ingredients.deleting":"กำลังลบวัตถุดิบ...","stock.ingredients.checkingAuth":"กำลังตรวจสอบสิทธิ์การใช้งาน...","stock.ingredients.redirecting":"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับหน้าแรก...","stock.ingredients.title":"วัตถุดิบ","stock.ingredients.subtitle":"{{count}} รายการ","stock.ingredients.refresh":"รีเฟรช","stock.ingredients.add":"เพิ่มวัตถุดิบ","stock.ingredients.listTitle":"รายการวัตถุดิบ","stock.ingredients.emptyTitle":"ยังไม่มีวัตถุดิบ","stock.ingredients.emptyDescription":"เริ่มต้นด้วยการเพิ่มวัตถุดิบแรกของคุณ","stock.ingredients.emptyAction":"เพิ่มวัตถุดิบ","stock.ingredients.headerLabel":"จัดการข้อมูล","stock.ingredients.stats.total":"ทั้งหมด","stock.ingredients.stats.active":"ใช้งาน","stock.ingredients.stats.inactive":"ไม่ใช้งาน","common.checkingAuth":"กำลังตรวจสอบสิทธิ์การใช้งาน...","common.noPermissionRedirect":"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับหน้าแรก...","ingredientsUnit.title":"หน่วยวัตถุดิบ","ingredientsUnit.subtitle":"{{count}} หน่วย","ingredientsUnit.button.refresh":"รีเฟรช","ingredientsUnit.button.add":"เพิ่มหน่วยวัตถุดิบ","ingredientsUnit.section.list":"รายการหน่วยวัตถุดิบ","ingredientsUnit.loading":"กำลังโหลดหน่วยวัตถุดิบ...","ingredientsUnit.empty.title":"ยังไม่มีหน่วยวัตถุดิบ","ingredientsUnit.empty.desc":"เริ่มต้นด้วยการเพิ่มหน่วยวัตถุดิบแรกของคุณ","ingredientsUnit.fetch.error":"ไม่สามารถดึงข้อมูลหน่วยวัตถุดิบได้","ingredientsUnit.create.toast":"เพิ่มหน่วยวัตถุดิบ {{name}} แล้ว","ingredientsUnit.delete.title":"ยืนยันการลบหน่วยวัตถุดิบ","ingredientsUnit.delete.content":"ต้องการลบหน่วยวัตถุดิบ \\"{{name}}\\" หรือไม่?","ingredientsUnit.delete.ok":"ลบ","ingredientsUnit.delete.cancel":"ยกเลิก","ingredientsUnit.delete.success":"ลบหน่วยวัตถุดิบ \\"{{name}}\\" สำเร็จ","stockHistory.title":"ประวัติออเดอร์สต็อก","stockHistory.subtitle":"รายการที่เสร็จสิ้น/ยกเลิก","stockHistory.refresh":"รีเฟรช","stockHistory.sectionAll":"ประวัติทั้งหมด","stockHistory.count":"ทั้งหมด {{total}} รายการ","stockHistory.empty.title":"ยังไม่มีประวัติออเดอร์","stockHistory.empty.desc":"เมื่อมีรายการเสร็จสิ้น/ยกเลิก จะแสดงที่หน้านี้","stockHistory.delete.title":"ยืนยันการลบ","stockHistory.delete.content":"ต้องการลบประวัติออเดอร์ #{{code}} หรือไม่? ข้อมูลที่เกี่ยวข้องทั้งหมดจะถูกลบด้วย","stockHistory.delete.ok":"ลบ","stockHistory.delete.cancel":"ยกเลิก","stockHistory.delete.success":"ลบประวัติออเดอร์สำเร็จ","stockHistory.delete.error":"ลบประวัติออเดอร์ล้มเหลว","stockHistory.fetch.error":"ไม่สามารถโหลดประวัติออเดอร์ได้","stockHistory.paginationTotal":"ทั้งหมด {{total}} รายการ"}');function i(e,t){var r;let i=null!==(r=a[e])&&void 0!==r?r:e;return t?i.replace(/\{\{(\w+)\}\}/g,(e,r)=>{var a;return(null!==(a=t[r])&&void 0!==a?a:"").toString()}):i}},7806:function(e,t,r){"use strict";r.d(t,{S:function(){return a}});let a=e=>{if(!(null==e?void 0:e.length))return[];let t=new Map;for(let u of e){var r,a,i,n,o,s,l,d,c;let e=(null===(r=u.details)||void 0===r?void 0:r.length)?JSON.stringify(u.details.map(e=>({n:e.detail_name,p:e.extra_price})).sort((e,t)=>e.n.localeCompare(t.n))):"[]",h=(null!==(i=u.notes)&&void 0!==i?i:"").trim().toLowerCase(),p=String(null!==(n=u.status)&&void 0!==n?n:""),m=null!==(s=null!==(o=null===(a=u.product)||void 0===a?void 0:a.id)&&void 0!==o?o:u.product_id)&&void 0!==s?s:"unknown",y="".concat(m,"|").concat(e,"|").concat(h,"|").concat(p),g=t.get(y);if(g){g.quantity+=Number(u.quantity),g.total_price+=Number(null!==(l=u.total_price)&&void 0!==l?l:0),g.originalItems.push(u);continue}let f={...u,id:String(null!==(d=null==u?void 0:u.id)&&void 0!==d?d:y),quantity:Number(u.quantity),total_price:Number(null!==(c=u.total_price)&&void 0!==c?c:0),originalItems:[u]};t.set(y,f)}return Array.from(t.values())}},97235:function(e,t,r){"use strict";r.d(t,{P:function(){return s}});var a=r(5447);let i=null,n=0,o=null;async function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&i&&t-n<6e5?i:(o||(o=a.O.getCsrfToken().then(e=>(i=e||"",n=Date.now(),i)).finally(()=>{o=null})),o)}},67697:function(e,t,r){"use strict";r.d(t,{D:function(){return o},v:function(){return n}});var a=r(2265);let i=e=>{if("string"==typeof e)return e;if(e&&"object"==typeof e){var t;if("id"in e&&e.id)return e.id;if("data"in e&&(null===(t=e.data)||void 0===t?void 0:t.id))return e.data.id}};function n(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e.id,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>!0;(0,a.useEffect)(()=>{if(!e)return;let a=e=>{if(!o(e))return;let t=n(e);r(r=>r.some(e=>n(e)===t)?r:[...r,e])},s=e=>{let t=n(e);r(r=>o(e)?r.some(e=>n(e)===t)?r.map(r=>n(r)===t?e:r):[...r,e]:r.filter(e=>n(e)!==t))},l=e=>{let t=i(e);t&&r(e=>e.filter(e=>n(e)!==t))};return e.on(t.create,a),e.on(t.update,s),e.on(t.delete,l),()=>{e.off(t.create,a),e.off(t.update,s),e.off(t.delete,l)}},[e,t.create,t.update,t.delete,n,r,o])}function o(e){let{socket:t,events:r=[],onRefresh:i,intervalMs:n,enabled:o=!0,debounceMs:s}=e;(0,a.useEffect)(()=>{if(!o||!t||0===r.length)return;let e=null,a=()=>{if(!s||s<=0){i();return}e&&clearTimeout(e),e=setTimeout(()=>{e=null,i()},s)};return r.forEach(e=>t.on(e,a)),()=>{e&&clearTimeout(e),r.forEach(e=>t.off(e,a))}},[o,t,r,i,s]),(0,a.useEffect)(()=>{if(!o||!n)return;let e=setInterval(i,n);return()=>clearInterval(e)},[o,n,i])}},12028:function(e,t,r){"use strict";r.d(t,{b:function(){return a},g:function(){return i}});let a={system:{announcement:"system:announcement"},users:{create:"users:create",update:"users:update",delete:"users:delete",status:"users:update-status"},roles:{create:"roles:create",update:"roles:update",delete:"roles:delete"},branches:{create:"branches:create",update:"branches:update",delete:"branches:delete"},products:{create:"products:create",update:"products:update",delete:"products:delete"},productsUnit:{create:"productsUnit:create",update:"productsUnit:update",delete:"productsUnit:delete"},categories:{create:"category:create",update:"category:update",delete:"category:delete"},tables:{create:"tables:create",update:"tables:update",delete:"tables:delete"},orders:{create:"orders:create",update:"orders:update",delete:"orders:delete"},payments:{create:"payments:create",update:"payments:update",delete:"payments:delete"},discounts:{create:"discounts:create",update:"discounts:update",delete:"discounts:delete"},delivery:{create:"delivery:create",update:"delivery:update",delete:"delivery:delete"},shifts:{update:"shifts:update"},orderQueue:{added:"order-queue:added",updated:"order-queue:updated",removed:"order-queue:removed",reordered:"order-queue:reordered"},ingredients:{create:"ingredients:create",update:"ingredients:update",delete:"ingredients:delete"},ingredientsUnit:{create:"ingredientsUnit:create",update:"ingredientsUnit:update",delete:"ingredientsUnit:delete"},stock:{update:"stock:update"},stockOrders:{create:"stock:orders:create",update:"stock:orders:update",status:"stock:orders:status",delete:"stock:orders:delete",detailUpdate:"stock:orders:detail:update"},paymentAccounts:{create:"payment-accounts:create",update:"payment-accounts:update",delete:"payment-accounts:delete"},paymentMethods:{create:"paymentMethod:create",update:"paymentMethod:update",delete:"paymentMethod:delete"},shopProfile:{update:"shopProfile:update"},salesOrderItem:{create:"salesOrderItem:create",update:"salesOrderItem:update",delete:"salesOrderItem:delete"},salesOrderDetail:{create:"salesOrderDetail:create",update:"salesOrderDetail:update",delete:"salesOrderDetail:delete"}},i={stockOrdersUpdated:"orders_updated"}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,3248,2401,9,8879,8589,19,4221,3834,9763,1713,8056,4547,3145,3106,2362,5619,4191,2971,2117,1744],function(){return e(e.s=8118)}),_N_E=e.O()}]);