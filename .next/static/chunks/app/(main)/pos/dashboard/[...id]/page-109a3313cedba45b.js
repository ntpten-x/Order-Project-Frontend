(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9224],{12873:function(e,t,n){Promise.resolve().then(n.bind(n,30066))},30066:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var a=n(57437),i=n(2265),s=n(39486),o=n(34029),r=n(48651),l=n(50742),c=n(38382),d=n(53743),f=n(62376),x=n(93132),p=n(52539),u=n(29107),m=n(83669),h=n(81770),y=n(17588),g=n(60392),j=n(15883),b=n(48998),v=n(99458),w=n(5540),k=n(99376),N=n(53286),_=n(19135),S=n(32446),z=n(92723),C=n(71096),F=n.n(C);n(6729);var D=n(29),A=n.n(D),I=n(7806),E=n(61414);F().locale("th");let T=(0,i.forwardRef)((e,t)=>{var n,i,s,o;let{order:r,shopName:l,shopAddress:c,shopPhone:d,shopTaxId:f,shopLogo:x}=e,p=(r.items||[]).filter(e=>!(0,E.s6)(e.status)),u=r.payments||[],m=p.reduce((e,t)=>e+Number(t.total_price||0),0),h=Number(r.discount_amount||0),y=r.vat>0?(m-h)*.07:0;return(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 receipt-container",children:[(0,a.jsxs)("div",{ref:t,className:"jsx-ac80ffc1703a8a53 receipt-paper",children:[(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 text-center mb-4",children:[x&&(0,a.jsx)("img",{src:x,alt:"Logo",className:"jsx-ac80ffc1703a8a53 receipt-logo"}),(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 shop-name",children:l||"ร้านค้า POS"}),c&&(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 shop-info",children:c}),d&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 shop-info shop-phone",children:["โทร: ",d]}),f&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 shop-info",children:["TAX ID: ",f]})]}),(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 dashed-line"}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 section",children:[(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"เลขที่ออเดอร์:"}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53 font-bold",children:["#",r.order_no]})]}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"วันที่:"}),(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:F()(r.create_date).format("DD/MM/YYYY HH:mm")})]}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"ประเภท:"}),(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:(e=>{switch(e){case S.m.DineIn:return"ทานที่ร้าน";case S.m.TakeAway:return"สั่งกลับบ้าน";case S.m.Delivery:return"เดลิเวอรี่";default:return e}})(r.order_type)})]}),r.order_type===S.m.DineIn&&r.table&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"โต๊ะ:"}),(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:r.table.table_name})]}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"พนักงาน:"}),(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:(null===(n=r.created_by)||void 0===n?void 0:n.name)||(null===(i=r.created_by)||void 0===i?void 0:i.username)||"-"})]})]}),(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 dashed-line"}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 section",children:[(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 section-header",children:"รายการสินค้า"}),(0,I.S)(p).map((e,t)=>{var n,i;return(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 item-row",children:[(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:(null===(n=e.product)||void 0===n?void 0:n.display_name)||(null===(i=e.product)||void 0===i?void 0:i.product_name)||"สินค้า"})}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 item-details",children:[(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:[e.quantity," x ฿",Number(e.price).toLocaleString()]}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["฿",Number(e.total_price).toLocaleString()]})]}),e.details&&e.details.map((e,t)=>(0,a.jsxs)("div",{style:{color:"#16a34a",fontStyle:"normal"},className:"jsx-ac80ffc1703a8a53 item-note",children:["+ ",e.detail_name," ",e.extra_price>0&&"(+฿".concat(Number(e.extra_price).toLocaleString(),")")]},t)),e.notes&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 item-note",children:["*",e.notes]})]},e.id||t)})]}),(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 dashed-line"}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 section",children:[(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"รวมรายการ:"}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["฿",Number(m).toLocaleString()]})]}),h>0&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["ส่วนลด (",(null===(s=r.discount)||void 0===s?void 0:s.display_name)||(null===(o=r.discount)||void 0===o?void 0:o.discount_name)||"ส่วนลด","):"]}),(0,a.jsxs)("span",{style:{color:"#ef4444"},className:"jsx-ac80ffc1703a8a53",children:["-฿",Number(h).toLocaleString()]})]}),y>0&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"VAT 7%:"}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["฿",Number(y).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 total-row",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"ยอดสุทธิ:"}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["฿",Number(m-h+y).toLocaleString()]})]})]}),(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 dashed-line"}),u.length>0&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 section",children:[(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 section-header",children:"การชำระเงิน"}),u.map((e,t)=>{var n,i;return(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:(null===(n=e.payment_method)||void 0===n?void 0:n.display_name)||(null===(i=e.payment_method)||void 0===i?void 0:i.payment_method_name)||"ไม่ระบุ"}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["฿",Number(e.amount).toLocaleString()]})]},e.id||t)}),u.some(e=>e.change_amount>0)&&(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 flex-between",children:[(0,a.jsx)("span",{className:"jsx-ac80ffc1703a8a53",children:"เงินทอน:"}),(0,a.jsxs)("span",{className:"jsx-ac80ffc1703a8a53",children:["฿",u.reduce((e,t)=>e+Number(t.change_amount||0),0).toLocaleString()]})]})]}),(0,a.jsx)("div",{className:"jsx-ac80ffc1703a8a53 dashed-line"}),(0,a.jsxs)("div",{className:"jsx-ac80ffc1703a8a53 receipt-footer",children:[(0,a.jsx)("div",{style:{fontSize:"12px",fontWeight:600,marginBottom:4},className:"jsx-ac80ffc1703a8a53",children:"ขอบคุณที่ใช้บริการ"}),(0,a.jsx)("div",{style:{fontSize:"10px",color:"#666"},className:"jsx-ac80ffc1703a8a53",children:"Thank you for your purchase!"}),(0,a.jsxs)("div",{style:{fontSize:"9px",color:"#999",marginTop:8},className:"jsx-ac80ffc1703a8a53",children:["พิมพ์เมื่อ: ",F()().format("DD/MM/YYYY HH:mm:ss")]})]})]}),(0,a.jsx)(A(),{id:"ac80ffc1703a8a53",children:'.receipt-container.jsx-ac80ffc1703a8a53{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:20px;background:#f0f2f5}.receipt-paper.jsx-ac80ffc1703a8a53{font-family:"Courier New",Courier,monospace;font-size:12px;width:80mm;padding:16px;background-color:#fff;color:#000;margin:0 auto;-webkit-box-shadow:0 4px 12px rgba(0,0,0,.1);-moz-box-shadow:0 4px 12px rgba(0,0,0,.1);box-shadow:0 4px 12px rgba(0,0,0,.1);position:relative}.text-center.jsx-ac80ffc1703a8a53{text-align:center;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%}.mb-4.jsx-ac80ffc1703a8a53{margin-bottom:16px}.dashed-line.jsx-ac80ffc1703a8a53{border-top:1px dashed#000;margin:12px 0;opacity:.5}.shop-name.jsx-ac80ffc1703a8a53{font-weight:900;font-size:28px;margin-bottom:4px;text-align:center;width:100%}.shop-info.jsx-ac80ffc1703a8a53{font-size:12px;margin-bottom:2px;text-align:center;width:100%}.shop-phone.jsx-ac80ffc1703a8a53{font-size:16px;font-weight:700;margin-top:4px}.section.jsx-ac80ffc1703a8a53{margin-bottom:8px}.section-header.jsx-ac80ffc1703a8a53{font-weight:bold;margin-bottom:8px;font-size:13px}.flex-between.jsx-ac80ffc1703a8a53{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:4px}.font-bold.jsx-ac80ffc1703a8a53{font-weight:bold}.receipt-logo.jsx-ac80ffc1703a8a53{width:60px;height:60px;-o-object-fit:contain;object-fit:contain;margin-bottom:8px;margin-left:auto;margin-right:auto;display:block;-webkit-filter:grayscale(100%);filter:grayscale(100%)}.item-row.jsx-ac80ffc1703a8a53{margin-bottom:6px}.item-details.jsx-ac80ffc1703a8a53{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding-left:10px;font-size:12px;font-weight:600;color:#000}.item-note.jsx-ac80ffc1703a8a53{padding-left:10px;font-size:9px;font-weight:300;font-style:italic;color:#4b5563}.total-row.jsx-ac80ffc1703a8a53{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;font-weight:900;font-size:26px;margin-top:12px;border-top:2px solid#000;padding-top:8px}.receipt-footer.jsx-ac80ffc1703a8a53{text-align:center;margin-top:16px}@media print{.receipt-container.jsx-ac80ffc1703a8a53{padding:0;background:none}.receipt-paper.jsx-ac80ffc1703a8a53{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;width:100%;max-width:80mm}}'})]})});T.displayName="ReceiptTemplate";let P=e=>[...e].sort((e,t)=>{let n=(0,E.s6)(e.status),a=(0,E.s6)(t.status);return n&&!a?1:!n&&a?-1:0}),L=e=>(0,E.s6)(e)?{color:"#f5222d",fontWeight:"bold"}:{};var R=n(24675),Z=n(67697),B=n(12028),W=n(25193);let{Title:H,Text:M}=s.default;F().locale("th");let q=["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],O=e=>{let t=F()(e);return"".concat(t.date()," ").concat(q[t.month()]," ").concat(t.format("HH:mm"))};function Y(e){var t,n,s;let{params:C}=e,F=(0,k.useRouter)(),D=C.id[0],{socket:A}=(0,R.s)(),[q,Y]=(0,i.useState)(null),[G,U]=(0,i.useState)(!0),[J,V]=(0,i.useState)(null),[X,$]=(0,i.useState)(!1),K=(0,i.useRef)(null),Q=(0,i.useCallback)(async()=>{if(D){U(!0);try{let e=await N.x.getById(D);Y(e)}catch(e){console.error("Fetch order detail error:",e),o.ZP.error("ไม่พบข้อมูลออเดอร์")}finally{U(!1)}}},[D]);(0,i.useEffect)(()=>{Q()},[Q]),(0,Z.D)({socket:A,events:[B.b.orders.update,B.b.orders.delete,B.b.payments.create,B.b.payments.update],onRefresh:()=>Q(),intervalMs:2e4});let ee=(0,i.useCallback)(async()=>{try{let e=await _.n.getProfile();V(e)}catch(e){console.warn("Could not fetch shop profile",e)}},[]);(0,i.useEffect)(()=>{ee()},[ee]),(0,Z.D)({socket:A,events:[B.b.shopProfile.update],onRefresh:()=>ee(),debounceMs:800});let et=(0,i.useMemo)(()=>{let e=((null==q?void 0:q.items)||[]).filter(e=>!(0,E.s6)(e.status));return P((0,I.S)(e))},[null==q?void 0:q.items]),en=(0,i.useMemo)(()=>et.reduce((e,t)=>e+Number(t.total_price||0),0),[et]),ea=Math.max(0,en-Number((null==q?void 0:q.discount_amount)||0)+Number((null==q?void 0:q.vat)||0));if(G)return(0,a.jsx)(W.Z,{maxWidth:99999,style:{padding:0},children:(0,a.jsx)("div",{style:{minHeight:"100vh",background:"#F8FAFC",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,a.jsx)(r.Z,{size:"large"})})});if(!q)return(0,a.jsx)(W.Z,{maxWidth:99999,style:{padding:0},children:(0,a.jsx)("div",{style:{minHeight:"100vh",background:"#F8FAFC",padding:24},children:(0,a.jsxs)("div",{style:{textAlign:"center",paddingTop:60},children:[(0,a.jsx)(f.Z,{style:{fontSize:48,color:"#CBD5E1",marginBottom:16}}),(0,a.jsx)(H,{level:4,style:{color:"#64748B"},children:"ไม่พบข้อมูลออเดอร์"}),(0,a.jsx)(l.ZP,{type:"primary",onClick:()=>F.back(),children:"ย้อนกลับ"})]})})});let ei=q.payments||[],es=(null===(t=q.created_by)||void 0===t?void 0:t.name)||(null===(n=q.created_by)||void 0===n?void 0:n.username)||"ไม่ทราบ",eo=(null===(s=q.table)||void 0===s?void 0:s.table_name)||"-",er=q.discount,el=(e=>{switch(e){case S.m.DineIn:return{icon:(0,a.jsx)(x.Z,{}),label:"ทานที่ร้าน",color:"#fff",bg:"#3B82F6"};case S.m.TakeAway:return{icon:(0,a.jsx)(p.Z,{}),label:"กลับบ้าน",color:"#fff",bg:"#22C55E"};case S.m.Delivery:return{icon:(0,a.jsx)(u.Z,{}),label:"เดลิเวอรี่",color:"#fff",bg:"#EC4899"};default:return{icon:(0,a.jsx)(f.Z,{}),label:e,color:"#fff",bg:"#6B7280"}}})(q.order_type),ec=(e=>{switch(e){case S.i.Paid:return{bg:"#DCFCE7",color:"#16A34A",label:"ชำระเงินแล้ว",icon:(0,a.jsx)(m.Z,{})};case S.i.Cancelled:return{bg:"#FEE2E2",color:"#DC2626",label:"ยกเลิก",icon:(0,a.jsx)(h.Z,{})};default:return{bg:"#F3F4F6",color:"#6B7280",label:e,icon:null}}})(q.status);return(0,a.jsx)(W.Z,{maxWidth:99999,style:{padding:0},children:(0,a.jsxs)("div",{style:{minHeight:"100vh",background:"#F8FAFC",paddingBottom:100},children:[(0,a.jsx)("div",{style:{background:z.Pc.headerGradient,padding:"16px",position:"sticky",top:0,zIndex:100,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,a.jsx)(l.ZP,{type:"text",icon:(0,a.jsx)(y.Z,{style:{fontSize:18,color:"#fff"}}),onClick:()=>F.back(),style:{background:"rgba(255,255,255,0.15)",border:"none",width:40,height:40,borderRadius:12}}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(M,{style:{color:"#fff",fontSize:18,fontWeight:700,display:"block"},children:["#",q.order_no]}),(0,a.jsxs)(M,{style:{color:"rgba(255,255,255,0.8)",fontSize:12},children:["\uD83D\uDCC5 ",O(q.create_date)]})]})]}),(0,a.jsx)(l.ZP,{icon:(0,a.jsx)(g.Z,{}),onClick:()=>{$(!0),setTimeout(()=>{if(K.current){let e=K.current.innerHTML,t=window.open("","","width=400,height=600");t&&(t.document.write("\n                        <html>\n                            <head>\n                                <title>ใบเสร็จ #".concat(null==q?void 0:q.order_no,"</title>\n                                <style>\n                                    body { \n                                        font-family: 'Courier New', Courier, monospace; \n                                        padding: 0; \n                                        margin: 0; \n                                        background: #fff;\n                                    }\n                                    .receipt-paper {\n                                        width: 80mm;\n                                        padding: 16px;\n                                        margin: 0 auto;\n                                    }\n                                    .text-center { \n                                        text-align: center;\n                                        display: flex;\n                                        flex-direction: column;\n                                        align-items: center;\n                                        justify-content: center;\n                                        width: 100%;\n                                    }\n                                    .shop-name {\n                                        font-weight: 900;\n                                        font-size: 28px;\n                                        margin-bottom: 4px;\n                                        text-align: center;\n                                        width: 100%;\n                                    }\n                                    .shop-info {\n                                        font-size: 12px;\n                                        margin-bottom: 2px;\n                                        text-align: center;\n                                        width: 100%;\n                                    }\n                                    .shop-phone {\n                                        font-size: 16px;\n                                        font-weight: 700;\n                                        margin-top: 4px;\n                                    }\n                                    .receipt-logo {\n                                        width: 60px;\n                                        height: 60px;\n                                        object-fit: contain;\n                                        margin-bottom: 8px;\n                                        margin-left: auto;\n                                        margin-right: auto;\n                                        display: block;\n                                        filter: grayscale(100%);\n                                    }\n                                    .dashed-line {\n                                        border-top: 1px dashed #000;\n                                        margin: 12px 0;\n                                        opacity: 0.5;\n                                    }\n                                    .section { margin-bottom: 8px; }\n                                    .flex-between {\n                                        display: flex;\n                                        justify-content: space-between;\n                                        margin-bottom: 4px;\n                                    }\n                                    .font-bold { font-weight: bold; }\n                                    .item-details {\n                                        display: flex;\n                                        justify-content: space-between;\n                                        padding-left: 10px;\n                                        font-size: 12px;\n                                        font-weight: 600;\n                                        color: #000;\n                                    }\n                                    .item-note {\n                                        padding-left: 10px;\n                                        font-size: 9px;\n                                        font-weight: 300;\n                                        font-style: italic;\n                                        color: #4b5563;\n                                    }\n                                    .total-row {\n                                        display: flex;\n                                        justify-content: space-between;\n                                        font-weight: 900;\n                                        font-size: 26px;\n                                        margin-top: 12px;\n                                        border-top: 2px solid #000;\n                                        padding-top: 8px;\n                                    }\n                                    .receipt-footer {\n                                        text-align: center;\n                                        margin-top: 16px;\n                                    }\n                                    @media print {\n                                        body { -webkit-print-color-adjust: exact; }\n                                        .receipt-paper { width: 100%; max-width: 80mm; box-shadow: none; }\n                                    }\n                                </style>\n                            </head>\n                            <body>\n                                <div class=\"receipt-paper\">\n                                    ").concat(e,"\n                                </div>\n                            </body>\n                        </html>\n                    ")),t.document.close(),t.focus(),t.print(),t.close())}$(!1)},500)},style:{background:"#fff",color:z.Pc.primary,border:"none",borderRadius:10,fontWeight:600,height:36},children:"พิมพ์"})]})}),(0,a.jsxs)("div",{style:{padding:"16px",maxWidth:600,margin:"0 auto"},children:[(0,a.jsxs)("div",{style:{background:"white",borderRadius:16,padding:"20px",marginBottom:16,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[(0,a.jsxs)("span",{style:{padding:"6px 14px",borderRadius:8,background:ec.bg,color:ec.color,fontWeight:700,fontSize:13,display:"inline-flex",alignItems:"center",gap:6},children:[ec.icon,ec.label]}),(0,a.jsxs)(M,{style:{fontSize:26,fontWeight:800,color:z.Pc.salesColor},children:["฿",Number(ea).toLocaleString()]})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:[(0,a.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:12,padding:"12px",display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)("span",{style:{width:36,height:36,borderRadius:10,background:el.bg,color:el.color,display:"flex",alignItems:"center",justifyContent:"center",fontSize:16},children:el.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:11,display:"block"},children:"ประเภท"}),(0,a.jsx)(M,{strong:!0,style:{fontSize:13},children:el.label})]})]}),(0,a.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:12,padding:"12px",display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)("span",{style:{width:36,height:36,borderRadius:10,background:"#EEF2FF",color:"#6366F1",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16},children:(0,a.jsx)(x.Z,{})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:11,display:"block"},children:"โต๊ะ"}),(0,a.jsx)(M,{strong:!0,style:{fontSize:13},children:eo})]})]}),(0,a.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:12,padding:"12px",display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)("span",{style:{width:36,height:36,borderRadius:10,background:"#FEF3C7",color:"#D97706",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16},children:(0,a.jsx)(j.Z,{})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:11,display:"block"},children:"พนักงาน"}),(0,a.jsx)(M,{strong:!0,style:{fontSize:13},children:es})]})]}),(0,a.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:12,padding:"12px",display:"flex",alignItems:"center",gap:10},children:[(0,a.jsx)("span",{style:{width:36,height:36,borderRadius:10,background:er?"#FEE2E2":"#F3F4F6",color:er?"#DC2626":"#9CA3AF",display:"flex",alignItems:"center",justifyContent:"center",fontSize:16},children:(0,a.jsx)(b.Z,{})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:11,display:"block"},children:"ส่วนลด"}),er?(0,a.jsxs)(M,{strong:!0,style:{fontSize:13,color:"#DC2626"},children:["-฿",Number(q.discount_amount).toLocaleString()]}):(0,a.jsx)(M,{type:"secondary",style:{fontSize:13},children:"ไม่มี"})]})]})]})]}),(0,a.jsxs)("div",{style:{background:"white",borderRadius:16,overflow:"hidden",marginBottom:16,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,a.jsxs)("div",{style:{padding:"16px",borderBottom:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)(f.Z,{style:{color:z.Pc.primary,fontSize:18}}),(0,a.jsxs)(M,{strong:!0,style:{fontSize:15},children:["รายการสินค้า (",et.length,")"]})]}),(0,a.jsx)("div",{style:{padding:"8px 0"},children:et.map((e,t)=>{var n,i,s,o;let r=L(e.status),l=(0,E.s6)(e.status);return(0,a.jsxs)("div",{style:{padding:"12px 16px",borderBottom:t<et.length-1?"1px solid #F8FAFC":"none",display:"flex",gap:12,opacity:l?.5:1},children:[(0,a.jsx)("div",{style:{width:56,height:56,borderRadius:10,overflow:"hidden",flexShrink:0,background:"#F8FAFC",border:"1px solid #E5E7EB"},children:(null===(n=e.product)||void 0===n?void 0:n.img_url)?(0,a.jsx)(c.Z,{src:e.product.img_url,width:56,height:56,style:{objectFit:"cover"},preview:!1,alt:(null===(i=e.product)||void 0===i?void 0:i.product_name)||"product"}):(0,a.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(f.Z,{style:{color:"#CBD5E1",fontSize:20}})})}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8},children:[(0,a.jsx)(M,{strong:!0,style:{fontSize:14,...r},children:(null===(s=e.product)||void 0===s?void 0:s.display_name)||(null===(o=e.product)||void 0===o?void 0:o.product_name)||"สินค้า"}),(0,a.jsxs)(M,{strong:!0,style:{fontSize:14,color:z.Pc.salesColor,flexShrink:0,...r},children:["฿",Number(e.total_price).toLocaleString()]})]}),(0,a.jsxs)("div",{style:{marginTop:4,display:"flex",alignItems:"center",gap:8},children:[(0,a.jsxs)(M,{type:"secondary",style:{fontSize:12},children:["x",e.quantity," • ฿",Number(e.price).toLocaleString(),"/ชิ้น"]}),l&&(0,a.jsx)("span",{style:{fontSize:10,padding:"2px 6px",borderRadius:4,background:"#FEE2E2",color:"#DC2626",fontWeight:600},children:"ยกเลิก"})]}),e.details&&e.details.length>0&&(0,a.jsx)("div",{style:{marginTop:6},children:e.details.map((e,t)=>(0,a.jsxs)(M,{style:{fontSize:11,display:"block",color:"#16A34A",fontWeight:500},children:["+ ",e.detail_name," ",e.extra_price>0&&(0,a.jsxs)("span",{style:{color:"#16A34A"},children:["(+฿",Number(e.extra_price).toLocaleString(),")"]})]},t))}),e.notes&&(0,a.jsx)("div",{style:{marginTop:6,background:"#FEF3C7",padding:"4px 8px",borderRadius:6,display:"inline-block"},children:(0,a.jsxs)(M,{style:{fontSize:11,color:"#B45309"},children:["\uD83D\uDCDD ",e.notes]})})]})]},e.id)})}),(0,a.jsxs)("div",{style:{background:"#F8FAFC",padding:"12px 16px",borderTop:"1px solid #F1F5F9"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:13},children:"รวมรายการ"}),(0,a.jsxs)(M,{style:{fontSize:13},children:["฿",Number(en).toLocaleString()]})]}),q.discount_amount>0&&(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:13},children:"ส่วนลด"}),(0,a.jsxs)(M,{style:{fontSize:13,color:"#DC2626"},children:["-฿",Number(q.discount_amount).toLocaleString()]})]}),q.vat>0&&(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[(0,a.jsx)(M,{type:"secondary",style:{fontSize:13},children:"VAT 7%"}),(0,a.jsxs)(M,{style:{fontSize:13},children:["฿",Number(q.vat).toLocaleString()]})]}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:8,borderTop:"1px dashed #E2E8F0"},children:[(0,a.jsx)(M,{strong:!0,style:{fontSize:15},children:"ยอดสุทธิ"}),(0,a.jsxs)(M,{strong:!0,style:{fontSize:18,color:z.Pc.salesColor},children:["฿",Number(ea).toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{style:{background:"white",borderRadius:16,overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,a.jsxs)("div",{style:{padding:"16px",borderBottom:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)(v.Z,{style:{color:"#22C55E",fontSize:18}}),(0,a.jsxs)(M,{strong:!0,style:{fontSize:15},children:["การชำระเงิน (",ei.length,")"]})]}),ei.length>0?(0,a.jsx)("div",{style:{padding:"8px 0"},children:ei.map((e,t)=>{var n,i;return(0,a.jsxs)("div",{style:{padding:"14px 16px",borderBottom:t<ei.length-1?"1px solid #F8FAFC":"none"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("span",{style:{width:8,height:8,borderRadius:"50%",background:"Success"===e.status?"#22C55E":"#EF4444"}}),(0,a.jsx)(M,{strong:!0,style:{fontSize:14},children:(null===(n=e.payment_method)||void 0===n?void 0:n.display_name)||(null===(i=e.payment_method)||void 0===i?void 0:i.payment_method_name)||"ไม่ระบุ"})]}),(0,a.jsxs)(M,{strong:!0,style:{fontSize:15,color:z.Pc.salesColor},children:["฿",Number(e.amount).toLocaleString()]})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,a.jsxs)(M,{type:"secondary",style:{fontSize:12},children:[(0,a.jsx)(w.Z,{style:{marginRight:4}}),O(e.payment_date)]}),e.amount_received>0&&(0,a.jsxs)(M,{type:"secondary",style:{fontSize:12},children:["รับมา ฿",Number(e.amount_received).toLocaleString(),e.change_amount>0&&" • ทอน ฿".concat(Number(e.change_amount).toLocaleString())]})]})]},e.id)})}):(0,a.jsxs)("div",{style:{padding:"30px 16px",textAlign:"center"},children:[(0,a.jsx)(v.Z,{style:{fontSize:32,color:"#CBD5E1",marginBottom:8}}),(0,a.jsx)(M,{type:"secondary",style:{display:"block"},children:"ไม่มีข้อมูลการชำระเงิน"})]})]})]}),(0,a.jsx)(d.Z,{open:X,footer:null,closable:!1,width:380,centered:!0,children:(0,a.jsxs)("div",{style:{textAlign:"center",padding:20},children:[(0,a.jsx)(r.Z,{size:"large"}),(0,a.jsx)("div",{style:{marginTop:16},children:"กำลังเตรียมพิมพ์..."})]})}),(0,a.jsx)("div",{style:{position:"absolute",left:"-9999px",top:"-9999px"},children:(0,a.jsx)(T,{ref:K,order:q,shopName:null==J?void 0:J.shop_name,shopAddress:null==J?void 0:J.address,shopPhone:null==J?void 0:J.phone,shopTaxId:null==J?void 0:J.tax_id,shopLogo:null==J?void 0:J.logo_url})})]})})}},19135:function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var a=n(2913),i=n(98170);let s="/pos/shopProfile",o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return t&&(n["Content-Type"]=t),e&&(n.Cookie=e),n},r={getProfile:async e=>{let t=(0,a.b)("GET",s),n=o(e,""),r=await fetch(t,{cache:"no-store",headers:n,credentials:"include"});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error((0,i.i_)(e,"ไม่สามารถดึงข้อมูลร้านค้าได้"))}return(0,i.hH)(await r.json())},updateProfile:async(e,t,n)=>{let r=(0,a.b)("PUT",s),l=o(t);n&&(l["X-CSRF-Token"]=n);let c=await fetch(r,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(e)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error((0,i.i_)(e,"ไม่สามารถอัปเดตข้อมูลร้านค้าได้"))}return(0,i.hH)(await c.json())}}},34962:function(e,t,n){"use strict";var a,i;n.d(t,{c:function(){return a}}),(i=a||(a={})).Available="Available",i.Unavailable="Unavailable"},7806:function(e,t,n){"use strict";n.d(t,{S:function(){return a}});let a=e=>{if(!(null==e?void 0:e.length))return[];let t=new Map;for(let f of e){var n,a,i,s,o,r,l,c,d;let e=(null===(n=f.details)||void 0===n?void 0:n.length)?JSON.stringify(f.details.map(e=>({n:e.detail_name,p:e.extra_price})).sort((e,t)=>e.n.localeCompare(t.n))):"[]",x=(null!==(i=f.notes)&&void 0!==i?i:"").trim().toLowerCase(),p=String(null!==(s=f.status)&&void 0!==s?s:""),u=null!==(r=null!==(o=null===(a=f.product)||void 0===a?void 0:a.id)&&void 0!==o?o:f.product_id)&&void 0!==r?r:"unknown",m="".concat(u,"|").concat(e,"|").concat(x,"|").concat(p),h=t.get(m);if(h){h.quantity+=Number(f.quantity),h.total_price+=Number(null!==(l=f.total_price)&&void 0!==l?l:0),h.originalItems.push(f);continue}let y={...f,id:String(null!==(c=null==f?void 0:f.id)&&void 0!==c?c:m),quantity:Number(f.quantity),total_price:Number(null!==(d=f.total_price)&&void 0!==d?d:0),originalItems:[f]};t.set(m,y)}return Array.from(t.values())}},61414:function(e,t,n){"use strict";n.d(t,{EO:function(){return v},Gs:function(){return c},HL:function(){return w},M9:function(){return k},Nz:function(){return h},OY:function(){return o},Rr:function(){return j},Wl:function(){return s},d$:function(){return N},d7:function(){return l},iN:function(){return x},jN:function(){return m},ku:function(){return g},mz:function(){return d},qO:function(){return f},s6:function(){return r},xG:function(){return u},yj:function(){return b},zP:function(){return p},zf:function(){return _}});var a=n(32446),i=n(34962);let s=e=>{var t,n;if(e.status===i.c.Available)return"/pos/channels/dine-in/".concat(e.id);let s=e.active_order_id||(null===(t=e.active_order)||void 0===t?void 0:t.id),o=e.active_order_status||(null===(n=e.active_order)||void 0===n?void 0:n.status);return s?o===a.i.WaitingForPayment?"/pos/items/payment/".concat(s):"/pos/orders/".concat(s):"/pos/channels/dine-in/".concat(e.id)},o=e=>{switch(e){case a.i.Pending:return"orange";case a.i.Cooking:return"blue";case a.i.Served:return"green";case a.i.Paid:return"cyan";case a.i.Cancelled:return"red";case a.i.WaitingForPayment:return"gold";default:if("cancelled"===String(null!=e?e:"").trim().toLowerCase())return"red";return"default"}},r=e=>"cancelled"===String(null!=e?e:"").trim().toLowerCase(),l=(e,t)=>{switch(e){case a.i.Pending:return"กำลังดำเนินการ";case a.i.Cooking:return"กำลังปรุง";case a.i.Served:if("TakeAway"===t||"Delivery"===t)return"ทำแล้ว";return"เสิร์ฟแล้ว";case a.i.Paid:return"ชำระเงินแล้ว";case a.i.Completed:return"สำเร็จ";case a.i.Cancelled:return"ยกเลิก";case a.i.WaitingForPayment:return"รอชำระเงิน";default:if(r(e))return"ยกเลิก";return e}},c=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},d=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},f=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",x=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",p=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",u=e=>{let t="string"==typeof e?parseFloat(e):e;return"฿".concat(Number(t).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2}))},m=e=>{var t,n;return"DineIn"===e.order_type?(null===(t=e.table)||void 0===t?void 0:t.table_name)||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||(null===(n=e.delivery)||void 0===n?void 0:n.delivery_name)||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A"},h=e=>(null!=e?e:[]).filter(e=>!r(e.status)),y=e=>(null!=e?e:[]).reduce((e,t)=>e+(Number(t.extra_price)||0),0),g=(e,t,n)=>((Number(e)||0)+y(n))*t,j=e=>h(e).reduce((e,t)=>{var n,a;let i=(null===(a=t.product)||void 0===a?void 0:null===(n=a.category)||void 0===n?void 0:n.display_name)||"ไม่ระบุหมวด";return e[i]=(e[i]||0)+(t.quantity||0),e},{}),b=e=>h(e).reduce((e,t)=>e+Number(t.total_price||0),0),v=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",w=e=>"/pos/orders/".concat(e),k=e=>e.status===a.i.WaitingForPayment?e.order_type===a.m.Delivery?"/pos/items/delivery/".concat(e.id):"/pos/items/payment/".concat(e.id):"/pos/orders/".concat(e.id),N=e=>e===a.m.Delivery?"/pos/channels/delivery":e===a.m.TakeAway?"/pos/channels/takeaway":e===a.m.DineIn?"/pos/channels/dine-in":"/pos/channels",_=(e,t,n,i)=>({order_no:i.orderNo||"ORD-".concat(Date.now()),order_type:t,sub_total:n.subTotal,discount_amount:n.discountAmount,vat:0,total_amount:n.totalAmount,received_amount:0,change_amount:0,status:a.i.Pending,discount_id:i.discountId||null,payment_method_id:null,table_id:i.tableId||null,delivery_id:i.deliveryId||null,delivery_code:i.deliveryCode||null,items:e.map(e=>{var n;let i=t===a.m.Delivery?Number(null!==(n=e.product.price_delivery)&&void 0!==n?n:e.product.price):Number(e.product.price),s=(i+(e.details||[]).reduce((e,t)=>e+Number(t.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:i,total_price:s,discount_amount:0,notes:e.notes||"",status:a.i.Cooking,details:e.details||[]}})})}},function(e){e.O(0,[253,1522,3418,742,9486,4252,8651,4159,3831,2224,3248,2401,19,6905,924,7884,9385,4572,2971,2117,1744],function(){return e(e.s=12873)}),_N_E=e.O()}]);