(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1694],{66630:function(e,t,i){Promise.resolve().then(i.bind(i,49190))},49190:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return z}});var n=i(57437),o=i(2265),r=i(19683),a=i(64625),d=i(48651),s=i(50742),l=i(53743),c=i(17588),p=i(55322),u=i(86955),g=i(37527),x=i(83669),h=i(96473),f=i(99376),b=i(92525),y=i(3369),m=i(44225);let j={container:{minHeight:"100vh",background:m.X1.background,fontFamily:"'Inter', 'Sarabun', sans-serif",paddingBottom:60},heroParams:{background:"linear-gradient(145deg, ".concat(m.X1.primary," 0%, ").concat(m.X1.primaryDark," 100%)"),padding:"20px 20px 60px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(99, 102, 241, 0.2)",zIndex:1,overflow:"hidden"},heroDecoCircle1:{position:"absolute",top:-60,right:-60,width:160,height:160,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},heroDecoCircle2:{position:"absolute",bottom:-40,left:-40,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.06)"},headerContent:{maxWidth:1e3,margin:"0 auto",position:"relative",zIndex:10},headerRow:{display:"flex",alignItems:"center",gap:16},backButton:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},sectionTitle:{display:"flex",alignItems:"center",gap:12,marginBottom:20,color:"#fff"},contentWrapper:{maxWidth:700,margin:"-40px auto 30px",padding:"0 20px",position:"relative",zIndex:20},card:{borderRadius:20,boxShadow:"0 4px 20px rgba(0,0,0,0.06)",border:"none"},activeAccountCard:{background:"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)",border:"1px solid #a7f3d0",borderRadius:16,padding:"20px",marginBottom:24},addButton:{borderRadius:14,height:52,fontSize:16,fontWeight:600,background:"#fff",border:"2px dashed ".concat(m.X1.primary),color:m.X1.primary,transition:"all 0.2s ease"},dividerTitle:{fontSize:16,fontWeight:600},accountSelector:{border:"1px solid #e2e8f0",borderRadius:14,padding:"14px 18px",cursor:"pointer",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:56,transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},accountSelectorHover:{borderColor:m.X1.primary,boxShadow:"0 0 0 3px ".concat(m.X1.primaryLight)},modalAccountItem:{padding:"16px",border:"1px solid #e5e7eb",borderRadius:14,cursor:"pointer",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s ease"},modalAccountItemActive:{border:"2px solid #10b981",background:"#ecfdf5"},accountIconBox:{width:44,height:44,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center"}};var k=i(97235),v=i(24675),S=i(67697),F=i(3286),w=i(2938);let{Title:R,Text:C}=r.default;function z(){let{message:e}=a.Z.useApp(),t=(0,f.useRouter)(),[i,r]=(0,o.useState)(!0),[m,z]=(0,o.useState)([]),[I,B]=(0,o.useState)(null),[E,_]=(0,o.useState)(!1),{showLoading:P,hideLoading:Z}=(0,y.x)(),{socket:D}=(0,v.s)(),{isAuthorized:W,isChecking:A}=(0,F.e)({requiredRole:"Admin"}),X=(0,o.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{t||r(!0);let e=await b.p.getByShopId();z(e);let i=e.find(e=>e.is_active);B(i||null)}catch(t){e.error("ไม่สามารถดึงข้อมูลบัญชีได้")}finally{t||r(!1)}},[e]);(0,o.useEffect)(()=>{X()},[X]),(0,S.D)({socket:D,events:["payment-accounts:update","payment-accounts:create","payment-accounts:delete"],onRefresh:()=>X(!0),intervalMs:2e4});let H=async t=>{try{P("กำลังเปลี่ยนบัญชีรับเงิน...");let i=m.find(e=>e.id===t);i&&B(i);let n=await (0,k.P)();await b.p.activate(t,void 0,void 0,n),e.success("เปลี่ยนบัญชีรับเงินหลักสำเร็จ"),await X(!0)}catch(t){e.error("ไม่สามารถเปลี่ยนบัญชีได้"),await X(!0)}finally{Z()}};return A?(0,n.jsx)(w.H,{message:"กำลังตรวจสอบสิทธิ์..."}):W?i?(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:j.container.background},children:(0,n.jsx)(d.Z,{size:"large",tip:"กำลังโหลด..."})}):(0,n.jsxs)("div",{style:{minHeight:"100vh",background:"#F8FAFC",padding:16,paddingBottom:80},children:[(0,n.jsx)("div",{style:{background:"white",borderRadius:16,padding:16,marginBottom:16,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,n.jsx)(s.ZP,{type:"text",icon:(0,n.jsx)(c.Z,{}),onClick:()=>t.back(),style:{width:40,height:40,borderRadius:10,border:"1px solid #E2E8F0",color:"#64748B"}}),(0,n.jsx)("div",{style:{width:44,height:44,background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 8px rgba(99, 102, 241, 0.3)"},children:(0,n.jsx)(p.Z,{style:{fontSize:20,color:"white"}})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(R,{level:5,style:{margin:0,fontSize:16,fontWeight:700,color:"#1E293B"},children:"ตั้งค่าบัญชีรับเงิน"}),(0,n.jsx)(C,{style:{fontSize:12,color:"#64748B"},children:"Payment Settings"})]})]})}),(0,n.jsxs)("div",{style:{background:"white",borderRadius:16,padding:16,marginBottom:16,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,n.jsx)(C,{type:"secondary",style:{fontSize:13,display:"block",marginBottom:12},children:"เลือกบัญชีรับเงินหลัก"}),(0,n.jsxs)("div",{style:{border:"2px solid ".concat(I?"#10b981":"#E2E8F0"),borderRadius:12,padding:14,cursor:"pointer",background:I?"#F0FDF4":"#fff",display:"flex",alignItems:"center",gap:12},onClick:()=>_(!0),children:[(0,n.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:(null==I?void 0:I.account_type)==="PromptPay"?"#FDF2F8":"#EFF6FF",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(null==I?void 0:I.account_type)==="PromptPay"?(0,n.jsx)(u.Z,{style:{color:"#EC4899",fontSize:18}}):(0,n.jsx)(g.Z,{style:{color:"#3B82F6",fontSize:18}})}),(0,n.jsx)("div",{style:{flex:1,minWidth:0},children:I?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C,{strong:!0,style:{fontSize:15,display:"block",color:"#1E293B"},children:I.account_name}),(0,n.jsx)(C,{type:"secondary",style:{fontSize:12},children:I.account_number})]}):(0,n.jsx)(C,{type:"secondary",children:"กดเพื่อเลือกบัญชี"})}),(0,n.jsx)("div",{style:{background:"#10b981",color:"white",padding:"4px 10px",borderRadius:6,fontSize:11,fontWeight:600,flexShrink:0},children:"เปลี่ยน"})]})]}),I&&(0,n.jsxs)("div",{style:{background:"linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%)",border:"1px solid #A7F3D0",borderRadius:14,padding:14,marginBottom:16,display:"flex",alignItems:"center",gap:12},children:[(0,n.jsx)(x.Z,{style:{fontSize:24,color:"#10B981",flexShrink:0}}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)(C,{style:{fontSize:11,color:"#059669",display:"block"},children:"กำลังใช้งาน"}),(0,n.jsx)(C,{strong:!0,style:{fontSize:14,display:"block",color:"#065F46"},children:I.account_name}),(0,n.jsxs)(C,{style:{fontSize:12,color:"#047857"},children:["PromptPay"===I.account_type?"พร้อมเพย์":I.bank_name,": ",I.account_number]})]})]}),(0,n.jsx)(s.ZP,{block:!0,size:"large",icon:(0,n.jsx)(h.Z,{}),onClick:()=>t.push("/pos/settings/payment-accounts/manage"),style:{borderRadius:12,height:48,fontSize:14,fontWeight:600,background:"#fff",border:"2px dashed #6366f1",color:"#6366f1",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:"จัดการบัญชีทั้งหมด"}),(0,n.jsx)(l.Z,{title:"เลือกบัญชีรับเงิน",open:E,onCancel:()=>_(!1),footer:null,centered:!0,styles:{body:{padding:16}},children:(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[m.map(e=>{let t=(null==I?void 0:I.id)===e.id;return(0,n.jsxs)("div",{onClick:()=>{t||(H(e.id),_(!1))},style:{padding:14,border:"2px solid ".concat(t?"#10b981":"#E5E7EB"),borderRadius:12,cursor:t?"default":"pointer",background:t?"#F0FDF4":"#fff",display:"flex",alignItems:"center",gap:12},children:[(0,n.jsx)("div",{style:{width:36,height:36,borderRadius:8,background:"PromptPay"===e.account_type?"#FDF2F8":"#EFF6FF",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"PromptPay"===e.account_type?(0,n.jsx)(u.Z,{style:{color:"#EC4899",fontSize:16}}):(0,n.jsx)(g.Z,{style:{color:"#3B82F6",fontSize:16}})}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsx)(C,{strong:!0,style:{fontSize:14,display:"block"},children:e.account_name}),(0,n.jsx)(C,{type:"secondary",style:{fontSize:12},children:e.account_number})]}),t&&(0,n.jsx)(x.Z,{style:{color:"#10b981",fontSize:18}})]},e.id)}),(0,n.jsx)(s.ZP,{type:"dashed",block:!0,icon:(0,n.jsx)(h.Z,{}),onClick:()=>t.push("/pos/settings/payment-accounts/manage"),style:{height:44,borderRadius:10,marginTop:8},children:"เพิ่ม/แก้ไขบัญชี"})]})})]}):(0,n.jsx)(w.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=66630)}),_N_E=e.O()}]);