(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9655],{80240:function(e,n,t){Promise.resolve().then(t.bind(t,77489))},77489:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return W}});var a=t(57437),r=t(2265),i=t(19683),o=t(64625),d=t(19878),s=t(50742),l=t(48651),c=t(47451),p=t(69410),x=t(96931),u=t(80009),m=t(53743),g=t(88589),h=t(23496),b=t(86955),y=t(96473),f=t(83669),j=t(13377),v=t(26349),w=t(99376),k=t(44225);let Z={container:{minHeight:"100vh",background:k.X1.background,fontFamily:"var(--font-sans), 'Sarabun', sans-serif",paddingBottom:60},heroHeader:{background:"linear-gradient(145deg, #eb2f96 0%, #c41d7f 100%)",padding:"20px 20px 60px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(235, 47, 150, 0.2)",overflow:"hidden"},heroDecoCircle1:{position:"absolute",top:-60,right:-60,width:160,height:160,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},heroDecoCircle2:{position:"absolute",bottom:-40,left:-40,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.06)"},headerContent:{maxWidth:1200,margin:"0 auto",position:"relative",zIndex:10},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},headerLeft:{display:"flex",alignItems:"center",gap:16},backButton:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},contentWrapper:{maxWidth:1200,margin:"-40px auto 30px",padding:"0 20px",position:"relative",zIndex:20},card:{borderRadius:20,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.06)",transition:"all 0.3s ease"},cardActive:{border:"2px solid ".concat(k.X1.primary),boxShadow:"0 8px 24px ".concat(k.X1.primary,"15")},accountIconBox:{width:56,height:56,borderRadius:16,background:"#eb2f9610",display:"flex",alignItems:"center",justifyContent:"center"},accountNumber:{background:"#f8fafc",borderRadius:12,padding:"12px 16px",border:"1px solid #e2e8f0"},addButton:{borderRadius:14,height:52,padding:"0 28px",fontWeight:600,background:"rgba(255,255,255,0.95)",border:"none",color:"#eb2f96",boxShadow:"0 4px 12px rgba(235, 47, 150, 0.15)"}};var R=t(92525),S=t(97235),C=t(3286),z=t(2938),I=t(25193),P=t(37410),_=t(20148),B=t(2786);let{Title:F,Text:T}=i.default;function W(){let{message:e}=o.Z.useApp(),n=(0,w.useRouter)(),[t,i]=(0,r.useState)([]),[W,A]=(0,r.useState)(!1),{isAuthorized:E,isChecking:X}=(0,C.e)({requiredRole:"Admin"}),[N,V]=(0,r.useState)(!1),[D]=d.Z.useForm(),[H,L]=(0,r.useState)(null),[O,$]=(0,r.useState)(null),q=r.useCallback(async()=>{A(!0);try{let e=await R.p.getByShopId();i(e)}catch(n){e.error("ไม่สามารถโหลดข้อมูลบัญชีได้")}finally{A(!1)}},[e]);(0,r.useEffect)(()=>{q()},[q]);let Y=()=>{L(null),D.resetFields(),V(!0)},M=e=>{L(e.id),D.setFieldsValue(e),V(!0)},U=async n=>{try{let t=await (0,S.P)();await R.p.delete(n,void 0,void 0,t),e.success("ลบบัญชีสำเร็จ"),$(null),q()}catch(t){let n=t instanceof Error?t.message:"ลบไม่สำเร็จ (บัญชีที่ใช้งานอยู่อาจลบไม่ได้)";e.error(n),$(null)}},G=async()=>{try{let n=await D.validateFields();if(!/^\d{10}$/.test(n.account_number))return e.error("เบอร์พร้อมเพย์ต้องเป็นตัวเลข 10 หลักเท่านั้น");if(n.phone&&!/^\d{10}$/.test(n.phone))return e.error("เบอร์โทรศัพท์ร้านต้องเป็นตัวเลข 10 หลักเท่านั้น");let t=await (0,S.P)();H?(await R.p.update(H,n,void 0,void 0,t),e.success("แก้ไขบัญชีสำเร็จ")):(await R.p.create(n,void 0,void 0,t),e.success("เพิ่มบัญชีสำเร็จ")),V(!1),q()}catch(t){if("object"==typeof t&&null!==t&&"errorFields"in t)return;let n=t instanceof Error?t.message:"บันทึกไม่สำเร็จ";e.error(n)}};return X?(0,a.jsx)(z.H,{message:"กำลังตรวจสอบสิทธิ์..."}):E?(0,a.jsxs)("div",{style:Z.container,children:[(0,a.jsx)("style",{children:"\n    @keyframes fadeInUp {\n        from {\n            opacity: 0;\n            transform: translateY(16px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n\n    .payment-card-animate {\n        animation: fadeInUp 0.4s ease forwards;\n        opacity: 0;\n    }\n\n    .payment-card-delay-1 { animation-delay: 0.1s; }\n    .payment-card-delay-2 { animation-delay: 0.2s; }\n    .payment-card-delay-3 { animation-delay: 0.3s; }\n\n    /* Mobile-first */\n    .payment-header-mobile {\n        padding: 16px 16px 50px !important;\n    }\n\n    .payment-header-row-mobile {\n        flex-direction: column !important;\n        align-items: flex-start !important;\n        gap: 20px !important;\n    }\n\n    .payment-content-mobile {\n        padding: 0 16px !important;\n        margin-top: -35px !important;\n    }\n\n    @media (max-width: 576px) {\n        .payment-add-btn {\n            width: 100% !important;\n        }\n\n        .payment-modal .ant-modal {\n            max-width: calc(100vw - 32px) !important;\n            margin: 16px auto !important;\n        }\n\n        .payment-modal .ant-modal-content {\n            border-radius: 20px;\n        }\n    }\n\n    @media (min-width: 768px) {\n        .payment-header-mobile {\n            padding: 24px 24px 60px !important;\n        }\n\n        .payment-header-row-mobile {\n            flex-direction: row !important;\n            align-items: center !important;\n            justify-content: space-between !important;\n        }\n\n        .payment-content-mobile {\n            padding: 0 24px !important;\n        }\n    }\n\n    /* Touch-friendly */\n    .payment-touch-btn {\n        -webkit-tap-highlight-color: rgba(235, 47, 150, 0.1);\n        touch-action: manipulation;\n        min-height: 44px;\n    }\n\n    /* Card hover */\n    .payment-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.08) !important;\n    }\n"}),(0,a.jsx)(_.Z,{title:"จัดการพร้อมเพย์",subtitle:"PromptPay Management",icon:(0,a.jsx)(b.Z,{}),onBack:()=>n.back(),actions:(0,a.jsx)(s.ZP,{type:"primary",icon:(0,a.jsx)(y.Z,{}),onClick:Y,children:"เพิ่มพร้อมเพย์ใหม่"})}),(0,a.jsx)(I.Z,{maxWidth:1100,children:(0,a.jsx)(P.Z,{style:{background:"transparent",border:"none"},children:(0,a.jsx)("div",{style:Z.contentWrapper,className:"payment-content-mobile",children:W?(0,a.jsx)("div",{style:{textAlign:"center",padding:"100px 0"},children:(0,a.jsx)(l.Z,{size:"large"})}):t.length>0?(0,a.jsx)(c.Z,{gutter:[24,24],children:t.map(e=>(0,a.jsx)(p.Z,{xs:24,md:12,lg:8,children:(0,a.jsxs)(x.Z,{hoverable:!0,variant:"borderless",style:{borderRadius:20,overflow:"hidden",boxShadow:e.is_active?"0 8px 24px ".concat(k.X1.primary,"15"):"0 4px 12px rgba(0,0,0,0.03)",border:e.is_active?"2px solid ".concat(k.X1.primary):"2px solid transparent",transition:"all 0.3s ease"},bodyStyle:{padding:24},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:20},children:[(0,a.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:"#eb2f9610",display:"flex",justifyContent:"center",alignItems:"center",fontSize:28,color:"#eb2f96"},children:(0,a.jsx)(b.Z,{})}),e.is_active&&(0,a.jsxs)(u.Z,{color:"green",style:{borderRadius:8,margin:0,padding:"4px 12px",fontWeight:600,fontSize:13,border:"none"},children:[(0,a.jsx)(f.Z,{style:{marginRight:4}})," กำลังใช้งาน"]})]}),(0,a.jsxs)("div",{style:{marginBottom:20},children:[(0,a.jsx)(F,{level:4,style:{margin:"0 0 4px 0",fontSize:18,color:"#1e293b"},children:e.account_name}),(0,a.jsx)(T,{type:"secondary",style:{fontSize:14},children:"พร้อมเพย์ (PromptPay)"})]}),(0,a.jsx)("div",{style:{background:"#f8fafc",borderRadius:12,padding:"12px 16px",marginBottom:24,border:"1px solid #e2e8f0"},children:(0,a.jsx)(T,{strong:!0,style:{fontSize:20,letterSpacing:1.5,fontFamily:"monospace"},children:e.account_number})}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[(0,a.jsx)(s.ZP,{icon:(0,a.jsx)(j.Z,{}),onClick:()=>M(e),style:{borderRadius:10,border:"1px solid #e2e8f0"},children:"จัดการ"}),!e.is_active&&(0,a.jsx)(s.ZP,{danger:!0,icon:(0,a.jsx)(v.Z,{}),style:{borderRadius:10},onClick:()=>$(e.id)})]})]})},e.id))}):(0,a.jsx)(x.Z,{style:{borderRadius:24,padding:"80px 0",textAlign:"center"},children:(0,a.jsx)(B.Z,{title:"ยังไม่มีข้อมูลบัญชีรับเงินในระบบ",description:"กดปุ่มเพื่อเริ่มต้นเพิ่มบัญชีแรก",action:(0,a.jsx)(s.ZP,{type:"primary",size:"large",onClick:Y,icon:(0,a.jsx)(y.Z,{}),style:{borderRadius:10,height:48},children:"เริ่มต้นเพิ่มบัญชีแรก"})})})})})}),(0,a.jsx)(m.Z,{title:H?"แก้ไขข้อมูลพร้อมเพย์":"เพิ่มพร้อมเพย์ใหม่",open:N,onOk:G,onCancel:()=>V(!1),okText:"บันทึกข้อมูล",cancelText:"ยกเลิก",okButtonProps:{size:"large",style:{borderRadius:8,background:k.X1.primary}},cancelButtonProps:{size:"large",style:{borderRadius:8}},width:500,children:(0,a.jsx)("div",{style:{paddingTop:12},children:(0,a.jsxs)(d.Z,{form:D,layout:"vertical",initialValues:{account_type:"PromptPay"},children:[(0,a.jsx)(d.Z.Item,{name:"account_type",hidden:!0,initialValue:"PromptPay",children:(0,a.jsx)(g.default,{})}),(0,a.jsx)(d.Z.Item,{name:"account_name",label:(0,a.jsx)(T,{strong:!0,children:"ชื่อบัญชี / เจ้าของพร้อมเพย์"}),rules:[{required:!0,message:"กรุณาระบุชื่อ"}],children:(0,a.jsx)(g.default,{size:"large",placeholder:"เช่น นายสมใจ ดีมาก",style:{borderRadius:8}})}),(0,a.jsx)(d.Z.Item,{name:"account_number",label:(0,a.jsx)(T,{strong:!0,children:"เบอร์พร้อมเพย์"}),rules:[{required:!0,message:"กรุณาระบุเลขพร้อมเพย์"},{pattern:/^\d{10}$/,message:"ต้องเป็นตัวเลข 10 หลักเท่านั้น"}],extra:"กรอกเบอร์โทรศัพท์พร้อมเพย์ (10 หลัก)",children:(0,a.jsx)(g.default,{size:"large",placeholder:"08xxxxxxxx",style:{borderRadius:8},maxLength:10,onChange:e=>{let n=e.target.value.replace(/\D/g,"").slice(0,10);D.setFieldValue("account_number",n)}})}),(0,a.jsx)(h.Z,{plain:!0,style:{fontSize:13,color:"#999"},children:"ข้อมูลติดต่อเพิ่มเติม (ถ้ามี)"}),(0,a.jsx)(d.Z.Item,{name:"phone",label:(0,a.jsx)(T,{strong:!0,children:"เบอร์โทรศัพท์ร้าน"}),rules:[{pattern:/^\d{10}$/,message:"ต้องเป็นตัวเลข 10 หลักเท่านั้น"}],children:(0,a.jsx)(g.default,{size:"large",placeholder:"08xxxxxxxx",style:{borderRadius:8},maxLength:10,onChange:e=>{let n=e.target.value.replace(/\D/g,"").slice(0,10);D.setFieldValue("phone",n)}})}),(0,a.jsx)(d.Z.Item,{name:"address",label:(0,a.jsx)(T,{strong:!0,children:"ที่อยู่ร้าน"}),children:(0,a.jsx)(g.default.TextArea,{rows:2,placeholder:"ระบุที่อยู่สำหรับบัญชีนี้",style:{borderRadius:8}})})]})})}),(0,a.jsx)(m.Z,{title:"ยืนยันการลบ",open:null!==O,onOk:()=>O&&U(O),onCancel:()=>$(null),okText:"ลบทิ้ง",cancelText:"ยกเลิก",okButtonProps:{danger:!0,size:"large",style:{borderRadius:8}},cancelButtonProps:{size:"large",style:{borderRadius:8}},centered:!0,children:(0,a.jsxs)("div",{style:{padding:"16px 0",textAlign:"center"},children:[(0,a.jsx)(v.Z,{style:{fontSize:48,color:"#ff4d4f",marginBottom:16}}),(0,a.jsx)("p",{style:{fontSize:16,margin:0},children:"คุณแน่ใจหรือไม่ว่าต้องการลบบัญชีนี้?"}),(0,a.jsx)("p",{style:{fontSize:13,color:"#888",marginTop:8},children:"การดำเนินการนี้ไม่สามารถย้อนกลับได้"})]})})]}):(0,a.jsx)(z.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=80240)}),_N_E=e.O()}]);