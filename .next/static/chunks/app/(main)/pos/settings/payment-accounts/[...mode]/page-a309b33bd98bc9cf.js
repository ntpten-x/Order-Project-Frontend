(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9655],{80240:function(e,n,t){Promise.resolve().then(t.bind(t,77489))},77489:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return E}});var a=t(57437),r=t(2265),i=t(19683),o=t(64625),s=t(19878),d=t(50742),l=t(48651),c=t(47451),p=t(69410),x=t(96931),m=t(80009),u=t(85180),h=t(53743),g=t(88589),y=t(23496),b=t(17588),f=t(86955),j=t(96473),v=t(83669),w=t(13377),k=t(26349),R=t(99376),Z=t(44225);let S={container:{minHeight:"100vh",background:Z.X1.background,fontFamily:"'Inter', 'Sarabun', sans-serif",paddingBottom:60},heroHeader:{background:"linear-gradient(145deg, #eb2f96 0%, #c41d7f 100%)",padding:"20px 20px 60px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(235, 47, 150, 0.2)",overflow:"hidden"},heroDecoCircle1:{position:"absolute",top:-60,right:-60,width:160,height:160,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},heroDecoCircle2:{position:"absolute",bottom:-40,left:-40,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.06)"},headerContent:{maxWidth:1200,margin:"0 auto",position:"relative",zIndex:10},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},headerLeft:{display:"flex",alignItems:"center",gap:16},backButton:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},contentWrapper:{maxWidth:1200,margin:"-40px auto 30px",padding:"0 20px",position:"relative",zIndex:20},card:{borderRadius:20,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.06)",transition:"all 0.3s ease"},cardActive:{border:"2px solid ".concat(Z.X1.primary),boxShadow:"0 8px 24px ".concat(Z.X1.primary,"15")},accountIconBox:{width:56,height:56,borderRadius:16,background:"#eb2f9610",display:"flex",alignItems:"center",justifyContent:"center"},accountNumber:{background:"#f8fafc",borderRadius:12,padding:"12px 16px",border:"1px solid #e2e8f0"},addButton:{borderRadius:14,height:52,padding:"0 28px",fontWeight:600,background:"rgba(255,255,255,0.95)",border:"none",color:"#eb2f96",boxShadow:"0 4px 12px rgba(235, 47, 150, 0.15)"}};var C=t(92525),z=t(97235),I=t(3286),P=t(2938);let{Title:_,Text:B}=i.default;function E(){let{message:e}=o.Z.useApp(),n=(0,R.useRouter)(),[t,i]=(0,r.useState)([]),[E,F]=(0,r.useState)(!1),{isAuthorized:N,isChecking:T}=(0,I.e)({requiredRole:"Admin"}),[A,D]=(0,r.useState)(!1),[W]=s.Z.useForm(),[L,X]=(0,r.useState)(null),[H,V]=(0,r.useState)(null),M=r.useCallback(async()=>{F(!0);try{let e=await C.p.getByShopId();i(e)}catch(n){e.error("ไม่สามารถโหลดข้อมูลบัญชีได้")}finally{F(!1)}},[e]);(0,r.useEffect)(()=>{M()},[M]);let O=()=>{X(null),W.resetFields(),D(!0)},$=e=>{X(e.id),W.setFieldsValue(e),D(!0)},q=async n=>{try{let t=await (0,z.P)();await C.p.delete(n,void 0,void 0,t),e.success("ลบบัญชีสำเร็จ"),V(null),M()}catch(t){let n=t instanceof Error?t.message:"ลบไม่สำเร็จ (บัญชีที่ใช้งานอยู่อาจลบไม่ได้)";e.error(n),V(null)}},Y=async()=>{try{let n=await W.validateFields();if(!/^\d{10}$/.test(n.account_number))return e.error("เบอร์พร้อมเพย์ต้องเป็นตัวเลข 10 หลักเท่านั้น");if(n.phone&&!/^\d{10}$/.test(n.phone))return e.error("เบอร์โทรศัพท์ร้านต้องเป็นตัวเลข 10 หลักเท่านั้น");let t=await (0,z.P)();L?(await C.p.update(L,n,void 0,void 0,t),e.success("แก้ไขบัญชีสำเร็จ")):(await C.p.create(n,void 0,void 0,t),e.success("เพิ่มบัญชีสำเร็จ")),D(!1),M()}catch(t){if("object"==typeof t&&null!==t&&"errorFields"in t)return;let n=t instanceof Error?t.message:"บันทึกไม่สำเร็จ";e.error(n)}};return T?(0,a.jsx)(P.H,{message:"กำลังตรวจสอบสิทธิ์..."}):N?(0,a.jsxs)("div",{style:S.container,children:[(0,a.jsx)("style",{children:"\n    @keyframes fadeInUp {\n        from {\n            opacity: 0;\n            transform: translateY(16px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n\n    .payment-card-animate {\n        animation: fadeInUp 0.4s ease forwards;\n        opacity: 0;\n    }\n\n    .payment-card-delay-1 { animation-delay: 0.1s; }\n    .payment-card-delay-2 { animation-delay: 0.2s; }\n    .payment-card-delay-3 { animation-delay: 0.3s; }\n\n    /* Mobile-first */\n    .payment-header-mobile {\n        padding: 16px 16px 50px !important;\n    }\n\n    .payment-header-row-mobile {\n        flex-direction: column !important;\n        align-items: flex-start !important;\n        gap: 20px !important;\n    }\n\n    .payment-content-mobile {\n        padding: 0 16px !important;\n        margin-top: -35px !important;\n    }\n\n    @media (max-width: 576px) {\n        .payment-add-btn {\n            width: 100% !important;\n        }\n\n        .payment-modal .ant-modal {\n            max-width: calc(100vw - 32px) !important;\n            margin: 16px auto !important;\n        }\n\n        .payment-modal .ant-modal-content {\n            border-radius: 20px;\n        }\n    }\n\n    @media (min-width: 768px) {\n        .payment-header-mobile {\n            padding: 24px 24px 60px !important;\n        }\n\n        .payment-header-row-mobile {\n            flex-direction: row !important;\n            align-items: center !important;\n            justify-content: space-between !important;\n        }\n\n        .payment-content-mobile {\n            padding: 0 24px !important;\n        }\n    }\n\n    /* Touch-friendly */\n    .payment-touch-btn {\n        -webkit-tap-highlight-color: rgba(235, 47, 150, 0.1);\n        touch-action: manipulation;\n        min-height: 44px;\n    }\n\n    /* Card hover */\n    .payment-card:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.08) !important;\n    }\n"}),(0,a.jsxs)("div",{style:S.heroHeader,className:"payment-header-mobile",children:[(0,a.jsx)("div",{style:S.heroDecoCircle1}),(0,a.jsx)("div",{style:S.heroDecoCircle2}),(0,a.jsx)("div",{style:S.headerContent,children:(0,a.jsxs)("div",{style:S.headerRow,className:"payment-header-row-mobile",children:[(0,a.jsxs)("div",{style:S.headerLeft,children:[(0,a.jsx)(d.ZP,{type:"text",icon:(0,a.jsx)(b.Z,{style:{fontSize:18,color:"#fff"}}),onClick:()=>n.back(),style:S.backButton,className:"payment-touch-btn"}),(0,a.jsx)("div",{style:S.headerIconBox,children:(0,a.jsx)(f.Z,{style:{fontSize:26,color:"#fff"}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(_,{level:3,style:{margin:0,color:"#fff"},children:"จัดการพร้อมเพย์"}),(0,a.jsx)(B,{style:{color:"rgba(255,255,255,0.9)",fontSize:14},children:"PromptPay Management"})]})]}),(0,a.jsx)(d.ZP,{type:"default",icon:(0,a.jsx)(j.Z,{}),onClick:O,size:"large",style:S.addButton,className:"payment-add-btn payment-touch-btn",children:"เพิ่มพร้อมเพย์ใหม่"})]})})]}),(0,a.jsx)("div",{style:S.contentWrapper,className:"payment-content-mobile",children:E?(0,a.jsx)("div",{style:{textAlign:"center",padding:"100px 0"},children:(0,a.jsx)(l.Z,{size:"large"})}):t.length>0?(0,a.jsx)(c.Z,{gutter:[24,24],children:t.map(e=>(0,a.jsx)(p.Z,{xs:24,md:12,lg:8,children:(0,a.jsxs)(x.Z,{hoverable:!0,variant:"borderless",style:{borderRadius:20,overflow:"hidden",boxShadow:e.is_active?"0 8px 24px ".concat(Z.X1.primary,"15"):"0 4px 12px rgba(0,0,0,0.03)",border:e.is_active?"2px solid ".concat(Z.X1.primary):"2px solid transparent",transition:"all 0.3s ease"},bodyStyle:{padding:24},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:20},children:[(0,a.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:"#eb2f9610",display:"flex",justifyContent:"center",alignItems:"center",fontSize:28,color:"#eb2f96"},children:(0,a.jsx)(f.Z,{})}),e.is_active&&(0,a.jsxs)(m.Z,{color:"green",style:{borderRadius:8,margin:0,padding:"4px 12px",fontWeight:600,fontSize:13,border:"none"},children:[(0,a.jsx)(v.Z,{style:{marginRight:4}})," กำลังใช้งาน"]})]}),(0,a.jsxs)("div",{style:{marginBottom:20},children:[(0,a.jsx)(_,{level:4,style:{margin:"0 0 4px 0",fontSize:18,color:"#1e293b"},children:e.account_name}),(0,a.jsx)(B,{type:"secondary",style:{fontSize:14},children:"พร้อมเพย์ (PromptPay)"})]}),(0,a.jsx)("div",{style:{background:"#f8fafc",borderRadius:12,padding:"12px 16px",marginBottom:24,border:"1px solid #e2e8f0"},children:(0,a.jsx)(B,{strong:!0,style:{fontSize:20,letterSpacing:1.5,fontFamily:"monospace"},children:e.account_number})}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[(0,a.jsx)(d.ZP,{icon:(0,a.jsx)(w.Z,{}),onClick:()=>$(e),style:{borderRadius:10,border:"1px solid #e2e8f0"},children:"จัดการ"}),!e.is_active&&(0,a.jsx)(d.ZP,{danger:!0,icon:(0,a.jsx)(k.Z,{}),style:{borderRadius:10},onClick:()=>V(e.id)})]})]})},e.id))}):(0,a.jsx)(x.Z,{style:{borderRadius:24,padding:"80px 0",textAlign:"center"},children:(0,a.jsx)(u.Z,{description:(0,a.jsx)(B,{type:"secondary",style:{fontSize:16},children:"ยังไม่มีข้อมูลบัญชีรับเงินในระบบ"}),image:u.Z.PRESENTED_IMAGE_SIMPLE,children:(0,a.jsx)(d.ZP,{type:"primary",size:"large",onClick:O,icon:(0,a.jsx)(j.Z,{}),style:{borderRadius:10,height:48,marginTop:16},children:"เริ่มต้นเพิ่มบัญชีแรก"})})})}),(0,a.jsx)(h.Z,{title:L?"แก้ไขข้อมูลพร้อมเพย์":"เพิ่มพร้อมเพย์ใหม่",open:A,onOk:Y,onCancel:()=>D(!1),okText:"บันทึกข้อมูล",cancelText:"ยกเลิก",okButtonProps:{size:"large",style:{borderRadius:8,background:Z.X1.primary}},cancelButtonProps:{size:"large",style:{borderRadius:8}},width:500,children:(0,a.jsx)("div",{style:{paddingTop:12},children:(0,a.jsxs)(s.Z,{form:W,layout:"vertical",initialValues:{account_type:"PromptPay"},children:[(0,a.jsx)(s.Z.Item,{name:"account_type",hidden:!0,initialValue:"PromptPay",children:(0,a.jsx)(g.default,{})}),(0,a.jsx)(s.Z.Item,{name:"account_name",label:(0,a.jsx)(B,{strong:!0,children:"ชื่อบัญชี / เจ้าของพร้อมเพย์"}),rules:[{required:!0,message:"กรุณาระบุชื่อ"}],children:(0,a.jsx)(g.default,{size:"large",placeholder:"เช่น นายสมใจ ดีมาก",style:{borderRadius:8}})}),(0,a.jsx)(s.Z.Item,{name:"account_number",label:(0,a.jsx)(B,{strong:!0,children:"เบอร์พร้อมเพย์"}),rules:[{required:!0,message:"กรุณาระบุเลขพร้อมเพย์"},{pattern:/^\d{10}$/,message:"ต้องเป็นตัวเลข 10 หลักเท่านั้น"}],extra:"กรอกเบอร์โทรศัพท์พร้อมเพย์ (10 หลัก)",children:(0,a.jsx)(g.default,{size:"large",placeholder:"08xxxxxxxx",style:{borderRadius:8},maxLength:10,onChange:e=>{let n=e.target.value.replace(/\D/g,"").slice(0,10);W.setFieldValue("account_number",n)}})}),(0,a.jsx)(y.Z,{plain:!0,style:{fontSize:13,color:"#999"},children:"ข้อมูลติดต่อเพิ่มเติม (ถ้ามี)"}),(0,a.jsx)(s.Z.Item,{name:"phone",label:(0,a.jsx)(B,{strong:!0,children:"เบอร์โทรศัพท์ร้าน"}),rules:[{pattern:/^\d{10}$/,message:"ต้องเป็นตัวเลข 10 หลักเท่านั้น"}],children:(0,a.jsx)(g.default,{size:"large",placeholder:"08xxxxxxxx",style:{borderRadius:8},maxLength:10,onChange:e=>{let n=e.target.value.replace(/\D/g,"").slice(0,10);W.setFieldValue("phone",n)}})}),(0,a.jsx)(s.Z.Item,{name:"address",label:(0,a.jsx)(B,{strong:!0,children:"ที่อยู่ร้าน"}),children:(0,a.jsx)(g.default.TextArea,{rows:2,placeholder:"ระบุที่อยู่สำหรับบัญชีนี้",style:{borderRadius:8}})})]})})}),(0,a.jsx)(h.Z,{title:"ยืนยันการลบ",open:null!==H,onOk:()=>H&&q(H),onCancel:()=>V(null),okText:"ลบทิ้ง",cancelText:"ยกเลิก",okButtonProps:{danger:!0,size:"large",style:{borderRadius:8}},cancelButtonProps:{size:"large",style:{borderRadius:8}},centered:!0,children:(0,a.jsxs)("div",{style:{padding:"16px 0",textAlign:"center"},children:[(0,a.jsx)(k.Z,{style:{fontSize:48,color:"#ff4d4f",marginBottom:16}}),(0,a.jsx)("p",{style:{fontSize:16,margin:0},children:"คุณแน่ใจหรือไม่ว่าต้องการลบบัญชีนี้?"}),(0,a.jsx)("p",{style:{fontSize:13,color:"#888",marginTop:8},children:"การดำเนินการนี้ไม่สามารถย้อนกลับได้"})]})})]}):(0,a.jsx)(P.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=80240)}),_N_E=e.O()}]);