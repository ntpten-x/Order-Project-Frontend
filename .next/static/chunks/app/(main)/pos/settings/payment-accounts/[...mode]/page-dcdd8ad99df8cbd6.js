(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9655],{80240:function(e,t,i){Promise.resolve().then(i.bind(i,77489))},77489:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return ea}});var a=i(57437),n=i(2265),s=i(60283),r=i(88589),l=i(50337),o=i(61778),d=i(38616),c=i(19878),u=i(34029),p=i(53743),x=i(24783),h=i(50742),g=i(24738),m=i(96931),y=i(80009),f=i(47451),b=i(69410),j=i(66487),v=i(86955),Z=i(8900),_=i(26349),w=i(55322),k=i(89245),C=i(96473),S=i(29436),P=i(82618),R=i(13377),F=i(15424),I=i(78355),z=i(29271),E=i(99376),A=i(44225);let W={container:{minHeight:"100vh",background:A.X1.background,fontFamily:"var(--font-sans), 'Sarabun', sans-serif",paddingBottom:60},heroHeader:{background:"linear-gradient(145deg, #eb2f96 0%, #c41d7f 100%)",padding:"20px 20px 60px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(235, 47, 150, 0.2)",overflow:"hidden"},heroDecoCircle1:{position:"absolute",top:-60,right:-60,width:160,height:160,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},heroDecoCircle2:{position:"absolute",bottom:-40,left:-40,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.06)"},headerContent:{maxWidth:1200,margin:"0 auto",position:"relative",zIndex:10},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16},headerLeft:{display:"flex",alignItems:"center",gap:16},backButton:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},contentWrapper:{maxWidth:1200,margin:"-40px auto 30px",padding:"0 20px",position:"relative",zIndex:20},card:{borderRadius:20,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.06)",transition:"all 0.3s ease"},cardActive:{border:"2px solid ".concat(A.X1.primary),boxShadow:"0 8px 24px ".concat(A.X1.primary,"15")},accountIconBox:{width:56,height:56,borderRadius:16,background:"#eb2f9610",display:"flex",alignItems:"center",justifyContent:"center"},accountNumber:{background:"#f8fafc",borderRadius:12,padding:"12px 16px",border:"1px solid #e2e8f0"},addButton:{borderRadius:14,height:52,padding:"0 28px",fontWeight:600,background:"rgba(255,255,255,0.95)",border:"none",color:"#eb2f96",boxShadow:"0 4px 12px rgba(235, 47, 150, 0.15)"}};var B=i(92525),T=i(97235),L=i(67918),N=i(2938),D=i(24675),M=i(67697),O=i(12028),H=i(25193),V=i(37410),q=i(27623),X=i(20148),U=i(2786);let{Title:Y,Text:G}=s.default,{TextArea:J}=r.default,K=e=>e.replace(/\D/g,""),Q=e=>{if(!e)return"-";let t=new Date(e);return Number.isNaN(t.getTime())?"-":new Intl.DateTimeFormat("th-TH",{dateStyle:"medium",timeStyle:"short"}).format(t)},$=(e,t)=>{let i=null==e?void 0:e.status,a=null==e?void 0:e.code,n=(null==e?void 0:e.message)||"",s=n.toLowerCase();return"DUPLICATE_ENTRY"===a||s.includes("duplicate")||s.includes("already exists")?s.includes("active account")||s.includes("cannot delete")?"ลบบัญชีหลักไม่ได้ กรุณาเปลี่ยนบัญชีหลักก่อน":"เลขพร้อมเพย์นี้ถูกใช้งานแล้ว กรุณาตรวจสอบและลองใหม่":409===i&&"DATABASE_ERROR"===a?"เซิร์ฟเวอร์แจ้งข้อผิดพลาดฐานข้อมูล (ไม่ใช่เลขซ้ำ) กรุณาลองใหม่หรือตรวจสอบ backend":409===i?n||"เกิดข้อขัดแย้งของข้อมูล กรุณารีเฟรชแล้วลองใหม่":400===i?n||"ข้อมูลไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง":403===i?"สิทธิ์ไม่เพียงพอ หรือ CSRF token หมดอายุ กรุณารีเฟรชแล้วลองใหม่":404===i?"ไม่พบข้อมูลบัญชีที่ต้องการ":n||t},ee=e=>{let{total:t,active:i,inactive:n}=e;return(0,a.jsxs)("div",{style:{background:"#fff",borderRadius:16,border:"1px solid #e2e8f0",display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",gap:8,padding:14},children:[(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("span",{style:{fontSize:24,fontWeight:700,color:"#0f172a",display:"block"},children:t}),(0,a.jsx)(G,{style:{fontSize:12,color:"#64748b"},children:"ทั้งหมด"})]}),(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("span",{style:{fontSize:24,fontWeight:700,color:"#16a34a",display:"block"},children:i}),(0,a.jsx)(G,{style:{fontSize:12,color:"#64748b"},children:"บัญชีหลัก"})]}),(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("span",{style:{fontSize:24,fontWeight:700,color:"#b91c1c",display:"block"},children:n}),(0,a.jsx)(G,{style:{fontSize:12,color:"#64748b"},children:"ไม่ใช้งาน"})]})]})},et=e=>{let{compact:t=!1,rows:i=3}=e;return(0,a.jsx)("div",{style:{display:"grid",gap:t?8:12},children:Array.from({length:i}).map((e,i)=>(0,a.jsx)(l.Z.Input,{active:!0,block:!0,style:{height:t?32:38}},i))})},ei=e=>{let{accountName:t,accountNumber:i,isActive:n}=e;return(0,a.jsxs)("div",{style:{background:"white",borderRadius:20,padding:20,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",border:"1px solid #F1F5F9"},children:[(0,a.jsx)(Y,{level:5,style:{color:"#db2777",marginBottom:16,fontWeight:700},children:"ตัวอย่างการแสดงผล"}),(0,a.jsxs)("div",{style:{borderRadius:16,border:"1px solid ".concat(n?"#bbf7d0":"#e2e8f0"),padding:14,background:n?"#f0fdf4":"#f8fafc",display:"flex",alignItems:"center",gap:12,marginBottom:16},children:[(0,a.jsx)("div",{style:{width:48,height:48,borderRadius:12,background:"#fdf2f8",color:"#db2777",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontSize:20},children:(0,a.jsx)(v.Z,{})}),(0,a.jsxs)("div",{style:{textAlign:"left",flex:1,minWidth:0},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)(G,{strong:!0,style:{fontSize:16,color:"#0f172a"},ellipsis:!0,children:t||"ชื่อบัญชีพร้อมเพย์"}),n&&(0,a.jsx)(Z.Z,{style:{color:"#16a34a",fontSize:14}})]}),(0,a.jsx)(G,{type:"secondary",style:{fontSize:13,display:"block"},children:i||"เลขพร้อมเพย์"}),(0,a.jsx)(G,{type:"secondary",style:{fontSize:12,display:"block"},children:"พร้อมเพย์ (PromptPay)"})]})]}),(0,a.jsx)(o.Z,{type:n?"success":"info",showIcon:!0,message:n?"บัญชีนี้จะเป็นบัญชีหลักสำหรับรับเงิน":"บัญชีนี้ยังไม่ถูกตั้งเป็นบัญชีหลัก"})]})};function ea(e){var t,i,s,Z,A,ea;let{params:en}=e,es=(0,E.useRouter)(),{socket:er}=(0,D.s)(),el=!d.default.useBreakpoint().md,{isAuthorized:eo,isChecking:ed}=(0,L.e)({allowedRoles:["Admin","Manager"]}),[ec]=c.Z.useForm(),[eu,ep]=(0,n.useState)([]),[ex,eh]=(0,n.useState)(!0),[eg,em]=(0,n.useState)(!1),[ey,ef]=(0,n.useState)(!1),[eb,ej]=(0,n.useState)(!1),[ev,eZ]=(0,n.useState)(null),[e_,ew]=(0,n.useState)(""),[ek,eC]=(0,n.useState)("all"),[eS,eP]=(0,n.useState)(null),eR=null===(t=en.mode)||void 0===t?void 0:t[0],eF="manage"===eR||"add"===eR||"edit"===eR?eR:null,eI=null!==(s=null===(i=en.mode)||void 0===i?void 0:i[1])&&void 0!==s?s:null,ez=null!==eF&&("edit"!==eF||!!eI),eE="manage"===eF,eA="add"===eF,eW="edit"===eF&&!!eI,eB=null!==(Z=c.Z.useWatch("account_name",ec))&&void 0!==Z?Z:"",eT=null!==(A=c.Z.useWatch("account_number",ec))&&void 0!==A?A:"",eL=null!==(ea=c.Z.useWatch("is_active",ec))&&void 0!==ea&&ea,eN=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?em(!0):eh(!0);let t=await B.p.getByShopId();ep(t.filter(e=>"PromptPay"===e.account_type))}catch(e){console.error(e),u.ZP.error($(e,"ไม่สามารถโหลดข้อมูลบัญชีพร้อมเพย์ได้"))}finally{e?em(!1):eh(!1),ef(!0)}},[]);(0,n.useEffect)(()=>{eo&&eN()},[eo,eN]),(0,n.useEffect)(()=>{ez||es.replace("/pos/settings/payment-accounts/manage")},[ez,es]),(0,M.v)(er,{create:O.b.paymentAccounts.create,update:O.b.paymentAccounts.update,delete:O.b.paymentAccounts.delete},ep,e=>e.id,e=>"PromptPay"===e.account_type),(0,M.D)({socket:er,events:[O.b.paymentAccounts.create,O.b.paymentAccounts.update,O.b.paymentAccounts.delete],onRefresh:()=>eN(!0),intervalMs:45e3,enabled:eo});let eD=(0,n.useMemo)(()=>{var e;return eW&&eI&&null!==(e=eu.find(e=>e.id===eI))&&void 0!==e?e:null},[eu,eI,eW]),eM=!!(eW&&(null==eD?void 0:eD.is_active));(0,n.useEffect)(()=>{eA&&(ec.resetFields(),ec.setFieldsValue({account_name:"",account_number:"",phone:"",address:"",is_active:0===eu.length}),eP(null))},[eu.length,ec,eA]),(0,n.useEffect)(()=>{if(eW&&eI&&ey){if(!eD){u.ZP.error("ไม่พบบัญชีพร้อมเพย์ที่ต้องการแก้ไข"),es.replace("/pos/settings/payment-accounts/manage");return}eS!==eI&&(ec.setFieldsValue({account_name:eD.account_name,account_number:eD.account_number,phone:eD.phone||"",address:eD.address||"",is_active:eD.is_active}),eP(eI))}},[eI,eD,ey,ec,eS,eW,es]);let eO=(0,n.useMemo)(()=>{let e=eu.length,t=eu.filter(e=>e.is_active).length;return{total:e,active:t,inactive:e-t}},[eu]),eH=(0,n.useMemo)(()=>{let e=eu;"active"===ek?e=e.filter(e=>e.is_active):"inactive"===ek&&(e=e.filter(e=>!e.is_active));let t=e_.trim().toLowerCase();return t&&(e=e.filter(e=>e.account_name.toLowerCase().includes(t)||e.account_number.toLowerCase().includes(t))),e},[eu,e_,ek]),eV=async e=>{if(!e.is_active){eZ(e.id);try{let t=await (0,T.P)();await B.p.activate(e.id,void 0,void 0,t),u.ZP.success('ตั้ง "'.concat(e.account_name,'" เป็นบัญชีหลักแล้ว')),await eN(!0)}catch(e){console.error(e),u.ZP.error($(e,"ไม่สามารถตั้งบัญชีหลักได้"))}finally{eZ(null)}}},eq=e=>{p.Z.confirm({title:"ยืนยันการลบบัญชีพร้อมเพย์",content:e.is_active?"บัญชีหลักไม่สามารถลบได้ กรุณาเปลี่ยนบัญชีหลักก่อน":'คุณต้องการลบบัญชี "'.concat(e.account_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,a.jsx)(_.Z,{style:{color:"#EF4444"}}),okButtonProps:{disabled:e.is_active},onOk:async()=>{if(e.is_active){u.ZP.warning("ลบบัญชีหลักไม่ได้ กรุณาเปลี่ยนบัญชีหลักก่อน");return}try{let t=await (0,T.P)();await B.p.delete(e.id,void 0,void 0,t),u.ZP.success('ลบบัญชี "'.concat(e.account_name,'" สำเร็จ')),await eN(!0),eW&&es.push("/pos/settings/payment-accounts/manage")}catch(e){console.error(e),u.ZP.error($(e,"ไม่สามารถลบบัญชีพร้อมเพย์ได้"))}}})},eX=async e=>{ej(!0);try{var t;let i=K(e.account_number||""),a=K(e.phone||"");if(10!==i.length&&13!==i.length)throw Error("เลขพร้อมเพย์ต้องมีความยาว 10 หรือ 13 หลัก");if(a&&10!==a.length)throw Error("เบอร์โทรศัพท์ต้องเป็นตัวเลข 10 หลัก");let n=eu.find(e=>K(e.account_number)===i&&(!eW||e.id!==eI));if(n)throw Error('เลขพร้อมเพย์นี้ถูกใช้งานแล้ว โดยบัญชี "'.concat(n.account_name,'"'));let s={account_name:e.account_name.trim(),account_number:i,account_type:"PromptPay",bank_name:void 0,phone:a||void 0,address:(null===(t=e.address)||void 0===t?void 0:t.trim())||void 0,is_active:!!eM||!!e.is_active},r=await (0,T.P)();eW&&eI?(await B.p.update(eI,s,void 0,void 0,r),u.ZP.success('อัปเดตบัญชี "'.concat(s.account_name,'" สำเร็จ'))):(await B.p.create(s,void 0,void 0,r),u.ZP.success('เพิ่มบัญชี "'.concat(s.account_name,'" สำเร็จ'))),es.push("/pos/settings/payment-accounts/manage"),await eN(!0)}catch(e){console.error(e),u.ZP.error($(e,"ไม่สามารถบันทึกข้อมูลได้"))}finally{ej(!1)}};if(ed)return(0,a.jsx)(N.H,{message:"กำลังตรวจสอบสิทธิ์..."});if(!eo)return(0,a.jsx)(N.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"});if(!ez)return null;let eU=eE?"จัดการบัญชีพร้อมเพย์":eW?"แก้ไขบัญชีพร้อมเพย์":"เพิ่มบัญชีพร้อมเพย์",eY=eE?"จัดการรายการพร้อมเพย์ ตั้งบัญชีหลัก และแก้ไขข้อมูล":eW?"ปรับแก้ข้อมูลบัญชีพร้อมเพย์ที่มีอยู่":"เพิ่มบัญชีพร้อมเพย์ใหม่สำหรับรับชำระใน POS";return(0,a.jsxs)("div",{style:W.container,children:[(0,a.jsx)(X.Z,{title:eU,subtitle:eY,icon:(0,a.jsx)(w.Z,{}),onBack:()=>es.push("/pos/settings"),actions:eE?(0,a.jsxs)(x.Z,{size:8,wrap:!0,children:[(0,a.jsx)(h.ZP,{icon:(0,a.jsx)(k.Z,{}),onClick:()=>eN(!1),loading:ex||eg}),(0,a.jsx)(h.ZP,{type:"primary",icon:(0,a.jsx)(C.Z,{}),onClick:()=>es.push("/pos/settings/payment-accounts/add"),children:"เพิ่มพร้อมเพย์"})]}):(0,a.jsxs)(x.Z,{size:8,wrap:!0,children:[eW&&eD?(0,a.jsx)(h.ZP,{danger:!0,icon:(0,a.jsx)(_.Z,{}),onClick:()=>eq(eD),disabled:eD.is_active,children:"ลบ"}):null,(0,a.jsx)(h.ZP,{onClick:()=>es.push("/pos/settings/payment-accounts/manage"),children:"กลับหน้ารายการ"})]})}),(0,a.jsx)(H.Z,{maxWidth:1100,children:eE?(0,a.jsxs)(q.Z,{children:[(0,a.jsx)(V.Z,{title:"ภาพรวมบัญชีพร้อมเพย์",children:ex?(0,a.jsx)(et,{compact:el,rows:2}):(0,a.jsx)(ee,{total:eO.total,active:eO.active,inactive:eO.inactive})}),(0,a.jsx)(V.Z,{title:"ค้นหาและตัวกรอง",children:ex?(0,a.jsx)(et,{compact:el,rows:3}):(0,a.jsxs)("div",{style:{display:"grid",gap:el?8:10},children:[(0,a.jsx)(r.default,{size:el?"middle":"large",prefix:(0,a.jsx)(S.Z,{style:{color:"#94A3B8"}}),allowClear:!0,placeholder:"ค้นหาจากชื่อบัญชี หรือเลขพร้อมเพย์...",value:e_,onChange:e=>ew(e.target.value)}),(0,a.jsx)(g.Z,{options:[{label:"ทั้งหมด (".concat(eu.length,")"),value:"all"},{label:"บัญชีหลัก (".concat(eO.active,")"),value:"active"},{label:"ไม่ใช้งาน (".concat(eO.inactive,")"),value:"inactive"}],block:el,size:el?"small":"middle",value:ek,onChange:e=>eC(e)})]})}),(0,a.jsx)(V.Z,{title:"รายการบัญชีพร้อมเพย์",extra:(0,a.jsx)("span",{style:{fontWeight:600},children:eH.length}),children:ex?(0,a.jsx)("div",{style:{display:"grid",gap:el?8:10},children:Array.from({length:3}).map((e,t)=>(0,a.jsx)(m.Z,{size:"small",style:{borderRadius:12},children:(0,a.jsx)(l.Z,{active:!0,paragraph:{rows:1},title:{width:"60%"}})},t))}):eH.length>0?(0,a.jsx)("div",{style:{display:"grid",gap:el?8:10},children:eH.map(e=>(0,a.jsxs)("div",{style:{borderRadius:16,border:"1px solid ".concat(e.is_active?"#86efac":"#e2e8f0"),background:e.is_active?"#f0fdf4":"#fff",padding:el?10:14,display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,minWidth:0},children:[(0,a.jsx)("div",{style:{width:el?38:44,height:el?38:44,borderRadius:12,background:"#fdf2f8",color:"#db2777",display:"flex",alignItems:"center",justifyContent:"center",fontSize:18},children:(0,a.jsx)(v.Z,{})}),(0,a.jsxs)("div",{style:{minWidth:0},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[(0,a.jsx)(G,{strong:!0,style:{fontSize:15},children:e.account_name}),(0,a.jsx)(y.Z,{color:e.is_active?"green":"default",style:{margin:0,borderRadius:6},children:e.is_active?"บัญชีหลัก":"พร้อมเพย์"})]}),(0,a.jsx)(G,{type:"secondary",style:{fontSize:12,display:"block"},children:e.account_number})]})]}),(0,a.jsxs)(x.Z,{size:8,wrap:!0,children:[e.is_active?null:(0,a.jsx)(h.ZP,{type:"primary",icon:(0,a.jsx)(P.Z,{}),loading:ev===e.id,onClick:()=>eV(e),children:"ตั้งเป็นบัญชีหลัก"}),(0,a.jsx)(h.ZP,{icon:(0,a.jsx)(R.Z,{}),onClick:()=>es.push("/pos/settings/payment-accounts/edit/".concat(e.id)),children:"แก้ไข"}),(0,a.jsx)(h.ZP,{danger:!0,icon:(0,a.jsx)(_.Z,{}),onClick:()=>eq(e),disabled:e.is_active,children:"ลบ"})]})]},e.id))}):(0,a.jsx)(U.Z,{title:e_.trim()?"ไม่พบบัญชีตามคำค้น":"ยังไม่มีบัญชีพร้อมเพย์",description:e_.trim()?"ลองเปลี่ยนคำค้นหาหรือฟิลเตอร์":"เพิ่มบัญชีแรกเพื่อเริ่มรับชำระเงินผ่านระบบ POS",action:e_.trim()?null:(0,a.jsx)(h.ZP,{type:"primary",icon:(0,a.jsx)(C.Z,{}),onClick:()=>es.push("/pos/settings/payment-accounts/add"),children:"เพิ่มบัญชีแรก"})})})]}):(0,a.jsx)(V.Z,{style:{background:"transparent",border:"none"},children:ex&&eW?(0,a.jsxs)(f.Z,{gutter:[20,20],children:[(0,a.jsx)(b.Z,{xs:24,lg:15,children:(0,a.jsx)(et,{compact:el,rows:7})}),(0,a.jsx)(b.Z,{xs:24,lg:9,children:(0,a.jsx)(et,{compact:el,rows:4})})]}):(0,a.jsxs)(f.Z,{gutter:[20,20],children:[(0,a.jsx)(b.Z,{xs:24,lg:15,children:(0,a.jsxs)(m.Z,{bordered:!1,style:{borderRadius:20,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},styles:{body:{padding:el?14:24}},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:20},children:[(0,a.jsx)(w.Z,{style:{fontSize:20,color:"#db2777"}}),(0,a.jsx)(Y,{level:5,style:{margin:0},children:"ข้อมูลบัญชีพร้อมเพย์"})]}),(0,a.jsxs)(c.Z,{form:ec,layout:"vertical",onFinish:eX,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!1},children:[(0,a.jsx)(o.Z,{showIcon:!0,type:"info",icon:(0,a.jsx)(F.Z,{}),message:"รองรับเฉพาะพร้อมเพย์",description:"หน้าจอนี้รองรับการเพิ่ม/แก้ไขบัญชีพร้อมเพย์เท่านั้น",style:{marginBottom:16}}),(0,a.jsx)(c.Z.Item,{name:"account_name",label:(0,a.jsx)("span",{style:{fontWeight:600,color:"#334155"},children:"ชื่อบัญชี"}),rules:[{required:!0,message:"กรุณากรอกชื่อบัญชี"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,a.jsx)(r.default,{size:el?"middle":"large",placeholder:"เช่น ร้านกาแฟสาขาหลัก",style:{borderRadius:12,height:46,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,a.jsx)(c.Z.Item,{name:"account_number",label:(0,a.jsx)("span",{style:{fontWeight:600,color:"#334155"},children:"เลขพร้อมเพย์"}),validateTrigger:["onBlur","onSubmit"],rules:[{required:!0,message:"กรุณากรอกเลขพร้อมเพย์"},{validator:async(e,t)=>{let i=K(t||"");if(i){if(10!==i.length&&13!==i.length)throw Error("เลขพร้อมเพย์ต้องมีความยาว 10 หรือ 13 หลัก");if(eu.some(e=>K(e.account_number)===i&&(!eW||e.id!==eI)))throw Error("เลขพร้อมเพย์นี้ถูกใช้งานแล้ว")}}}],children:(0,a.jsx)(r.default,{size:el?"middle":"large",placeholder:"08xxxxxxxx หรือเลข 13 หลัก",style:{borderRadius:12,height:46,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:13,onChange:e=>{ec.setFieldValue("account_number",K(e.target.value).slice(0,13))}})}),(0,a.jsx)(c.Z.Item,{name:"phone",label:(0,a.jsx)("span",{style:{fontWeight:600,color:"#334155"},children:"เบอร์โทรติดต่อ (ไม่บังคับ)"}),rules:[{validator:async(e,t)=>{if(t&&10!==K(t).length)throw Error("เบอร์โทรศัพท์ต้องเป็นตัวเลข 10 หลัก")}}],children:(0,a.jsx)(r.default,{size:el?"middle":"large",placeholder:"08xxxxxxxx",style:{borderRadius:12,height:46,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:10,onChange:e=>{ec.setFieldValue("phone",K(e.target.value).slice(0,10))}})}),(0,a.jsx)(c.Z.Item,{name:"address",label:(0,a.jsx)("span",{style:{fontWeight:600,color:"#334155"},children:"ที่อยู่/หมายเหตุ (ไม่บังคับ)"}),rules:[{max:255,message:"ความยาวต้องไม่เกิน 255 ตัวอักษร"}],children:(0,a.jsx)(J,{rows:3,placeholder:"เช่น ใช้สำหรับหน้าร้านชั้น 1",maxLength:255,style:{borderRadius:12,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"}})}),(0,a.jsx)("div",{style:{padding:16,background:"#F8FAFC",borderRadius:14,marginTop:16,marginBottom:18},children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(G,{strong:!0,style:{fontSize:15,display:"block"},children:"ตั้งเป็นบัญชีหลัก"}),(0,a.jsx)(G,{type:"secondary",style:{fontSize:13},children:"เปิดเพื่อใช้บัญชีนี้เป็นบัญชีหลักรับชำระเงิน"})]}),(0,a.jsx)(c.Z.Item,{name:"is_active",valuePropName:"checked",noStyle:!0,children:(0,a.jsx)(j.Z,{disabled:eM,style:{background:eL?"#10B981":void 0}})})]})}),(0,a.jsxs)("div",{style:{marginTop:12,display:"flex",gap:12},children:[(0,a.jsx)(h.ZP,{size:el?"middle":"large",onClick:()=>es.push("/pos/settings/payment-accounts/manage"),style:{flex:1,borderRadius:12,height:46,fontWeight:600},children:"ยกเลิก"}),(0,a.jsx)(h.ZP,{type:"primary",htmlType:"submit",loading:eb,icon:(0,a.jsx)(I.Z,{}),size:el?"middle":"large",style:{flex:2,borderRadius:12,height:46,fontWeight:600,background:"#db2777",boxShadow:"0 4px 12px rgba(219, 39, 119, 0.25)"},children:"บันทึกข้อมูล"})]})]})]})}),(0,a.jsx)(b.Z,{xs:24,lg:9,children:(0,a.jsxs)("div",{style:{display:"grid",gap:14},children:[(0,a.jsx)(ei,{accountName:eB,accountNumber:eT,isActive:eL}),eW&&eD?(0,a.jsxs)(m.Z,{style:{borderRadius:16},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:10},children:[(0,a.jsx)(z.Z,{style:{color:"#0369a1"}}),(0,a.jsx)(G,{strong:!0,children:"รายละเอียดรายการ"})]}),(0,a.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,a.jsxs)(G,{type:"secondary",children:["ID: ",eD.id]}),(0,a.jsxs)(G,{type:"secondary",children:["สร้างเมื่อ: ",Q(eD.created_at)]}),(0,a.jsxs)(G,{type:"secondary",children:["อัปเดตเมื่อ: ",Q(eD.updated_at)]}),(0,a.jsxs)(G,{type:"secondary",children:["สถานะ: ",eD.is_active?"บัญชีหลัก":"ยังไม่ใช้งาน"]})]})]}):null]})})]})})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=80240)}),_N_E=e.O()}]);