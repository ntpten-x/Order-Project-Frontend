(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1694],{66630:function(e,t,n){Promise.resolve().then(n.bind(n,49190))},49190:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var i=n(57437),o=n(2265),r=n(19683),a=n(64625),d=n(48651),s=n(50742),l=n(53743),c=n(55322),p=n(86955),u=n(37527),x=n(83669),g=n(96473),h=n(99376),b=n(92525),f=n(3369),y=n(44225);let m={container:{minHeight:"100vh",background:y.X1.background,fontFamily:"var(--font-sans), 'Sarabun', sans-serif",paddingBottom:60},heroParams:{background:"linear-gradient(145deg, ".concat(y.X1.primary," 0%, ").concat(y.X1.primaryDark," 100%)"),padding:"20px 20px 60px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(99, 102, 241, 0.2)",zIndex:1,overflow:"hidden"},heroDecoCircle1:{position:"absolute",top:-60,right:-60,width:160,height:160,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},heroDecoCircle2:{position:"absolute",bottom:-40,left:-40,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.06)"},headerContent:{maxWidth:1e3,margin:"0 auto",position:"relative",zIndex:10},headerRow:{display:"flex",alignItems:"center",gap:16},backButton:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},sectionTitle:{display:"flex",alignItems:"center",gap:12,marginBottom:20,color:"#fff"},contentWrapper:{maxWidth:700,margin:"-40px auto 30px",padding:"0 20px",position:"relative",zIndex:20},card:{borderRadius:20,boxShadow:"0 4px 20px rgba(0,0,0,0.06)",border:"none"},activeAccountCard:{background:"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)",border:"1px solid #a7f3d0",borderRadius:16,padding:"20px",marginBottom:24},addButton:{borderRadius:14,height:52,fontSize:16,fontWeight:600,background:"#fff",border:"2px dashed ".concat(y.X1.primary),color:y.X1.primary,transition:"all 0.2s ease"},dividerTitle:{fontSize:16,fontWeight:600},accountSelector:{border:"1px solid #e2e8f0",borderRadius:14,padding:"14px 18px",cursor:"pointer",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:56,transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},accountSelectorHover:{borderColor:y.X1.primary,boxShadow:"0 0 0 3px ".concat(y.X1.primaryLight)},modalAccountItem:{padding:"16px",border:"1px solid #e5e7eb",borderRadius:14,cursor:"pointer",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s ease"},modalAccountItemActive:{border:"2px solid #10b981",background:"#ecfdf5"},accountIconBox:{width:44,height:44,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center"}};var j=n(97235),k=n(24675),v=n(67697),S=n(3286),F=n(2938),w=n(25193),C=n(37410),R=n(20148);let{Text:z}=r.default;function Z(){let{message:e}=a.Z.useApp(),t=(0,h.useRouter)(),[n,r]=(0,o.useState)(!0),[y,Z]=(0,o.useState)([]),[B,I]=(0,o.useState)(null),[_,P]=(0,o.useState)(!1),{showLoading:E,hideLoading:D}=(0,f.x)(),{socket:W}=(0,k.s)(),{isAuthorized:A,isChecking:H}=(0,S.e)({requiredRole:"Admin"}),X=(0,o.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{t||r(!0);let e=await b.p.getByShopId();Z(e);let n=e.find(e=>e.is_active);I(n||null)}catch(t){e.error("ไม่สามารถดึงข้อมูลบัญชีได้")}finally{t||r(!1)}},[e]);(0,o.useEffect)(()=>{X()},[X]),(0,v.D)({socket:W,events:["payment-accounts:update","payment-accounts:create","payment-accounts:delete"],onRefresh:()=>X(!0),intervalMs:2e4});let N=async t=>{try{E("กำลังเปลี่ยนบัญชีรับเงิน...");let n=y.find(e=>e.id===t);n&&I(n);let i=await (0,j.P)();await b.p.activate(t,void 0,void 0,i),e.success("เปลี่ยนบัญชีรับเงินหลักสำเร็จ"),await X(!0)}catch(t){e.error("ไม่สามารถเปลี่ยนบัญชีได้"),await X(!0)}finally{D()}};return H?(0,i.jsx)(F.H,{message:"กำลังตรวจสอบสิทธิ์..."}):A?n?(0,i.jsxs)("div",{style:{minHeight:"100vh",background:m.container.background},children:[(0,i.jsx)(R.Z,{title:"ตั้งค่าบัญชีรับเงิน",subtitle:"Payment Settings",icon:(0,i.jsx)(c.Z,{}),onBack:()=>t.back()}),(0,i.jsx)(w.Z,{maxWidth:900,children:(0,i.jsx)(C.Z,{children:(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:(0,i.jsx)(d.Z,{size:"large",tip:"กำลังโหลด..."})})})})]}):(0,i.jsxs)("div",{style:{minHeight:"100vh",background:"#F8FAFC",paddingBottom:80},children:[(0,i.jsx)(R.Z,{title:"ตั้งค่าบัญชีรับเงิน",subtitle:"Payment Settings",icon:(0,i.jsx)(c.Z,{}),onBack:()=>t.back(),actions:(0,i.jsx)(s.ZP,{onClick:()=>X(!1),loading:n,children:"รีเฟรช"})}),(0,i.jsx)(w.Z,{maxWidth:900,children:(0,i.jsxs)(C.Z,{style:{background:"transparent",border:"none"},children:[(0,i.jsxs)("div",{style:{background:"white",borderRadius:16,padding:16,marginBottom:16,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[(0,i.jsx)(z,{type:"secondary",style:{fontSize:13,display:"block",marginBottom:12},children:"เลือกบัญชีรับเงินหลัก"}),(0,i.jsxs)("div",{style:{border:"2px solid ".concat(B?"#10b981":"#E2E8F0"),borderRadius:12,padding:14,cursor:"pointer",background:B?"#F0FDF4":"#fff",display:"flex",alignItems:"center",gap:12},onClick:()=>P(!0),children:[(0,i.jsx)("div",{style:{width:40,height:40,borderRadius:10,background:(null==B?void 0:B.account_type)==="PromptPay"?"#FDF2F8":"#EFF6FF",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(null==B?void 0:B.account_type)==="PromptPay"?(0,i.jsx)(p.Z,{style:{color:"#EC4899",fontSize:18}}):(0,i.jsx)(u.Z,{style:{color:"#3B82F6",fontSize:18}})}),(0,i.jsx)("div",{style:{flex:1,minWidth:0},children:B?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(z,{strong:!0,style:{fontSize:15,display:"block",color:"#1E293B"},children:B.account_name}),(0,i.jsx)(z,{type:"secondary",style:{fontSize:12},children:B.account_number})]}):(0,i.jsx)(z,{type:"secondary",children:"กดเพื่อเลือกบัญชี"})}),(0,i.jsx)("div",{style:{background:"#10b981",color:"white",padding:"4px 10px",borderRadius:6,fontSize:11,fontWeight:600,flexShrink:0},children:"เปลี่ยน"})]})]}),B&&(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, #ECFDF5 0%, #D1FAE5 100%)",border:"1px solid #A7F3D0",borderRadius:14,padding:14,marginBottom:16,display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)(x.Z,{style:{fontSize:24,color:"#10B981",flexShrink:0}}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsx)(z,{style:{fontSize:11,color:"#059669",display:"block"},children:"กำลังใช้งาน"}),(0,i.jsx)(z,{strong:!0,style:{fontSize:14,display:"block",color:"#065F46"},children:B.account_name}),(0,i.jsxs)(z,{style:{fontSize:12,color:"#047857"},children:["PromptPay"===B.account_type?"พร้อมเพย์":B.bank_name,": ",B.account_number]})]})]}),(0,i.jsx)(s.ZP,{block:!0,size:"large",icon:(0,i.jsx)(g.Z,{}),onClick:()=>t.push("/pos/settings/payment-accounts/manage"),style:{borderRadius:12,height:48,fontSize:14,fontWeight:600,background:"#fff",border:"2px dashed #6366f1",color:"#6366f1",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:"จัดการบัญชีทั้งหมด"})]})}),(0,i.jsx)(l.Z,{title:"เลือกบัญชีรับเงิน",open:_,onCancel:()=>P(!1),footer:null,centered:!0,styles:{body:{padding:16}},children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[y.map(e=>{let t=(null==B?void 0:B.id)===e.id;return(0,i.jsxs)("div",{onClick:()=>{t||(N(e.id),P(!1))},style:{padding:14,border:"2px solid ".concat(t?"#10b981":"#E5E7EB"),borderRadius:12,cursor:t?"default":"pointer",background:t?"#F0FDF4":"#fff",display:"flex",alignItems:"center",gap:12},children:[(0,i.jsx)("div",{style:{width:36,height:36,borderRadius:8,background:"PromptPay"===e.account_type?"#FDF2F8":"#EFF6FF",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"PromptPay"===e.account_type?(0,i.jsx)(p.Z,{style:{color:"#EC4899",fontSize:16}}):(0,i.jsx)(u.Z,{style:{color:"#3B82F6",fontSize:16}})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsx)(z,{strong:!0,style:{fontSize:14,display:"block"},children:e.account_name}),(0,i.jsx)(z,{type:"secondary",style:{fontSize:12},children:e.account_number})]}),t&&(0,i.jsx)(x.Z,{style:{color:"#10b981",fontSize:18}})]},e.id)}),(0,i.jsx)(s.ZP,{type:"dashed",block:!0,icon:(0,i.jsx)(g.Z,{}),onClick:()=>t.push("/pos/settings/payment-accounts/manage"),style:{height:44,borderRadius:10,marginTop:8},children:"เพิ่ม/แก้ไขบัญชี"})]})})]}):(0,i.jsx)(F.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=66630)}),_N_E=e.O()}]);