(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{80329:function(e,t,i){Promise.resolve().then(i.bind(i,95905))},95905:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return T}});var r=i(57437),l=i(29),s=i.n(l),a=i(2265),n=i(19683),o=i(80009),d=i(50742),c=i(53743),h=i(34029),p=i(24783),y=i(88589),x=i(33145),u=i(29107),v=i(13377),f=i(26349),g=i(29436),j=i(89245),m=i(96473),b=i(99376),w=i(3369),k=i(26972),C=i(24675),_=i(97235),R=i(3286),Z=i(67697),F=i(73814),E=i(82967),B=i(2938),S=i(25193),A=i(37410),P=i(27623),N=i(20148),z=i(2786);let{Text:D}=n.default,L=e=>{let{totalDelivery:t,activeDelivery:i,inactiveDelivery:l}=e;return(0,r.jsxs)("div",{style:E.R.statsCard,children:[(0,r.jsxs)("div",{style:E.R.statItem,children:[(0,r.jsx)("span",{style:{...E.R.statNumber,color:"#0891B2"},children:t}),(0,r.jsx)(D,{style:E.R.statLabel,children:"ทั้งหมด"})]}),(0,r.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,r.jsxs)("div",{style:E.R.statItem,children:[(0,r.jsx)("span",{style:{...E.R.statNumber,color:"#10B981"},children:i}),(0,r.jsx)(D,{style:E.R.statLabel,children:"เปิดใช้งาน"})]}),(0,r.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,r.jsxs)("div",{style:E.R.statItem,children:[(0,r.jsx)("span",{style:{...E.R.statNumber,color:"#EF4444"},children:l}),(0,r.jsx)(D,{style:E.R.statLabel,children:"ปิดใช้งาน"})]})]})},I=e=>{let{delivery:t,index:i,onEdit:l,onDelete:s}=e;return(0,r.jsx)("div",{className:"delivery-card",style:{...E.R.deliveryCard(t.is_active),animationDelay:"".concat(.03*i,"s")},onClick:()=>l(t),children:(0,r.jsxs)("div",{style:E.R.deliveryCardInner,children:[(0,r.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:t.is_active?"linear-gradient(135deg, #CFFAFE 0%, #A5F3FC 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,overflow:"hidden",position:"relative",boxShadow:t.is_active?"0 4px 10px rgba(8, 145, 178, 0.1)":"none"},children:t.logo?(0,r.jsx)(x.default,{src:t.logo,alt:t.delivery_name,fill:!0,sizes:"56px",style:{objectFit:"contain",padding:8,opacity:t.is_active?1:.6}}):(0,r.jsx)(u.Z,{style:{fontSize:24,color:t.is_active?"#0891B2":"#94A3B8"}})}),(0,r.jsxs)("div",{style:{flex:1,minWidth:0,paddingRight:8},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,r.jsx)(D,{strong:!0,style:{fontSize:16,color:t.is_active?"#1E293B":"#64748B"},ellipsis:{tooltip:t.delivery_name},children:t.delivery_name}),t.is_active?(0,r.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#10B981",boxShadow:"0 0 0 2px #ecfdf5"}}):(0,r.jsx)("div",{style:{width:6,height:6,borderRadius:"50%",background:"#CBD5E1"}})]}),t.delivery_prefix&&(0,r.jsx)("div",{style:{display:"flex"},children:(0,r.jsx)(o.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:"#0891B2",background:"#CFFAFE",border:"none",fontWeight:600,padding:"0 6px",lineHeight:"18px",height:18},children:t.delivery_prefix})})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,r.jsx)(d.ZP,{type:"text",icon:(0,r.jsx)(v.Z,{}),onClick:e=>{e.stopPropagation(),l(t)},style:{borderRadius:12,color:"#0891B2",background:"#CFFAFE",width:36,height:36}}),(0,r.jsx)(d.ZP,{type:"text",danger:!0,icon:(0,r.jsx)(f.Z,{}),onClick:e=>{e.stopPropagation(),s(t)},style:{borderRadius:12,background:"#FEF2F2",width:36,height:36}})]})]})})};function T(){let e=(0,b.useRouter)(),[t,i]=(0,a.useState)([]),[l,n]=(0,a.useState)([]),[o,x]=(0,a.useState)(""),{execute:v}=(0,k.J)(),{showLoading:D}=(0,w.x)(),{socket:T}=(0,C.s)(),{isAuthorized:W,isChecking:H}=(0,R.e)({requiredRole:"Admin"});(0,a.useEffect)(()=>{(0,_.P)()},[]),(0,a.useEffect)(()=>{let e=(0,F.t)("pos:delivery-providers",6e5);e&&Array.isArray(e)&&i(e)},[]);let O=(0,a.useCallback)(async()=>{v(async()=>{let e=await fetch("/api/pos/delivery?limit=100");if(!e.ok)throw Error("Failed to fetch deliveries");let t=await e.json(),r=t.data||t;Array.isArray(r)&&(i(r),(0,F.v)("pos:delivery-providers",r))},"กำลังโหลดข้อมูล...")},[v]);(0,a.useEffect)(()=>{W&&O()},[W,O]),(0,Z.v)(T,{create:"delivery:create",update:"delivery:update",delete:"delivery:delete"},i),(0,a.useEffect)(()=>{if(o){let e=o.toLowerCase();n(t.filter(t=>t.delivery_name.toLowerCase().includes(e)||t.delivery_prefix&&t.delivery_prefix.toLowerCase().includes(e)))}else n(t)},[t,o]);let q=e=>{x(e)},J=()=>{D("กำลังเปิดหน้าจัดการบริการส่ง..."),e.push("/pos/delivery/manager/add")},X=t=>{D("กำลังเปิดหน้าแก้ไขบริการส่ง..."),e.push("/pos/delivery/manager/edit/".concat(t.id))},G=e=>{c.Z.confirm({title:"ยืนยันการลบบริการส่ง",content:'คุณต้องการลบบริการส่ง "'.concat(e.delivery_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,r.jsx)(f.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{await v(async()=>{let t=await (0,_.P)();if(!(await fetch("/api/pos/delivery/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบบริการส่งได้");h.ZP.success('ลบบริการส่ง "'.concat(e.delivery_name,'" สำเร็จ'))},"กำลังลบบริการส่ง...")}})};if(H)return(0,r.jsx)(B.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."});if(!W)return(0,r.jsx)(B.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"});let K=t.filter(e=>e.is_active),M=t.filter(e=>!e.is_active);return(0,r.jsxs)("div",{style:E.R.container,className:"jsx-81e749a9668c95f6 delivery-page",children:[(0,r.jsx)("style",{children:E.W}),(0,r.jsx)(s(),{id:"81e749a9668c95f6",children:".search-input-placeholder-white input::-webkit-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input{color:white!important}.delivery-card{cursor:pointer;-webkit-tap-highlight-color:transparent}"}),(0,r.jsx)(N.Z,{title:"ช่องทางจัดส่ง",subtitle:"".concat(t.length," รายการ"),icon:(0,r.jsx)(u.Z,{}),actions:(0,r.jsxs)(p.Z,{size:8,wrap:!0,children:[(0,r.jsx)(y.default,{prefix:(0,r.jsx)(g.Z,{style:{color:"#94A3B8"}}),allowClear:!0,placeholder:"ค้นหาช่องทางจัดส่ง...",onChange:e=>q(e.target.value),style:{minWidth:220}}),(0,r.jsx)(d.ZP,{icon:(0,r.jsx)(j.Z,{}),onClick:O}),(0,r.jsx)(d.ZP,{type:"primary",icon:(0,r.jsx)(m.Z,{}),onClick:J,children:"เพิ่มช่องทางจัดส่ง"})]})}),(0,r.jsx)(S.Z,{children:(0,r.jsxs)(P.Z,{children:[(0,r.jsx)(L,{totalDelivery:t.length,activeDelivery:K.length,inactiveDelivery:M.length}),(0,r.jsx)(A.Z,{title:"รายการช่องทางจัดส่ง",extra:(0,r.jsx)("span",{style:{fontWeight:600},className:"jsx-81e749a9668c95f6",children:l.length}),children:l.length>0?l.map((e,t)=>(0,r.jsx)(I,{delivery:e,index:t,onEdit:X,onDelete:G},e.id)):(0,r.jsx)(z.Z,{title:o.trim()?"ไม่พบช่องทางจัดส่งที่ค้นหา":"ยังไม่มีช่องทางจัดส่ง",description:o.trim()?"ลองค้นหาด้วยคำอื่นหรือล้างการค้นหา":"เพิ่มช่องทางจัดส่งตัวแรกเพื่อเริ่มต้นใช้งาน",action:o.trim()?null:(0,r.jsx)(d.ZP,{type:"primary",icon:(0,r.jsx)(m.Z,{}),onClick:J,children:"เพิ่มช่องทางจัดส่ง"})})})]})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=80329)}),_N_E=e.O()}]);