(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{80329:function(e,i,t){Promise.resolve().then(t.bind(t,95905))},95905:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return I}});var r=t(57437),s=t(29),l=t.n(s),a=t(2265),d=t(19683),n=t(50742),o=t(88589),c=t(80009),h=t(85180),p=t(53743),x=t(34029),y=t(33145),g=t(29107),u=t(89245),f=t(96473),j=t(29436),v=t(13377),b=t(26349),m=t(99376),w=t(3369),R=t(26972),k=t(24675),C=t(97235),S=t(3286),E=t(67697),F=t(73814),_=t(82967),Z=t(2938);let{Text:N,Title:B}=d.default,A=e=>{let{onRefresh:i,onAdd:t,onSearch:s}=e;return(0,r.jsxs)("div",{style:_.R.header,children:[(0,r.jsx)("div",{style:_.R.headerDecoCircle1}),(0,r.jsx)("div",{style:_.R.headerDecoCircle2}),(0,r.jsxs)("div",{style:_.R.headerContent,children:[(0,r.jsxs)("div",{style:_.R.headerLeft,children:[(0,r.jsx)("div",{style:_.R.headerIconBox,children:(0,r.jsx)(g.Z,{style:{fontSize:24,color:"white"}})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(N,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"จัดการผู้ให้บริการเดลิเวอรี่"}),(0,r.jsx)(B,{level:4,style:{color:"white",margin:0,fontWeight:700,letterSpacing:"0.5px",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"บริการเดลิเวอรี่"})]})]}),(0,r.jsxs)("div",{style:_.R.headerActions,children:[(0,r.jsx)(n.ZP,{type:"text",icon:(0,r.jsx)(u.Z,{style:{color:"white"}}),onClick:i,style:{background:"rgba(255,255,255,0.2)",backdropFilter:"blur(4px)",borderRadius:12,height:40,width:40,border:"1px solid rgba(255,255,255,0.3)"}}),(0,r.jsx)(n.ZP,{type:"primary",icon:(0,r.jsx)(f.Z,{}),onClick:t,style:{background:"white",color:"#0891B2",borderRadius:12,height:40,fontWeight:600,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:(0,r.jsx)("span",{className:"hidden sm:inline",children:"เพิ่มบริการส่ง"})})]})]}),(0,r.jsx)("div",{style:{marginTop:24,padding:"0 4px"},children:(0,r.jsx)(o.default,{prefix:(0,r.jsx)(j.Z,{style:{color:"#fff",opacity:.7}}),placeholder:"ค้นหาบริการส่ง (ชื่อ หรือ Prefix)...",onChange:e=>s(e.target.value),bordered:!1,style:{background:"rgba(255,255,255,0.15)",backdropFilter:"blur(8px)",borderRadius:14,padding:"8px 16px",color:"white",fontSize:15},className:"search-input-placeholder-white"})})]})},z=e=>{let{totalDelivery:i,activeDelivery:t,inactiveDelivery:s}=e;return(0,r.jsxs)("div",{style:_.R.statsCard,children:[(0,r.jsxs)("div",{style:_.R.statItem,children:[(0,r.jsx)("span",{style:{..._.R.statNumber,color:"#0891B2"},children:i}),(0,r.jsx)(N,{style:_.R.statLabel,children:"ทั้งหมด"})]}),(0,r.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,r.jsxs)("div",{style:_.R.statItem,children:[(0,r.jsx)("span",{style:{..._.R.statNumber,color:"#10B981"},children:t}),(0,r.jsx)(N,{style:_.R.statLabel,children:"เปิดใช้งาน"})]}),(0,r.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,r.jsxs)("div",{style:_.R.statItem,children:[(0,r.jsx)("span",{style:{..._.R.statNumber,color:"#EF4444"},children:s}),(0,r.jsx)(N,{style:_.R.statLabel,children:"ปิดใช้งาน"})]})]})},P=e=>{let{delivery:i,index:t,onEdit:s,onDelete:l}=e;return(0,r.jsx)("div",{className:"delivery-card",style:{..._.R.deliveryCard(i.is_active),animationDelay:"".concat(.03*t,"s")},onClick:()=>s(i),children:(0,r.jsxs)("div",{style:_.R.deliveryCardInner,children:[(0,r.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:i.is_active?"linear-gradient(135deg, #CFFAFE 0%, #A5F3FC 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,overflow:"hidden",position:"relative",boxShadow:i.is_active?"0 4px 10px rgba(8, 145, 178, 0.1)":"none"},children:i.logo?(0,r.jsx)(y.default,{src:i.logo,alt:i.delivery_name,fill:!0,sizes:"56px",style:{objectFit:"contain",padding:8,opacity:i.is_active?1:.6}}):(0,r.jsx)(g.Z,{style:{fontSize:24,color:i.is_active?"#0891B2":"#94A3B8"}})}),(0,r.jsxs)("div",{style:{flex:1,minWidth:0,paddingRight:8},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,r.jsx)(N,{strong:!0,style:{fontSize:16,color:i.is_active?"#1E293B":"#64748B"},ellipsis:{tooltip:i.delivery_name},children:i.delivery_name}),i.is_active?(0,r.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#10B981",boxShadow:"0 0 0 2px #ecfdf5"}}):(0,r.jsx)("div",{style:{width:6,height:6,borderRadius:"50%",background:"#CBD5E1"}})]}),i.delivery_prefix&&(0,r.jsx)("div",{style:{display:"flex"},children:(0,r.jsx)(c.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:"#0891B2",background:"#CFFAFE",border:"none",fontWeight:600,padding:"0 6px",lineHeight:"18px",height:18},children:i.delivery_prefix})})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,r.jsx)(n.ZP,{type:"text",icon:(0,r.jsx)(v.Z,{}),onClick:e=>{e.stopPropagation(),s(i)},style:{borderRadius:12,color:"#0891B2",background:"#CFFAFE",width:36,height:36}}),(0,r.jsx)(n.ZP,{type:"text",danger:!0,icon:(0,r.jsx)(b.Z,{}),onClick:e=>{e.stopPropagation(),l(i)},style:{borderRadius:12,background:"#FEF2F2",width:36,height:36}})]})]})})},D=e=>{let{onAdd:i,isSearch:t}=e;return(0,r.jsx)(h.Z,{image:h.Z.PRESENTED_IMAGE_SIMPLE,description:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsx)(N,{type:"secondary",style:{fontSize:15},children:t?"ไม่พบข้อมูลที่ค้นหา":"ยังไม่มีบริการส่ง"}),(0,r.jsx)("br",{}),!t&&(0,r.jsx)(N,{type:"secondary",style:{fontSize:13},children:"เริ่มต้นเพิ่มบริการส่งแรกของคุณได้เลย"})]}),style:{padding:"60px 20px",background:"white",borderRadius:24,margin:"24px 16px",boxShadow:"0 4px 24px rgba(0,0,0,0.04)"},children:!t&&(0,r.jsx)(n.ZP,{type:"primary",icon:(0,r.jsx)(f.Z,{}),onClick:i,size:"large",style:{background:"#0891B2",borderRadius:12,height:48,padding:"0 32px",boxShadow:"0 4px 12px rgba(8, 145, 178, 0.3)"},children:"เพิ่มบริการส่ง"})})};function I(){let e=(0,m.useRouter)(),[i,t]=(0,a.useState)([]),[s,d]=(0,a.useState)([]),[n,o]=(0,a.useState)(""),{execute:c}=(0,R.J)(),{showLoading:h}=(0,w.x)(),{socket:y}=(0,k.s)(),{isAuthorized:g,isChecking:u}=(0,S.e)({requiredRole:"Admin"});(0,a.useEffect)(()=>{(0,C.P)()},[]),(0,a.useEffect)(()=>{let e=(0,F.t)("pos:delivery-providers",6e5);e&&Array.isArray(e)&&t(e)},[]);let f=(0,a.useCallback)(async()=>{c(async()=>{let e=await fetch("/api/pos/delivery?limit=100");if(!e.ok)throw Error("Failed to fetch deliveries");let i=await e.json(),r=i.data||i;Array.isArray(r)&&(t(r),(0,F.v)("pos:delivery-providers",r))},"กำลังโหลดข้อมูล...")},[c]);(0,a.useEffect)(()=>{g&&f()},[g,f]),(0,E.v)(y,{create:"delivery:create",update:"delivery:update",delete:"delivery:delete"},t),(0,a.useEffect)(()=>{if(n){let e=n.toLowerCase();d(i.filter(i=>i.delivery_name.toLowerCase().includes(e)||i.delivery_prefix&&i.delivery_prefix.toLowerCase().includes(e)))}else d(i)},[i,n]);let j=()=>{h("กำลังเปิดหน้าจัดการบริการส่ง..."),e.push("/pos/delivery/manager/add")},v=i=>{h("กำลังเปิดหน้าแก้ไขบริการส่ง..."),e.push("/pos/delivery/manager/edit/".concat(i.id))},N=e=>{p.Z.confirm({title:"ยืนยันการลบบริการส่ง",content:'คุณต้องการลบบริการส่ง "'.concat(e.delivery_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,r.jsx)(b.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{await c(async()=>{let i=await (0,C.P)();if(!(await fetch("/api/pos/delivery/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":i}})).ok)throw Error("ไม่สามารถลบบริการส่งได้");x.ZP.success('ลบบริการส่ง "'.concat(e.delivery_name,'" สำเร็จ'))},"กำลังลบบริการส่ง...")}})};if(u)return(0,r.jsx)(Z.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."});if(!g)return(0,r.jsx)(Z.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"});let B=i.filter(e=>e.is_active),I=i.filter(e=>!e.is_active);return(0,r.jsxs)("div",{style:_.R.container,className:"jsx-81e749a9668c95f6 delivery-page",children:[(0,r.jsx)("style",{children:_.W}),(0,r.jsx)(l(),{id:"81e749a9668c95f6",children:".search-input-placeholder-white input::-webkit-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input{color:white!important}.delivery-card{cursor:pointer;-webkit-tap-highlight-color:transparent}"}),(0,r.jsx)(A,{onRefresh:f,onAdd:j,onSearch:e=>{o(e)}}),(0,r.jsx)("div",{style:{marginTop:-32,padding:"0 16px",position:"relative",zIndex:10},className:"jsx-81e749a9668c95f6",children:(0,r.jsx)(z,{totalDelivery:i.length,activeDelivery:B.length,inactiveDelivery:I.length})}),(0,r.jsx)("div",{style:_.R.listContainer,className:"jsx-81e749a9668c95f6",children:s.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:_.R.sectionTitle,className:"jsx-81e749a9668c95f6",children:[(0,r.jsx)("div",{style:{width:4,height:16,background:"#0891B2",borderRadius:2},className:"jsx-81e749a9668c95f6"}),(0,r.jsx)("span",{style:{fontSize:16,fontWeight:700,color:"#1E293B"},className:"jsx-81e749a9668c95f6",children:"รายการบริการส่ง"}),(0,r.jsx)("div",{style:{background:"#CFFAFE",color:"#0891B2",padding:"2px 10px",borderRadius:12,fontSize:12,fontWeight:700,marginLeft:"auto"},className:"jsx-81e749a9668c95f6",children:s.length})]}),s.map((e,i)=>(0,r.jsx)(P,{delivery:e,index:i,onEdit:v,onDelete:N},e.id))]}):(0,r.jsx)(D,{onAdd:j,isSearch:!!n})}),(0,r.jsx)("div",{style:{height:40},className:"jsx-81e749a9668c95f6"})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=80329)}),_N_E=e.O()}]);