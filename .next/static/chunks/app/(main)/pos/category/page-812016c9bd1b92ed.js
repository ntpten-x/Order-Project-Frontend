(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4049],{59968:function(e,t,n){Promise.resolve().then(n.bind(n,54161))},54161:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var r=n(57437),i=n(2265),a=n(82646),s=n(50742),o=n(85180),l=n(53743),d=n(34029),c=n(48651),g=n(71891),h=n(89245),u=n(96473),f=n(8900),y=n(39725),x=n(13377),p=n(26349),b=n(99376),j=n(3369),m=n(26972),v=n(24675),k=n(97235),w=n(3286),C=n(67697),S=n(73814);let I={container:{paddingBottom:100,backgroundColor:"#f8f9fc",minHeight:"100vh"},header:{background:"linear-gradient(135deg, #722ed1 0%, #531dab 100%)",padding:"20px 20px 60px 20px",position:"relative",overflow:"hidden"},headerDecoCircle1:{position:"absolute",top:-50,right:-50,width:150,height:150,borderRadius:"50%",background:"rgba(255,255,255,0.1)"},headerDecoCircle2:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},headerContent:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"space-between"},headerLeft:{display:"flex",alignItems:"center",gap:12},headerIconBox:{width:48,height:48,borderRadius:14,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(8px)"},headerActions:{display:"flex",gap:8},statsCard:{margin:"-40px 16px 0 16px",padding:"16px",background:"white",borderRadius:20,boxShadow:"0 8px 24px rgba(0,0,0,0.08)",display:"flex",justifyContent:"space-around",position:"relative",zIndex:10},statItem:{textAlign:"center",flex:1},statNumber:{fontSize:24,fontWeight:700,display:"block"},statLabel:{fontSize:12,color:"#8c8c8c",marginTop:2},listContainer:{padding:"20px 16px 0 16px"},sectionTitle:{display:"flex",alignItems:"center",gap:8,marginBottom:16},categoryCard:e=>({marginBottom:12,borderRadius:20,border:"none",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",overflow:"hidden",transition:"all 0.3s ease",background:e?"white":"linear-gradient(to right, #fafafa, white)",opacity:e?1:.7}),categoryCardInner:{padding:16,display:"flex",alignItems:"center",gap:14}},{Text:z,Title:Z}=a.default,E=e=>{let{onRefresh:t,onAdd:n}=e;return(0,r.jsxs)("div",{style:I.header,children:[(0,r.jsx)("div",{style:I.headerDecoCircle1}),(0,r.jsx)("div",{style:I.headerDecoCircle2}),(0,r.jsxs)("div",{style:I.headerContent,children:[(0,r.jsxs)("div",{style:I.headerLeft,children:[(0,r.jsx)("div",{style:I.headerIconBox,children:(0,r.jsx)(g.Z,{style:{fontSize:24,color:"white"}})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(z,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block"},children:"จัดการข้อมูล"}),(0,r.jsx)(Z,{level:4,style:{color:"white",margin:0,fontWeight:700,letterSpacing:"0.5px"},children:"หมวดหมู่สินค้า"})]})]}),(0,r.jsxs)("div",{style:I.headerActions,children:[(0,r.jsx)(s.ZP,{type:"text",icon:(0,r.jsx)(h.Z,{style:{color:"white"}}),onClick:t,style:{background:"rgba(255,255,255,0.2)",borderRadius:12,height:40,width:40}}),(0,r.jsx)(s.ZP,{type:"primary",icon:(0,r.jsx)(u.Z,{}),onClick:n,style:{background:"white",color:"#722ed1",borderRadius:12,height:40,fontWeight:600,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:"เพิ่มหมวดหมู่"})]})]})]})},R=e=>{let{totalCategories:t,activeCategories:n,inactiveCategories:i}=e;return(0,r.jsxs)("div",{style:I.statsCard,children:[(0,r.jsxs)("div",{style:I.statItem,children:[(0,r.jsx)("span",{style:{...I.statNumber,color:"#722ed1"},children:t}),(0,r.jsx)(z,{style:I.statLabel,children:"ทั้งหมด"})]}),(0,r.jsx)("div",{style:{width:1,background:"#f0f0f0"}}),(0,r.jsxs)("div",{style:I.statItem,children:[(0,r.jsx)("span",{style:{...I.statNumber,color:"#52c41a"},children:n}),(0,r.jsx)(z,{style:I.statLabel,children:"ใช้งาน"})]}),(0,r.jsx)("div",{style:{width:1,background:"#f0f0f0"}}),(0,r.jsxs)("div",{style:I.statItem,children:[(0,r.jsx)("span",{style:{...I.statNumber,color:"#ff4d4f"},children:i}),(0,r.jsx)(z,{style:I.statLabel,children:"ไม่ใช้งาน"})]})]})},_=e=>{let{category:t,index:n,onEdit:i,onDelete:a}=e;return(0,r.jsx)("div",{className:"category-card",style:{...I.categoryCard(t.is_active),animationDelay:"".concat(.03*n,"s")},children:(0,r.jsxs)("div",{style:I.categoryCardInner,children:[(0,r.jsx)("div",{style:{width:56,height:56,borderRadius:14,background:"linear-gradient(135deg, #f9f0ff 0%, #efdbff 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,r.jsx)(g.Z,{style:{fontSize:24,color:"#722ed1"}})}),(0,r.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,r.jsx)(z,{strong:!0,style:{fontSize:16,color:"#1a1a2e"},ellipsis:{tooltip:t.display_name},children:t.display_name}),t.is_active?(0,r.jsx)(f.Z,{style:{color:"#52c41a",fontSize:14}}):(0,r.jsx)(y.Z,{style:{color:"#ff4d4f",fontSize:14}})]}),(0,r.jsx)(z,{type:"secondary",style:{fontSize:13,display:"block"},ellipsis:{tooltip:t.category_name},children:t.category_name})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,r.jsx)(s.ZP,{type:"text",icon:(0,r.jsx)(x.Z,{}),onClick:e=>{e.stopPropagation(),i(t)},style:{borderRadius:10,color:"#722ed1",background:"#f9f0ff"}}),(0,r.jsx)(s.ZP,{type:"text",danger:!0,icon:(0,r.jsx)(p.Z,{}),onClick:e=>{e.stopPropagation(),a(t)},style:{borderRadius:10,background:"#fff2f0"}})]})]})})},P=e=>{let{onAdd:t}=e;return(0,r.jsx)(o.Z,{image:o.Z.PRESENTED_IMAGE_SIMPLE,description:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[(0,r.jsx)(z,{type:"secondary",style:{fontSize:15},children:"ยังไม่มีหมวดหมู่"}),(0,r.jsx)("br",{}),(0,r.jsx)(z,{type:"secondary",style:{fontSize:13},children:"เริ่มต้นเพิ่มหมวดหมู่แรกของคุณ"})]}),style:{padding:"60px 20px",background:"white",borderRadius:20,margin:"0 16px"},children:(0,r.jsx)(s.ZP,{type:"primary",icon:(0,r.jsx)(u.Z,{}),onClick:t,style:{background:"#722ed1"},children:"เพิ่มหมวดหมู่"})})};function D(){let e=(0,b.useRouter)(),[t,n]=(0,i.useState)([]),{execute:a}=(0,m.J)(),{showLoading:s}=(0,j.x)(),{socket:o}=(0,v.s)(),{isAuthorized:h,isChecking:u}=(0,w.e)({requiredRole:"Admin"});(0,i.useEffect)(()=>{(0,k.P)()},[]),(0,i.useEffect)(()=>{let e=(0,S.t)("pos:categories",3e5);e&&e.length>0&&n(e)},[]);let f=(0,i.useCallback)(async()=>{a(async()=>{let e=await fetch("/api/pos/category");if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||t.message||"ไม่สามารถดึงข้อมูลหมวดหมู่ได้")}n(await e.json())},"กำลังโหลดข้อมูลหมวดหมู่...")},[a]);(0,i.useEffect)(()=>{h&&f()},[h,f]),(0,C.v)(o,{create:"category:create",update:"category:update",delete:"category:delete"},n),(0,i.useEffect)(()=>{t.length>0&&(0,S.v)("pos:categories",t)},[t]);let y=()=>{s("กำลังเปิดหน้าจัดการหมวดหมู่..."),e.push("/pos/category/manager/add")},x=t=>{s("กำลังเปิดหน้าแก้ไขหมวดหมู่..."),e.push("/pos/category/manager/edit/".concat(t.id))},p=e=>{l.Z.confirm({title:"ยืนยันการลบหมวดหมู่",content:'คุณต้องการลบหมวดหมู่ "'.concat(e.display_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{await a(async()=>{let t=await (0,k.P)();if(!(await fetch("/api/pos/category/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบหมวดหมู่ได้");d.ZP.success('ลบหมวดหมู่ "'.concat(e.display_name,'" สำเร็จ'))},"กำลังลบหมวดหมู่...")}})};if(u)return(0,r.jsxs)("div",{style:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:16},children:[(0,r.jsx)(c.Z,{size:"large"}),(0,r.jsx)(z,{type:"secondary",children:"กำลังตรวจสอบสิทธิ์การใช้งาน..."})]});if(!h)return(0,r.jsxs)("div",{style:{display:"flex",height:"100vh",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:16},children:[(0,r.jsx)(c.Z,{size:"large"}),(0,r.jsx)(z,{type:"danger",children:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ..."})]});let Z=t.filter(e=>e.is_active),D=t.filter(e=>!e.is_active);return(0,r.jsxs)("div",{className:"category-page",style:I.container,children:[(0,r.jsx)("style",{children:"\n    @keyframes fadeSlideIn {\n        from {\n            opacity: 0;\n            transform: translateY(12px);\n        }\n        to {\n            opacity: 1;\n            transform: translateY(0);\n        }\n    }\n    \n    .category-card {\n        animation: fadeSlideIn 0.4s ease both;\n    }\n    \n    .category-card:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 8px 24px rgba(0,0,0,0.1) !important;\n    }\n    \n    .category-card:active {\n        transform: scale(0.98);\n    }\n    \n    .category-page *::-webkit-scrollbar {\n        width: 6px;\n    }\n    .category-page *::-webkit-scrollbar-track {\n        background: transparent;\n    }\n    .category-page *::-webkit-scrollbar-thumb {\n        background: #d9d9d9;\n        border-radius: 3px;\n    }\n    .category-page *::-webkit-scrollbar-thumb:hover {\n        background: #bfbfbf;\n    }\n"}),(0,r.jsx)(E,{onRefresh:f,onAdd:y}),(0,r.jsx)(R,{totalCategories:t.length,activeCategories:Z.length,inactiveCategories:D.length}),(0,r.jsx)("div",{style:I.listContainer,children:t.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:I.sectionTitle,children:[(0,r.jsx)(g.Z,{style:{fontSize:18,color:"#722ed1"}}),(0,r.jsx)("span",{style:{fontSize:16,fontWeight:600,color:"#1a1a2e"},children:"รายการหมวดหมู่"}),(0,r.jsxs)("div",{style:{background:"linear-gradient(135deg, #722ed1 0%, #531dab 100%)",color:"white",padding:"4px 12px",borderRadius:20,fontSize:12,fontWeight:600},children:[t.length," รายการ"]})]}),t.map((e,t)=>(0,r.jsx)(_,{category:e,index:t,onEdit:x,onDelete:p},e.id))]}):(0,r.jsx)(P,{onAdd:y})})]})}},26972:function(e,t,n){"use strict";n.d(t,{J:function(){return s}});var r=n(2265),i=n(3369),a=n(53743);let s=()=>{let{showLoading:e,hideLoading:t}=(0,i.x)();return{execute:(0,r.useCallback)(async function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"กำลังดำเนินการ...",i=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"เกิดข้อผิดพลาด");try{return e(r,"async"),await n()}catch(e){console.error("Async action error:",e),a.Z.error({title:"ข้อผิดพลาด",content:e.message||i});return}finally{t("async")}},[e,t])}}},3286:function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var r=n(2265),i=n(34029),a=n(99376),s=n(14362);function o(){let{requiredRole:e="Admin",redirectUnauthenticated:t="/login",redirectUnauthorized:n="/pos",unauthorizedMessage:o="คุณไม่มีสิทธิ์เข้าถึงหน้านี้"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,a.useRouter)(),{user:d,loading:c}=(0,s.a)(),g=(0,r.useMemo)(()=>c?"checking":d?e&&d.role!==e?"unauthorized":"authorized":"unauthenticated",[d,c,e]),h=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{if("unauthenticated"===g){l.replace(t);return}"unauthorized"===g&&(h.current||(h.current=!0,i.ZP.error(o)),l.replace(n))},[g,l,t,n,o]),{status:g,isAuthorized:"authorized"===g,isChecking:"checking"===g,user:d}}},73814:function(e,t,n){"use strict";n.d(t,{t:function(){return i},v:function(){return a}});let r=()=>!0,i=(e,t)=>{if(!r())return null;try{var n;let r=window.localStorage.getItem(e);if(!r)return null;let i=JSON.parse(r);if(!(null==i?void 0:i.ts)||Date.now()-i.ts>t)return null;return null!==(n=i.data)&&void 0!==n?n:null}catch(e){return null}},a=(e,t)=>{if(r())try{let n={ts:Date.now(),data:t};window.localStorage.setItem(e,JSON.stringify(n))}catch(e){}}},97235:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(5447);let i=null,a=0,s=null;async function o(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Date.now();return!e&&i&&t-a<6e5?i:(s||(s=r.O.getCsrfToken().then(e=>(i=e||"",a=Date.now(),i)).finally(()=>{s=null})),s)}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,6937,3490,2971,2117,1744],function(){return e(e.s=59968)}),_N_E=e.O()}]);