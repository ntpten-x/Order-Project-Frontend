(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4049],{59968:function(e,t,i){Promise.resolve().then(i.bind(i,75676))},75676:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return A}});var s=i(57437),a=i(29),r=i.n(a),l=i(2265),n=i(19683),o=i(50742),c=i(53743),d=i(34029),h=i(24783),p=i(88589),g=i(71891),u=i(13377),x=i(26349),y=i(29436),f=i(89245),j=i(96473),m=i(99376),b=i(3369),w=i(26972),v=i(24675),k=i(97235),C=i(3286),E=i(67697),R=i(73814),Z=i(33417),_=i(2938),F=i(25193),S=i(37410),P=i(27623),B=i(20148),N=i(2786);let{Text:D}=n.default,L=e=>{let{totalCategories:t,activeCategories:i,inactiveCategories:a}=e;return(0,s.jsxs)("div",{style:Z.R.statsCard,children:[(0,s.jsxs)("div",{style:Z.R.statItem,children:[(0,s.jsx)("span",{style:{...Z.R.statNumber,color:"#7C3AED"},children:t}),(0,s.jsx)(D,{style:Z.R.statLabel,children:"ทั้งหมด"})]}),(0,s.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,s.jsxs)("div",{style:Z.R.statItem,children:[(0,s.jsx)("span",{style:{...Z.R.statNumber,color:"#10B981"},children:i}),(0,s.jsx)(D,{style:Z.R.statLabel,children:"ใช้งาน"})]}),(0,s.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,s.jsxs)("div",{style:Z.R.statItem,children:[(0,s.jsx)("span",{style:{...Z.R.statNumber,color:"#EF4444"},children:a}),(0,s.jsx)(D,{style:Z.R.statLabel,children:"ไม่ใช้งาน"})]})]})},z=e=>{let{category:t,index:i,onEdit:a,onDelete:r}=e;return(0,s.jsx)("div",{className:"category-card",style:{...Z.R.categoryCard(t.is_active),animationDelay:"".concat(.05*i,"s")},onClick:()=>a(t),children:(0,s.jsxs)("div",{style:Z.R.categoryCardInner,children:[(0,s.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:t.is_active?"linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,boxShadow:t.is_active?"0 4px 10px rgba(124, 58, 237, 0.1)":"none"},children:(0,s.jsx)(g.Z,{style:{fontSize:24,color:t.is_active?"#7C3AED":"#94A3B8"}})}),(0,s.jsxs)("div",{style:{flex:1,minWidth:0,paddingRight:8},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,s.jsx)(D,{strong:!0,style:{fontSize:16,color:t.is_active?"#1E293B":"#64748B"},ellipsis:{tooltip:t.display_name},children:t.display_name}),t.is_active?(0,s.jsx)("div",{style:{width:8,height:8,borderRadius:"50%",background:"#10B981",boxShadow:"0 0 0 2px #ecfdf5"}}):(0,s.jsx)("div",{style:{width:6,height:6,borderRadius:"50%",background:"#CBD5E1"}})]}),(0,s.jsx)(D,{type:"secondary",style:{fontSize:13,display:"block",color:"#64748B"},ellipsis:{tooltip:t.category_name},children:t.category_name})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,s.jsx)(o.ZP,{type:"text",icon:(0,s.jsx)(u.Z,{}),onClick:e=>{e.stopPropagation(),a(t)},style:{borderRadius:12,color:"#7C3AED",background:"#F3E8FF",width:36,height:36}}),(0,s.jsx)(o.ZP,{type:"text",danger:!0,icon:(0,s.jsx)(x.Z,{}),onClick:e=>{e.stopPropagation(),r(t)},style:{borderRadius:12,background:"#FEF2F2",width:36,height:36}})]})]})})};function A(){let e=(0,m.useRouter)(),[t,i]=(0,l.useState)([]),[a,n]=(0,l.useState)([]),[u,D]=(0,l.useState)(""),{execute:A}=(0,w.J)(),{showLoading:I}=(0,b.x)(),{socket:T}=(0,v.s)(),{isAuthorized:W,isChecking:O}=(0,C.e)({requiredRole:"Admin"});(0,l.useEffect)(()=>{(0,k.P)()},[]),(0,l.useEffect)(()=>{let e=(0,R.t)("pos:categories",3e5);e&&e.length>0&&i(e)},[]);let H=(0,l.useCallback)(async()=>{A(async()=>{let e=await fetch("/api/pos/category");if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||t.message||"ไม่สามารถดึงข้อมูลหมวดหมู่ได้")}i(await e.json())},"กำลังโหลดข้อมูลหมวดหมู่...")},[A]);(0,l.useEffect)(()=>{W&&H()},[W,H]),(0,E.v)(T,{create:"category:create",update:"category:update",delete:"category:delete"},i),(0,l.useEffect)(()=>{if(u){let e=u.toLowerCase();n(t.filter(t=>t.display_name.toLowerCase().includes(e)||t.category_name.toLowerCase().includes(e)))}else n(t)},[t,u]),(0,l.useEffect)(()=>{t.length>0&&(0,R.v)("pos:categories",t)},[t]);let q=e=>{D(e)},J=()=>{I("กำลังเปิดหน้าจัดการหมวดหมู่..."),e.push("/pos/category/manager/add")},X=t=>{I("กำลังเปิดหน้าแก้ไขหมวดหมู่..."),e.push("/pos/category/manager/edit/".concat(t.id))},G=e=>{c.Z.confirm({title:"ยืนยันการลบหมวดหมู่",content:'คุณต้องการลบหมวดหมู่ "'.concat(e.display_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,s.jsx)(x.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{await A(async()=>{let t=await (0,k.P)();if(!(await fetch("/api/pos/category/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบหมวดหมู่ได้");d.ZP.success('ลบหมวดหมู่ "'.concat(e.display_name,'" สำเร็จ'))},"กำลังลบหมวดหมู่...")}})};if(O)return(0,s.jsx)(_.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."});if(!W)return(0,s.jsx)(_.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"});let K=t.filter(e=>e.is_active),M=t.filter(e=>!e.is_active);return(0,s.jsxs)("div",{style:Z.R.container,className:"jsx-730db15f67c266cf category-page",children:[(0,s.jsx)("style",{children:Z.W}),(0,s.jsx)(r(),{id:"730db15f67c266cf",children:".search-input-placeholder-white input::-webkit-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input{color:white!important}.category-card{cursor:pointer;-webkit-tap-highlight-color:transparent}"}),(0,s.jsx)(B.Z,{title:"หมวดหมู่สินค้า",subtitle:"".concat(t.length," รายการ"),icon:(0,s.jsx)(g.Z,{}),actions:(0,s.jsxs)(h.Z,{size:8,wrap:!0,children:[(0,s.jsx)(p.default,{prefix:(0,s.jsx)(y.Z,{style:{color:"#94A3B8"}}),allowClear:!0,placeholder:"ค้นหาหมวดหมู่...",onChange:e=>q(e.target.value),style:{minWidth:220}}),(0,s.jsx)(o.ZP,{icon:(0,s.jsx)(f.Z,{}),onClick:H}),(0,s.jsx)(o.ZP,{type:"primary",icon:(0,s.jsx)(j.Z,{}),onClick:J,children:"เพิ่มหมวดหมู่"})]})}),(0,s.jsx)(F.Z,{children:(0,s.jsxs)(P.Z,{children:[(0,s.jsx)(L,{totalCategories:t.length,activeCategories:K.length,inactiveCategories:M.length}),(0,s.jsx)(S.Z,{title:"รายการหมวดหมู่",extra:(0,s.jsx)("span",{style:{fontWeight:600},className:"jsx-730db15f67c266cf",children:a.length}),children:a.length>0?a.map((e,t)=>(0,s.jsx)(z,{category:e,index:t,onEdit:X,onDelete:G},e.id)):(0,s.jsx)(N.Z,{title:u.trim()?"ไม่พบหมวดหมู่ที่ค้นหา":"ยังไม่มีหมวดหมู่",description:u.trim()?"ลองค้นหาด้วยคำอื่นหรือล้างการค้นหา":"เพิ่มหมวดหมู่แรกเพื่อเริ่มต้นใช้งาน",action:u.trim()?null:(0,s.jsx)(o.ZP,{type:"primary",icon:(0,s.jsx)(j.Z,{}),onClick:J,children:"เพิ่มหมวดหมู่"})})})]})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=59968)}),_N_E=e.O()}]);