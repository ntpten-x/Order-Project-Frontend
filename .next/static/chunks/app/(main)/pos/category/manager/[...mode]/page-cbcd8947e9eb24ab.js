(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3358],{62761:function(e,t,s){Promise.resolve().then(s.bind(s,64922))},64922:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return z}});var r=s(57437),a=s(2265),i=s(19683),n=s(19878),o=s(34029),l=s(53743),d=s(50742),c=s(48651),g=s(47451),x=s(69410),y=s(96931),h=s(88589),p=s(66487),u=s(99376),m=s(25193),f=s(37410),j=s(20148),b=s(71891),F=s(8900),v=s(26349),k=s(88009),Z=s(78355),E=s(97235),C=s(3286),S=s(2938),_=s(33417);let{Title:w,Text:B}=i.default,R=e=>{let{displayName:t,categoryName:s,isActive:a}=e;return(0,r.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",textAlign:"center",border:"1px solid #F1F5F9",height:"100%"},children:[(0,r.jsx)(w,{level:5,style:{color:"#94A3B8",marginBottom:20,fontWeight:600},children:"ตัวอย่างการแสดงผล"}),(0,r.jsxs)("div",{style:{borderRadius:20,border:"1px solid ".concat(a?"#E2E8F0":"#F1F5F9"),padding:16,background:a?"white":"rgba(255,255,255,0.6)",boxShadow:a?"0 4px 12px rgba(0,0,0,0.06)":"none",display:"flex",alignItems:"center",gap:16,marginBottom:24,maxWidth:320,margin:"0 auto 24px"},children:[(0,r.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:a?"linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,r.jsx)(b.Z,{style:{fontSize:24,color:a?"#7C3AED":"#94A3B8"}})}),(0,r.jsxs)("div",{style:{textAlign:"left",flex:1},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,r.jsx)(B,{strong:!0,style:{fontSize:16,color:a?"#1E293B":"#64748B"},children:t||"ชื่อหมวดหมู่"}),a&&(0,r.jsx)(F.Z,{style:{color:"#10B981",fontSize:14}})]}),(0,r.jsx)(B,{type:"secondary",style:{fontSize:13,display:"block"},children:s||"Category Name"})]})]}),(0,r.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:16,padding:16},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,r.jsx)(B,{style:{fontSize:13,color:"#64748B"},children:"สถานะ"}),(0,r.jsx)("div",{style:{padding:"4px 12px",borderRadius:20,background:a?"#ECFDF5":"#FEF2F2",color:a?"#10B981":"#EF4444",fontSize:12,fontWeight:600},children:a?"พร้อมใช้งาน":"ปิดใช้งาน"})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)(B,{style:{fontSize:13,color:"#64748B"},children:"ประเภท"}),(0,r.jsx)(B,{strong:!0,style:{fontSize:13,color:"#1E293B"},children:"สินค้าทั่วไป"})]})]})]})};function z(e){let{params:t}=e,s=(0,u.useRouter)(),[i]=n.Z.useForm(),[b,F]=(0,a.useState)(!1),[z,A]=(0,a.useState)(!1),[P,T]=(0,a.useState)(""),[I,N]=(0,a.useState)(""),[W,D]=(0,a.useState)(!0),[O,q]=(0,a.useState)(""),L=t.mode[0],V=t.mode[1]||null,H="edit"===L&&!!V,{isAuthorized:X,isChecking:J}=(0,C.e)({requiredRole:"Admin"});(0,a.useEffect)(()=>{(async()=>{q(await (0,E.P)())})()},[]);let M=(0,a.useCallback)(async()=>{F(!0);try{let e=await fetch("/api/pos/category/getById/".concat(V));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลหมวดหมู่ได้");let t=await e.json();i.setFieldsValue({category_name:t.category_name,display_name:t.display_name,is_active:t.is_active}),T(t.display_name||""),N(t.category_name||""),D(t.is_active)}catch(e){console.error(e),o.ZP.error("ไม่สามารถดึงข้อมูลหมวดหมู่ได้"),s.push("/pos/category")}finally{F(!1)}},[V,i,s]);(0,a.useEffect)(()=>{H&&M()},[H,V,M]);let U=async e=>{A(!0);try{let t=H?"/api/pos/category/update/".concat(V):"/api/pos/category/create",r=await fetch(t,{method:H?"PUT":"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":O},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||(H?"ไม่สามารถอัปเดตหมวดหมู่ได้":"ไม่สามารถสร้างหมวดหมู่ได้"))}o.ZP.success(H?"อัปเดตหมวดหมู่สำเร็จ":"สร้างหมวดหมู่สำเร็จ"),s.push("/pos/category")}catch(e){console.error(e),o.ZP.error(e.message)}finally{A(!1)}},$=()=>s.push("/pos/category");return J?(0,r.jsx)(S.H,{message:"กำลังตรวจสอบสิทธิ์..."}):X?(0,r.jsxs)("div",{className:"manage-page",style:_.R.container,children:[(0,r.jsx)(j.Z,{title:H?"แก้ไขหมวดหมู่":"เพิ่มหมวดหมู่",subtitle:H?"แก้ไขข้อมูลหมวดหมู่":"สร้างหมวดหมู่ใหม่",onBack:$,actions:H?(0,r.jsx)(d.ZP,{danger:!0,onClick:()=>{V&&l.Z.confirm({title:"ยืนยันการลบหมวดหมู่",content:'คุณต้องการลบหมวดหมู่ "'.concat(P,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,r.jsx)(v.Z,{style:{color:"#EF4444"}}),onOk:async()=>{try{if(!(await fetch("/api/pos/category/delete/".concat(V),{method:"DELETE",headers:{"X-CSRF-Token":O}})).ok)throw Error("ไม่สามารถลบหมวดหมู่ได้");o.ZP.success("ลบหมวดหมู่สำเร็จ"),s.push("/pos/category")}catch(e){console.error(e),o.ZP.error("ไม่สามารถลบหมวดหมู่ได้")}}})},icon:(0,r.jsx)(v.Z,{}),children:"ลบ"}):null}),(0,r.jsx)(m.Z,{maxWidth:1e3,children:(0,r.jsx)(f.Z,{style:{background:"transparent",border:"none"},children:b?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"100px 0",background:"rgba(255,255,255,0.8)",borderRadius:24,backdropFilter:"blur(10px)"},children:(0,r.jsx)(c.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,r.jsxs)(g.Z,{gutter:[24,24],children:[(0,r.jsx)(x.Z,{xs:24,lg:14,xl:15,children:(0,r.jsxs)(y.Z,{bordered:!1,style:{borderRadius:24,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},styles:{body:{padding:32}},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:24},children:[(0,r.jsx)(k.Z,{style:{fontSize:20,color:"#7C3AED"}}),(0,r.jsx)(w,{level:5,style:{margin:0},children:"ข้อมูลหมวดหมู่"})]}),(0,r.jsxs)(n.Z,{form:i,layout:"vertical",onFinish:U,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.display_name&&T(e.display_name),void 0!==e.category_name&&N(e.category_name),void 0!==e.is_active&&D(e.is_active)},children:[(0,r.jsx)(n.Z.Item,{name:"category_name",label:(0,r.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"Category Name (English)"}),rules:[{required:!0,message:"กรุณากรอกชื่อหมวดหมู่"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,r.jsx)(h.default,{size:"large",placeholder:"e.g. Beverage, Food",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,r.jsx)(n.Z.Item,{name:"display_name",label:(0,r.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"ชื่อที่แสดง (ภาษาไทย)"}),rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,r.jsx)(h.default,{size:"large",placeholder:"เช่น เครื่องดื่ม, อาหาร",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,r.jsx)("div",{style:{padding:"20px",background:"#F8FAFC",borderRadius:16,marginTop:24},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(B,{strong:!0,style:{fontSize:15,display:"block"},children:"สถานะการใช้งาน"}),(0,r.jsx)(B,{type:"secondary",style:{fontSize:13},children:"เปิดเพื่อให้แสดงในหน้าขายสินค้า"})]}),(0,r.jsx)(n.Z.Item,{name:"is_active",valuePropName:"checked",noStyle:!0,children:(0,r.jsx)(p.Z,{style:{background:W?"#10B981":void 0}})})]})}),(0,r.jsxs)("div",{style:{marginTop:32,display:"flex",gap:12},children:[(0,r.jsx)(d.ZP,{size:"large",onClick:$,style:{flex:1,borderRadius:12,height:48,fontWeight:600},children:"ยกเลิก"}),(0,r.jsx)(d.ZP,{type:"primary",htmlType:"submit",loading:z,icon:(0,r.jsx)(Z.Z,{}),style:{flex:2,borderRadius:12,height:48,fontWeight:600,background:"#7C3AED",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.3)"},children:"บันทึกข้อมูล"})]})]})]})}),(0,r.jsx)(x.Z,{xs:24,lg:10,xl:9,children:(0,r.jsx)(R,{displayName:P,categoryName:I,isActive:W})})]})})})]}):(0,r.jsx)(S.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=62761)}),_N_E=e.O()}]);