(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3358],{62761:function(e,t,s){Promise.resolve().then(s.bind(s,64922))},64922:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return z}});var i=s(57437),r=s(2265),a=s(19683),l=s(50742),o=s(19878),n=s(34029),d=s(53743),c=s(48651),x=s(47451),g=s(69410),h=s(96931),y=s(88589),p=s(66487),u=s(99376),m=s(17588),j=s(26349),f=s(71891),b=s(8900),F=s(88009),v=s(78355),k=s(97235),E=s(3286),C=s(2938),S=s(33417);let{Title:Z,Text:w}=a.default,_=e=>{let{isEdit:t,onBack:s,onDelete:r}=e;return(0,i.jsxs)("div",{style:{...S.R.header,minHeight:180},children:[(0,i.jsx)("div",{style:S.R.headerDecoCircle1}),(0,i.jsx)("div",{style:S.R.headerDecoCircle2}),(0,i.jsxs)("div",{style:S.R.headerContent,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,i.jsx)(l.ZP,{type:"text",icon:(0,i.jsx)(m.Z,{style:{fontSize:20,color:"white"}}),onClick:s,style:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"white"}}),(0,i.jsxs)("div",{children:[(0,i.jsx)(w,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:t?"แก้ไขข้อมูล":"สร้างรายการใหม่"}),(0,i.jsx)(Z,{level:4,style:{color:"white",margin:0,fontWeight:700,textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:t?"แก้ไขหมวดหมู่":"เพิ่มหมวดหมู่"})]})]}),t&&r&&(0,i.jsx)(l.ZP,{type:"text",danger:!0,icon:(0,i.jsx)(j.Z,{}),onClick:r,style:{background:"#FEF2F2",color:"#EF4444",borderRadius:12,height:40,padding:"0 16px",fontWeight:600},children:(0,i.jsx)("span",{className:"hidden sm:inline",children:"ลบหมวดหมู่"})})]})]})},R=e=>{let{displayName:t,categoryName:s,isActive:r}=e;return(0,i.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",textAlign:"center",border:"1px solid #F1F5F9",height:"100%"},children:[(0,i.jsx)(Z,{level:5,style:{color:"#94A3B8",marginBottom:20,fontWeight:600},children:"ตัวอย่างการแสดงผล"}),(0,i.jsxs)("div",{style:{borderRadius:20,border:"1px solid ".concat(r?"#E2E8F0":"#F1F5F9"),padding:16,background:r?"white":"rgba(255,255,255,0.6)",boxShadow:r?"0 4px 12px rgba(0,0,0,0.06)":"none",display:"flex",alignItems:"center",gap:16,marginBottom:24,maxWidth:320,margin:"0 auto 24px"},children:[(0,i.jsx)("div",{style:{width:56,height:56,borderRadius:16,background:r?"linear-gradient(135deg, #F3E8FF 0%, #E9D5FF 100%)":"#F1F5F9",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,i.jsx)(f.Z,{style:{fontSize:24,color:r?"#7C3AED":"#94A3B8"}})}),(0,i.jsxs)("div",{style:{textAlign:"left",flex:1},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.jsx)(w,{strong:!0,style:{fontSize:16,color:r?"#1E293B":"#64748B"},children:t||"ชื่อหมวดหมู่"}),r&&(0,i.jsx)(b.Z,{style:{color:"#10B981",fontSize:14}})]}),(0,i.jsx)(w,{type:"secondary",style:{fontSize:13,display:"block"},children:s||"Category Name"})]})]}),(0,i.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:16,padding:16},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[(0,i.jsx)(w,{style:{fontSize:13,color:"#64748B"},children:"สถานะ"}),(0,i.jsx)("div",{style:{padding:"4px 12px",borderRadius:20,background:r?"#ECFDF5":"#FEF2F2",color:r?"#10B981":"#EF4444",fontSize:12,fontWeight:600},children:r?"พร้อมใช้งาน":"ปิดใช้งาน"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)(w,{style:{fontSize:13,color:"#64748B"},children:"ประเภท"}),(0,i.jsx)(w,{strong:!0,style:{fontSize:13,color:"#1E293B"},children:"สินค้าทั่วไป"})]})]})]})};function z(e){let{params:t}=e,s=(0,u.useRouter)(),[a]=o.Z.useForm(),[m,f]=(0,r.useState)(!1),[b,z]=(0,r.useState)(!1),[B,A]=(0,r.useState)(""),[P,I]=(0,r.useState)(""),[T,N]=(0,r.useState)(!0),[W,D]=(0,r.useState)(""),O=t.mode[0],q=t.mode[1]||null,H="edit"===O&&!!q,{isAuthorized:L,isChecking:V}=(0,E.e)({requiredRole:"Admin"});(0,r.useEffect)(()=>{(async()=>{D(await (0,k.P)())})()},[]);let X=(0,r.useCallback)(async()=>{f(!0);try{let e=await fetch("/api/pos/category/getById/".concat(q));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลหมวดหมู่ได้");let t=await e.json();a.setFieldsValue({category_name:t.category_name,display_name:t.display_name,is_active:t.is_active}),A(t.display_name||""),I(t.category_name||""),N(t.is_active)}catch(e){console.error(e),n.ZP.error("ไม่สามารถดึงข้อมูลหมวดหมู่ได้"),s.push("/pos/category")}finally{f(!1)}},[q,a,s]);(0,r.useEffect)(()=>{H&&X()},[H,q,X]);let J=async e=>{z(!0);try{let t=H?"/api/pos/category/update/".concat(q):"/api/pos/category/create",i=H?"PUT":"POST",r=await fetch(t,{method:i,headers:{"Content-Type":"application/json","X-CSRF-Token":W},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||(H?"ไม่สามารถอัปเดตหมวดหมู่ได้":"ไม่สามารถสร้างหมวดหมู่ได้"))}n.ZP.success(H?"อัปเดตหมวดหมู่สำเร็จ":"สร้างหมวดหมู่สำเร็จ"),s.push("/pos/category")}catch(e){console.error(e),n.ZP.error(e.message)}finally{z(!1)}},M=()=>s.push("/pos/category");return V?(0,i.jsx)(C.H,{message:"กำลังตรวจสอบสิทธิ์..."}):L?(0,i.jsxs)("div",{className:"manage-page",style:S.R.container,children:[(0,i.jsx)(_,{isEdit:H,onBack:M,onDelete:H?()=>{q&&d.Z.confirm({title:"ยืนยันการลบหมวดหมู่",content:'คุณต้องการลบหมวดหมู่ "'.concat(B,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,i.jsx)(j.Z,{style:{color:"#EF4444"}}),onOk:async()=>{try{if(!(await fetch("/api/pos/category/delete/".concat(q),{method:"DELETE",headers:{"X-CSRF-Token":W}})).ok)throw Error("ไม่สามารถลบหมวดหมู่ได้");n.ZP.success("ลบหมวดหมู่สำเร็จ"),s.push("/pos/category")}catch(e){console.error(e),n.ZP.error("ไม่สามารถลบหมวดหมู่ได้")}}})}:void 0}),(0,i.jsx)("div",{style:{maxWidth:1e3,margin:"-60px auto 40px",padding:"0 16px",position:"relative",zIndex:10},children:m?(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"100px 0",background:"rgba(255,255,255,0.8)",borderRadius:24,backdropFilter:"blur(10px)"},children:(0,i.jsx)(c.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,i.jsxs)(x.Z,{gutter:[24,24],children:[(0,i.jsx)(g.Z,{xs:24,lg:14,xl:15,children:(0,i.jsxs)(h.Z,{bordered:!1,style:{borderRadius:24,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},styles:{body:{padding:32}},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:24},children:[(0,i.jsx)(F.Z,{style:{fontSize:20,color:"#7C3AED"}}),(0,i.jsx)(Z,{level:5,style:{margin:0},children:"ข้อมูลหมวดหมู่"})]}),(0,i.jsxs)(o.Z,{form:a,layout:"vertical",onFinish:J,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.display_name&&A(e.display_name),void 0!==e.category_name&&I(e.category_name),void 0!==e.is_active&&N(e.is_active)},children:[(0,i.jsx)(o.Z.Item,{name:"category_name",label:(0,i.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"Category Name (English)"}),rules:[{required:!0,message:"กรุณากรอกชื่อหมวดหมู่"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,i.jsx)(y.default,{size:"large",placeholder:"e.g. Beverage, Food",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,i.jsx)(o.Z.Item,{name:"display_name",label:(0,i.jsx)("span",{style:{fontWeight:600,color:"#475569"},children:"ชื่อที่แสดง (ภาษาไทย)"}),rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:(0,i.jsx)(y.default,{size:"large",placeholder:"เช่น เครื่องดื่ม, อาหาร",style:{borderRadius:12,height:48,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),(0,i.jsx)("div",{style:{padding:"20px",background:"#F8FAFC",borderRadius:16,marginTop:24},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(w,{strong:!0,style:{fontSize:15,display:"block"},children:"สถานะการใช้งาน"}),(0,i.jsx)(w,{type:"secondary",style:{fontSize:13},children:"เปิดเพื่อให้แสดงในหน้าขายสินค้า"})]}),(0,i.jsx)(o.Z.Item,{name:"is_active",valuePropName:"checked",noStyle:!0,children:(0,i.jsx)(p.Z,{style:{background:T?"#10B981":void 0}})})]})}),(0,i.jsxs)("div",{style:{marginTop:32,display:"flex",gap:12},children:[(0,i.jsx)(l.ZP,{size:"large",onClick:M,style:{flex:1,borderRadius:12,height:48,fontWeight:600},children:"ยกเลิก"}),(0,i.jsx)(l.ZP,{type:"primary",htmlType:"submit",loading:b,icon:(0,i.jsx)(v.Z,{}),style:{flex:2,borderRadius:12,height:48,fontWeight:600,background:"#7C3AED",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.3)"},children:"บันทึกข้อมูล"})]})]})]})}),(0,i.jsx)(g.Z,{xs:24,lg:10,xl:9,children:(0,i.jsx)(R,{displayName:B,categoryName:P,isActive:T})})]})})]}):(0,i.jsx)(C.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=62761)}),_N_E=e.O()}]);