(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9799],{69642:function(e,t,i){Promise.resolve().then(i.bind(i,97955))},97955:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return H}});var a=i(57437),s=i(29),l=i.n(s),r=i(2265),n=i(19683),o=i(80009),c=i(50742),d=i(53743),h=i(34029),p=i(24783),x=i(88589),u=i(93132),b=i(8900),g=i(39725),j=i(13377),y=i(26349),f=i(29436),m=i(89245),w=i(96473),k=i(34962),v=i(99376),E=i(3369),C=i(26972),F=i(24675),R=i(97235),Z=i(3286),B=i(67697),A=i(73814),S=i(85790),_=i(2938),D=i(25193),P=i(37410),N=i(27623),z=i(20148),I=i(2786);let{Text:L}=n.default,T=e=>{let{tables:t}=e,i=t.length,s=t.filter(e=>e.status===k.c.Available).length,l=t.filter(e=>e.status===k.c.Unavailable).length;return(0,a.jsxs)("div",{style:S.R.statsCard,children:[(0,a.jsxs)("div",{style:S.R.statItem,children:[(0,a.jsx)("span",{style:{...S.R.statNumber,color:"#7C3AED"},children:i}),(0,a.jsx)(L,{style:S.R.statLabel,children:"ทั้งหมด"})]}),(0,a.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,a.jsxs)("div",{style:S.R.statItem,children:[(0,a.jsx)("span",{style:{...S.R.statNumber,color:"#10B981"},children:s}),(0,a.jsx)(L,{style:S.R.statLabel,children:"ว่าง"})]}),(0,a.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,a.jsxs)("div",{style:S.R.statItem,children:[(0,a.jsx)("span",{style:{...S.R.statNumber,color:"#F59E0B"},children:l}),(0,a.jsx)(L,{style:S.R.statLabel,children:"ไม่ว่าง"})]})]})},W=e=>{let{table:t,index:i,onEdit:s,onDelete:l}=e,r=t.status===k.c.Available;return(0,a.jsx)("div",{className:"table-card",style:{...S.R.tableCard(t.is_active),animationDelay:"".concat(.03*i,"s")},onClick:()=>s(t),children:(0,a.jsxs)("div",{style:S.R.tableCardInner,children:[(0,a.jsxs)("div",{style:{width:56,height:56,borderRadius:"50%",background:r?"linear-gradient(135deg, #A7F3D0 0%, #6EE7B7 100%)":"linear-gradient(135deg, #FDE68A 0%, #FCD34D 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,position:"relative",boxShadow:r?"0 4px 10px rgba(16, 185, 129, 0.2)":"0 4px 10px rgba(245, 158, 11, 0.2)"},children:[(0,a.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(u.Z,{style:{fontSize:22,color:r?"#10B981":"#F59E0B"}})}),(0,a.jsx)("div",{style:{position:"absolute",bottom:0,right:0,width:16,height:16,borderRadius:"50%",background:r?"#10B981":"#F59E0B",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}})]}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0,paddingRight:8,paddingLeft:8},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,a.jsx)(L,{strong:!0,style:{fontSize:16,color:t.is_active?"#1E293B":"#64748B"},children:t.table_name}),t.is_active?(0,a.jsx)("div",{style:{padding:"2px 6px",background:"#F0FDF4",borderRadius:6,border:"1px solid #DCFCE7"},children:(0,a.jsx)(b.Z,{style:{color:"#10B981",fontSize:10}})}):(0,a.jsx)("div",{style:{padding:"2px 6px",background:"#F8FAFC",borderRadius:6,border:"1px solid #E2E8F0"},children:(0,a.jsx)(g.Z,{style:{color:"#94A3B8",fontSize:10}})})]}),(0,a.jsx)("div",{style:{display:"flex"},children:(0,a.jsx)(o.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:r?"#10B981":"#B45309",background:r?"#ECFDF5":"#FEF3C7",border:"none",fontWeight:600,padding:"0 8px",lineHeight:"18px",height:18},children:r?"ว่าง":"ไม่ว่าง"})})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,a.jsx)(c.ZP,{type:"text",icon:(0,a.jsx)(j.Z,{}),onClick:e=>{e.stopPropagation(),s(t)},style:{borderRadius:12,color:"#7C3AED",background:"#F5F3FF",width:36,height:36}}),(0,a.jsx)(c.ZP,{type:"text",danger:!0,icon:(0,a.jsx)(y.Z,{}),onClick:e=>{e.stopPropagation(),l(t)},style:{borderRadius:12,background:"#FEF2F2",width:36,height:36}})]})]})})};function H(){let e=(0,v.useRouter)(),[t,i]=(0,r.useState)([]),[s,n]=(0,r.useState)([]),[o,b]=(0,r.useState)(""),{execute:g}=(0,C.J)(),{showLoading:j}=(0,E.x)(),{socket:k}=(0,F.s)(),{isAuthorized:L,isChecking:H}=(0,Z.e)({requiredRole:"Admin"});(0,r.useEffect)(()=>{(0,R.P)()},[]),(0,r.useEffect)(()=>{let e=(0,A.t)("pos:tables",6e5);e&&Array.isArray(e)&&i(e)},[]);let O=(0,r.useCallback)(async()=>{g(async()=>{let e=await fetch("/api/pos/tables?limit=100");if(!e.ok)throw Error("Failed to fetch tables");let t=await e.json(),a=t.data||t;Array.isArray(a)&&(i(a),(0,A.v)("pos:tables",a))},"กำลังโหลดข้อมูลโต๊ะ...")},[g]);(0,r.useEffect)(()=>{L&&O()},[L,O]),(0,B.v)(k,{create:"tables:create",update:"tables:update",delete:"tables:delete"},i),(0,r.useEffect)(()=>{if(o){let e=o.toLowerCase();n(t.filter(t=>t.table_name.toLowerCase().includes(e)))}else n(t)},[t,o]);let q=e=>{b(e)},J=()=>{j("กำลังเปิดหน้าจัดการโต๊ะ..."),e.push("/pos/tables/manager/add")},U=t=>{j("กำลังเปิดหน้าแก้ไขโต๊ะ..."),e.push("/pos/tables/manager/edit/".concat(t.id))},X=e=>{d.Z.confirm({title:"ยืนยันการลบโต๊ะ",content:'คุณต้องการลบโต๊ะ "'.concat(e.table_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,a.jsx)(y.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{await g(async()=>{let t=await (0,R.P)();if(!(await fetch("/api/pos/tables/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบโต๊ะได้");h.ZP.success('ลบโต๊ะ "'.concat(e.table_name,'" สำเร็จ'))},"กำลังลบโต๊ะ...")}})};return H?(0,a.jsx)(_.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."}):L?(0,a.jsxs)("div",{style:S.R.container,className:"jsx-70760a0aebce288b tables-page",children:[(0,a.jsx)("style",{children:S.W}),(0,a.jsx)(l(),{id:"70760a0aebce288b",children:".search-input-placeholder-white input::-webkit-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input{color:white!important}.table-card{cursor:pointer;-webkit-tap-highlight-color:transparent}"}),(0,a.jsx)(z.Z,{title:"โต๊ะ",subtitle:"".concat(t.length," รายการ"),icon:(0,a.jsx)(u.Z,{}),actions:(0,a.jsxs)(p.Z,{size:8,wrap:!0,children:[(0,a.jsx)(x.default,{prefix:(0,a.jsx)(f.Z,{style:{color:"#94A3B8"}}),allowClear:!0,placeholder:"ค้นหาโต๊ะ...",onChange:e=>q(e.target.value),style:{minWidth:220}}),(0,a.jsx)(c.ZP,{icon:(0,a.jsx)(m.Z,{}),onClick:O}),(0,a.jsx)(c.ZP,{type:"primary",icon:(0,a.jsx)(w.Z,{}),onClick:J,children:"เพิ่มโต๊ะ"})]})}),(0,a.jsx)(D.Z,{children:(0,a.jsxs)(N.Z,{children:[(0,a.jsx)(T,{tables:t}),(0,a.jsx)(P.Z,{title:"รายการโต๊ะ",extra:(0,a.jsx)("span",{style:{fontWeight:600},className:"jsx-70760a0aebce288b",children:s.length}),children:s.length>0?s.map((e,t)=>(0,a.jsx)(W,{table:e,index:t,onEdit:U,onDelete:X},e.id)):(0,a.jsx)(I.Z,{title:o.trim()?"ไม่พบโต๊ะที่ค้นหา":"ยังไม่มีโต๊ะในระบบ",description:o.trim()?"ลองค้นหาด้วยคำอื่นหรือล้างการค้นหา":"เริ่มต้นด้วยการเพิ่มโต๊ะแรกเพื่อใช้งาน",action:o.trim()?null:(0,a.jsx)(c.ZP,{type:"primary",icon:(0,a.jsx)(w.Z,{}),onClick:J,children:"เพิ่มโต๊ะ"})})})]})})]}):(0,a.jsx)(_.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=69642)}),_N_E=e.O()}]);