(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4165],{94169:function(e,t,i){Promise.resolve().then(i.bind(i,73511))},73511:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return R}});var s=i(57437),a=i(29),n=i.n(a),r=i(2265),l=i(19683),o=i(50742),d=i(19878),c=i(34029),p=i(53743),h=i(48651),x=i(88589),g=i(93834),m=i(66487),u=i(99376),b=i(15327),y=i(26349),f=i(93132),j=i(8900),v=i(78355),k=i(85790),w=i(97235),E=i(3286),C=i(2938),F=i(3369),S=i(34962);let{Title:Z,Text:B}=l.default,z=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{children:k.W}),(0,s.jsx)(n(),{id:"bdcc97fb7d436e32",children:".ant-form-item-label>label{font-size:15px;font-weight:500;color:#334155}.ant-input-lg,.ant-input-number-lg,.ant-select-selector{-webkit-border-radius:12px!important;-moz-border-radius:12px!important;border-radius:12px!important;padding:8px 11px!important;font-size:16px!important;border-color:#E2E8F0!important}.ant-select-lg .ant-select-selector{padding:0 11px!important;height:48px!important;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.ant-input-lg:hover,.ant-input-number-lg:hover,.ant-select-selector:hover{border-color:#7C3AED!important}.ant-input-lg:focus,.ant-input-number-lg:focus,.ant-select-focused .ant-select-selector{border-color:#7C3AED!important;-webkit-box-shadow:0 0 0 2px rgba(124,58,237,.1)!important;-moz-box-shadow:0 0 0 2px rgba(124,58,237,.1)!important;box-shadow:0 0 0 2px rgba(124,58,237,.1)!important}"})]}),T=e=>{let{isEdit:t,onBack:i,onDelete:a}=e;return(0,s.jsxs)("div",{style:{marginBottom:32,display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative",zIndex:10},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,s.jsx)(o.ZP,{icon:(0,s.jsx)(b.Z,{}),onClick:i,style:{borderRadius:"50%",width:44,height:44,border:"none",background:"white",boxShadow:"0 4px 12px rgba(0,0,0,0.08)",color:"#64748B",display:"flex",alignItems:"center",justifyContent:"center"}}),(0,s.jsxs)("div",{children:[(0,s.jsx)(Z,{level:3,style:{margin:0,fontWeight:700,color:"#1E293B",fontSize:24},children:t?"แก้ไขข้อมูลโต๊ะ":"เพิ่มโต๊ะใหม่"}),(0,s.jsx)(B,{type:"secondary",style:{fontSize:14},children:t?"แก้ไขชื่อหรือสถานะของโต๊ะอาหาร":"สร้างโต๊ะใหม่ในร้านของคุณ"})]})]}),t&&a&&(0,s.jsx)(o.ZP,{danger:!0,type:"text",icon:(0,s.jsx)(y.Z,{}),onClick:a,style:{borderRadius:12,height:44,padding:"0 20px",background:"#FEF2F2",color:"#EF4444",fontWeight:600},children:"ลบโต๊ะ"})]})},_=e=>{let{name:t}=e;return(0,s.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",border:"1px solid #F1F5F9",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,s.jsx)(Z,{level:5,style:{color:"#94A3B8",marginBottom:20,fontWeight:600,width:"100%",textAlign:"left"},children:"ตัวอย่างการแสดงผล"}),(0,s.jsxs)("div",{style:{width:"100%",background:"white",borderRadius:16,border:"1px solid #E2E8F0",padding:"16px",display:"flex",alignItems:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.03)",maxWidth:400},children:[(0,s.jsx)("div",{style:{width:56,height:56,borderRadius:"50%",background:"linear-gradient(135deg, #A7F3D0 0%, #6EE7B7 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginRight:16,position:"relative",boxShadow:"0 4px 10px rgba(16, 185, 129, 0.2)"},children:(0,s.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,s.jsx)(f.Z,{style:{fontSize:22,color:"#10B981"}})})}),(0,s.jsx)("div",{style:{flex:1,minWidth:0},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,s.jsx)(B,{strong:!0,style:{fontSize:16,color:"#1E293B"},children:t||"ชื่อโต๊ะ"}),(0,s.jsx)(j.Z,{style:{color:"#10B981",fontSize:14}})]})})]}),(0,s.jsx)("div",{style:{marginTop:24,textAlign:"center"},children:(0,s.jsx)(B,{type:"secondary",style:{fontSize:13},children:"นี่คือลักษณะที่จะแสดงในรายการ (สถานะว่าง)"})})]})},P=e=>{let{isEdit:t,loading:i,onCancel:a}=e;return(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:12,marginTop:40,borderTop:"1px solid #F1F5F9",paddingTop:24},children:[(0,s.jsx)(o.ZP,{size:"large",onClick:a,style:{borderRadius:12,height:48,padding:"0 32px",border:"1px solid #E2E8F0",color:"#64748B",fontWeight:600},children:"ยกเลิก"}),(0,s.jsx)(o.ZP,{type:"primary",htmlType:"submit",loading:i,icon:(0,s.jsx)(v.Z,{}),size:"large",style:{borderRadius:12,height:48,padding:"0 32px",background:"#7C3AED",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.3)",fontWeight:600,border:"none"},children:t?"บันทึกการแก้ไข":"สร้างโต๊ะ"})]})};function R(e){let{params:t}=e,i=(0,u.useRouter)(),[a]=d.Z.useForm(),[n,l]=(0,r.useState)(!1),[o,b]=(0,r.useState)(!1),[f,j]=(0,r.useState)(""),[v,Z]=(0,r.useState)(""),{showLoading:R,hideLoading:I}=(0,F.x)(),A=t.mode[0],N=t.mode[1]||null,W="edit"===A&&!!N,{isAuthorized:O,isChecking:D}=(0,E.e)({requiredRole:"Admin"});(0,r.useEffect)(()=>{(async()=>{Z(await (0,w.P)())})()},[]);let V=(0,r.useCallback)(async()=>{l(!0),R();try{let e=await fetch("/api/pos/tables/getById/".concat(N));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลโต๊ะได้");let t=await e.json();a.setFieldsValue({table_name:t.table_name,status:t.status,is_active:t.is_active}),j(t.table_name||"")}catch(e){console.error(e),c.ZP.error("ไม่สามารถดึงข้อมูลโต๊ะได้"),i.push("/pos/tables")}finally{l(!1),I()}},[N,a,i,R,I]);(0,r.useEffect)(()=>{W?V():(I(),a.setFieldsValue({status:S.c.Available,is_active:!0}))},[W,N,V,I,a]);let q=async e=>{b(!0);try{if(W){let t=await fetch("/api/pos/tables/update/".concat(N),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":v},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตโต๊ะได้")}c.ZP.success("อัปเดตโต๊ะสำเร็จ")}else{let t=await fetch("/api/pos/tables/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":v},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างโต๊ะได้")}c.ZP.success("สร้างโต๊ะสำเร็จ")}i.push("/pos/tables")}catch(e){console.error(e),c.ZP.error(e.message||(W?"ไม่สามารถอัปเดตโต๊ะได้":"ไม่สามารถสร้างโต๊ะได้"))}finally{b(!1)}},U=()=>i.push("/pos/tables");return D?(0,s.jsx)(C.H,{message:"กำลังตรวจสอบสิทธิ์..."}):O?(0,s.jsxs)("div",{className:"manage-page",style:k.R.container,children:[(0,s.jsx)(z,{}),(0,s.jsxs)("div",{style:{maxWidth:1e3,margin:"0 auto",position:"relative",zIndex:1,paddingBottom:40},children:[(0,s.jsx)(T,{isEdit:W,onBack:U,onDelete:W?()=>{N&&p.Z.confirm({title:"ยืนยันการลบโต๊ะ",content:'คุณต้องการลบโต๊ะ "'.concat(f,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,s.jsx)(y.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{try{let e=await fetch("/api/pos/tables/delete/".concat(N),{method:"DELETE",headers:{"X-CSRF-Token":v}});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||t.message||"ไม่สามารถลบโต๊ะได้")}c.ZP.success("ลบโต๊ะสำเร็จ"),i.push("/pos/tables")}catch(e){console.error(e),c.ZP.error("ไม่สามารถลบโต๊ะได้")}}})}:void 0}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)("div",{style:{background:"white",borderRadius:24,padding:32,boxShadow:"0 4px 24px rgba(0,0,0,0.04)"},children:n?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:(0,s.jsx)(h.Z,{size:"large"})}):(0,s.jsxs)(d.Z,{form:a,layout:"vertical",onFinish:q,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0,status:S.c.Available},onValuesChange:e=>{void 0!==e.table_name&&j(e.table_name)},children:[(0,s.jsxs)("div",{style:{marginBottom:24},children:[(0,s.jsx)(B,{strong:!0,style:{fontSize:18,color:"#1E293B",display:"block",marginBottom:16},children:"ข้อมูลทั่วไป"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,s.jsx)(d.Z.Item,{name:"table_name",label:"ชื่อโต๊ะ *",rules:[{required:!0,message:"กรุณากรอกชื่อโต๊ะ"},{max:50,message:"ความยาวต้องไม่เกิน 50 ตัวอักษร"}],children:(0,s.jsx)(x.default,{size:"large",placeholder:"เช่น T-01, VIP-1",maxLength:50})}),(0,s.jsx)(d.Z.Item,{name:"status",label:"สถานะเริ่มต้น",rules:[{required:!0,message:"กรุณาเลือกสถานะ"}],children:(0,s.jsxs)(g.default,{size:"large",children:[(0,s.jsx)(g.default.Option,{value:S.c.Available,children:"ว่าง (Available)"}),(0,s.jsx)(g.default.Option,{value:S.c.Unavailable,children:"ไม่ว่าง (Unavailable)"})]})})]})]}),(0,s.jsxs)("div",{style:{marginBottom:24,borderTop:"1px solid #F1F5F9",paddingTop:24},children:[(0,s.jsx)(B,{strong:!0,style:{fontSize:18,color:"#1E293B",display:"block",marginBottom:16},children:"การตั้งค่าอื่นๆ"}),(0,s.jsx)(d.Z.Item,{name:"is_active",label:"สถานะการใช้งาน",valuePropName:"checked",style:{marginBottom:0},children:(0,s.jsx)(m.Z,{checkedChildren:"เปิดใช้งาน",unCheckedChildren:"ปิดใช้งาน",style:{background:a.getFieldValue("is_active")?"#10B981":void 0}})})]}),(0,s.jsx)(P,{isEdit:W,loading:o,onCancel:U})]})})}),(0,s.jsx)("div",{className:"md:col-span-1 hidden md:block",children:(0,s.jsx)("div",{style:{position:"sticky",top:24},children:(0,s.jsx)(_,{name:f})})})]})]})]}):(0,s.jsx)(C.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=94169)}),_N_E=e.O()}]);