(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9799],{69642:function(e,t,s){Promise.resolve().then(s.bind(s,97955))},97955:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var i=s(57437),a=s(29),r=s.n(a),l=s(2265),n=s(19683),d=s(50742),o=s(88589),c=s(80009),h=s(85180),p=s(53743),x=s(34029),b=s(93132),g=s(89245),u=s(96473),y=s(29436),j=s(8900),f=s(39725),m=s(13377),v=s(26349),w=s(34962),R=s(99376),k=s(3369),E=s(26972),C=s(24675),F=s(97235),S=s(3286),A=s(67697),Z=s(73814),D=s(85790),N=s(2938);let{Text:z,Title:B}=n.default,_=e=>{let{onRefresh:t,onAdd:s,onSearch:a}=e;return(0,i.jsxs)("div",{style:D.R.header,children:[(0,i.jsx)("div",{style:D.R.headerDecoCircle1}),(0,i.jsx)("div",{style:D.R.headerDecoCircle2}),(0,i.jsxs)("div",{style:D.R.headerContent,children:[(0,i.jsxs)("div",{style:D.R.headerLeft,children:[(0,i.jsx)("div",{style:D.R.headerIconBox,children:(0,i.jsx)(b.Z,{style:{fontSize:24,color:"white"}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(z,{style:{color:"rgba(255,255,255,0.85)",fontSize:13,display:"block",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"จัดการและติดตามสถานะโต๊ะทั้งหมด"}),(0,i.jsx)(B,{level:4,style:{color:"white",margin:0,fontWeight:700,letterSpacing:"0.5px",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"รายการโต๊ะ"})]})]}),(0,i.jsxs)("div",{style:D.R.headerActions,children:[(0,i.jsx)(d.ZP,{type:"text",icon:(0,i.jsx)(g.Z,{style:{color:"white"}}),onClick:t,style:{background:"rgba(255,255,255,0.2)",backdropFilter:"blur(4px)",borderRadius:12,height:40,width:40,border:"1px solid rgba(255,255,255,0.3)"}}),(0,i.jsx)(d.ZP,{type:"primary",icon:(0,i.jsx)(u.Z,{}),onClick:s,style:{background:"white",color:"#7C3AED",borderRadius:12,height:40,fontWeight:600,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:(0,i.jsx)("span",{className:"hidden sm:inline",children:"เพิ่มโต๊ะใหม่"})})]})]}),(0,i.jsx)("div",{style:{marginTop:24,padding:"0 4px"},children:(0,i.jsx)(o.default,{prefix:(0,i.jsx)(y.Z,{style:{color:"#fff",opacity:.7}}),placeholder:"ค้นหาโต๊ะ (ชื่อ)...",onChange:e=>a(e.target.value),bordered:!1,style:{background:"rgba(255,255,255,0.15)",backdropFilter:"blur(8px)",borderRadius:14,padding:"8px 16px",color:"white",fontSize:15},className:"search-input-placeholder-white"})})]})},P=e=>{let{tables:t}=e,s=t.length,a=t.filter(e=>e.status===w.c.Available).length,r=t.filter(e=>e.status===w.c.Unavailable).length;return(0,i.jsxs)("div",{style:D.R.statsCard,children:[(0,i.jsxs)("div",{style:D.R.statItem,children:[(0,i.jsx)("span",{style:{...D.R.statNumber,color:"#7C3AED"},children:s}),(0,i.jsx)(z,{style:D.R.statLabel,children:"ทั้งหมด"})]}),(0,i.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,i.jsxs)("div",{style:D.R.statItem,children:[(0,i.jsx)("span",{style:{...D.R.statNumber,color:"#10B981"},children:a}),(0,i.jsx)(z,{style:D.R.statLabel,children:"ว่าง"})]}),(0,i.jsx)("div",{style:{width:1,height:24,background:"#f0f0f0",alignSelf:"center"}}),(0,i.jsxs)("div",{style:D.R.statItem,children:[(0,i.jsx)("span",{style:{...D.R.statNumber,color:"#F59E0B"},children:r}),(0,i.jsx)(z,{style:D.R.statLabel,children:"ไม่ว่าง"})]})]})},I=e=>{let{table:t,index:s,onEdit:a,onDelete:r}=e,l=t.status===w.c.Available;return(0,i.jsx)("div",{className:"table-card",style:{...D.R.tableCard(t.is_active),animationDelay:"".concat(.03*s,"s")},onClick:()=>a(t),children:(0,i.jsxs)("div",{style:D.R.tableCardInner,children:[(0,i.jsxs)("div",{style:{width:56,height:56,borderRadius:"50%",background:l?"linear-gradient(135deg, #A7F3D0 0%, #6EE7B7 100%)":"linear-gradient(135deg, #FDE68A 0%, #FCD34D 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,position:"relative",boxShadow:l?"0 4px 10px rgba(16, 185, 129, 0.2)":"0 4px 10px rgba(245, 158, 11, 0.2)"},children:[(0,i.jsx)("div",{style:{width:48,height:48,borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(b.Z,{style:{fontSize:22,color:l?"#10B981":"#F59E0B"}})}),(0,i.jsx)("div",{style:{position:"absolute",bottom:0,right:0,width:16,height:16,borderRadius:"50%",background:l?"#10B981":"#F59E0B",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}})]}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0,paddingRight:8,paddingLeft:8},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,i.jsx)(z,{strong:!0,style:{fontSize:16,color:t.is_active?"#1E293B":"#64748B"},children:t.table_name}),t.is_active?(0,i.jsx)("div",{style:{padding:"2px 6px",background:"#F0FDF4",borderRadius:6,border:"1px solid #DCFCE7"},children:(0,i.jsx)(j.Z,{style:{color:"#10B981",fontSize:10}})}):(0,i.jsx)("div",{style:{padding:"2px 6px",background:"#F8FAFC",borderRadius:6,border:"1px solid #E2E8F0"},children:(0,i.jsx)(f.Z,{style:{color:"#94A3B8",fontSize:10}})})]}),(0,i.jsx)("div",{style:{display:"flex"},children:(0,i.jsx)(c.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:l?"#10B981":"#B45309",background:l?"#ECFDF5":"#FEF3C7",border:"none",fontWeight:600,padding:"0 8px",lineHeight:"18px",height:18},children:l?"ว่าง":"ไม่ว่าง"})})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,i.jsx)(d.ZP,{type:"text",icon:(0,i.jsx)(m.Z,{}),onClick:e=>{e.stopPropagation(),a(t)},style:{borderRadius:12,color:"#7C3AED",background:"#F5F3FF",width:36,height:36}}),(0,i.jsx)(d.ZP,{type:"text",danger:!0,icon:(0,i.jsx)(v.Z,{}),onClick:e=>{e.stopPropagation(),r(t)},style:{borderRadius:12,background:"#FEF2F2",width:36,height:36}})]})]})})},L=e=>{let{onAdd:t,isSearch:s}=e;return(0,i.jsx)(h.Z,{image:h.Z.PRESENTED_IMAGE_SIMPLE,description:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)(z,{type:"secondary",style:{fontSize:15},children:s?"ไม่พบข้อมูลที่ค้นหา":"ยังไม่มีโต๊ะ"}),(0,i.jsx)("br",{}),!s&&(0,i.jsx)(z,{type:"secondary",style:{fontSize:13},children:"เริ่มต้นเพิ่มโต๊ะแรกของคุณได้เลย"})]}),style:{padding:"60px 20px",background:"white",borderRadius:24,margin:"24px 16px",boxShadow:"0 4px 24px rgba(0,0,0,0.04)"},children:!s&&(0,i.jsx)(d.ZP,{type:"primary",icon:(0,i.jsx)(u.Z,{}),onClick:t,size:"large",style:{background:"#7C3AED",borderRadius:12,height:48,padding:"0 32px",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.3)"},children:"เพิ่มโต๊ะใหม่"})})};function T(){let e=(0,R.useRouter)(),[t,s]=(0,l.useState)([]),[a,n]=(0,l.useState)([]),[d,o]=(0,l.useState)(""),{execute:c}=(0,E.J)(),{showLoading:h}=(0,k.x)(),{socket:b}=(0,C.s)(),{isAuthorized:g,isChecking:u}=(0,S.e)({requiredRole:"Admin"});(0,l.useEffect)(()=>{(0,F.P)()},[]),(0,l.useEffect)(()=>{let e=(0,Z.t)("pos:tables",6e5);e&&Array.isArray(e)&&s(e)},[]);let y=(0,l.useCallback)(async()=>{c(async()=>{let e=await fetch("/api/pos/tables?limit=100");if(!e.ok)throw Error("Failed to fetch tables");let t=await e.json(),i=t.data||t;Array.isArray(i)&&(s(i),(0,Z.v)("pos:tables",i))},"กำลังโหลดข้อมูลโต๊ะ...")},[c]);(0,l.useEffect)(()=>{g&&y()},[g,y]),(0,A.v)(b,{create:"tables:create",update:"tables:update",delete:"tables:delete"},s),(0,l.useEffect)(()=>{if(d){let e=d.toLowerCase();n(t.filter(t=>t.table_name.toLowerCase().includes(e)))}else n(t)},[t,d]);let j=()=>{h("กำลังเปิดหน้าจัดการโต๊ะ..."),e.push("/pos/tables/manager/add")},f=t=>{h("กำลังเปิดหน้าแก้ไขโต๊ะ..."),e.push("/pos/tables/manager/edit/".concat(t.id))},m=e=>{p.Z.confirm({title:"ยืนยันการลบโต๊ะ",content:'คุณต้องการลบโต๊ะ "'.concat(e.table_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:(0,i.jsx)(v.Z,{style:{color:"#EF4444"}}),maskClosable:!0,onOk:async()=>{await c(async()=>{let t=await (0,F.P)();if(!(await fetch("/api/pos/tables/delete/".concat(e.id),{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบโต๊ะได้");x.ZP.success('ลบโต๊ะ "'.concat(e.table_name,'" สำเร็จ'))},"กำลังลบโต๊ะ...")}})};return u?(0,i.jsx)(N.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."}):g?(0,i.jsxs)("div",{style:D.R.container,className:"jsx-70760a0aebce288b tables-page",children:[(0,i.jsx)("style",{children:D.W}),(0,i.jsx)(r(),{id:"70760a0aebce288b",children:".search-input-placeholder-white input::-webkit-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-moz-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input:-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::-ms-input-placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input::placeholder{color:rgba(255,255,255,.6)!important}.search-input-placeholder-white input{color:white!important}.table-card{cursor:pointer;-webkit-tap-highlight-color:transparent}"}),(0,i.jsx)(_,{onRefresh:y,onAdd:j,onSearch:e=>{o(e)}}),(0,i.jsx)("div",{style:{marginTop:-32,padding:"0 16px",position:"relative",zIndex:10},className:"jsx-70760a0aebce288b",children:(0,i.jsx)(P,{tables:t})}),(0,i.jsx)("div",{style:D.R.listContainer,className:"jsx-70760a0aebce288b",children:a.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:D.R.sectionTitle,className:"jsx-70760a0aebce288b",children:[(0,i.jsx)("div",{style:{width:4,height:16,background:"#7C3AED",borderRadius:2},className:"jsx-70760a0aebce288b"}),(0,i.jsx)("span",{style:{fontSize:16,fontWeight:700,color:"#1E293B"},className:"jsx-70760a0aebce288b",children:"รายการโต๊ะ"}),(0,i.jsx)("div",{style:{background:"#F5F3FF",color:"#7C3AED",padding:"2px 10px",borderRadius:12,fontSize:12,fontWeight:700,marginLeft:"auto"},className:"jsx-70760a0aebce288b",children:a.length})]}),a.map((e,t)=>(0,i.jsx)(I,{table:e,index:t,onEdit:f,onDelete:m},e.id))]}):(0,i.jsx)(L,{onAdd:j,isSearch:!!d})}),(0,i.jsx)("div",{style:{height:40},className:"jsx-70760a0aebce288b"})]}):(0,i.jsx)(N.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้ กำลังพากลับ...",tone:"danger"})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=69642)}),_N_E=e.O()}]);