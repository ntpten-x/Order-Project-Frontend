(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1075],{28997:function(e,t,a){Promise.resolve().then(a.bind(a,76901))},76901:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return er}});var r=a(57437),n=a(2265),o=a(19683),s=a(64625),i=a(38616),l=a(48651),d=a(50742),c=a(35713),f=a(62376),p=a(99376),x=a(29),y=a.n(x),m=a(96931),h=a(45235),b=a(89970),g=a(80009),u=a(10868),j=a(88589),v=a(24738),w=a(82618),k=a(13377),z=a(26349),S=a(36972),Z=a(62273),C=a(29436),_=a(26430),T=a(2651);let{Title:R,Text:I}=o.default,{useToken:B}=T.default,W={minHeight:"100vh",background:"#f8f9fc",paddingBottom:40,width:"100%",overflowX:"hidden",boxSizing:"border-box"},P={maxWidth:1200,margin:"0 auto",padding:"0 16px",position:"relative",zIndex:2,width:"100%",boxSizing:"border-box"},D=e=>({borderRadius:20,border:"none",overflow:"hidden",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",background:"#fff",boxShadow:e?"0 10px 30px rgba(124, 58, 237, 0.15)":"0 4px 20px rgba(0,0,0,0.05)",transform:e?"translateY(-4px)":"none",position:"relative"}),H=()=>(0,r.jsx)(y(),{id:"dd1d5a5b53761c68",children:"@-webkit-keyframes fadeInUp{from{opacity:0;-webkit-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeInUp{from{opacity:0;-moz-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeInUp{from{opacity:0;-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeInUp{from{opacity:0;-webkit-transform:translatey(20px);-moz-transform:translatey(20px);-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes float{0%{-webkit-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-10px);transform:translatey(-10px)}100%{-webkit-transform:translatey(0px);transform:translatey(0px)}}@-moz-keyframes float{0%{-moz-transform:translatey(0px);transform:translatey(0px)}50%{-moz-transform:translatey(-10px);transform:translatey(-10px)}100%{-moz-transform:translatey(0px);transform:translatey(0px)}}@-o-keyframes float{0%{-o-transform:translatey(0px);transform:translatey(0px)}50%{-o-transform:translatey(-10px);transform:translatey(-10px)}100%{-o-transform:translatey(0px);transform:translatey(0px)}}@keyframes float{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-10px);-moz-transform:translatey(-10px);-o-transform:translatey(-10px);transform:translatey(-10px)}100%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}}@-webkit-keyframes slideDown{from{opacity:0;-webkit-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideDown{from{opacity:0;-moz-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideDown{from{opacity:0;-o-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideDown{from{opacity:0;-webkit-transform:translatey(-10px);-moz-transform:translatey(-10px);-o-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.decorative-shape{position:absolute;background:rgba(255,255,255,.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;pointer-events:none}.shape-1{width:300px;height:300px;right:-100px;top:-100px}.shape-2{width:150px;height:150px;left:10%;bottom:20px;-webkit-animation:float 6s ease-in-out infinite;-moz-animation:float 6s ease-in-out infinite;-o-animation:float 6s ease-in-out infinite;animation:float 6s ease-in-out infinite}body,html{overflow-x:hidden!important;max-width:100vw}.action-btn{opacity:.7;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.action-btn:hover{opacity:1;-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1)}.branch-card-hover{-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1)}.branch-card-hover:hover{-webkit-transform:translatey(-6px)scale(1.02);-moz-transform:translatey(-6px)scale(1.02);-ms-transform:translatey(-6px)scale(1.02);-o-transform:translatey(-6px)scale(1.02);transform:translatey(-6px)scale(1.02)}"}),E=e=>{let{totalBranches:t,activeBranches:a}=e,{token:n}=B(),{useBreakpoint:o}=i.default,s=!o().md,l=t-a;return(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:s?"1fr 1fr":"repeat(auto-fit, minmax(240px, 1fr))",gap:s?10:20,marginTop:s?24:-20,marginBottom:s?16:20,position:"relative",zIndex:2,maxWidth:1200,marginLeft:"auto",marginRight:"auto",padding:s?"0 12px":"0 24px",justifyContent:"center",width:"100%",boxSizing:"border-box"},children:[(0,r.jsx)(m.Z,{variant:"borderless",style:{borderRadius:s?14:18,boxShadow:s?"0 4px 12px rgba(124, 58, 237, 0.1)":"0 8px 24px rgba(124, 58, 237, 0.12)",background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",border:"1px solid ".concat(n.colorBorderSecondary),transition:"all 0.3s ease",animation:"slideDown 0.5s ease-out 0.1s backwards",width:"100%",padding:s?"12px":void 0},bodyStyle:s?{padding:"16px 12px"}:void 0,hoverable:!0,children:(0,r.jsx)(h.Z,{title:(0,r.jsx)(I,{type:"secondary",style:{fontSize:s?10:13,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:1.2},children:"สาขาทั้งหมด"}),value:t,prefix:(0,r.jsx)("div",{style:{background:"linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%)",padding:s?6:10,borderRadius:s?8:12,display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.15)"},children:(0,r.jsx)(f.Z,{style:{color:"#7c3aed",fontSize:s?14:20}})}),styles:{content:{fontWeight:800,fontSize:s?22:32,color:"#7c3aed",marginTop:s?4:8,lineHeight:1.2}}})}),(0,r.jsx)(m.Z,{variant:"borderless",style:{borderRadius:s?14:18,boxShadow:s?"0 4px 12px rgba(16, 185, 129, 0.1)":"0 8px 24px rgba(16, 185, 129, 0.12)",background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",border:"1px solid ".concat(n.colorBorderSecondary),transition:"all 0.3s ease",animation:"slideDown 0.5s ease-out 0.2s backwards",width:"100%",padding:s?"12px":void 0},bodyStyle:s?{padding:"16px 12px"}:void 0,hoverable:!0,children:(0,r.jsx)(h.Z,{title:(0,r.jsx)(I,{type:"secondary",style:{fontSize:s?10:13,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:1.2},children:"เปิดให้บริการ"}),value:a,prefix:(0,r.jsx)(c.Z,{status:"processing",color:"#10b981",style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",padding:s?4:8,borderRadius:s?8:12,display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.15)",minWidth:s?20:void 0,minHeight:s?20:void 0}}),styles:{content:{color:"#10b981",fontWeight:800,fontSize:s?22:32,marginTop:s?4:8,lineHeight:1.2}}})}),l>0&&(0,r.jsx)(m.Z,{variant:"borderless",style:{borderRadius:s?14:18,boxShadow:s?"0 4px 12px rgba(107, 114, 128, 0.08)":"0 8px 24px rgba(107, 114, 128, 0.08)",background:"linear-gradient(135deg, #ffffff 0%, #f9fafb 100%)",border:"1px solid ".concat(n.colorBorderSecondary),transition:"all 0.3s ease",animation:"slideDown 0.5s ease-out 0.3s backwards",width:"100%",gridColumn:s?"1 / -1":"auto",padding:s?"12px":void 0},bodyStyle:s?{padding:"16px 12px"}:void 0,hoverable:!0,children:(0,r.jsx)(h.Z,{title:(0,r.jsx)(I,{type:"secondary",style:{fontSize:s?10:13,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:1.2},children:"ปิดปรับปรุง"}),value:l,styles:{content:{color:"#6b7280",fontWeight:800,fontSize:s?22:32,marginTop:s?4:8,lineHeight:1.2}}})})]})},L=e=>{let{branch:t,onEdit:a,onDelete:n,onSwitch:o}=e,{token:s}=B();return(0,r.jsxs)(m.Z,{hoverable:!0,className:"branch-card-hover",style:D(t.is_active),styles:{body:{padding:24},actions:{background:s.colorFillTertiary,borderTop:"1px solid ".concat(s.colorBorderSecondary)}},actions:[(0,r.jsx)(b.Z,{title:"สลับไปสาขานี้",children:(0,r.jsx)(d.ZP,{type:"text",icon:(0,r.jsx)(w.Z,{style:{color:"#3b82f6",fontSize:16}}),onClick:e=>{e.stopPropagation(),o(t)},style:{height:"100%",borderRadius:0},children:"สลับ"})},"switch"),(0,r.jsx)(b.Z,{title:"แก้ไขข้อมูล",children:(0,r.jsx)(d.ZP,{type:"text",icon:(0,r.jsx)(k.Z,{style:{color:"#8b5cf6",fontSize:16}}),onClick:e=>{e.stopPropagation(),a(t)},style:{height:"100%",borderRadius:0},children:"แก้ไข"})},"edit"),(0,r.jsx)(b.Z,{title:"ลบสาขา",children:(0,r.jsx)(d.ZP,{type:"text",danger:!0,icon:(0,r.jsx)(z.Z,{style:{fontSize:16}}),onClick:e=>{e.stopPropagation(),n(t)},style:{height:"100%",borderRadius:0},children:"ลบ"})},"delete")],children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16,marginBottom:20},children:[(0,r.jsx)("div",{style:{width:72,height:72,borderRadius:18,background:t.is_active?"linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%)":"linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:t.is_active?"2px solid #a78bfa":"2px solid #d1d5db",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:t.is_active?"0 4px 12px rgba(124, 58, 237, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.05)"},children:(0,r.jsx)(f.Z,{style:{fontSize:32,color:t.is_active?"#7c3aed":"#9ca3af",transition:"all 0.3s ease"}})}),(0,r.jsx)("div",{style:{flex:1,minWidth:0},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8,marginBottom:8},children:[(0,r.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,r.jsx)(R,{level:4,style:{margin:0,marginBottom:6,color:"#1f2937",fontWeight:700,fontSize:18,lineHeight:1.3},ellipsis:!0,children:t.branch_name}),(0,r.jsx)(g.Z,{color:"purple",style:{borderRadius:8,border:"none",padding:"2px 10px",fontSize:12,fontWeight:500,background:"#f5f3ff",color:"#7c3aed"},children:t.branch_code})]}),(0,r.jsx)(b.Z,{title:t.is_active?"เปิดดำเนินการ":"ปิดปรับปรุง",children:(0,r.jsx)("div",{style:{width:14,height:14,borderRadius:"50%",background:t.is_active?"#10b981":"#d1d5db",boxShadow:t.is_active?"0 0 0 4px rgba(16, 185, 129, 0.15)":"none",flexShrink:0,marginTop:4}})})]})})]}),(0,r.jsxs)("div",{style:{background:"linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%)",padding:16,borderRadius:14,border:"1px solid ".concat(s.colorBorderSecondary),marginBottom:16},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:10,marginBottom:10},children:[(0,r.jsx)(S.Z,{style:{color:"#6b7280",fontSize:16,marginTop:2,flexShrink:0}}),(0,r.jsx)(I,{ellipsis:!0,style:{color:"#374151",fontSize:13,flex:1,lineHeight:1.5},children:t.address||"ไม่ระบุที่อยู่"})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,r.jsx)(Z.Z,{style:{color:"#6b7280",fontSize:16,flexShrink:0}}),(0,r.jsx)(I,{style:{color:"#374151",fontSize:13,fontWeight:500},children:t.phone||"ไม่ระบุเบอร์โทร"})]})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:12,borderTop:"1px solid ".concat(s.colorBorderSecondary)},children:[(0,r.jsxs)(I,{type:"secondary",style:{fontSize:12,fontWeight:500},children:["Tax ID: ",t.tax_id||"-"]}),t.is_active?(0,r.jsx)(g.Z,{color:"success",style:{margin:0,borderRadius:8,border:"none",fontSize:11,fontWeight:600,padding:"2px 10px"},children:"เปิดใช้งาน"}):(0,r.jsx)(g.Z,{style:{margin:0,borderRadius:8,border:"none",background:"#f3f4f6",color:"#6b7280",fontSize:11,fontWeight:600,padding:"2px 10px"},children:"ปิดใช้งาน"})]})]})},O=e=>{let{searchQuery:t,onSearchChange:a,filter:n,onFilterChange:o,resultCount:s,totalCount:l}=e,{token:c}=B(),{useBreakpoint:f}=i.default,p=!f().md;return(0,r.jsx)(m.Z,{size:"small",variant:"outlined",style:{borderRadius:p?14:16,background:c.colorBgContainer,border:"1px solid ".concat(c.colorBorderSecondary),animation:"slideDown 0.4s ease-out",marginTop:0},bodyStyle:{padding:p?16:20},children:(0,r.jsxs)(u.Z,{vertical:!0,gap:p?12:16,children:[(0,r.jsx)(j.default,{size:"large",placeholder:"ค้นหาสาขา (ชื่อ, รหัส, ที่อยู่, เบอร์โทร)",prefix:(0,r.jsx)(C.Z,{style:{color:c.colorTextSecondary}}),suffix:t?(0,r.jsx)(d.ZP,{type:"text",size:"small",icon:(0,r.jsx)(_.Z,{}),onClick:()=>a(""),style:{color:c.colorTextSecondary,padding:0,width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"}}):null,value:t,onChange:e=>a(e.target.value),style:{borderRadius:12,fontSize:15}}),(0,r.jsxs)(u.Z,{justify:"space-between",align:"center",wrap:"wrap",gap:12,children:[(0,r.jsx)(v.Z,{value:n,onChange:e=>o(e),options:[{label:"ทั้งหมด",value:"all"},{label:"เปิดใช้งาน",value:"active"},{label:"ปิดใช้งาน",value:"inactive"}],style:{borderRadius:10,background:c.colorFillTertiary}}),(t||"all"!==n)&&(0,r.jsxs)(I,{type:"secondary",style:{fontSize:13},children:["พบ ",(0,r.jsx)(I,{strong:!0,style:{color:c.colorPrimary},children:s})," จาก ",l," สาขา"]})]})]})})};var U=a(3369),F=a(24675),N=a(67697),A=a(14362),M=a(1665),J=a(5447),Q=a(97235),X=a(26972),Y=a(73814),q=a(25193),G=a(37410),K=a(27623),V=a(2786),$=a(20148);let{Title:ee,Text:et}=o.default,ea="pos:branches";function er(){let e=(0,p.useRouter)(),[t,a]=(0,n.useState)([]),[o,x]=(0,n.useState)(""),[y,m]=(0,n.useState)("all"),{showLoading:h,hideLoading:b}=(0,U.x)(),{socket:g}=(0,F.s)(),{user:u,loading:j}=(0,A.a)(),{message:v,modal:w}=s.Z.useApp(),{execute:k}=(0,X.J)(),z=(0,n.useCallback)(async()=>{k(async()=>{a(await M.x.getAll())},"กำลังโหลดข้อมูลสาขา...")},[k]);(0,N.v)(g,{create:"branches:create",update:"branches:update",delete:"branches:delete"},a,e=>e.id,e=>!1!==e.is_active),(0,n.useEffect)(()=>{let e=(0,Y.t)(ea,3e5);(null==e?void 0:e.length)&&a(e)},[]),(0,n.useEffect)(()=>{t.length>0&&(0,Y.v)(ea,t)},[t]),(0,n.useEffect)(()=>{if(!j&&u){if("Admin"!==u.role){v.error("คุณไม่มีสิทธิ์เข้าถึงหน้านี้"),e.push("/");return}z()}},[u,j,e,z,v]);let S=()=>{h(),e.push("/branch/manager/add"),setTimeout(()=>b(),500)},Z=t=>{e.push("/branch/manager/edit/".concat(t.id))},C=e=>{w.confirm({title:"ยืนยันการลบสาขา",content:'คุณต้องการลบสาขา "'.concat(e.branch_name,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{let t=await (0,Q.P)();await M.x.delete(e.id,void 0,t),v.success('ลบสาขา "'.concat(e.branch_name,'" สำเร็จ')),z()}catch(e){v.error("ไม่สามารถลบสาขาได้")}}})},_=t=>{k(async()=>{let a=await (0,Q.P)();await J.O.switchBranch(t.id,a),v.success('สลับไปสาขา "'.concat(t.branch_name,'" แล้ว')),e.push("/pos")},"กำลังสลับสาขา...")},T=(0,n.useMemo)(()=>{let e=t;if("active"===y?e=e.filter(e=>e.is_active):"inactive"===y&&(e=e.filter(e=>!e.is_active)),o.trim()){let t=o.toLowerCase().trim();e=e.filter(e=>e.branch_name.toLowerCase().includes(t)||e.branch_code.toLowerCase().includes(t)||e.address&&e.address.toLowerCase().includes(t)||e.phone&&e.phone.includes(t))}return e},[t,y,o]),R=t.filter(e=>e.is_active).length,{useBreakpoint:I}=i.default,B=!I().md;return j?(0,r.jsx)("div",{style:{height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},children:(0,r.jsx)(l.Z,{size:"large"})}):(0,r.jsxs)("div",{style:W,children:[(0,r.jsx)(H,{}),(0,r.jsx)($.Z,{title:"สาขา",subtitle:"".concat(t.length," รายการ"),icon:(0,r.jsx)(f.Z,{}),actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.ZP,{onClick:z,children:"รีเฟรช"}),(0,r.jsx)(d.ZP,{type:"primary",onClick:S,children:"เพิ่มสาขา"})]})}),(0,r.jsx)("div",{style:P,children:(0,r.jsx)(q.Z,{children:(0,r.jsxs)(K.Z,{gap:B?16:12,children:[(0,r.jsx)(E,{totalBranches:t.length,activeBranches:R}),(0,r.jsx)(O,{searchQuery:o,onSearchChange:x,filter:y,onFilterChange:m,resultCount:T.length,totalCount:t.length}),(0,r.jsx)(G.Z,{title:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,r.jsx)(ee,{level:4,style:{margin:0,fontWeight:700},children:"สาขาทั้งหมด"}),o||"all"!==y?(0,r.jsx)(c.Z,{count:T.length,showZero:!0,style:{backgroundColor:"#6366f1"}}):null]}),extra:(0,r.jsxs)(et,{strong:!0,style:{color:"#6366f1",background:"#eef2ff",padding:"4px 12px",borderRadius:10},children:[T.length," / ",t.length," สาขา"]}),children:T.length>0?(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,justifyContent:"center"},children:T.map((e,t)=>(0,r.jsx)("div",{style:{animation:"fadeInUp 0.5s ease-out forwards",animationDelay:"".concat(Math.min(30*t,300),"ms"),opacity:0},children:(0,r.jsx)(L,{branch:e,onEdit:Z,onDelete:C,onSwitch:_})},e.id))}):(0,r.jsx)(V.Z,{title:o||"all"!==y?"ไม่พบสาขาที่ค้นหา":"ไม่พบข้อมูลสาขาในระบบ",description:o||"all"!==y?"ลองเปลี่ยนคำค้นหาหรือตัวกรองเพื่อดูผลลัพธ์อื่น":"กรุณาเพิ่มสาขาเพื่อให้สามารถเริ่มต้นการจัดการข้อมูลหรือเข้าสู่ระบบ POS ได้",action:o||"all"!==y?(0,r.jsx)(d.ZP,{onClick:()=>{x(""),m("all")},children:"ล้างตัวกรอง"}):(0,r.jsx)(d.ZP,{type:"primary",onClick:S,children:"เพิ่มสาขาใหม่"})})})]})})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=28997)}),_N_E=e.O()}]);