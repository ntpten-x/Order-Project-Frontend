(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1075],{28997:function(e,t,a){Promise.resolve().then(a.bind(a,76901))},76901:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ei}});var r=a(57437),n=a(2265),i=a(60283),o=a(64625),s=a(38616),l=a(48651),d=a(50742),c=a(35713),f=a(62376),p=a(99376),x=a(29),h=a.n(x),b=a(96931),y=a(45235),m=a(89970),g=a(80009),u=a(10868),v=a(88589),j=a(24738),w=a(82618),k=a(13377),z=a(26349),S=a(36972),Z=a(62273),C=a(29436),T=a(26430),_=a(2651),R=a(36799);let{Title:B,Text:I}=i.default,{useToken:W}=_.default,P={minHeight:"100vh",background:"#f8f9fc",paddingBottom:40,width:"100%",overflowX:"hidden",boxSizing:"border-box"},D={maxWidth:1200,margin:"0 auto",padding:"0 16px",position:"relative",zIndex:2,width:"100%",boxSizing:"border-box"},H=e=>({borderRadius:20,border:"none",overflow:"hidden",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",background:"#fff",boxShadow:e?"0 10px 30px rgba(124, 58, 237, 0.15)":"0 4px 20px rgba(0,0,0,0.05)",transform:e?"translateY(-4px)":"none",position:"relative"}),E=()=>(0,r.jsx)(h(),{id:"dd1d5a5b53761c68",children:"@-webkit-keyframes fadeInUp{from{opacity:0;-webkit-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeInUp{from{opacity:0;-moz-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeInUp{from{opacity:0;-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeInUp{from{opacity:0;-webkit-transform:translatey(20px);-moz-transform:translatey(20px);-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@-webkit-keyframes float{0%{-webkit-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-10px);transform:translatey(-10px)}100%{-webkit-transform:translatey(0px);transform:translatey(0px)}}@-moz-keyframes float{0%{-moz-transform:translatey(0px);transform:translatey(0px)}50%{-moz-transform:translatey(-10px);transform:translatey(-10px)}100%{-moz-transform:translatey(0px);transform:translatey(0px)}}@-o-keyframes float{0%{-o-transform:translatey(0px);transform:translatey(0px)}50%{-o-transform:translatey(-10px);transform:translatey(-10px)}100%{-o-transform:translatey(0px);transform:translatey(0px)}}@keyframes float{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-10px);-moz-transform:translatey(-10px);-o-transform:translatey(-10px);transform:translatey(-10px)}100%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}}@-webkit-keyframes slideDown{from{opacity:0;-webkit-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes slideDown{from{opacity:0;-moz-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes slideDown{from{opacity:0;-o-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes slideDown{from{opacity:0;-webkit-transform:translatey(-10px);-moz-transform:translatey(-10px);-o-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.decorative-shape{position:absolute;background:rgba(255,255,255,.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;pointer-events:none}.shape-1{width:300px;height:300px;right:-100px;top:-100px}.shape-2{width:150px;height:150px;left:10%;bottom:20px;-webkit-animation:float 6s ease-in-out infinite;-moz-animation:float 6s ease-in-out infinite;-o-animation:float 6s ease-in-out infinite;animation:float 6s ease-in-out infinite}body,html{overflow-x:hidden!important;max-width:100vw}.action-btn{opacity:.7;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.action-btn:hover{opacity:1;-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1)}.branch-card-hover{-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1)}.branch-card-hover:hover{-webkit-transform:translatey(-6px)scale(1.02);-moz-transform:translatey(-6px)scale(1.02);-ms-transform:translatey(-6px)scale(1.02);-o-transform:translatey(-6px)scale(1.02);transform:translatey(-6px)scale(1.02)}"}),F=e=>{let{totalBranches:t,activeBranches:a}=e,{token:n}=W(),{useBreakpoint:i}=s.default,o=!i().md,l=t-a;return(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:o?"1fr 1fr":"repeat(auto-fit, minmax(240px, 1fr))",gap:o?10:20,marginTop:o?24:-20,marginBottom:o?16:20,position:"relative",zIndex:2,maxWidth:1200,marginLeft:"auto",marginRight:"auto",padding:o?"0 12px":"0 24px",justifyContent:"center",width:"100%",boxSizing:"border-box"},children:[(0,r.jsx)(b.Z,{variant:"borderless",style:{borderRadius:o?14:18,boxShadow:o?"0 4px 12px rgba(124, 58, 237, 0.1)":"0 8px 24px rgba(124, 58, 237, 0.12)",background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",border:"1px solid ".concat(n.colorBorderSecondary),transition:"all 0.3s ease",animation:"slideDown 0.5s ease-out 0.1s backwards",width:"100%",padding:o?"12px":void 0},bodyStyle:o?{padding:"16px 12px"}:void 0,hoverable:!0,children:(0,r.jsx)(y.Z,{title:(0,r.jsx)(I,{type:"secondary",style:{fontSize:o?10:13,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:1.2},children:(0,R.t)("branch.stats.total")}),value:t,prefix:(0,r.jsx)("div",{style:{background:"linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%)",padding:o?6:10,borderRadius:o?8:12,display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(124, 58, 237, 0.15)"},children:(0,r.jsx)(f.Z,{style:{color:"#7c3aed",fontSize:o?14:20}})}),styles:{content:{fontWeight:800,fontSize:o?22:32,color:"#7c3aed",marginTop:o?4:8,lineHeight:1.2}}})}),(0,r.jsx)(b.Z,{variant:"borderless",style:{borderRadius:o?14:18,boxShadow:o?"0 4px 12px rgba(16, 185, 129, 0.1)":"0 8px 24px rgba(16, 185, 129, 0.12)",background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",border:"1px solid ".concat(n.colorBorderSecondary),transition:"all 0.3s ease",animation:"slideDown 0.5s ease-out 0.2s backwards",width:"100%",padding:o?"12px":void 0},bodyStyle:o?{padding:"16px 12px"}:void 0,hoverable:!0,children:(0,r.jsx)(y.Z,{title:(0,r.jsx)(I,{type:"secondary",style:{fontSize:o?10:13,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:1.2},children:(0,R.t)("branch.stats.active")}),value:a,prefix:(0,r.jsx)(c.Z,{status:"processing",color:"#10b981",style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",padding:o?4:8,borderRadius:o?8:12,display:"inline-flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.15)",minWidth:o?20:void 0,minHeight:o?20:void 0}}),styles:{content:{color:"#10b981",fontWeight:800,fontSize:o?22:32,marginTop:o?4:8,lineHeight:1.2}}})}),l>0&&(0,r.jsx)(b.Z,{variant:"borderless",style:{borderRadius:o?14:18,boxShadow:o?"0 4px 12px rgba(107, 114, 128, 0.08)":"0 8px 24px rgba(107, 114, 128, 0.08)",background:"linear-gradient(135deg, #ffffff 0%, #f9fafb 100%)",border:"1px solid ".concat(n.colorBorderSecondary),transition:"all 0.3s ease",animation:"slideDown 0.5s ease-out 0.3s backwards",width:"100%",gridColumn:o?"1 / -1":"auto",padding:o?"12px":void 0},bodyStyle:o?{padding:"16px 12px"}:void 0,hoverable:!0,children:(0,r.jsx)(y.Z,{title:(0,r.jsx)(I,{type:"secondary",style:{fontSize:o?10:13,fontWeight:500,textTransform:"uppercase",letterSpacing:"0.5px",lineHeight:1.2},children:(0,R.t)("branch.stats.inactive")}),value:l,styles:{content:{color:"#6b7280",fontWeight:800,fontSize:o?22:32,marginTop:o?4:8,lineHeight:1.2}}})})]})},L=e=>{let{branch:t,onEdit:a,onDelete:n,onSwitch:i}=e,{token:o}=W(),s=[i?(0,r.jsx)(m.Z,{title:(0,R.t)("branch.card.switchTooltip"),children:(0,r.jsx)(d.ZP,{type:"text",icon:(0,r.jsx)(w.Z,{style:{color:"#3b82f6",fontSize:16}}),onClick:e=>{e.stopPropagation(),i(t)},style:{height:"100%",borderRadius:0},children:(0,R.t)("branch.card.switch")})},"switch"):null,a?(0,r.jsx)(m.Z,{title:(0,R.t)("branch.card.editTooltip"),children:(0,r.jsx)(d.ZP,{type:"text",icon:(0,r.jsx)(k.Z,{style:{color:"#8b5cf6",fontSize:16}}),onClick:e=>{e.stopPropagation(),a(t)},style:{height:"100%",borderRadius:0},children:(0,R.t)("branch.card.edit")})},"edit"):null,n?(0,r.jsx)(m.Z,{title:(0,R.t)("branch.card.deleteTooltip"),children:(0,r.jsx)(d.ZP,{type:"text",danger:!0,icon:(0,r.jsx)(z.Z,{style:{fontSize:16}}),onClick:e=>{e.stopPropagation(),n(t)},style:{height:"100%",borderRadius:0},children:(0,R.t)("branch.card.delete")})},"delete"):null].filter(Boolean);return(0,r.jsxs)(b.Z,{hoverable:!0,className:"branch-card-hover",style:H(t.is_active),styles:{body:{padding:24},actions:{background:o.colorFillTertiary,borderTop:"1px solid ".concat(o.colorBorderSecondary)}},actions:s.length?s:void 0,children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:16,marginBottom:20},children:[(0,r.jsx)("div",{style:{width:72,height:72,borderRadius:18,background:t.is_active?"linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%)":"linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:t.is_active?"2px solid #a78bfa":"2px solid #d1d5db",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:t.is_active?"0 4px 12px rgba(124, 58, 237, 0.15)":"0 2px 8px rgba(0, 0, 0, 0.05)"},children:(0,r.jsx)(f.Z,{style:{fontSize:32,color:t.is_active?"#7c3aed":"#9ca3af",transition:"all 0.3s ease"}})}),(0,r.jsx)("div",{style:{flex:1,minWidth:0},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8,marginBottom:8},children:[(0,r.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,r.jsx)(B,{level:4,style:{margin:0,marginBottom:6,color:"#1f2937",fontWeight:700,fontSize:18,lineHeight:1.3},ellipsis:!0,children:t.branch_name}),(0,r.jsx)(g.Z,{color:"purple",style:{borderRadius:8,border:"none",padding:"2px 10px",fontSize:12,fontWeight:500,background:"#f5f3ff",color:"#7c3aed"},children:t.branch_code})]}),(0,r.jsx)(m.Z,{title:t.is_active?(0,R.t)("branch.card.active"):(0,R.t)("branch.card.inactive"),children:(0,r.jsx)("div",{style:{width:14,height:14,borderRadius:"50%",background:t.is_active?"#10b981":"#d1d5db",boxShadow:t.is_active?"0 0 0 4px rgba(16, 185, 129, 0.15)":"none",flexShrink:0,marginTop:4}})})]})})]}),(0,r.jsxs)("div",{style:{background:"linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%)",padding:16,borderRadius:14,border:"1px solid ".concat(o.colorBorderSecondary),marginBottom:16},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:10,marginBottom:10},children:[(0,r.jsx)(S.Z,{style:{color:"#6b7280",fontSize:16,marginTop:2,flexShrink:0}}),(0,r.jsx)(I,{ellipsis:!0,style:{color:"#374151",fontSize:13,flex:1,lineHeight:1.5},children:t.address||(0,R.t)("branch.card.addressFallback")})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,r.jsx)(Z.Z,{style:{color:"#6b7280",fontSize:16,flexShrink:0}}),(0,r.jsx)(I,{style:{color:"#374151",fontSize:13,fontWeight:500},children:t.phone||(0,R.t)("branch.card.phoneFallback")})]})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:12,borderTop:"1px solid ".concat(o.colorBorderSecondary)},children:[(0,r.jsxs)(I,{type:"secondary",style:{fontSize:12,fontWeight:500},children:[(0,R.t)("branch.card.taxId"),": ",t.tax_id||"-"]}),t.is_active?(0,r.jsx)(g.Z,{color:"success",style:{margin:0,borderRadius:8,border:"none",fontSize:11,fontWeight:600,padding:"2px 10px"},children:(0,R.t)("branch.stats.active")}):(0,r.jsx)(g.Z,{style:{margin:0,borderRadius:8,border:"none",background:"#f3f4f6",color:"#6b7280",fontSize:11,fontWeight:600,padding:"2px 10px"},children:(0,R.t)("branch.stats.inactive")})]})]})},U=e=>{let{searchQuery:t,onSearchChange:a,filter:n,onFilterChange:i,resultCount:o,totalCount:l}=e,{token:c}=W(),{useBreakpoint:f}=s.default,p=!f().md;return(0,r.jsx)(b.Z,{size:"small",variant:"outlined",style:{borderRadius:p?14:16,background:c.colorBgContainer,border:"1px solid ".concat(c.colorBorderSecondary),animation:"slideDown 0.4s ease-out",marginTop:0},bodyStyle:{padding:p?16:20},children:(0,r.jsxs)(u.Z,{vertical:!0,gap:p?12:16,children:[(0,r.jsx)(v.default,{size:"large",placeholder:(0,R.t)("branch.search.placeholder"),prefix:(0,r.jsx)(C.Z,{style:{color:c.colorTextSecondary}}),suffix:t?(0,r.jsx)(d.ZP,{type:"text",size:"small",icon:(0,r.jsx)(T.Z,{}),onClick:()=>a(""),style:{color:c.colorTextSecondary,padding:0,width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center"}}):null,value:t,onChange:e=>a(e.target.value),style:{borderRadius:12,fontSize:15}}),(0,r.jsxs)(u.Z,{justify:"space-between",align:"center",wrap:"wrap",gap:12,children:[(0,r.jsx)(j.Z,{value:n,onChange:e=>i(e),options:[{label:(0,R.t)("branch.search.filter.all"),value:"all"},{label:(0,R.t)("branch.search.filter.active"),value:"active"},{label:(0,R.t)("branch.search.filter.inactive"),value:"inactive"}],style:{borderRadius:10,background:c.colorFillTertiary}}),(t||"all"!==n)&&(0,r.jsx)(I,{type:"secondary",style:{fontSize:13},children:(0,R.t)("branch.search.result",{count:o,total:l})})]})]})})};var A=a(3369),N=a(24675),O=a(67697),M=a(14362),J=a(1665),Q=a(5447),X=a(97235),Y=a(26972),q=a(73814),G=a(12028),K=a(25193),V=a(37410),$=a(27623),ee=a(2786),et=a(20148);let{Title:ea,Text:er}=i.default,en="pos:branches";function ei(){let e=(0,p.useRouter)(),[t,a]=(0,n.useState)([]),[i,x]=(0,n.useState)(""),[h,b]=(0,n.useState)("all"),{showLoading:y,hideLoading:m}=(0,A.x)(),{socket:g}=(0,N.s)(),{user:u,loading:v}=(0,M.a)(),j=(null==u?void 0:u.role)==="Admin",{message:w,modal:k}=o.Z.useApp(),{execute:z}=(0,Y.J)(),S=(0,n.useCallback)(async()=>{z(async()=>{a(await J.x.getAll())},(0,R.t)("branch.loading"))},[z]);(0,O.v)(g,{create:G.b.branches.create,update:G.b.branches.update,delete:G.b.branches.delete},a,e=>e.id,e=>!1!==e.is_active),(0,n.useEffect)(()=>{let e=(0,q.t)(en,3e5);(null==e?void 0:e.length)&&a(e)},[]),(0,n.useEffect)(()=>{t.length>0&&(0,q.v)(en,t)},[t]),(0,n.useEffect)(()=>{if(!v&&u){if(!["Admin","Manager"].includes(u.role)){w.error((0,R.t)("branch.noPermission")),e.push("/");return}S()}},[u,v,e,S,w]);let Z=()=>{j&&(y(),e.push("/branch/manager/add"),setTimeout(()=>m(),500))},C=t=>{j&&e.push("/branch/manager/edit/".concat(t.id))},T=e=>{j&&k.confirm({title:(0,R.t)("branch.delete.title"),content:(0,R.t)("branch.delete.content",{name:e.branch_name}),okText:(0,R.t)("branch.delete.ok"),okType:"danger",cancelText:(0,R.t)("branch.delete.cancel"),centered:!0,onOk:async()=>{try{let t=await (0,X.P)();await J.x.delete(e.id,void 0,t),w.success((0,R.t)("branch.delete.success",{name:e.branch_name})),S()}catch(e){w.error((0,R.t)("branch.delete.error"))}}})},_=t=>{if(!j){w.error((0,R.t)("branch.noPermission"));return}z(async()=>{let a=await (0,X.P)();await Q.O.switchBranch(t.id,a),w.success((0,R.t)("branch.switch.success",{name:t.branch_name})),e.push("/pos")},(0,R.t)("branch.switch.loading"))},B=(0,n.useMemo)(()=>{let e=t;if("active"===h?e=e.filter(e=>e.is_active):"inactive"===h&&(e=e.filter(e=>!e.is_active)),i.trim()){let t=i.toLowerCase().trim();e=e.filter(e=>e.branch_name.toLowerCase().includes(t)||e.branch_code.toLowerCase().includes(t)||e.address&&e.address.toLowerCase().includes(t)||e.phone&&e.phone.includes(t))}return e},[t,h,i]),I=t.filter(e=>e.is_active).length,{useBreakpoint:W}=s.default,H=!W().md;return v?(0,r.jsx)("div",{style:{height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},children:(0,r.jsx)(l.Z,{size:"large"})}):(0,r.jsxs)("div",{style:P,children:[(0,r.jsx)(E,{}),(0,r.jsx)(et.Z,{title:(0,R.t)("branch.page.title"),subtitle:(0,R.t)("branch.page.subtitle",{count:t.length}),icon:(0,r.jsx)(f.Z,{}),actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.ZP,{onClick:S,children:(0,R.t)("branch.actions.refresh")}),j&&(0,r.jsx)(d.ZP,{type:"primary",onClick:Z,children:(0,R.t)("branch.actions.add")})]})}),(0,r.jsx)("div",{style:D,children:(0,r.jsx)(K.Z,{children:(0,r.jsxs)($.Z,{gap:H?16:12,children:[(0,r.jsx)(F,{totalBranches:t.length,activeBranches:I}),(0,r.jsx)(U,{searchQuery:i,onSearchChange:x,filter:h,onFilterChange:b,resultCount:B.length,totalCount:t.length}),(0,r.jsx)(V.Z,{title:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,r.jsx)(ea,{level:4,style:{margin:0,fontWeight:700},children:(0,R.t)("branch.section.listTitle")}),i||"all"!==h?(0,r.jsx)(c.Z,{count:B.length,showZero:!0,style:{backgroundColor:"#6366f1"}}):null]}),extra:(0,r.jsx)(er,{strong:!0,style:{color:"#6366f1",background:"#eef2ff",padding:"4px 12px",borderRadius:10},children:(0,R.t)("branch.section.countTag",{filtered:B.length,total:t.length})}),children:B.length>0?(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,justifyContent:"center"},children:B.map((e,t)=>(0,r.jsx)("div",{style:{animation:"fadeInUp 0.5s ease-out forwards",animationDelay:"".concat(Math.min(30*t,300),"ms"),opacity:0},children:(0,r.jsx)(L,{branch:e,onEdit:j?C:void 0,onDelete:j?T:void 0,onSwitch:j?_:void 0})},e.id))}):(0,r.jsx)(ee.Z,{title:(0,R.t)(i||"all"!==h?"branch.empty.filtered.title":"branch.empty.default.title"),description:i||"all"!==h?(0,R.t)("branch.empty.filtered.description"):(0,R.t)("branch.empty.default.description"),action:i||"all"!==h?(0,r.jsx)(d.ZP,{onClick:()=>{x(""),b("all")},children:(0,R.t)("branch.empty.reset")}):(0,r.jsx)(d.ZP,{type:"primary",onClick:Z,children:(0,R.t)("branch.empty.add")})})})]})})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=28997)}),_N_E=e.O()}]);