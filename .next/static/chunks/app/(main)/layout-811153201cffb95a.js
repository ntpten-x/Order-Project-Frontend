(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4095],{31214:function(t,e,n){Promise.resolve().then(n.bind(n,37571))},15327:function(t,e,n){"use strict";n.d(e,{Z:function(){return c}});var o=n(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"},r=n(55015);function i(){return(i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var c=o.forwardRef((t,e)=>o.createElement(r.Z,i({},t,{ref:e,icon:a})))},77565:function(t,e,n){"use strict";n.d(e,{Z:function(){return c}});var o=n(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"},r=n(55015);function i(){return(i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}var c=o.forwardRef((t,e)=>o.createElement(r.Z,i({},t,{ref:e,icon:a})))},37571:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return c}});var o=n(57437);n(2265);var a=n(13817),r=n(30736),i=n(42785);function c(t){let{children:e}=t;return(0,i.DR)(),(0,o.jsx)(r.Z,{children:(0,o.jsx)(a.default,{style:{minHeight:"100%",background:"transparent"},children:(0,o.jsx)(a.default.Content,{style:{background:"transparent"},children:e})})})}},71567:function(t,e,n){"use strict";n.d(e,{q:function(){return a},v:function(){return o}});let o="/api",a={AUTH:{LOGIN:"/auth/login",LOGOUT:"/auth/logout",ME:"/auth/me",CSRF:"/csrf",SWITCH_BRANCH:"/auth/switch-branch"},AUDIT:{LOGS:"/audit/logs"},POS:{PRODUCTS:"/pos/products",ORDERS:"/pos/orders",TABLES:"/pos/tables",DISCOUNTS:"/pos/discounts",DELIVERY:"/pos/delivery",PAYMENT_METHODS:"/pos/paymentMethod",PAYMENTS:"/pos/payments",CATEGORY:"/pos/category",SHIFTS:{BASE:"/pos/shifts",CURRENT:"/pos/shifts/current",OPEN:"/pos/shifts/open",CLOSE:"/pos/shifts/close"},DASHBOARD:{SALES:"/pos/dashboard/sales",TOP_ITEMS:"/pos/dashboard/top-items"},CHANNELS:{STATS:"/pos/orders/stats"},SHOP_PROFILE:"/pos/shopProfile",SALES_ORDER_ITEMS:"/pos/salesOrderItem",SALES_ORDER_DETAILS:"/pos/salesOrderDetail",PRODUCTS_UNIT:"/pos/productsUnit",PAYMENT_DETAILS:"/pos/paymentDetails",BRANCH:"/branches",ORDER_QUEUE:"/pos/queue"}}},30736:function(t,e,n){"use strict";n.d(e,{Z:function(){return i},j:function(){return c}});var o=n(57437),a=n(2265);let r=(0,a.createContext)(void 0),i=t=>{let{children:e}=t,[n,i]=(0,a.useState)([]);(0,a.useEffect)(()=>{let t=localStorage.getItem("shopping_cart");if(t)try{i(JSON.parse(t))}catch(t){console.error("Failed to parse cart from local storage",t)}},[]),(0,a.useEffect)(()=>{localStorage.setItem("shopping_cart",JSON.stringify(n))},[n]);let c=(0,a.useCallback)(t=>{i(e=>e.find(e=>e.ingredient.id===t.id)?e.map(e=>e.ingredient.id===t.id?{...e,quantity:e.quantity+1}:e):[...e,{ingredient:t,quantity:1}])},[]),s=(0,a.useCallback)(t=>{i(e=>e.filter(e=>e.ingredient.id!==t))},[]),l=(0,a.useCallback)((t,e)=>{if(e<=0){s(t);return}i(n=>n.map(n=>n.ingredient.id===t?{...n,quantity:e}:n))},[s]),u=(0,a.useCallback)((t,e)=>{i(n=>n.map(n=>n.ingredient.id===t?{...n,note:e}:n))},[]),d=(0,a.useCallback)(()=>{i([])},[]),f=n.reduce((t,e)=>t+e.quantity,0),h=a.useMemo(()=>({items:n,addToCart:c,removeFromCart:s,updateQuantity:l,updateItemNote:u,clearCart:d,itemCount:f}),[n,c,s,l,u,d,f]);return(0,o.jsx)(r.Provider,{value:h,children:e})},c=()=>{let t=(0,a.useContext)(r);if(!t)throw Error("useCart must be used within a CartProvider");return t}},2913:function(t,e,n){"use strict";function o(t,e){return({GET:"".concat(a.API_BASE_URL).concat(e),POST:"".concat(a.API_BASE_URL).concat(e),PUT:"".concat(a.API_BASE_URL).concat(e),DELETE:"".concat(a.API_BASE_URL).concat(e),PATCH:"".concat(a.API_BASE_URL).concat(e)})[t]}n.d(e,{b:function(){return o}});let a={get API_BASE_URL(){return"/api"}}},5447:function(t,e,n){"use strict";n.d(e,{O:function(){return i}});var o=n(71567),a=n(2913),r=n(98170);let i={login:async(t,e,n)=>{try{let c=(0,a.b)("POST",o.q.AUTH.LOGIN),s={"Content-Type":"application/json"};e&&(s["X-CSRF-Token"]=e),n&&(s.Cookie=n);let l=await fetch(c,{method:"POST",headers:s,credentials:"include",body:JSON.stringify(t)});if(!l.ok){var i;let t=await l.json().catch(()=>({})),e=(null==t?void 0:null===(i=t.error)||void 0===i?void 0:i.message)||t.message||t.detail||"Login failed";throw Error(e)}let u=(0,r.hH)(await l.json());return{...u.user,token:u.token}}catch(t){throw Error(t.message||"เข้าสู่ระบบไม่สำเร็จ")}},logout:async(t,e,n)=>{try{let r=(0,a.b)("POST",o.q.AUTH.LOGOUT),i={"Content-Type":"application/json"};t&&(i.Authorization="Bearer ".concat(t)),e&&(i["X-CSRF-Token"]=e),n&&(i.Cookie=n),await fetch(r,{method:"POST",headers:i,credentials:"include"})}catch(t){console.error("Logout failed",t)}},switchBranch:async(t,e,n)=>{let i=(0,a.b)("POST",o.q.AUTH.SWITCH_BRANCH),c={"Content-Type":"application/json"};e&&(c["X-CSRF-Token"]=e),n&&(c.Cookie=n);let s=await fetch(i,{method:"POST",headers:c,credentials:"include",body:JSON.stringify({branch_id:t})});if(!s.ok){let t=await s.json().catch(()=>({}));throw Error((0,r.i_)(t,"Failed to switch branch"))}return(0,r.hH)(await s.json())},getMe:async t=>{try{let e=(0,a.b)("GET",o.q.AUTH.ME),n={"Content-Type":"application/json"};t&&(n.Authorization="Bearer ".concat(t));let i=await fetch(e,{method:"GET",headers:n,credentials:"include",cache:"no-store"});if(!i.ok)throw Error("Unauthorized");return(0,r.hH)(await i.json())}catch(t){throw t}},async getCsrfToken(){try{let t=await fetch("".concat(o.v).concat(o.q.AUTH.CSRF),{credentials:"include"});if(!t.ok){let e=await t.json().catch(()=>({}));return console.error("CSRF token fetch failed:",t.status,e),""}let e=await t.json();if(e.success&&e.csrfToken||e.csrfToken)return e.csrfToken;return""}catch(t){return console.error("Failed to fetch CSRF token",t),""}}}},53286:function(t,e,n){"use strict";n.d(e,{x:function(){return S}});var o=n(20019),a=n(2913),r=n(71567),i=n(32446);let c=o.Ryn({id:o.Z_8(),username:o.Z_8()}).partial().nullable(),s=o.Ryn({id:o.Z_8(),display_name:o.Z_8()}).partial().nullable(),l=o.Ryn({id:o.Z_8(),display_name:o.Z_8(),img_url:o.Z_8().nullable(),price:o.oQ2.number(),category:s.optional()}).partial().nullable(),u=o.Ryn({id:o.Z_8().optional(),detail_name:o.Z_8(),extra_price:o.oQ2.number()}).partial(),d=o.Ryn({id:o.Z_8(),order_id:o.Z_8(),product_id:o.Z_8(),product_name:o.Z_8().optional(),quantity:o.oQ2.number(),price:o.oQ2.number(),total_price:o.oQ2.number(),discount_amount:o.oQ2.number().optional().default(0),notes:o.Z_8().nullable().optional(),status:o.jbo(i.i).optional(),product:l.optional(),details:o.IXX(u).optional()}),f=o.Ryn({id:o.Z_8(),order_no:o.Z_8(),order_type:o.jbo(i.m),table_id:o.Z_8().nullable().optional(),delivery_id:o.Z_8().nullable().optional(),delivery_code:o.Z_8().nullable().optional(),sub_total:o.oQ2.number(),discount_id:o.Z_8().nullable().optional(),discount_amount:o.oQ2.number(),vat:o.oQ2.number(),total_amount:o.oQ2.number(),received_amount:o.oQ2.number(),change_amount:o.oQ2.number(),status:o.jbo(i.i),created_by_id:o.Z_8().nullable().optional(),create_date:o.Z_8(),update_date:o.Z_8(),items:o.IXX(d).optional(),created_by:c.optional(),table:o.YjB().optional(),delivery:o.YjB().optional(),discount:o.YjB().optional(),payments:o.IXX(o.YjB()).optional()}),h=o.Ryn({data:o.IXX(f),total:o.oQ2.number(),page:o.oQ2.number(),last_page:o.oQ2.number().optional()}),p=o.Ryn({table_name:o.Z_8().nullable().optional(),delivery_name:o.Z_8().nullable().optional()}).partial().nullable(),m=o.Ryn({id:o.Z_8(),order_no:o.Z_8(),order_type:o.jbo(i.m),status:o.jbo(i.i),create_date:o.Z_8(),total_amount:o.oQ2.number(),delivery_code:o.Z_8().nullable().optional(),table_id:o.Z_8().nullable().optional(),delivery_id:o.Z_8().nullable().optional(),table:p.optional(),delivery:p.optional(),items_summary:o.IMB(o.Z_8(),o.oQ2.number()).optional(),items_count:o.oQ2.number().optional()}),y=o.Ryn({data:o.IXX(m),total:o.oQ2.number(),page:o.oQ2.number(),last_page:o.oQ2.number().optional()});var _=n(98170);let b=r.q.POS.ORDERS,g=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",n={};return e&&(n["Content-Type"]=e),t&&(n.Cookie=t),n},S={getAll:async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:e.toString(),limit:n.toString(),...r&&{status:r},...i&&{type:i},...c&&{q:c}}),l="".concat(b,"?").concat(s.toString()),u=(0,a.b)("GET",l),d=g(t,""),f=await fetch(u,{cache:"no-store",headers:d,credentials:"include"});if(!f.ok){let t=await f.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let p=await f.json();try{return h.parse((0,_.XO)(p))}catch(t){throw console.error("Zod Validation Error in ordersService.getAll:",t),t instanceof o.jmq&&console.error("Zod Issues:",t.issues),t}},getAllSummary:async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0,s=new URLSearchParams({page:e.toString(),limit:n.toString(),...r&&{status:r},...i&&{type:i},...c&&{q:c}}),l="".concat(b,"/summary?").concat(s.toString()),u=(0,a.b)("GET",l),d=g(t,""),f=await fetch(u,{cache:"no-store",headers:d,credentials:"include"});if(!f.ok){let t=await f.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let h=await f.json();try{return y.parse((0,_.XO)(h))}catch(t){throw console.error("Zod Validation Error in ordersService.getAllSummary:",t),t instanceof o.jmq&&console.error("Zod Issues:",t.issues),t}},getStats:async t=>{let e=(0,a.b)("GET",r.q.POS.CHANNELS.STATS),n=g(t,""),o=await fetch(e,{cache:"no-store",headers:n,credentials:"include"});if(!o.ok){let t=await o.text();console.error("Order Stats Backend Error:",t);let e=await JSON.parse(t).catch(()=>({}));throw Error((0,_.i_)(e,"ไม่สามารถดึงข้อมูลสถิติได้"))}let i=await o.json();return(0,_.hH)(i)},getById:async(t,e)=>{let n=(0,a.b)("GET","".concat(b,"/").concat(t)),r=g(e,""),i=await fetch(n,{cache:"no-store",headers:r,credentials:"include"});if(!i.ok){let t=await i.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}let c=await i.json();try{let t=(0,_.hH)(c);if(Array.isArray(t)){if(0===t.length)throw Error("Order not found");return f.parse(t[0])}return f.parse(t)}catch(t){throw console.error("Zod Validation Error in ordersService.getById:",t),t instanceof o.jmq&&console.error("Zod Issues:",t.issues),t}},create:async(t,e,n)=>{let o=(0,a.b)("POST","".concat(b)),r=g(e);n&&(r["X-CSRF-Token"]=n);let i=await fetch(o,{method:"POST",headers:r,credentials:"include",body:JSON.stringify(t)});if(!i.ok){let t=await i.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถสร้างออเดอร์ได้"))}return(0,_.hH)(await i.json())},update:async(t,e,n,o)=>{let r=(0,a.b)("PUT","".concat(b,"/").concat(t)),i=g(n);o&&(i["X-CSRF-Token"]=o);let c=await fetch(r,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(e)});if(!c.ok){let t=await c.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถแก้ไขออเดอร์ได้"))}return(0,_.hH)(await c.json())},delete:async(t,e,n)=>{let o=(0,a.b)("DELETE","".concat(b,"/").concat(t)),r=g(e,"");n&&(r["X-CSRF-Token"]=n);let i=await fetch(o,{method:"DELETE",headers:r,credentials:"include"});if(!i.ok){let t=await i.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถลบออเดอร์ได้"))}},updateItemStatus:async(t,e,n,o)=>{let r=(0,a.b)("PATCH","".concat(b,"/items/").concat(t,"/status")),i=g(n);o&&(i["X-CSRF-Token"]=o);let c=await fetch(r,{method:"PATCH",headers:i,credentials:"include",body:JSON.stringify({status:e})});if(!c.ok){let t=await c.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถอัปเดตสถานะรายการได้"))}},getItems:async(t,e)=>{let n=(0,a.b)("GET","".concat(b,"/items").concat(t?"?status=".concat(t):"")),o=g(e,""),r=await fetch(n,{cache:"no-store",headers:o,credentials:"include"});if(!r.ok){let t=await r.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถดึงข้อมูลรายการได้"))}let i=(0,_.hH)(await r.json());if(Array.isArray(i))return i;if(i&&"object"==typeof i&&"data"in i){let t=i.data;if(Array.isArray(t))return t}return i},addItem:async(t,e,n,o)=>{let r=(0,a.b)("POST","".concat(b,"/").concat(t,"/items")),i=g(n);o&&(i["X-CSRF-Token"]=o);let c=await fetch(r,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(e)});if(!c.ok){let t=await c.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถเพิ่มรายการได้"))}return(0,_.hH)(await c.json())},updateItem:async(t,e,n,o)=>{let r=(0,a.b)("PUT","".concat(b,"/items/").concat(t)),i=g(n,"application/json");o&&(i["X-CSRF-Token"]=o);let c=await fetch(r,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(e)});if(!c.ok){let t=await c.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถแก้ไขรายการได้"))}return(0,_.hH)(await c.json())},deleteItem:async(t,e,n)=>{let o=(0,a.b)("DELETE","".concat(b,"/items/").concat(t)),r=g(e,"");n&&(r["X-CSRF-Token"]=n);let i=await fetch(o,{method:"DELETE",headers:r,credentials:"include"});if(!i.ok){let t=await i.json().catch(()=>({}));throw Error((0,_.i_)(t,"ไม่สามารถลบรายการได้"))}return(0,_.hH)(await i.json())},updateStatus:async(t,e,n)=>{let o={"Content-Type":"application/json"};n&&(o["X-CSRF-Token"]=n);let r=(0,a.b)("PUT","".concat(b,"/").concat(t));if(!(await fetch(r,{method:"PUT",headers:o,body:JSON.stringify({status:e}),credentials:"include"})).ok)throw Error("Failed to update status")}}},32446:function(t,e,n){"use strict";var o,a,r,i;n.d(e,{i:function(){return a},m:function(){return o}}),(r=o||(o={})).DineIn="DineIn",r.TakeAway="TakeAway",r.Delivery="Delivery",(i=a||(a={})).Pending="Pending",i.Cooking="Cooking",i.Served="Served",i.WaitingForPayment="WaitingForPayment",i.Paid="Paid",i.Completed="Completed",i.Cancelled="Cancelled"},98170:function(t,e,n){"use strict";function o(t){return!!t&&"object"==typeof t}function a(t){return t&&"object"==typeof t&&"success"in t&&!0===t.success&&"data"in t?t.data:t}function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Request failed";if("string"==typeof t)return t;if(!o(t))return e;if(!1===t.success){let e=t.error;if(o(e)&&"string"==typeof e.message&&e.message.trim())return e.message}if("error"in t){let e=t.error;if("string"==typeof e&&e.trim())return e;if(o(e)&&"string"==typeof e.message&&e.message.trim())return e.message}return"string"==typeof t.message&&t.message.trim()?t.message:e}function i(t){if(t&&"object"==typeof t&&"success"in t&&!0===t.success&&Array.isArray(t.data)){var e,n,o,a;let r="number"==typeof(null===(e=t.meta)||void 0===e?void 0:e.total)?t.meta.total:t.data.length,i="number"==typeof(null===(n=t.meta)||void 0===n?void 0:n.page)?t.meta.page:1,c="number"==typeof(null===(o=t.meta)||void 0===o?void 0:o.limit)?t.meta.limit:50,s="number"==typeof(null===(a=t.meta)||void 0===a?void 0:a.totalPages)?t.meta.totalPages:Math.max(Math.ceil(r/Math.max(c,1)),1);return{data:t.data,total:r,page:i,last_page:s}}return t}n.d(e,{XO:function(){return i},hH:function(){return a},i_:function(){return r}})},29827:function(t,e,n){"use strict";n.d(e,{NL:function(){return i},aH:function(){return c}});var o=n(2265),a=n(57437),r=o.createContext(void 0),i=t=>{let e=o.useContext(r);if(t)return t;if(!e)throw Error("No QueryClient set, use QueryClientProvider to set one");return e},c=t=>{let{client:e,children:n}=t;return o.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),(0,a.jsx)(r.Provider,{value:e,children:n})}}},function(t){t.O(0,[253,19,3817,2785,2971,2117,1744],function(){return t(t.s=31214)}),_N_E=t.O()}]);