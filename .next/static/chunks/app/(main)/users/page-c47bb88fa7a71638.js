(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9386],{90880:function(e,t,r){Promise.resolve().then(r.bind(r,23568))},81680:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"},s=r(55015);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i=n.forwardRef((e,t)=>n.createElement(s.Z,o({},e,{ref:t,icon:a})))},5540:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},s=r(55015);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i=n.forwardRef((e,t)=>n.createElement(s.Z,o({},e,{ref:t,icon:a})))},89245:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},s=r(55015);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i=n.forwardRef((e,t)=>n.createElement(s.Z,o({},e,{ref:t,icon:a})))},23568:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return N}});var n=r(57437),a=r(2265),s=r(39486),o=r(38616),i=r(34029),c=r(53743),l=r(50742),d=r(88589),u=r(50337),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"},f=r(55015);function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let h=a.forwardRef((e,t)=>a.createElement(f.Z,g({},e,{ref:t,icon:p})));var m=r(29436),b=r(89245),x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let v=a.forwardRef((e,t)=>a.createElement(f.Z,y({},e,{ref:t,icon:x})));var j=r(81680),F=r(5540),k=r(13377),w=r(26349),C=r(99376),S=r(24675),D=r(26972),E=r(3369),B=r(14362),z=r(48651),O=r(5447),A=r(92719),Z=r(12028),_=r(25193),M=r(37410),I=r(20148),R=r(12093);let{Text:P}=s.default,{useBreakpoint:T}=o.default,W={Admin:{color:"#D97706",bg:"#FFFBEB",emoji:"\uD83D\uDC51"},Manager:{color:"#DB2777",bg:"#FDF2F8",emoji:"⭐"},Cashier:{color:"#2563EB",bg:"#EFF6FF",emoji:"\uD83D\uDCB3"},Chef:{color:"#059669",bg:"#ECFDF5",emoji:"\uD83D\uDC68‍\uD83C\uDF73"},Waiter:{color:"#7C3AED",bg:"#F5F3FF",emoji:"\uD83C\uDF7D️"}},U={color:"#64748B",bg:"#F1F5F9",emoji:"\uD83D\uDC64"};function N(){let e=(0,C.useRouter)(),t=T(),r=!t.md,[s,o]=(0,a.useState)([]),{socket:p}=(0,S.s)(),{execute:f}=(0,D.J)(),{showLoading:g,hideLoading:x}=(0,E.x)(),{user:y,loading:N}=(0,B.a)(),[L,H]=(0,a.useState)(""),[J,q]=(0,a.useState)(""),[V,Y]=(0,a.useState)(!1),Q=(0,R.c)(J,300);(0,a.useEffect)(()=>{(async()=>{H(await O.O.getCsrfToken())})()},[]),(0,a.useEffect)(()=>{if(!N&&(!y||!["Admin","Manager"].includes(y.role))){let t=setTimeout(()=>{i.ZP.error("คุณไม่มีสิทธิ์เข้าถึงหน้านี้"),e.push("/")},1e3);return()=>clearTimeout(t)}},[y,N,e]);let X=(0,a.useCallback)(async()=>{f(async()=>{o(await A.W.getAllUsers())},"กำลังโหลดข้อมูลผู้ใช้...")},[f]);(0,a.useEffect)(()=>{N||(null==y?void 0:y.role)!=="Admin"&&(null==y?void 0:y.role)!=="Manager"||X()},[N,y,X]),(0,a.useEffect)(()=>{if(p)return p.on(Z.b.users.create,e=>{o(t=>[...t,e]),i.ZP.success("ผู้ใช้ใหม่ ".concat(e.name||e.username," ถูกเพิ่มแล้ว"))}),p.on(Z.b.users.update,e=>{o(t=>t.map(t=>t.id===e.id?e:t))}),p.on(Z.b.users.delete,e=>{let{id:t}=e;o(e=>e.filter(e=>e.id!==t))}),p.on(Z.b.users.status,e=>{let{id:t,is_active:r}=e;o(e=>e.map(e=>e.id===t?{...e,is_active:r}:e))}),()=>{p.off(Z.b.users.create),p.off(Z.b.users.update),p.off(Z.b.users.delete),p.off(Z.b.users.status)}},[p]);let G=(0,a.useMemo)(()=>{if(!Q)return s;let e=Q.toLowerCase();return s.filter(t=>{var r,n,a;return(t.name||"").toLowerCase().includes(e)||t.username.toLowerCase().includes(e)||((null===(r=t.roles)||void 0===r?void 0:r.display_name)||(null===(n=t.roles)||void 0===n?void 0:n.roles_name)||"").toLowerCase().includes(e)||((null===(a=t.branch)||void 0===a?void 0:a.branch_name)||"").toLowerCase().includes(e)})},[s,Q]),K=(0,a.useMemo)(()=>{let e=s.filter(e=>e.is_active).length,t=s.filter(e=>{var t;return(null===(t=e.roles)||void 0===t?void 0:t.roles_name)==="Admin"}).length;return{total:s.length,active:e,admin:t}},[s]),$=()=>{g(),e.push("/users/manage/add"),setTimeout(()=>x(),1e3)},ee=t=>{e.push("/users/manage/edit/".concat(t.id))},et=e=>{c.Z.confirm({title:"ยืนยันการลบผู้ใช้",content:'คุณต้องการลบผู้ใช้ "'.concat(e.name||e.username,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{await f(async()=>{await A.W.deleteUser(e.id,void 0,L),i.ZP.success('ลบผู้ใช้ "'.concat(e.name||e.username,'" สำเร็จ'))},"กำลังลบผู้ใช้งาน...")}})},er=e=>{let t=new Date,r=new Date(e),n=Math.floor((t.getTime()-r.getTime())/6e4);if(n<1)return"เมื่อกี้";if(n<60)return"".concat(n," นาทีที่แล้ว");let a=Math.floor(n/60);if(a<24)return"".concat(a," ชม.ที่แล้ว");let s=Math.floor(a/24);return s<30?"".concat(s," วันที่แล้ว"):r.toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"2-digit"})};if(N||!y||!["Admin","Manager"].includes(y.role))return(0,n.jsx)("div",{style:{height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#F8FAFC"},children:(0,n.jsx)(z.Z,{size:"large"})});let en=0===s.length;return(0,n.jsxs)("div",{style:{minHeight:"100vh",background:"#F8FAFC",paddingBottom:100},children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n  @keyframes fadeInUp {\n    from { opacity: 0; transform: translateY(12px); }\n    to { opacity: 1; transform: translateY(0); }\n  }\n  @keyframes pulse-dot {\n    0%, 100% { opacity: 1; transform: scale(1); }\n    50% { opacity: 0.5; transform: scale(0.8); }\n  }\n\n  .users-page-card {\n    animation: fadeInUp 0.35s cubic-bezier(0.4, 0, 0.2, 1) both;\n    cursor: pointer;\n    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n  .users-page-card:hover {\n    transform: translateY(-3px);\n    box-shadow: 0 12px 32px rgba(15,23,42,0.10) !important;\n  }\n  .users-page-card:active {\n    transform: scale(0.98);\n  }\n\n  .users-search-input .ant-input {\n    border: none !important;\n    box-shadow: none !important;\n    background: transparent !important;\n  }\n  .users-search-input .ant-input-affix-wrapper {\n    border: none !important;\n    box-shadow: none !important;\n    background: transparent !important;\n  }\n\n  .users-refresh-btn {\n    transition: all 0.3s ease;\n  }\n  .users-refresh-btn:hover {\n    background: rgba(59,130,246,0.08) !important;\n  }\n\n  .users-action-btn {\n    transition: all 0.2s ease;\n  }\n  .users-action-btn:hover {\n    transform: scale(1.05);\n  }\n\n  @media (hover: none) and (pointer: coarse) {\n    .users-page-card:active {\n      transform: scale(0.97);\n      opacity: 0.9;\n    }\n  }\n"}}),(0,n.jsx)(I.Z,{title:"จัดการผู้ใช้",subtitle:"ทั้งหมด ".concat(s.length," คน"),icon:(0,n.jsx)(h,{style:{fontSize:20}}),actions:(0,n.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,n.jsx)("button",{className:"users-refresh-btn",onClick:()=>Y(!V),style:{width:40,height:40,borderRadius:12,border:"1px solid #E2E8F0",background:"#fff",display:"grid",placeItems:"center",cursor:"pointer",color:V?"#3B82F6":"#64748B"},children:(0,n.jsx)(m.Z,{style:{fontSize:18}})}),(0,n.jsx)("button",{className:"users-refresh-btn",onClick:X,style:{width:40,height:40,borderRadius:12,border:"1px solid #E2E8F0",background:"#fff",display:"grid",placeItems:"center",cursor:"pointer",color:"#64748B"},children:(0,n.jsx)(b.Z,{style:{fontSize:18}})}),(0,n.jsx)(l.ZP,{type:"primary",icon:(0,n.jsx)(v,{}),onClick:$,style:{height:40,borderRadius:12,fontWeight:600,background:"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)",border:"none",boxShadow:"0 4px 12px rgba(59,130,246,0.25)"},children:!r&&"เพิ่มผู้ใช้"})]})}),V&&(0,n.jsx)("div",{style:{maxWidth:1200,margin:"0 auto",padding:r?"12px 16px 0":"16px 24px 0"},children:(0,n.jsx)("div",{className:"users-search-input",style:{background:"#fff",borderRadius:14,border:"1px solid #E2E8F0",boxShadow:"0 2px 8px rgba(15,23,42,0.04)",overflow:"hidden"},children:(0,n.jsx)(d.default,{prefix:(0,n.jsx)(m.Z,{style:{color:"#94A3B8",fontSize:16}}),placeholder:"ค้นหาผู้ใช้ตามชื่อ, username, บทบาท หรือสาขา...",value:J,onChange:e=>q(e.target.value),allowClear:!0,style:{padding:"12px 16px",fontSize:15,border:"none",background:"transparent"}})})}),(0,n.jsxs)(_.Z,{children:[(0,n.jsx)("div",{style:{display:"flex",gap:10,marginTop:16,marginBottom:20,overflowX:"auto",WebkitOverflowScrolling:"touch",scrollbarWidth:"none",msOverflowStyle:"none",paddingBottom:4},children:[{label:"ทั้งหมด",count:K.total,color:"#3B82F6",bg:"#EFF6FF",emoji:"\uD83D\uDC65"},{label:"ใช้งาน",count:K.active,color:"#10B981",bg:"#ECFDF5",emoji:"✅"},{label:"แอดมิน",count:K.admin,color:"#D97706",bg:"#FFFBEB",emoji:"\uD83D\uDC51"}].map(e=>(0,n.jsxs)("div",{style:{flex:"1 0 0",minWidth:100,background:e.bg,borderRadius:14,padding:r?"12px 10px":"14px 16px",textAlign:"center",border:"1px solid ".concat(e.color,"15"),boxShadow:"0 2px 8px rgba(15,23,42,0.04)"},children:[(0,n.jsx)("div",{style:{fontSize:r?18:22,marginBottom:2},children:e.emoji}),(0,n.jsx)("div",{style:{fontSize:r?20:24,fontWeight:800,color:e.color,lineHeight:1.2},children:e.count}),(0,n.jsx)("div",{style:{fontSize:11,color:"#64748B",fontWeight:600,marginTop:2},children:e.label})]},e.label))}),(0,n.jsx)(M.Z,{children:en?(0,n.jsx)("div",{style:{padding:20},children:[1,2,3].map(e=>(0,n.jsx)("div",{style:{background:"#fff",borderRadius:16,padding:20,marginBottom:12,border:"1px solid #F1F5F9"},children:(0,n.jsx)(u.Z,{active:!0,avatar:!0,paragraph:{rows:2}})},e))}):0===G.length?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"60px 20px"},children:[(0,n.jsx)("div",{style:{fontSize:56,marginBottom:16,opacity:.7},children:"\uD83D\uDC64"}),(0,n.jsx)(P,{strong:!0,style:{fontSize:17,display:"block",color:"#1E293B",marginBottom:6},children:J?"ไม่พบผู้ใช้ที่ค้นหา":"ยังไม่มีผู้ใช้ในระบบ"}),(0,n.jsx)(P,{style:{color:"#94A3B8",fontSize:14},children:J?"ลองค้นหาด้วยคำอื่น":'กดปุ่ม "เพิ่มผู้ใช้" เพื่อเริ่มต้น'}),!J&&(0,n.jsx)("div",{style:{marginTop:20},children:(0,n.jsx)(l.ZP,{type:"primary",icon:(0,n.jsx)(v,{}),onClick:$,style:{borderRadius:12,fontWeight:600,height:44,background:"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)",border:"none"},children:"เพิ่มผู้ใช้คนแรก"})})]}):(0,n.jsx)("div",{style:{display:"grid",gridTemplateColumns:r?"1fr":t.lg?"repeat(3, 1fr)":"repeat(2, 1fr)",gap:12},children:G.map((e,t)=>{var r,a;let s=(null===(r=e.roles)||void 0===r?void 0:r.roles_name)||"",o=W[s]||U,i=e.name||e.username,c=e.is_active||!1;return(0,n.jsxs)("div",{className:"users-page-card",style:{background:"#fff",borderRadius:18,border:"1px solid ".concat(c?"#D1FAE520":"#E2E8F0"),boxShadow:"0 2px 12px rgba(15,23,42,0.04)",overflow:"hidden",animationDelay:"".concat(.04*t,"s")},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"16px 16px 12px"},children:[(0,n.jsxs)("div",{style:{position:"relative",flexShrink:0},children:[(0,n.jsx)("div",{style:{width:48,height:48,borderRadius:16,background:o.bg,display:"grid",placeItems:"center",fontSize:22,border:"2px solid ".concat(o.color,"30")},children:o.emoji}),(0,n.jsx)("div",{style:{position:"absolute",bottom:-2,right:-2,width:14,height:14,borderRadius:"50%",background:c?"#10B981":"#CBD5E1",border:"2.5px solid #fff",boxShadow:c?"0 0 0 3px rgba(16,185,129,0.2)":"none"},className:c?"users-status-dot":""})]}),(0,n.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[(0,n.jsx)(P,{strong:!0,style:{fontSize:15,color:"#1E293B",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:i}),(0,n.jsx)("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:20,background:o.bg,color:o.color,fontSize:11,fontWeight:700,whiteSpace:"nowrap",flexShrink:0},children:(null===(a=e.roles)||void 0===a?void 0:a.display_name)||s||"N/A"})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[(0,n.jsxs)(P,{style:{fontSize:12,color:"#94A3B8"},children:["@",e.username]}),e.branch&&(0,n.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:3,padding:"1px 7px",borderRadius:8,background:"#F0F9FF",color:"#0369A1",fontSize:11,fontWeight:600},children:[(0,n.jsx)(j.Z,{style:{fontSize:10}}),e.branch.branch_name]})]})]}),(0,n.jsx)("span",{style:{padding:"4px 10px",borderRadius:20,background:c?"#ECFDF5":"#F1F5F9",color:c?"#059669":"#94A3B8",fontSize:11,fontWeight:700,whiteSpace:"nowrap",flexShrink:0},children:c?"\uD83D\uDFE2 ออนไลน์":"⚪ ออฟไลน์"})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 16px",background:"#FAFBFC",borderTop:"1px solid #F1F5F9"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,color:"#94A3B8",fontSize:12},children:[(0,n.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4,whiteSpace:"nowrap"},children:[(0,n.jsx)(F.Z,{style:{fontSize:12}}),e.last_login_at?er(e.last_login_at):"ยังไม่เคยเข้า"]}),void 0!==e.is_use&&(0,n.jsx)("span",{style:{display:"inline-flex",alignItems:"center",gap:3,padding:"1px 7px",borderRadius:8,background:e.is_use?"#ECFDF5":"#FEF2F2",color:e.is_use?"#059669":"#DC2626",fontSize:11,fontWeight:600,whiteSpace:"nowrap"},children:e.is_use?"✓ ใช้งานได้":"✕ ระงับ"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:6},children:[(0,n.jsx)("button",{className:"users-action-btn",onClick:t=>{t.stopPropagation(),ee(e)},style:{width:34,height:34,borderRadius:10,border:"1px solid #E2E8F0",background:"#fff",display:"grid",placeItems:"center",cursor:"pointer",color:"#3B82F6"},"aria-label":"แก้ไข ".concat(i),children:(0,n.jsx)(k.Z,{style:{fontSize:14}})}),(0,n.jsx)("button",{className:"users-action-btn",onClick:t=>{t.stopPropagation(),et(e)},style:{width:34,height:34,borderRadius:10,border:"1px solid #FEE2E2",background:"#FEF2F2",display:"grid",placeItems:"center",cursor:"pointer",color:"#EF4444"},"aria-label":"ลบ ".concat(i),children:(0,n.jsx)(w.Z,{style:{fontSize:14}})})]})]})]},e.id)})})})]})]})}},46252:function(e,t,r){"use strict";r.d(t,{J:function(){return c},SocketProvider:function(){return l}});var n=r(57437),a=r(2265),s=r(68680),o=r(34029),i=r(14362);let c=(0,a.createContext)({socket:null,isConnected:!1}),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),p=(0,a.useRef)(!1),{user:f}=(0,i.a)();return(0,a.useEffect)(()=>{var e;if(!f){r&&(r.disconnect(),l(null),u(!1));return}let t=(null===(e=f.branch)||void 0===e?void 0:e.id)||f.branch_id||null,n=(0,s.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:{userId:f.id,branchId:t},reconnection:!0,reconnectionAttempts:5,reconnectionDelay:800,reconnectionDelayMax:8e3});return n.on("connect",()=>{console.log("Socket Connected:",n.id),u(!0),p.current=!1,o.ZP.success({content:"เชื่อมต่อเรียลไทม์แล้ว",key:"socket-status",duration:1.5})}),n.on("disconnect",()=>{console.log("Socket Disconnected"),u(!1),p.current||(p.current=!0,o.ZP.warning({content:"การเชื่อมต่อเรียลไทม์หลุด กำลังพยายามเชื่อมต่อใหม่...",key:"socket-status",duration:2}))}),n.io.on("reconnect_attempt",e=>{console.log("Socket reconnect attempt",e),u(!1)}),n.io.on("reconnect_failed",()=>{console.log("Socket reconnect failed"),o.ZP.error({content:"เชื่อมต่อเรียลไทม์ไม่สำเร็จ",key:"socket-status",duration:2})}),l(n),()=>{n.disconnect()}},[null==f?void 0:f.id]),(0,n.jsx)(c.Provider,{value:{socket:r,isConnected:d},children:t})}},26972:function(e,t,r){"use strict";r.d(t,{J:function(){return o}});var n=r(2265),a=r(53743),s=r(3369);let o=()=>{let{showLoading:e,hideLoading:t}=(0,s.x)();return{execute:(0,n.useCallback)(async function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"กำลังดำเนินการ...",s=(arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"เกิดข้อผิดพลาด");try{return e(n,"async"),await r()}catch(t){console.error("Async action error:",t);let e=s;if("string"==typeof t)e=t;else if(t instanceof Error)e=t.message;else if("object"==typeof t&&null!==t){var o,i,c,l;e=null!==(l=null!==(c=null===(i=t.response)||void 0===i?void 0:null===(o=i.data)||void 0===o?void 0:o.message)&&void 0!==c?c:t.message)&&void 0!==l?l:(()=>{try{return JSON.stringify(t)}catch(e){return"เกิดข้อผิดพลาดที่ไม่ทราบสาเหตุ (Unknown Error)"}})()}a.Z.error({title:"ข้อผิดพลาด",content:e});return}finally{t("async")}},[e,t])}}},24675:function(e,t,r){"use strict";r.d(t,{s:function(){return s}});var n=r(2265),a=r(46252);let s=()=>(0,n.useContext)(a.J)},12028:function(e,t,r){"use strict";r.d(t,{b:function(){return n},g:function(){return a}});let n={system:{announcement:"system:announcement"},users:{create:"users:create",update:"users:update",delete:"users:delete",status:"users:update-status"},roles:{create:"roles:create",update:"roles:update",delete:"roles:delete"},branches:{create:"branches:create",update:"branches:update",delete:"branches:delete"},products:{create:"products:create",update:"products:update",delete:"products:delete"},productsUnit:{create:"productsUnit:create",update:"productsUnit:update",delete:"productsUnit:delete"},categories:{create:"category:create",update:"category:update",delete:"category:delete"},tables:{create:"tables:create",update:"tables:update",delete:"tables:delete"},orders:{create:"orders:create",update:"orders:update",delete:"orders:delete"},payments:{create:"payments:create",update:"payments:update",delete:"payments:delete"},discounts:{create:"discounts:create",update:"discounts:update",delete:"discounts:delete"},delivery:{create:"delivery:create",update:"delivery:update",delete:"delivery:delete"},shifts:{update:"shifts:update"},orderQueue:{added:"order-queue:added",updated:"order-queue:updated",removed:"order-queue:removed",reordered:"order-queue:reordered"},ingredients:{create:"ingredients:create",update:"ingredients:update",delete:"ingredients:delete"},ingredientsUnit:{create:"ingredientsUnit:create",update:"ingredientsUnit:update",delete:"ingredientsUnit:delete"},stock:{update:"stock:update"},stockOrders:{create:"stock:orders:create",update:"stock:orders:update",status:"stock:orders:status",delete:"stock:orders:delete",detailUpdate:"stock:orders:detail:update"},paymentAccounts:{create:"payment-accounts:create",update:"payment-accounts:update",delete:"payment-accounts:delete"},paymentMethods:{create:"paymentMethod:create",update:"paymentMethod:update",delete:"paymentMethod:delete"},shopProfile:{update:"shopProfile:update"},salesOrderItem:{create:"salesOrderItem:create",update:"salesOrderItem:update",delete:"salesOrderItem:delete"},salesOrderDetail:{create:"salesOrderDetail:create",update:"salesOrderDetail:update",delete:"salesOrderDetail:delete"}},a={stockOrdersUpdated:"orders_updated"}},12093:function(e,t,r){"use strict";r.d(t,{c:function(){return a}});var n=r(2265);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,[r,a]=(0,n.useState)(e);return(0,n.useEffect)(()=>{let r=setTimeout(()=>{a(e)},t);return()=>{clearTimeout(r)}},[e,t]),r}}},function(e){e.O(0,[253,1522,3418,742,9486,4252,3916,8651,6931,4159,3831,2224,3248,2401,8879,8589,19,4487,9385,4737,2971,2117,1744],function(){return e(e.s=90880)}),_N_E=e.O()}]);