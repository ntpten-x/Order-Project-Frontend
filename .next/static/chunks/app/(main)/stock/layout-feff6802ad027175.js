(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5277],{78923:function(e,t,n){Promise.resolve().then(n.bind(n,95597))},95597:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var s=n(57437),i=n(2265),a=n(13817),o=n(99376),l=n(40740),r=n(35631),c=n(50742),d=n(5311),u=n(52539),h=n(38434),p=n(84588),k=n(1915),x=n(15424),f=n(39760),m=n(14362),y=n(24675),b=n(76155),j=n(9771),g=()=>{let e=(0,o.useRouter)(),t=(0,o.usePathname)(),{user:n}=(0,m.a)(),[a,g]=(0,i.useState)(0),[v,Z]=(0,i.useState)(!1),{socket:w}=(0,y.s)(),C=(0,i.useCallback)(async()=>{try{let e=new URLSearchParams;e.append("status","pending"),e.append("t",Date.now().toString());let t=await b.x.getAllOrders(void 0,e);g(t.total)}catch(e){}},[]);(0,i.useEffect)(()=>{n&&C()},[n,C]),(0,i.useEffect)(()=>{if(!w)return;let e=e=>{((null==e?void 0:e.action)==="create"||(null==e?void 0:e.action)==="update_status")&&setTimeout(C,500)};w.on("orders_updated",e);let t=()=>C();return window.addEventListener("focus",t),()=>{w.off("orders_updated",e),window.removeEventListener("focus",t)}},[w,C]);let _=[{key:"home",label:"หน้าแรก",icon:(0,s.jsx)(d.Z,{}),path:"/"},{key:"shopping",label:"สั่งซื้อ",icon:(0,s.jsx)(u.Z,{}),path:"/stock"},{key:"orders",label:"รายการ",icon:(0,s.jsx)(h.Z,{}),path:"/stock/items"},{key:"history",label:"ประวัติ",icon:(0,s.jsx)(p.Z,{}),path:"/stock/history"},...(null==n?void 0:n.role)==="Admin"?[{key:"ingredients",label:"วัตถุดิบ",icon:(0,s.jsx)(k.Z,{}),path:"/stock/ingredients"},{key:"ingredientsUnit",label:"หน่วย",icon:(0,s.jsx)(x.Z,{}),path:"/stock/ingredientsUnit"}]:[]],E=e=>"/"===e?"/"===t:t===e||t.startsWith(e+"/"),S=_.slice(0,4),I=_.slice(4),P=I.some(e=>E(e.path));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Z,{maxWidth:560,items:[...S.map(t=>({key:t.key,label:t.label,icon:t.icon,onClick:()=>e.push(t.path),active:E(t.path),badgeDot:"orders"===t.key&&a>0})),...I.length?[{key:"more",label:"เพิ่มเติม",icon:(0,s.jsx)(f.Z,{}),onClick:()=>Z(!0),active:P}]:[]]}),(0,s.jsx)(l.Z,{open:v,onClose:()=>Z(!1),placement:"bottom",height:"auto",title:"เมนูเพิ่มเติม",zIndex:2e3,children:(0,s.jsx)("div",{style:{paddingBottom:"calc(12px + env(safe-area-inset-bottom))"},children:(0,s.jsx)(r.Z,{dataSource:I,renderItem:t=>(0,s.jsx)(r.Z.Item,{style:{paddingInline:0},children:(0,s.jsx)(c.ZP,{type:"text",block:!0,icon:t.icon,style:{height:48,justifyContent:"flex-start"},onClick:()=>{e.push(t.path),Z(!1)},children:t.label})})})})})]})},v=n(30736);function Z(e){let{children:t}=e;return(0,s.jsx)(v.Z,{children:(0,s.jsxs)(a.default,{style:{minHeight:"100%",background:"transparent"},children:[(0,s.jsx)(a.default.Content,{style:{background:"transparent"},children:t}),(0,s.jsx)(g,{})]})})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=78923)}),_N_E=e.O()}]);