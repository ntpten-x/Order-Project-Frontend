(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8423],{32387:function(e,n,a){Promise.resolve().then(a.bind(a,81545))},81545:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return C}});var t=a(57437),i=a(2265),r=a(19878),s=a(34029),o=a(53743),l=a(50742),c=a(48651),d=a(88589),p=a(66487),g=a(99376),m=a(19683),u=a(78355);let{Text:f,Title:h}=m.default,x={paddingBottom:100,backgroundColor:"#f8f9fc",minHeight:"100vh"},y={display:"flex",gap:12,marginTop:24,paddingTop:20,borderTop:"1px solid #f0f0f0"},k=()=>(0,t.jsx)("style",{children:"\n        @keyframes fadeSlideIn {\n            from {\n                opacity: 0;\n                transform: translateY(12px);\n            }\n            to {\n                opacity: 1;\n                transform: translateY(0);\n            }\n        }\n        \n        .manage-form-card {\n            animation: fadeSlideIn 0.4s ease both;\n        }\n        \n        .manage-page .ant-input,\n        .manage-page .ant-input-number,\n        .manage-page .ant-select-selector,\n        .manage-page .ant-input-affix-wrapper {\n            border-radius: 12px !important;\n            border: 2px solid #f0f0f0 !important;\n            transition: all 0.3s ease !important;\n        }\n        \n        .manage-page .ant-input:focus,\n        .manage-page .ant-input-focused,\n        .manage-page .ant-input-number:focus,\n        .manage-page .ant-input-number-focused,\n        .manage-page .ant-select-focused .ant-select-selector,\n        .manage-page .ant-input-affix-wrapper:focus,\n        .manage-page .ant-input-affix-wrapper-focused {\n            border-color: #722ed1 !important;\n            box-shadow: 0 0 0 3px rgba(114, 46, 209, 0.1) !important;\n        }\n        \n        .manage-page .ant-input-lg,\n        .manage-page .ant-select-lg .ant-select-selector {\n            padding: 12px 16px !important;\n            height: auto !important;\n        }\n        \n        .manage-page .ant-form-item-label > label {\n            font-weight: 600;\n            color: #1a1a2e;\n            font-size: 14px;\n        }\n        \n        .manage-page .ant-form-item-required::before {\n            display: none !important;\n        }\n        \n        .manage-page .ant-form-item-required::after {\n            content: '*' !important;\n            display: inline-block !important;\n            color: #ff4d4f !important;\n            margin-left: 4px !important;\n        }\n        \n        .manage-page .ant-switch {\n            min-width: 50px;\n        }\n        \n        .manage-page .ant-switch-checked {\n            background: linear-gradient(135deg, #52c41a 0%, #389e0d 100%);\n        }\n        \n        .manage-page textarea.ant-input {\n            border-radius: 12px !important;\n        }\n    "}),b=e=>{let{isEdit:n,loading:a,onCancel:i}=e;return(0,t.jsxs)("div",{style:y,children:[(0,t.jsx)(l.ZP,{size:"large",onClick:i,style:{flex:1,borderRadius:14,height:48},children:"ยกเลิก"}),(0,t.jsx)(l.ZP,{type:"primary",htmlType:"submit",size:"large",loading:a,icon:(0,t.jsx)(u.Z,{}),style:{flex:2,borderRadius:14,height:48,background:n?"linear-gradient(135deg, #faad14 0%, #fa8c16 100%)":"linear-gradient(135deg, #52c41a 0%, #389e0d 100%)",border:"none",fontWeight:600,boxShadow:n?"0 4px 12px rgba(250, 173, 20, 0.4)":"0 4px 12px rgba(82, 196, 26, 0.4)"},children:n?"อัปเดต":"บันทึก"})]})};var j=a(5447),w=a(25193),Z=a(37410),_=a(20148);function C(e){let{params:n}=e,a=(0,g.useRouter)(),[m]=r.Z.useForm(),[u,f]=(0,i.useState)(!1),[h,y]=(0,i.useState)(!1),[C,T]=(0,i.useState)(""),[v,E]=(0,i.useState)(""),P=n.mode[0],S=n.mode[1]||null,U="edit"===P&&!!S;(0,i.useEffect)(()=>{(async()=>{E(await j.O.getCsrfToken())})()},[]);let N=(0,i.useCallback)(async()=>{f(!0);try{let e=await fetch("/api/stock/ingredientsUnit/getById/".concat(S));if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลหน่วยวัตถุดิบได้");let n=await e.json();m.setFieldsValue({unit_name:n.unit_name,display_name:n.display_name,is_active:n.is_active}),T(n.display_name||"")}catch(e){console.error(e),s.ZP.error("ไม่สามารถดึงข้อมูลหน่วยวัตถุดิบได้"),a.push("/stock/ingredientsUnit")}finally{f(!1)}},[S,m,a]);(0,i.useEffect)(()=>{U&&N()},[U,S,N]);let z=async e=>{y(!0);try{if(U){let n=await fetch("/api/stock/ingredientsUnit/update/".concat(S),{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":v},body:JSON.stringify(e)});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตหน่วยวัตถุดิบได้")}s.ZP.success("อัปเดตหน่วยวัตถุดิบสำเร็จ")}else{let n=await fetch("/api/stock/ingredientsUnit/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":v},body:JSON.stringify(e)});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างหน่วยวัตถุดิบได้")}s.ZP.success("สร้างหน่วยวัตถุดิบสำเร็จ")}a.push("/stock/ingredientsUnit")}catch(e){console.error(e),s.ZP.error(e.message||(U?"ไม่สามารถอัปเดตหน่วยวัตถุดิบได้":"ไม่สามารถสร้างหน่วยวัตถุดิบได้"))}finally{y(!1)}},O=()=>a.push("/stock/ingredientsUnit");return(0,t.jsxs)("div",{className:"manage-page",style:x,children:[(0,t.jsx)(k,{}),(0,t.jsx)(_.Z,{title:U?"แก้ไขหน่วยวัตถุดิบ":"เพิ่มหน่วยวัตถุดิบ",subtitle:"หน่วยสำหรับวัตถุดิบในคลัง",onBack:O,actions:U?(0,t.jsx)(l.ZP,{danger:!0,onClick:()=>{S&&o.Z.confirm({title:"ยืนยันการลบหน่วยวัตถุดิบ",content:'คุณต้องการลบหน่วยวัตถุดิบ "'.concat(C,'" หรือไม่?'),okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{if(!(await fetch("/api/stock/ingredientsUnit/delete/".concat(S),{method:"DELETE",headers:{"X-CSRF-Token":v}})).ok)throw Error("ไม่สามารถลบหน่วยวัตถุดิบได้");s.ZP.success("ลบหน่วยวัตถุดิบสำเร็จ"),a.push("/stock/ingredientsUnit")}catch(e){console.error(e),s.ZP.error("ไม่สามารถลบหน่วยวัตถุดิบได้")}}})},children:"ลบ"}):void 0}),(0,t.jsx)(w.Z,{maxWidth:900,children:(0,t.jsx)("div",{className:"manage-form-card",children:(0,t.jsx)(Z.Z,{children:u?(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:(0,t.jsx)(c.Z,{size:"large"})}):(0,t.jsxs)(r.Z,{form:m,layout:"vertical",onFinish:z,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{"string"==typeof e.display_name&&T(e.display_name)},children:[(0,t.jsx)(r.Z.Item,{name:"unit_name",label:"ชื่อหน่วย (ภาษาอังกฤษ) *",rules:[{required:!0,message:"กรุณากรอกชื่อหน่วย"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:50,message:"ความยาวต้องไม่เกิน 50 ตัวอักษร"}],children:(0,t.jsx)(d.default,{size:"large",placeholder:"เช่น kg, g, l, ml",maxLength:50})}),(0,t.jsx)(r.Z.Item,{name:"display_name",label:"ชื่อที่แสดง (ภาษาไทย) *",rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:50,message:"ความยาวต้องไม่เกิน 50 ตัวอักษร"}],children:(0,t.jsx)(d.default,{size:"large",placeholder:"เช่น กิโลกรัม, กรัม, ลิตร, มิลลิลิตร",maxLength:50})}),(0,t.jsx)(r.Z.Item,{name:"is_active",label:"สถานะการใช้งาน",valuePropName:"checked",children:(0,t.jsx)(p.Z,{checkedChildren:"ใช้งาน",unCheckedChildren:"ไม่ใช้งาน"})}),(0,t.jsx)(b,{isEdit:U,loading:h,onCancel:O})]})})})})]})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=32387)}),_N_E=e.O()}]);