(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5277],{78923:function(e,t,n){Promise.resolve().then(n.bind(n,95597))},95597:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var s=n(57437),o=n(2265),a=n(13817),r=n(99376),i=n(40740),l=n(35631),c=n(50742),d=n(5311),u=n(52539),h=n(38434),k=n(84588),p=n(1915),f=n(15424),b=n(39760),x=n(14362),g=n(24675),m=n(76155),y=n(9771),j=n(12028),v=()=>{let e=(0,r.useRouter)(),t=(0,r.usePathname)(),{user:n}=(0,x.a)(),[a,v]=(0,o.useState)(0),[Z,O]=(0,o.useState)(!1),{socket:w}=(0,g.s)(),C=(0,o.useCallback)(async()=>{try{let e=new URLSearchParams;e.append("status","pending"),e.append("t",Date.now().toString());let t=await m.x.getAllOrders(void 0,e);v(t.total)}catch(e){}},[]);(0,o.useEffect)(()=>{n&&C()},[n,C]),(0,o.useEffect)(()=>{if(!w)return;let e=()=>setTimeout(C,500),t=t=>{((null==t?void 0:t.action)==="create"||(null==t?void 0:t.action)==="update_status")&&e()};w.on(j.b.stockOrders.create,e),w.on(j.b.stockOrders.status,e),w.on(j.b.stockOrders.delete,e),w.on(j.g.stockOrdersUpdated,t);let n=()=>C();return window.addEventListener("focus",n),()=>{w.off(j.b.stockOrders.create,e),w.off(j.b.stockOrders.status,e),w.off(j.b.stockOrders.delete,e),w.off(j.g.stockOrdersUpdated,t),window.removeEventListener("focus",n)}},[w,C]);let E=[{key:"home",label:"หน้าแรก",icon:(0,s.jsx)(d.Z,{}),path:"/"},{key:"shopping",label:"สั่งซื้อ",icon:(0,s.jsx)(u.Z,{}),path:"/stock"},{key:"orders",label:"รายการ",icon:(0,s.jsx)(h.Z,{}),path:"/stock/items"},{key:"history",label:"ประวัติ",icon:(0,s.jsx)(k.Z,{}),path:"/stock/history"},...(null==n?void 0:n.role)==="Admin"||(null==n?void 0:n.role)==="Manager"?[{key:"ingredients",label:"วัตถุดิบ",icon:(0,s.jsx)(p.Z,{}),path:"/stock/ingredients"},{key:"ingredientsUnit",label:"หน่วย",icon:(0,s.jsx)(f.Z,{}),path:"/stock/ingredientsUnit"}]:[]],_=e=>"/"===e?"/"===t:t===e||t.startsWith(e+"/"),S=E.slice(0,4),U=E.slice(4),I=U.some(e=>_(e.path));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(y.Z,{maxWidth:560,items:[...S.map(t=>({key:t.key,label:t.label,icon:t.icon,onClick:()=>e.push(t.path),active:_(t.path),badgeDot:"orders"===t.key&&a>0})),...U.length?[{key:"more",label:"เพิ่มเติม",icon:(0,s.jsx)(b.Z,{}),onClick:()=>O(!0),active:I}]:[]]}),(0,s.jsx)(i.Z,{open:Z,onClose:()=>O(!1),placement:"bottom",height:"auto",title:"เมนูเพิ่มเติม",zIndex:2e3,children:(0,s.jsx)("div",{style:{paddingBottom:"calc(12px + env(safe-area-inset-bottom))"},children:(0,s.jsx)(l.Z,{dataSource:U,renderItem:t=>(0,s.jsx)(l.Z.Item,{style:{paddingInline:0},children:(0,s.jsx)(c.ZP,{type:"text",block:!0,icon:t.icon,style:{height:48,justifyContent:"flex-start"},onClick:()=>{e.push(t.path),O(!1)},children:t.label})})})})})]})},Z=n(30736);function O(e){let{children:t}=e;return(0,s.jsx)(Z.Z,{children:(0,s.jsxs)(a.default,{style:{minHeight:"100%",background:"transparent"},children:[(0,s.jsx)(a.default.Content,{style:{background:"transparent"},children:t}),(0,s.jsx)(v,{})]})})}}},function(e){e.O(0,[8024,4736,8592,1744],function(){return e(e.s=78923)}),_N_E=e.O()}]);