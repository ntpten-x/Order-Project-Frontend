(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6797],{1654:function(e,t,r){Promise.resolve().then(r.bind(r,66266))},66266:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return X}});var a=r(57437),n=r(2265),o=r(83464),i=r(82646),s=r(34029),l=r(96931),d=r(50337),c=r(24783),f=r(35713),u=r(35631),g=r(8110),p=r(52539),x=r(89245),h=r(29),m=r.n(h),b=r(80009),y=r(50742),k=r(53743),j=r(33145),w=r(54752),S=r(9738),v=r(40312),T=r(49638),C=r(30736);let{Title:E,Paragraph:z,Text:P}=i.default;var I=e=>{let{ingredient:t}=e,{addToCart:r}=(0,C.j)(),[o,i]=(0,n.useState)(!1),[d,c]=(0,n.useState)(!1),[f,u]=(0,n.useState)(!1),g=(0,n.useCallback)(()=>{c(!0)},[]),p=(0,n.useCallback)(()=>{c(!1)},[]);(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&d&&p()};return d&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[d,p]);let x=t.img_url||"https://placehold.co/600x400?text=No+Image";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.Z,{hoverable:!0,cover:(0,a.jsxs)("div",{onClick:g,style:{position:"relative",overflow:"hidden",borderRadius:"16px 16px 0 0",cursor:"pointer",background:"linear-gradient(145deg, #f8fafc 0%, #e2e8f0 100%)"},className:"jsx-34e97e55521c7fb8",children:[(0,a.jsxs)("div",{style:{position:"relative",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",minHeight:200,maxHeight:280,padding:16},className:"jsx-34e97e55521c7fb8",children:[!f&&(0,a.jsx)("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(145deg, #f1f5f9 0%, #e2e8f0 100%)"},className:"jsx-34e97e55521c7fb8",children:(0,a.jsx)("div",{style:{width:40,height:40,border:"3px solid #e2e8f0",borderTopColor:"#667eea",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-34e97e55521c7fb8"})}),(0,a.jsx)("div",{style:{position:"relative",width:"100%",height:"250px"},className:"jsx-34e97e55521c7fb8",children:(0,a.jsx)(j.default,{alt:t.display_name,src:x,fill:!0,sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",style:{objectFit:"contain",transition:"transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), filter 0.3s ease",opacity:f?1:0,borderRadius:8,filter:"drop-shadow(0 4px 12px rgba(0,0,0,0.1))"},onLoad:()=>u(!0),onError:()=>{u(!0)},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.08)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"}})})]}),(0,a.jsxs)("div",{style:{position:"absolute",bottom:12,left:12,padding:"8px 14px",borderRadius:20,background:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(8px)",color:"#fff",display:"flex",alignItems:"center",gap:6,fontSize:12,fontWeight:500,opacity:.8,transition:"all 0.3s ease",border:"1px solid rgba(255,255,255,0.1)"},onMouseEnter:e=>{e.currentTarget.style.opacity="1",e.currentTarget.style.transform="scale(1.05)"},onMouseLeave:e=>{e.currentTarget.style.opacity="0.8",e.currentTarget.style.transform="scale(1)"},className:"jsx-34e97e55521c7fb8",children:[(0,a.jsx)(w.Z,{style:{fontSize:14}}),(0,a.jsx)("span",{className:"jsx-34e97e55521c7fb8",children:"ดูรูปขยาย"})]}),t.unit&&(0,a.jsx)(b.Z,{style:{position:"absolute",top:12,right:12,margin:0,padding:"8px 16px",fontSize:"13px",fontWeight:600,borderRadius:24,background:"linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%)",backdropFilter:"blur(8px)",color:"#fff",border:"none",boxShadow:"0 4px 15px rgba(102, 126, 234, 0.4)"},children:t.unit.display_name})]}),style:{width:"100%",borderRadius:20,overflow:"hidden",border:"none",boxShadow:"0 4px 24px rgba(0,0,0,0.06)",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",background:"#fff"},styles:{body:{padding:"20px 24px 24px",display:"flex",flexDirection:"column",background:"#fff"}},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-10px)",e.currentTarget.style.boxShadow="0 20px 50px rgba(102, 126, 234, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 24px rgba(0,0,0,0.06)"},children:[(0,a.jsxs)("div",{style:{marginBottom:16,flexGrow:1},className:"jsx-34e97e55521c7fb8",children:[(0,a.jsx)(E,{level:4,style:{margin:0,marginBottom:6,lineHeight:1.3,fontSize:"20px",fontWeight:700,color:"#1e293b",letterSpacing:"-0.02em"},children:t.display_name}),t.ingredient_name&&(0,a.jsx)(P,{style:{fontSize:"14px",color:"#64748b",fontWeight:500},children:t.ingredient_name}),(0,a.jsx)(z,{ellipsis:{rows:2,expandable:!1},style:{marginTop:14,marginBottom:0,minHeight:"48px",color:"#64748b",fontSize:"14px",lineHeight:1.7},children:t.description||"ไม่มีคำอธิบาย"})]}),(0,a.jsx)(y.ZP,{type:"primary",icon:o?(0,a.jsx)(S.Z,{}):(0,a.jsx)(v.Z,{}),onClick:e=>{e.stopPropagation(),r(t),i(!0),s.ZP.success("เพิ่ม ".concat(t.display_name," ลงตะกร้าแล้ว")),setTimeout(()=>i(!1),1500)},block:!0,size:"large",style:{height:52,borderRadius:14,fontSize:"15px",fontWeight:600,background:o?"linear-gradient(135deg, #22c55e 0%, #16a34a 100%)":"linear-gradient(135deg, #0d9488 0%, #059669 100%)",border:"none",boxShadow:o?"0 4px 20px rgba(34, 197, 94, 0.4)":"0 4px 20px rgba(5, 150, 105, 0.35)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:o?"scale(0.98)":"scale(1)"},onMouseEnter:e=>{o||(e.currentTarget.style.transform="translateY(-3px)",e.currentTarget.style.boxShadow="0 8px 28px rgba(5, 150, 105, 0.5)")},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow=o?"0 4px 20px rgba(34, 197, 94, 0.4)":"0 4px 20px rgba(5, 150, 105, 0.35)"},children:o?"เพิ่มแล้ว ✓":"เพิ่มลงตะกร้า"})]}),(0,a.jsx)(k.Z,{open:d,onCancel:p,footer:null,centered:!0,width:"auto",style:{maxWidth:"95vw"},styles:{mask:{backgroundColor:"rgba(0, 0, 0, 0.85)",backdropFilter:"blur(8px)"},wrapper:{background:"transparent"},body:{padding:0,background:"transparent"}},closeIcon:(0,a.jsx)("div",{style:{position:"fixed",top:20,right:20,width:44,height:44,borderRadius:"50%",background:"rgba(255,255,255,0.15)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease",border:"1px solid rgba(255,255,255,0.2)"},className:"jsx-34e97e55521c7fb8",children:(0,a.jsx)(T.Z,{style:{color:"#fff",fontSize:18}})}),children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:20,animation:"modalFadeIn 0.3s ease-out"},className:"jsx-34e97e55521c7fb8",children:[(0,a.jsx)("div",{style:{background:"rgba(255,255,255,0.08)",borderRadius:20,padding:20,backdropFilter:"blur(12px)",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 20px 60px rgba(0,0,0,0.5)"},className:"jsx-34e97e55521c7fb8",children:(0,a.jsx)("img",{alt:t.display_name,src:x,style:{maxWidth:"85vw",maxHeight:"75vh",width:"auto",height:"auto",objectFit:"contain",borderRadius:12,display:"block"},onError:e=>{e.currentTarget.src="https://placehold.co/600x400?text=No+Image"},className:"jsx-34e97e55521c7fb8"})}),(0,a.jsxs)("div",{style:{textAlign:"center",color:"#fff",maxWidth:"80vw"},className:"jsx-34e97e55521c7fb8",children:[(0,a.jsx)(E,{level:3,style:{color:"#fff",margin:0,marginBottom:8,fontWeight:700,textShadow:"0 2px 10px rgba(0,0,0,0.3)"},children:t.display_name}),t.ingredient_name&&(0,a.jsx)(P,{style:{color:"rgba(255,255,255,0.7)",fontSize:16},children:t.ingredient_name}),t.unit&&(0,a.jsx)(b.Z,{style:{marginLeft:12,padding:"4px 14px",fontSize:"13px",fontWeight:600,borderRadius:16,background:"linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%)",color:"#fff",border:"none"},children:t.unit.display_name})]})]})}),(0,a.jsx)(m(),{id:"34e97e55521c7fb8",children:"@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes modalFadeIn{from{opacity:0;-webkit-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes modalFadeIn{from{opacity:0;-moz-transform:scale(.95);transform:scale(.95)}to{opacity:1;-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes modalFadeIn{from{opacity:0;-o-transform:scale(.95);transform:scale(.95)}to{opacity:1;-o-transform:scale(1);transform:scale(1)}}@keyframes modalFadeIn{from{opacity:0;-webkit-transform:scale(.95);-moz-transform:scale(.95);-o-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}"})]})},R=r(92190),O=r(91652),_=r(26349),Z=r(83669),N=r(22623),A=r(96473),L=r(14362),F=r(5447),D=r(76155),U=r(99376);let{Text:B,Title:M}=i.default;function W(){let[e,t]=(0,n.useState)(!1),{items:r,updateQuantity:o,clearCart:i,itemCount:d}=(0,C.j)(),{user:u}=(0,L.a)(),g=(0,U.useRouter)(),[x,h]=(0,n.useState)(!1),[m,b]=(0,n.useState)("");n.useEffect(()=>{let t=async()=>{b(await F.O.getCsrfToken())};e&&t()},[e]);let j=async()=>{if(!u){s.ZP.error("กรุณาเข้าสู่ระบบก่อนสั่งซื้อ");return}if(0===r.length){s.ZP.warning("ไม่มีสินค้าในตะกร้า");return}h(!0);try{let e=r.map(e=>({ingredient_id:e.ingredient.id,quantity_ordered:e.quantity}));await D.x.createOrder({ordered_by_id:u.id,items:e,remark:"สั่งซื้อผ่านเว็บ"},void 0,m),s.ZP.success("\uD83C\uDF89 สั่งออเดอร์สำเร็จ!"),i(),t(!1),g.push("/stock/items")}catch(e){console.error("Order failed:",e),s.ZP.error(e.message||"การสั่งซื้อล้มเหลว")}finally{h(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{position:"fixed",bottom:100,right:24,zIndex:1e3},children:(0,a.jsx)(f.Z,{count:d,offset:[-8,8],style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",border:"2px solid #fff",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",fontWeight:600},children:(0,a.jsx)(y.ZP,{type:"primary",shape:"circle",size:"large",icon:(0,a.jsx)(v.Z,{style:{fontSize:28}}),style:{width:64,height:64,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:"0 8px 24px rgba(102, 126, 234, 0.5)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},onClick:()=>{t(!0)},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1) translateY(-4px)",e.currentTarget.style.boxShadow="0 12px 32px rgba(102, 126, 234, 0.6)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1) translateY(0)",e.currentTarget.style.boxShadow="0 8px 24px rgba(102, 126, 234, 0.5)"}})})}),(0,a.jsx)(R.Z,{title:(0,a.jsxs)(c.Z,{align:"center",size:12,children:[(0,a.jsx)("div",{style:{width:40,height:40,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(v.Z,{style:{color:"#fff",fontSize:20}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(M,{level:5,style:{margin:0,fontSize:18},children:"ตะกร้าสินค้า"}),(0,a.jsxs)(B,{type:"secondary",style:{fontSize:13},children:[d," รายการ"]})]})]}),placement:"right",onClose:()=>{t(!1)},open:e,styles:{wrapper:{width:420},header:{background:"#fafbff",borderBottom:"1px solid #f0f0f0",padding:"16px 24px"},body:{padding:0,background:"#f8f9fc"},footer:{padding:"16px 24px",background:"#fff",borderTop:"1px solid #f0f0f0"}},extra:r.length>0&&(0,a.jsx)(y.ZP,{type:"text",danger:!0,icon:(0,a.jsx)(_.Z,{}),onClick:()=>k.Z.confirm({title:"ล้างตะกร้า",content:"ยืนยันลบรายการทั้งหมด?",okText:"ยืนยัน",cancelText:"ยกเลิก",okButtonProps:{style:{background:"#ff4d4f"}},onOk:i}),style:{fontWeight:500},children:"ล้าง"}),footer:(0,a.jsx)("div",{children:(0,a.jsxs)(y.ZP,{type:"primary",block:!0,size:"large",onClick:j,loading:x,disabled:0===r.length,icon:(0,a.jsx)(Z.Z,{}),style:{height:56,borderRadius:14,fontSize:17,fontWeight:600,background:0===r.length?"#d9d9d9":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:0===r.length?"none":"0 6px 20px rgba(102, 126, 234, 0.4)"},children:["ยืนยันการสั่งซื้อ (",d," รายการ)"]})}),children:(0,a.jsx)("div",{style:{padding:"16px 24px"},children:0===r.length?(0,a.jsxs)("div",{style:{textAlign:"center",marginTop:80},children:[(0,a.jsx)("div",{style:{width:120,height:120,margin:"0 auto 24px",background:"linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(p.Z,{style:{fontSize:56,color:"#667eea"}})}),(0,a.jsx)(M,{level:4,style:{color:"#666",marginBottom:8},children:"ตะกร้าว่างเปล่า"}),(0,a.jsx)(B,{type:"secondary",style:{fontSize:15},children:"เลือกวัตถุดิบที่ต้องการสั่งซื้อ"})]}):(0,a.jsx)(c.Z,{direction:"vertical",size:12,style:{width:"100%"},children:r.map(e=>{var t;return(0,a.jsx)(l.Z,{size:"small",style:{borderRadius:16,border:"none",boxShadow:"0 2px 12px rgba(0,0,0,0.06)",overflow:"hidden"},styles:{body:{padding:"16px"}},children:(0,a.jsxs)(c.Z,{align:"start",size:16,style:{width:"100%"},children:[(0,a.jsx)(O.Z,{src:e.ingredient.img_url,shape:"square",size:72,style:{borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}}),(0,a.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,a.jsx)(B,{strong:!0,style:{fontSize:16,display:"block",marginBottom:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.ingredient.display_name}),(0,a.jsx)(B,{type:"secondary",style:{fontSize:13,display:"block",marginBottom:12},children:(null===(t=e.ingredient.unit)||void 0===t?void 0:t.display_name)||"-"}),(0,a.jsxs)(c.Z,{size:12,children:[(0,a.jsx)(y.ZP,{size:"small",shape:"circle",danger:1===e.quantity,icon:1===e.quantity?(0,a.jsx)(_.Z,{}):(0,a.jsx)(N.Z,{}),onClick:()=>o(e.ingredient.id,e.quantity-1),style:{width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",border:1===e.quantity?"1px solid #ff4d4f":"1px solid #d9d9d9"}}),(0,a.jsx)("div",{style:{minWidth:48,height:36,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%)",borderRadius:8,fontWeight:700,fontSize:16,color:"#333"},children:e.quantity}),(0,a.jsx)(y.ZP,{size:"small",shape:"circle",icon:(0,a.jsx)(A.Z,{}),onClick:()=>o(e.ingredient.id,e.quantity+1),style:{width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",color:"#fff"}})]})]})]})},e.ingredient.id)})})})})]})}var q=r(24675);let H={container:{minHeight:"100vh",background:"#f8f9fc",fontFamily:"'Inter', 'Sarabun', sans-serif"},heroParams:{background:"linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%)",padding:"40px 24px 80px",position:"relative",borderBottomLeftRadius:32,borderBottomRightRadius:32,boxShadow:"0 10px 30px -10px rgba(79, 70, 229, 0.3)",marginBottom:-40,zIndex:1,overflow:"hidden"},contentWrapper:{padding:"0 24px 120px",maxWidth:1200,margin:"0 auto",width:"100%",position:"relative",zIndex:2},gridConfig:{gutter:24,xs:1,sm:1,md:2,lg:3,xl:3,xxl:4}},G=()=>(0,a.jsx)(m(),{id:"395bfc5f9757b567",children:".hero-pattern{position:absolute;top:0;left:0;width:100%;height:100%;background-image:-webkit-radial-gradient(rgba(255,255,255,.1)1px,transparent 1px);background-image:-moz-radial-gradient(rgba(255,255,255,.1)1px,transparent 1px);background-image:-o-radial-gradient(rgba(255,255,255,.1)1px,transparent 1px);background-image:radial-gradient(rgba(255,255,255,.1)1px,transparent 1px);-webkit-background-size:20px 20px;-moz-background-size:20px 20px;-o-background-size:20px 20px;background-size:20px 20px;opacity:.5;pointer-events:none}.decorative-circle{position:absolute;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;background:rgba(255,255,255,.1);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.circle-1{width:300px;height:300px;top:-100px;right:-50px}.circle-2{width:150px;height:150px;bottom:-30px;left:10%}@-webkit-keyframes fadeInUp{from{opacity:0;-webkit-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeInUp{from{opacity:0;-moz-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeInUp{from{opacity:0;-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeInUp{from{opacity:0;-webkit-transform:translatey(20px);-moz-transform:translatey(20px);-o-transform:translatey(20px);transform:translatey(20px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.animate-card{-webkit-animation:fadeInUp.6s ease-out forwards;-moz-animation:fadeInUp.6s ease-out forwards;-o-animation:fadeInUp.6s ease-out forwards;animation:fadeInUp.6s ease-out forwards;opacity:0}"}),{Title:J,Text:Y}=i.default;function X(){let[e,t]=(0,n.useState)([]),[r,i]=(0,n.useState)(!0),[h,m]=(0,n.useState)(null),{socket:b}=(0,q.s)();(0,n.useEffect)(()=>{(async()=>{try{i(!0);let e=await o.Z.get("/api/stock/ingredients?active=true");t(e.data),m(null)}catch(e){console.error("Error fetching ingredients:",e),m("Failed to load ingredients. Please try again later.")}finally{i(!1)}})()},[]),(0,n.useEffect)(()=>{if(!b)return;let e=e=>{e.is_active&&(t(t=>[e,...t]),s.ZP.info("\uD83C\uDD95 มีวัตถุดิบใหม่: ".concat(e.display_name)))},r=e=>{t(t=>{let r=t.find(t=>t.id===e.id);return e.is_active?r?t.map(t=>t.id===e.id?e:t):[e,...t]:t.filter(t=>t.id!==e.id)})},a=e=>{let{id:r}=e;t(e=>e.filter(e=>e.id!==r))};return b.on("ingredients:create",e),b.on("ingredients:update",r),b.on("ingredients:delete",a),()=>{b.off("ingredients:create",e),b.off("ingredients:update",r),b.off("ingredients:delete",a)}},[b]);let y=()=>(0,a.jsxs)(l.Z,{style:{borderRadius:16,overflow:"hidden",boxShadow:"0 4px 20px rgba(0,0,0,0.06)",border:"none"},children:[(0,a.jsx)(d.Z.Image,{active:!0,style:{width:"100%",height:180}}),(0,a.jsx)("div",{style:{padding:"16px 0"},children:(0,a.jsx)(d.Z,{active:!0,paragraph:{rows:2}})})]});return(0,a.jsxs)("div",{style:H.container,children:[(0,a.jsx)(G,{}),(0,a.jsxs)("div",{style:H.heroParams,children:[(0,a.jsx)("div",{className:"hero-pattern"}),(0,a.jsx)("div",{className:"decorative-circle circle-1"}),(0,a.jsx)("div",{className:"decorative-circle circle-2"}),(0,a.jsxs)("div",{style:{maxWidth:1200,margin:"0 auto",position:"relative",zIndex:2},children:[(0,a.jsxs)(c.Z,{align:"center",size:16,style:{marginBottom:8},children:[(0,a.jsx)(p.Z,{style:{fontSize:32,color:"#fff"}}),(0,a.jsx)(J,{level:2,style:{margin:0,color:"#fff",fontWeight:800},children:"เลือกซื้อวัตถุดิบ"})]}),(0,a.jsx)(Y,{style:{display:"block",color:"rgba(255,255,255,0.9)",fontSize:16,marginTop:8,paddingLeft:4},children:"คัดสรรวัตถุดิบคุณภาพดีที่สุดเพื่อครัวของคุณ"}),(0,a.jsx)("div",{style:{marginTop:24,display:"flex",gap:12},children:(0,a.jsx)(f.Z,{count:r?0:e.length,style:{backgroundColor:"#fff",color:"#4f46e5",fontWeight:"bold"},overflowCount:999,children:(0,a.jsx)("div",{style:{background:"rgba(255,255,255,0.2)",padding:"6px 16px",borderRadius:20,color:"white",backdropFilter:"blur(4px)",fontWeight:500},children:"รายการทั้งหมด"})})})]})]}),(0,a.jsx)("div",{style:H.contentWrapper,children:r?(0,a.jsx)(u.Z,{grid:H.gridConfig,dataSource:[1,2,3,4,5,6],renderItem:()=>(0,a.jsx)(u.Z.Item,{children:(0,a.jsx)(y,{})})}):h?(0,a.jsx)(g.ZP,{status:"error",title:"เกิดข้อผิดพลาด",subTitle:h,extra:(0,a.jsxs)("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:8,color:"#fff",fontWeight:600,cursor:"pointer",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[(0,a.jsx)(x.Z,{style:{marginRight:8}}),"ลองใหม่อีกครั้ง"]}),style:{background:"white",padding:40,borderRadius:24,marginTop:24,boxShadow:"0 4px 20px rgba(0,0,0,0.05)"}}):0===e.length?(0,a.jsxs)("div",{style:{background:"white",padding:"60px 20px",borderRadius:24,marginTop:24,textAlign:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.05)"},children:[(0,a.jsx)(p.Z,{style:{color:"#d1d5db",fontSize:80,marginBottom:16}}),(0,a.jsx)(J,{level:3,style:{color:"#374151",margin:0},children:"ยังไม่มีวัตถุดิบ"}),(0,a.jsx)(Y,{type:"secondary",style:{fontSize:16},children:"ยังไม่มีวัตถุดิบที่พร้อมให้สั่งซื้อในขณะนี้ โปรดกลับมาใหม่ภายหลัง"})]}):(0,a.jsx)(u.Z,{grid:H.gridConfig,dataSource:e,renderItem:(e,t)=>(0,a.jsx)(u.Z.Item,{className:"animate-card",style:{animationDelay:"".concat(50*t,"ms"),marginBottom:24},children:(0,a.jsx)(I,{ingredient:e})})})}),(0,a.jsx)(W,{})]})}},71567:function(e,t,r){"use strict";r.d(t,{q:function(){return n},v:function(){return a}});let a="/api",n={AUTH:{LOGIN:"/auth/login",ME:"/auth/me",CSRF:"/csrf"},POS:{PRODUCTS:"/pos/products",ORDERS:"/pos/orders",TABLES:"/pos/tables",DISCOUNTS:"/pos/discounts",DELIVERY:"/pos/delivery",PAYMENT_METHODS:"/pos/paymentMethod",PAYMENTS:"/pos/payments",CATEGORY:"/pos/category",SHIFTS:{BASE:"/pos/shifts",CURRENT:"/pos/shifts/current",OPEN:"/pos/shifts/open",CLOSE:"/pos/shifts/close"},DASHBOARD:{SALES:"/pos/dashboard/sales",TOP_ITEMS:"/pos/dashboard/top-items"},CHANNELS:{STATS:"/pos/orders/stats"},SHOP_PROFILE:"/pos/shopProfile",SALES_ORDER_ITEMS:"/pos/salesOrderItem",SALES_ORDER_DETAILS:"/pos/salesOrderDetail",PRODUCTS_UNIT:"/pos/productsUnit",PAYMENT_DETAILS:"/pos/paymentDetails",BRANCH:"/branches"}}},14362:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return f},a:function(){return u}});var a=r(57437),n=r(2265),o=r(99376),i=r(5447),s=r(84859),l=r(48651),d=r(3369);let c=(0,n.createContext)(void 0),f=e=>{let{children:t}=e,[r,f]=(0,n.useState)(null),[u,g]=(0,n.useState)(!0),p=(0,o.useRouter)(),x=(0,o.usePathname)(),h=async()=>{try{let e="";e=localStorage.getItem("token_ws")||"";let t=await i.O.getMe(e);f(t)}catch(e){f(null)}finally{g(!1)}};(0,n.useEffect)(()=>{h()},[]);let{showLoading:m,hideLoading:b}=(0,d.x)();(0,n.useEffect)(()=>{u||r||"/login"===x||p.push("/login")},[r,u,x,p]);let y=async e=>{try{m("กำลังเข้าสู่ระบบ...");let t=await i.O.getCsrfToken(),{token:r,...a}=await i.O.login(e,t);r&&localStorage.setItem("token_ws",r),f(a),p.push("/")}catch(e){throw e}finally{b()}},k=async()=>{try{m("กำลังออกจากระบบ...");let e="";e=localStorage.getItem("token_ws")||"",await i.O.logout(e),localStorage.removeItem("token_ws"),s.x.clearQueue(),f(null),p.push("/login")}catch(e){console.error("Logout error:",e)}finally{b()}};return u?(0,a.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-white",children:(0,a.jsx)(l.Z,{size:"large"})}):r||"/login"===x?(0,a.jsx)(c.Provider,{value:{user:r,loading:u,login:y,logout:k,checkAuth:h},children:t}):null},u=()=>{let e=(0,n.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},46252:function(e,t,r){"use strict";r.d(t,{J:function(){return s},SocketProvider:function(){return l}});var a=r(57437),n=r(2265),o=r(68680),i=r(14362);let s=(0,n.createContext)({socket:null,isConnected:!1}),l=e=>{let{children:t}=e,[r,l]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1),{user:f}=(0,i.a)();return(0,n.useEffect)(()=>{if(!f){r&&(r.disconnect(),l(null),c(!1));return}let e=localStorage.getItem("token_ws"),t=(0,o.io)("http://localhost:3000",{transports:["websocket"],withCredentials:!0,auth:e?{token:e}:void 0});return t.on("connect",()=>{console.log("Socket Connected:",t.id),c(!0)}),t.on("disconnect",()=>{console.log("Socket Disconnected"),c(!1)}),l(t),()=>{t.disconnect()}},[f]),(0,a.jsx)(s.Provider,{value:{socket:r,isConnected:d},children:t})}},3369:function(e,t,r){"use strict";r.d(t,{GlobalLoadingProvider:function(){return l},O:function(){return c},x:function(){return d}});var a=r(57437),n=r(2265),o=r(48651);let i=(0,n.createContext)(void 0),s=(0,n.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,n.useState)({}),[d,c]=(0,n.useState)(void 0),f=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";l(e=>({...e,[t]:(e[t]||0)+1})),e&&c(e)},[]),u=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";l(t=>{if(!t[e])return t;let r={...t};return r[e]-=1,r[e]<=0&&delete r[e],r})},[]),g=(0,n.useCallback)(()=>{l({}),c(void 0)},[]),p=Object.keys(r).length>0,x=(0,n.useMemo)(()=>({isLoading:p,loadingMessage:d}),[p,d]),h=(0,n.useMemo)(()=>({showLoading:f,hideLoading:u,resetLoading:g}),[f,u,g]);return(0,a.jsx)(s.Provider,{value:h,children:(0,a.jsxs)(i.Provider,{value:x,children:[t,p&&(0,a.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center pointer-events-auto bg-black/10 backdrop-blur-[1px]",children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,background:"rgba(255, 255, 255, 0.9)",padding:"20px 40px",borderRadius:12,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[(0,a.jsx)(o.Z,{size:"large"}),d&&(0,a.jsx)("div",{style:{fontSize:14,color:"#1f1f1f",fontWeight:500},children:d})]})})]})})};function d(){let e=(0,n.useContext)(i),t=(0,n.useContext)(s);if(!e||!t)throw Error("useGlobalLoading must be used within a GlobalLoadingProvider");return(0,n.useMemo)(()=>({...e,...t}),[e,t])}function c(){let e=(0,n.useContext)(s);if(!e)throw Error("useGlobalLoadingDispatch must be used within a GlobalLoadingProvider");return e}},30736:function(e,t,r){"use strict";r.d(t,{CartProvider:function(){return i},j:function(){return s}});var a=r(57437),n=r(2265);let o=(0,n.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=localStorage.getItem("shopping_cart");if(e)try{i(JSON.parse(e))}catch(e){console.error("Failed to parse cart from local storage",e)}},[]),(0,n.useEffect)(()=>{localStorage.setItem("shopping_cart",JSON.stringify(r))},[r]);let s=(0,n.useCallback)(e=>{i(t=>t.find(t=>t.ingredient.id===e.id)?t.map(t=>t.ingredient.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{ingredient:e,quantity:1}])},[]),l=(0,n.useCallback)(e=>{i(t=>t.filter(t=>t.ingredient.id!==e))},[]),d=(0,n.useCallback)((e,t)=>{if(t<=0){l(e);return}i(r=>r.map(r=>r.ingredient.id===e?{...r,quantity:t}:r))},[l]),c=(0,n.useCallback)(()=>{i([])},[]),f=r.reduce((e,t)=>e+t.quantity,0),u=n.useMemo(()=>({items:r,addToCart:s,removeFromCart:l,updateQuantity:d,clearCart:c,itemCount:f}),[r,s,l,d,c,f]);return(0,a.jsx)(o.Provider,{value:u,children:t})},s=()=>{let e=(0,n.useContext)(o);if(!e)throw Error("useCart must be used within a CartProvider");return e}},24675:function(e,t,r){"use strict";r.d(t,{s:function(){return o}});var a=r(2265),n=r(46252);let o=()=>(0,a.useContext)(n.J)},2913:function(e,t,r){"use strict";function a(e,t){return({GET:"".concat(n.API_BASE_URL).concat(t),POST:"".concat(n.API_BASE_URL).concat(t),PUT:"".concat(n.API_BASE_URL).concat(t),DELETE:"".concat(n.API_BASE_URL).concat(t),PATCH:"".concat(n.API_BASE_URL).concat(t)})[e]}r.d(t,{b:function(){return a}});let n={get API_BASE_URL(){return"/api"}}},5447:function(e,t,r){"use strict";r.d(t,{O:function(){return o}});var a=r(71567),n=r(2913);let o={login:async(e,t,r)=>{try{let o=(0,n.b)("POST",a.q.AUTH.LOGIN),i={"Content-Type":"application/json"};t&&(i["X-CSRF-Token"]=t),r&&(i.Cookie=r);let s=await fetch(o,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(e)});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.message||e.detail||"เข้าสู่ระบบไม่สำเร็จ")}let l=await s.json();return{...l.user,token:l.token}}catch(e){throw Error(e.message||"เข้าสู่ระบบไม่สำเร็จ")}},logout:async(e,t,r)=>{try{let a=(0,n.b)("POST","/auth/logout"),o={"Content-Type":"application/json"};e&&(o.Authorization="Bearer ".concat(e)),t&&(o["X-CSRF-Token"]=t),r&&(o.Cookie=r),await fetch(a,{method:"POST",headers:o,credentials:"include"})}catch(e){console.error("Logout failed",e)}},getMe:async e=>{try{let t=(0,n.b)("GET",a.q.AUTH.ME),r=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include",cache:"no-store"});if(!r.ok)throw Error("Unauthorized");return await r.json()}catch(e){throw e}},async getCsrfToken(){try{let e=await fetch("".concat(a.v).concat(a.q.AUTH.CSRF),{credentials:"include"});if(!e.ok)return"";return(await e.json()).csrfToken}catch(e){return console.error("Failed to fetch CSRF token",e),""}}}},84859:function(e,t,r){"use strict";r.d(t,{M:function(){return s},x:function(){return i}});let a="pos_offline_queue",n=()=>{let e=localStorage.getItem(a);return e?JSON.parse(e):[]},o=e=>{localStorage.setItem(a,JSON.stringify(e))},i={addToQueue:(e,t)=>{let r=n(),a={id:"offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,payload:t,timestamp:Date.now(),retryCount:0};return o([...r,a]),a},getQueue:()=>n(),removeFromQueue:e=>{o(n().filter(t=>t.id!==e))},incrementRetry:(e,t)=>{o(n().map(r=>r.id===e?{...r,retryCount:r.retryCount+1,lastError:t}:r))},clearQueue:()=>{localStorage.removeItem(a)},pruneExceeded:()=>{o(n().filter(e=>e.retryCount<=5))}},s={maxRetry:5,backoff:e=>Math.min(3e4,2e3*e)}},76155:function(e,t,r){"use strict";r.d(t,{x:function(){return i}});var a=r(2913);let n="/stock/orders",o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/json",r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},i={createOrder:async(e,t,r)=>{let i=(0,a.b)("POST",n),s=o(t);r&&(s["X-CSRF-Token"]=r);let l=await fetch(i,{method:"POST",headers:s,body:JSON.stringify(e)});if(!l.ok){let e=await l.text();console.error("Backend Error [createOrder]:",{status:l.status,statusText:l.statusText,url:i,body:e});let t={};try{t=JSON.parse(e)}catch(e){}throw Error(t.error||t.message||"ไม่สามารถสร้างออเดอร์ได้ (".concat(l.status,")"))}return l.json()},getAllOrders:async(e,t)=>{let r=(0,a.b)("GET",n);t&&(r+="?".concat(t.toString()));let i=o(e,""),s=await fetch(r,{cache:"no-store",headers:i});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลออเดอร์ได้")}return s.json()},getOrderById:async(e,t)=>{let r=(0,a.b)("GET","".concat(n,"/").concat(e)),i=o(t,""),s=await fetch(r,{cache:"no-store",headers:i});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถดึงข้อมูลออเดอร์ได้")}return s.json()},updateStatus:async(e,t,r,i)=>{let s=(0,a.b)("PUT","".concat(n,"/").concat(e,"/status")),l=o(r);i&&(l["X-CSRF-Token"]=i);let d=await fetch(s,{method:"PUT",headers:l,body:JSON.stringify({status:t})});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตสถานะออเดอร์ได้")}return d.json()},updateOrder:async(e,t,r,i)=>{let s=(0,a.b)("PUT","".concat(n,"/").concat(e)),l=o(r);i&&(l["X-CSRF-Token"]=i);let d=await fetch(s,{method:"PUT",headers:l,body:JSON.stringify({items:t})});if(!d.ok){let e=await d.text();throw Error("Failed to update order: ".concat(d.status," ").concat(e))}return d.json()},confirmPurchase:async(e,t,r,i,s)=>{let l=(0,a.b)("POST","".concat(n,"/").concat(e,"/purchase")),d=o(i);s&&(d["X-CSRF-Token"]=s);let c=await fetch(l,{method:"POST",headers:d,body:JSON.stringify({items:t,purchased_by_id:r})});if(!c.ok){let e=await c.text();throw Error("Failed to confirm purchase: ".concat(c.status," ").concat(e))}return c.json()},updatePurchaseDetail:async(e,t)=>{let r=(0,a.b)("POST","/stock/ordersDetail/update"),n=o(t),i=await fetch(r,{method:"POST",headers:n,body:JSON.stringify(e)});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตข้อมูลการซื้อได้")}return i.json()},deleteOrder:async(e,t,r)=>{let i=(0,a.b)("DELETE","".concat(n,"/").concat(e)),s=o(t,"");r&&(s["X-CSRF-Token"]=r);let l=await fetch(i,{method:"DELETE",headers:s});if(!l.ok){let e=await l.text();throw Error("Failed to delete order: ".concat(l.status," ").concat(e))}}}}},function(e){e.O(0,[5015,7717,7698,742,3211,7993,8651,2646,6207,7213,9021,2224,3248,1721,9,5496,3834,8640,6931,8056,1652,5713,9356,5799,8110,4520,7206,2971,2117,1744],function(){return e(e.s=1654)}),_N_E=e.O()}]);