"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6835],{77961:function(t,e,r){r.d(e,{Z:function(){return Q}});var o=r(57437),a=r(2265),i=r(33145),n=r(39486),s=r(34029),l=r(50742),d=r(88589),c=r(48651),p=r(80009),m=r(8056),u=r(85180),x=r(35713),f=r(92190),y=r(53743),g=r(35631),h=r(33477),b=r(17588),w=r(29436),j=r(62376),k=r(96473),v=r(40312),S=r(26349),z=r(49638),C=r(13377),_=r(22623),I=r(99376),T=r(8949),Z=r(3369),E=r(29827),R=r(11713),F=r(45345),B=r(46252),N=r(47799),P=r(12028);let D=t=>{if("string"==typeof t)return t;if(t&&"object"==typeof t){var e;if("id"in t&&t.id)return t.id;if("data"in t&&(null===(e=t.data)||void 0===e?void 0:e.id))return t.data.id}};var W=r(79657),L=r(29),A=r.n(L);let q={primary:"var(--color-primary)",primaryDark:"var(--color-primary-hover)",primaryLight:"var(--color-primary-light)",primaryBorder:"var(--color-primary-border)",success:"#10B981",successLight:"#ECFDF5",warning:"#F59E0B",warningLight:"#FFFBEB",warningBorder:"#FDE68A",text:"#1E293B",textSecondary:"#64748B",background:"#F8FAFC",white:"#FFFFFF",border:"#E2E8F0",borderLight:"#F1F5F9"},O={container:{minHeight:"100vh",background:q.background,display:"flex",flexDirection:"column",paddingBottom:100},header:{background:"linear-gradient(145deg, var(--color-primary-hover) 0%, var(--color-primary) 55%, var(--color-primary-soft) 100%)",padding:"20px 24px",boxShadow:"0 4px 20px rgb(var(--color-primary-rgb) / 0.18)",position:"sticky",top:0,zIndex:100,borderRadius:"0 0 24px 24px"},headerContent:{maxWidth:1400,margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"space-between",gap:16},headerLeft:{display:"flex",alignItems:"center",gap:14,flex:1,minWidth:0},headerBackButton:{display:"flex",alignItems:"center",justifyContent:"center",width:42,height:42,borderRadius:14,background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"#fff",cursor:"pointer",transition:"all 0.2s ease"},headerIconWrapper:{width:48,height:48,borderRadius:16,background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.3)",display:"flex",alignItems:"center",justifyContent:"center"},headerInfo:{flex:1,minWidth:0},headerTitle:{color:"#fff",fontSize:22,fontWeight:700,margin:0,lineHeight:1.2,textShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},headerSubtitle:{color:"rgba(255, 255, 255, 0.9)",fontSize:14,marginTop:4,fontWeight:500},headerActions:{display:"flex",alignItems:"center",gap:10},categoryBar:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",padding:"14px 24px",borderBottom:"1px solid rgba(226, 232, 240, 0.8)",position:"sticky",top:84,zIndex:99,overflow:"hidden"},categoryScroll:{display:"flex",gap:10,overflowX:"auto",paddingBottom:2},content:{maxWidth:1400,margin:"0 auto",padding:"24px",flex:1,width:"100%"},productGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:20},productCard:{background:q.white,borderRadius:20,overflow:"hidden",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.04)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",border:"1px solid rgba(226, 232, 240, 0.8)",position:"relative"},productImage:{width:"100%",height:160,position:"relative",overflow:"hidden",background:"linear-gradient(135deg, ".concat(q.primaryLight," 0%, #DBEAFE 100%)")},productInfo:{padding:16},productName:{fontSize:15,fontWeight:600,lineHeight:1.4,color:q.text,marginBottom:6,display:"block"},productCategory:{fontSize:11,color:q.textSecondary,marginBottom:10},productFooter:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:14,paddingTop:12,borderTop:"1px solid #F1F5F9"},productPrice:{fontSize:18,fontWeight:700,color:q.primary},addButton:{background:"linear-gradient(135deg, ".concat(q.success," 0%, #059669 100%)"),color:"#fff",border:"none",borderRadius:12,padding:"10px 16px",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:6,boxShadow:"0 4px 12px ".concat(q.success,"40")},paginationContainer:{display:"flex",justifyContent:"center",marginTop:32,padding:"24px 0"},floatingCartButton:{width:64,height:64,borderRadius:20,background:"linear-gradient(145deg, ".concat(q.primary," 0%, ").concat(q.primaryDark," 100%)"),boxShadow:"0 8px 24px rgb(var(--color-primary-rgb) / 0.32)",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid #fff"},loadingContainer:{textAlign:"center",padding:80,background:"#fff",borderRadius:24,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.04)"},emptyContainer:{textAlign:"center",padding:80,background:"#fff",borderRadius:24,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.04)"}};q.text,q.textSecondary,q.warningLight,q.warningBorder;let H={modalTitleRow:{display:"flex",alignItems:"center",gap:10},modalIconBase:{width:36,height:36,borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center"},modalButton:{borderRadius:10,height:42},modalButtonLarge:{borderRadius:10,height:44},cartItemContainer:{padding:"12px",marginBottom:"12px",background:"#fff",borderRadius:"16px",border:"none",transition:"all 0.2s",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},cartItemRow:{display:"flex",gap:12,width:"100%"},cartItemImage:{width:72,height:72,borderRadius:12,overflow:"hidden",border:"1px solid #f1f5f9"},cartItemImagePlaceholder:{width:72,height:72,borderRadius:12,background:"#f8fafc",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #f1f5f9"},cartItemTag:{border:"none",background:"#f1f5f9",color:"#64748b",fontSize:11,padding:"0 6px",margin:0,borderRadius:6},cartItemNote:{marginTop:4,background:"#fef2f2",padding:"2px 6px",borderRadius:4,display:"inline-block",border:"1px solid #fecaca"},cartItemQtyControl:{display:"flex",alignItems:"center",background:"#f8fafc",borderRadius:10,padding:"4px",border:"1px solid #e2e8f0"},drawerTitleRow:{display:"flex",alignItems:"center",gap:12},drawerTitleIcon:{width:40,height:40,background:"#ecfdf5",borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center"},checkoutItemRow:{display:"flex",gap:12,padding:"14px 0",borderBottom:"1px dashed #E2E8F0"},checkoutItemImage:{width:44,height:44,borderRadius:10,overflow:"hidden",flexShrink:0,border:"1px solid #E2E8F0"},checkoutItemImagePlaceholder:{width:"100%",height:"100%",background:q.primaryLight,display:"flex",alignItems:"center",justifyContent:"center"},flexRowBetween:{display:"flex",justifyContent:"space-between",alignItems:"center"}},U=()=>(0,o.jsx)(A(),{id:"7a2cfa1861a4fa31",dynamic:[q.primaryBorder,q.primary,q.primary],children:".pos-product-card{-webkit-transform:translatey(0);-moz-transform:translatey(0);-ms-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}.pos-product-card:hover{-webkit-transform:translatey(-6px);-moz-transform:translatey(-6px);-ms-transform:translatey(-6px);-o-transform:translatey(-6px);transform:translatey(-6px);-webkit-box-shadow:0 12px 32px rgba(0,0,0,.1);-moz-box-shadow:0 12px 32px rgba(0,0,0,.1);box-shadow:0 12px 32px rgba(0,0,0,.1);border-color:".concat(q.primaryBorder,"}.pos-product-card:active{-webkit-transform:translatey(-2px)scale(.99);-moz-transform:translatey(-2px)scale(.99);-ms-transform:translatey(-2px)scale(.99);-o-transform:translatey(-2px)scale(.99);transform:translatey(-2px)scale(.99)}.pos-add-button:hover{background:-webkit-linear-gradient(315deg,#059669 0%,#047857 100%);background:-moz-linear-gradient(315deg,#059669 0%,#047857 100%);background:-o-linear-gradient(315deg,#059669 0%,#047857 100%);background:linear-gradient(135deg,#059669 0%,#047857 100%);-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-ms-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05);-webkit-box-shadow:0 6px 16px rgba(16,185,129,.5);-moz-box-shadow:0 6px 16px rgba(16,185,129,.5);box-shadow:0 6px 16px rgba(16,185,129,.5)}.pos-add-button:active{-webkit-transform:scale(.98);-moz-transform:scale(.98);-ms-transform:scale(.98);-o-transform:scale(.98);transform:scale(.98)}@-webkit-keyframes pos-fade-in{from{opacity:0;-webkit-transform:translatey(16px);transform:translatey(16px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes pos-fade-in{from{opacity:0;-moz-transform:translatey(16px);transform:translatey(16px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes pos-fade-in{from{opacity:0;-o-transform:translatey(16px);transform:translatey(16px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes pos-fade-in{from{opacity:0;-webkit-transform:translatey(16px);-moz-transform:translatey(16px);-o-transform:translatey(16px);transform:translatey(16px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.pos-fade-in{-webkit-animation:pos-fade-in.4s ease-out forwards;-moz-animation:pos-fade-in.4s ease-out forwards;-o-animation:pos-fade-in.4s ease-out forwards;animation:pos-fade-in.4s ease-out forwards}.pos-delay-1{-webkit-animation-delay:.05s;-moz-animation-delay:.05s;-o-animation-delay:.05s;animation-delay:.05s;opacity:0}.pos-delay-2{-webkit-animation-delay:.1s;-moz-animation-delay:.1s;-o-animation-delay:.1s;animation-delay:.1s;opacity:0}.pos-delay-3{-webkit-animation-delay:.15s;-moz-animation-delay:.15s;-o-animation-delay:.15s;animation-delay:.15s;opacity:0}.pos-delay-4{-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s;opacity:0}.pos-category-scroll-row::-webkit-scrollbar,.pos-category-bar::-webkit-scrollbar{height:4px}.pos-category-scroll-row::-webkit-scrollbar-track,.pos-category-bar::-webkit-scrollbar-track{background:transparent}.pos-category-scroll-row::-webkit-scrollbar-thumb,.pos-category-bar::-webkit-scrollbar-thumb{background:#CBD5E1;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}.pos-category-btn{-webkit-border-radius:12px!important;-moz-border-radius:12px!important;border-radius:12px!important;font-weight:600!important;height:42px!important;padding:0 20px!important;border:1.5px solid#E2E8F0!important;-webkit-transition:all.2s ease!important;-moz-transition:all.2s ease!important;-o-transition:all.2s ease!important;transition:all.2s ease!important}.pos-category-btn:hover{border-color:").concat(q.primary,"!important;color:").concat(q.primary,"!important}.pos-cart-icon-btn{padding:0!important;display:-webkit-inline-box!important;display:-webkit-inline-flex!important;display:-moz-inline-box!important;display:-ms-inline-flexbox!important;display:inline-flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-moz-box-align:center!important;-ms-flex-align:center!important;align-items:center!important;-webkit-box-pack:center!important;-webkit-justify-content:center!important;-moz-box-pack:center!important;-ms-flex-pack:center!important;justify-content:center!important;line-height:1!important;min-width:40px!important;width:40px!important;height:40px!important}.pos-cart-qty-btn{width:40px!important;height:40px!important}.pos-cart-action-btn{width:40px!important;height:40px!important}.pos-header-back:hover{background:rgba(255,255,255,.3)!important;-webkit-transform:translatex(-2px);-moz-transform:translatex(-2px);-ms-transform:translatex(-2px);-o-transform:translatex(-2px);transform:translatex(-2px)}.pos-header-back:focus-visible,.pos-category-btn:focus-visible,.pos-add-button:focus-visible,.pos-cart-icon-btn:focus-visible,.pos-product-card:focus-visible,.pos-product-search:focus-visible{outline:3px solid rgba(59,130,246,.5);outline-offset:2px}.pos-floating-btn-container{position:fixed!important;bottom:32px!important;right:32px!important;z-index:1000!important;-webkit-transition:all.3s cubic-bezier(.175,.885,.32,1.275);-moz-transition:all.3s cubic-bezier(.175,.885,.32,1.275);-o-transition:all.3s cubic-bezier(.175,.885,.32,1.275);transition:all.3s cubic-bezier(.175,.885,.32,1.275)}@-webkit-keyframes pos-pulse{0%,100%{-webkit-box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32);box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32)}50%{-webkit-box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45);box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45)}}@-moz-keyframes pos-pulse{0%,100%{-moz-box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32);box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32)}50%{-moz-box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45);box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45)}}@-o-keyframes pos-pulse{0%,100%{box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32)}50%{box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45)}}@keyframes pos-pulse{0%,100%{-webkit-box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32);-moz-box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32);box-shadow:0 8px 24px rgb(var(--color-primary-rgb)/.32)}50%{-webkit-box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45);-moz-box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45);box-shadow:0 12px 32px rgb(var(--color-primary-rgb)/.45)}}.pos-cart-pulse{-webkit-animation:pos-pulse 2s ease-in-out infinite;-moz-animation:pos-pulse 2s ease-in-out infinite;-o-animation:pos-pulse 2s ease-in-out infinite;animation:pos-pulse 2s ease-in-out infinite}@media(max-width:768px){.pos-cart-qty-btn,.pos-cart-action-btn{width:44px!important;height:44px!important}.pos-cart-item-controls{gap:8px!important;-webkit-flex-wrap:wrap!important;-ms-flex-wrap:wrap!important;flex-wrap:wrap!important}.pos-cart-action-row{-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-box-pack:end!important;-webkit-justify-content:flex-end!important;-moz-box-pack:end!important;-ms-flex-pack:end!important;justify-content:flex-end!important}.pos-header-mobile{padding:16px 16px 20px!important;-webkit-border-radius:0 0 20px 20px!important;-moz-border-radius:0 0 20px 20px!important;border-radius:0 0 20px 20px!important}.pos-header-title-mobile{font-size:18px!important}.pos-header-subtitle-mobile{font-size:12px!important}.pos-category-bar-mobile{padding:12px 16px!important;top:76px!important}.pos-content-mobile{padding:16px!important}.pos-product-grid-mobile{grid-template-columns:repeat(2,1fr)!important;gap:14px!important}.pos-product-image-mobile{height:130px!important}.pos-product-info-mobile{padding:12px!important}.pos-product-name-mobile{font-size:13px!important;line-height:1.3!important}.pos-product-price-mobile{font-size:15px!important}.pos-add-button-mobile{padding:8px 12px!important;font-size:11px!important;-webkit-border-radius:10px!important;-moz-border-radius:10px!important;border-radius:10px!important}.pos-floating-btn-container{bottom:100px!important;right:20px!important}.pos-product-card{min-height:220px}.pos-category-btn{height:38px!important;padding:0 16px!important;font-size:13px!important}}@media(max-width:480px){.pos-cart-item-controls{-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-moz-box-orient:vertical!important;-moz-box-direction:normal!important;-ms-flex-direction:column!important;flex-direction:column!important;-webkit-box-align:stretch!important;-webkit-align-items:stretch!important;-moz-box-align:stretch!important;-ms-flex-align:stretch!important;align-items:stretch!important}.pos-cart-qty-control{-webkit-box-pack:justify!important;-webkit-justify-content:space-between!important;-moz-box-pack:justify!important;-ms-flex-pack:justify!important;justify-content:space-between!important}.pos-cart-action-row{-webkit-box-pack:end!important;-webkit-justify-content:flex-end!important;-moz-box-pack:end!important;-ms-flex-pack:end!important;justify-content:flex-end!important}.pos-product-grid-mobile{gap:10px!important}.pos-product-image-mobile{height:110px!important}.pos-product-info-mobile{padding:10px!important}.pos-product-footer-mobile{-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-moz-box-orient:vertical!important;-moz-box-direction:normal!important;-ms-flex-direction:column!important;flex-direction:column!important;gap:10px!important;-webkit-box-align:stretch!important;-webkit-align-items:stretch!important;-moz-box-align:stretch!important;-ms-flex-align:stretch!important;align-items:stretch!important}.pos-add-button-mobile{width:100%!important;-webkit-box-pack:center!important;-webkit-justify-content:center!important;-moz-box-pack:center!important;-ms-flex-pack:center!important;justify-content:center!important}}@media(min-width:1200px){.pos-product-grid{grid-template-columns:repeat(auto-fill,minmax(220px,1fr))!important;gap:24px!important}}@media(min-width:1600px){.pos-product-grid{grid-template-columns:repeat(auto-fill,minmax(240px,1fr))!important}}@media(hover:none){.pos-cart-icon-btn{min-width:44px!important;width:44px!important;height:44px!important}.pos-product-card:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.pos-product-card:hover{-webkit-transform:none!important;-moz-transform:none!important;-ms-transform:none!important;-o-transform:none!important;transform:none!important;-webkit-box-shadow:0 4px 16px rgba(0,0,0,.04)!important;-moz-box-shadow:0 4px 16px rgba(0,0,0,.04)!important;box-shadow:0 4px 16px rgba(0,0,0,.04)!important}}@media(prefers-reduced-motion:reduce){*,*::before,*::after{-webkit-animation-duration:.01ms!important;-moz-animation-duration:.01ms!important;-o-animation-duration:.01ms!important;animation-duration:.01ms!important;-webkit-animation-iteration-count:1!important;-moz-animation-iteration-count:1!important;-o-animation-iteration-count:1!important;animation-iteration-count:1!important;-webkit-transition-duration:.01ms!important;-moz-transition-duration:.01ms!important;-o-transition-duration:.01ms!important;transition-duration:.01ms!important;scroll-behavior:auto!important}.pos-cart-pulse{-webkit-animation:none!important;-moz-animation:none!important;-o-animation:none!important;animation:none!important}}")});var M=r(7806),X=r(67338);let{Title:G,Text:K}=n.default;function Q(t){var e;let{title:r,subtitle:n,icon:h,onConfirmOrder:_}=t,{isLoading:L}=(0,Z.x)(),A=(0,I.useRouter)(),[Q,$]=(0,a.useState)(1),[tt,te]=(0,a.useState)(void 0),{data:tr=[]}=(0,W.L)(),[to,ta]=(0,a.useState)(""),[ti,tn]=(0,a.useState)("");a.useEffect(()=>{let t=window.setTimeout(()=>{tn(to.trim())},250);return()=>{window.clearTimeout(t)}},[to]);let{products:ts,isLoading:tl,total:td}=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,{socket:i}=(0,a.useContext)(B.J),n=(0,E.NL)(),{data:s,error:l,isLoading:d,refetch:c}=(0,R.a)({queryKey:["products",t,e,r||"all",o||""],queryFn:async()=>{let a=new URLSearchParams;r&&a.append("category_id",r);let i=null==o?void 0:o.trim();return i&&a.append("q",i),await N.R.findAll(t,e,void 0,a)},placeholderData:F.Wk,staleTime:3e4});return(0,a.useEffect)(()=>{if(!i)return;let t=(t,e)=>"all"===t||"string"!=typeof t||"string"==typeof e&&e===t,e=e=>{n.invalidateQueries({predicate:r=>{if("products"!==r.queryKey[0])return!1;let o=r.queryKey[1],a=r.queryKey[3];return 1===o&&(!e||t(a,e.category_id))}})},r=t=>{e(t)},o=e=>{for(let[r,o]of n.getQueriesData({queryKey:["products"]})){if(!o||!t(r[3],e.category_id))continue;let a=o.data.findIndex(t=>t.id===e.id);if(-1===a)continue;let i=[...o.data];i[a]=e,n.setQueryData(r,{...o,data:i})}},a=t=>{let e=D(t);if(e)for(let[t,r]of n.getQueriesData({queryKey:["products"]}))r&&r.data.some(t=>t.id===e)&&(n.setQueryData(t,{...r,data:r.data.filter(t=>t.id!==e),total:Math.max((r.total||0)-1,0)}),n.invalidateQueries({queryKey:t,exact:!0}))},s=()=>e();return i.on(P.b.products.create,r),i.on(P.b.products.update,o),i.on(P.b.products.delete,a),i.on(P.b.stock.update,s),()=>{i.off(P.b.products.create,r),i.off(P.b.products.update,o),i.off(P.b.products.delete,a),i.off(P.b.stock.update,s)}},[i,n]),{products:(null==s?void 0:s.data)||[],total:(null==s?void 0:s.total)||0,currentPage:(null==s?void 0:s.page)||1,lastPage:(null==s?void 0:s.last_page)||1,isLoading:d,isError:l,mutate:c}}(Q,20,tt,ti),[tc,tp]=(0,a.useState)(!1),[tm,tu]=(0,a.useState)(!1),[tx,tf]=(0,a.useState)(!1),[ty,tg]=(0,a.useState)(!1),[th,tb]=(0,a.useState)(null),{cartItems:tw,addToCart:tj,removeFromCart:tk,updateQuantity:tv,updateItemNote:tS,clearCart:tz,updateItemDetails:tC,orderMode:t_,selectedDiscount:tI}=(0,T.j)(),{totalItems:tT,subtotal:tZ,discountAmount:tE,finalPrice:tR}=(0,a.useMemo)(()=>{let t=0,e=0;for(let o of tw){var r;t+=o.quantity,e+=(("DELIVERY"===t_?Number(null!==(r=o.product.price_delivery)&&void 0!==r?r:o.product.price):Number(o.product.price))+(o.details||[]).reduce((t,e)=>t+Number(e.extra_price||0),0))*o.quantity}let o=0;tI&&(o="Percentage"===tI.discount_type?e*tI.discount_amount/100:Math.min(tI.discount_amount,e));let a=Math.max(0,e-o);return{totalItems:t,subtotal:e,discountAmount:o,finalPrice:a}},[tw,t_,tI]),tF=(0,a.useCallback)(t=>{var e;return"DELIVERY"===t_?Number(null!==(e=t.price_delivery)&&void 0!==e?e:t.price):Number(t.price)},[t_]);a.useEffect(()=>{let t=window.location.pathname;return()=>{window.location.pathname!==t&&tz()}},[tz]);let[tB,tN]=(0,a.useState)(!1),[tP,tD]=(0,a.useState)(null),[tW,tL]=(0,a.useState)(""),[tA,tq]=(0,a.useState)(!1),[tO,tH]=(0,a.useState)(null),tU=(0,a.useCallback)((t,e,r)=>{tH({id:t,name:e,details:r||[]}),tq(!0)},[]),tM=(0,a.useCallback)((t,e,r)=>{tD({id:t,name:e,note:r}),tL(r||""),tN(!0)},[]),tX=(0,a.useCallback)(()=>{tP&&(tS(tP.id,tW),tN(!1),tD(null),s.ZP.success("บันทึกโน้ตเรียบร้อยแล้ว"))},[tP,tW,tS]),tG=(0,a.useCallback)(t=>{let e=tj(t),r=t.display_name||t.product_name||"สินค้า";s.ZP.open({type:"success",content:(0,o.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[(0,o.jsxs)("span",{children:["เพิ่ม ",r," ลงตะกร้าแล้ว"]}),(0,o.jsx)(l.ZP,{type:"link",size:"small",onClick:t=>{t.preventDefault(),tk(e),s.ZP.destroy("cart-add")},style:{padding:0,height:"auto"},children:"Undo"})]}),key:"cart-add",duration:2.5})},[tj,tk]),tK=t=>{tb(t),tg(!0)},tQ=()=>{tg(!1),tb(null)},tJ=(0,a.useCallback)(()=>{if(0===tw.length){s.ZP.warning("กรุณาเพิ่มสินค้าลงตะกร้าก่อน");return}tu(!0)},[tw.length]),tY=(0,a.useCallback)(async()=>{try{tf(!0),await _(),tu(!1),tp(!1)}catch(t){console.error(t)}finally{tf(!1)}},[_]),tV=(0,a.useMemo)(()=>(0,M.S)(tw),[tw]),t$=(0,a.useMemo)(()=>{let t={};return tw.forEach(e=>{var r;let o=(null===(r=e.product.category)||void 0===r?void 0:r.display_name)||"อื่นๆ";t[o]=(t[o]||0)+e.quantity}),Object.entries(t).map(t=>{let[e,r]=t;return{name:e,count:r}})},[tw]),t0=(0,a.useCallback)(t=>(0,o.jsx)(J,{item:t,getProductUnitPrice:tF,onUpdateQuantity:tv,onRemove:tk,onOpenNote:tM,onOpenDetail:tU}),[tF,tv,tk,tM,tU]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(U,{}),(0,o.jsxs)("div",{style:O.container,children:[(0,o.jsx)("header",{style:O.header,className:"pos-header-mobile",role:"banner",children:(0,o.jsx)("div",{style:O.headerContent,children:(0,o.jsxs)("div",{style:O.headerLeft,children:[(0,o.jsx)("button",{className:"pos-header-back",style:O.headerBackButton,onClick:()=>A.back(),"aria-label":"กลับ",children:(0,o.jsx)(b.Z,{style:{fontSize:18}})}),(0,o.jsx)("div",{style:O.headerIconWrapper,children:h}),(0,o.jsxs)("div",{style:O.headerInfo,children:[(0,o.jsx)(G,{level:4,style:O.headerTitle,className:"pos-header-title-mobile",children:r}),(0,o.jsx)(K,{style:O.headerSubtitle,className:"pos-header-subtitle-mobile",children:n})]})]})})}),(0,o.jsx)("nav",{style:O.categoryBar,className:"pos-category-bar pos-category-bar-mobile",role:"navigation","aria-label":"ตัวกรองหมวดหมู่",children:(0,o.jsxs)("div",{style:{maxWidth:1400,margin:"0 auto",display:"flex",flexDirection:"column",gap:12},children:[(0,o.jsx)(d.default,{value:to,allowClear:!0,prefix:(0,o.jsx)(w.Z,{style:{color:"#94a3b8"}}),placeholder:"ค้นหาสินค้า...","aria-label":"ค้นหาสินค้า",onChange:t=>{ta(t.target.value),$(1)},className:"pos-product-search",style:{borderRadius:16,height:44}}),(0,o.jsxs)("div",{style:O.categoryScroll,className:"pos-category-scroll-row",children:[(0,o.jsx)(l.ZP,{type:tt?"text":"primary",onClick:()=>{te(void 0),$(1)},className:"pos-category-btn",style:{background:tt?"white":q.primary,borderColor:tt?"#E2E8F0":q.primary,color:tt?"#64748B":"#fff",border:tt?"1px solid #E2E8F0":"1px solid ".concat(q.primary),fontWeight:tt?400:600,boxShadow:tt?"none":"0 4px 12px rgba(79, 70, 229, 0.2)",height:36,padding:"0 20px",borderRadius:18,transition:"all 0.3s ease"},children:"ทั้งหมด"}),tr.map(t=>(0,o.jsx)(l.ZP,{type:tt===t.id?"primary":"text",onClick:()=>{te(t.id),$(1)},className:"pos-category-btn",style:{background:tt===t.id?q.primary:"white",borderColor:tt===t.id?q.primary:"#E2E8F0",color:tt===t.id?"#fff":"#64748B",border:tt===t.id?"1px solid ".concat(q.primary):"1px solid #E2E8F0",fontWeight:tt===t.id?600:400,boxShadow:tt===t.id?"0 4px 12px rgba(79, 70, 229, 0.2)":"none",height:36,padding:"0 20px",borderRadius:18,transition:"all 0.3s ease"},children:t.display_name},t.id))]})]})}),(0,o.jsx)("main",{style:O.content,className:"pos-content-mobile",role:"main",children:tl&&!L?(0,o.jsxs)("div",{style:O.loadingContainer,children:[(0,o.jsx)(c.Z,{size:"large"}),(0,o.jsx)(K,{style:{display:"block",marginTop:16,color:q.textSecondary},children:"กำลังโหลดสินค้า..."})]}):ts.length>0?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:O.productGrid,className:"pos-product-grid pos-product-grid-mobile",children:ts.map((t,e)=>(0,o.jsxs)("article",{className:"pos-product-card pos-fade-in pos-delay-".concat(e%4+1),style:O.productCard,onClick:()=>tK(t),role:"button",tabIndex:0,"aria-label":"ดูรายละเอียด ".concat(t.display_name),"aria-haspopup":"dialog",onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),tK(t))},children:[(0,o.jsx)("div",{style:O.productImage,className:"pos-product-image-mobile",children:(0,X.dU)(t)?(0,o.jsx)(i.default,{alt:t.product_name,src:t.img_url,fill:!0,style:{objectFit:"cover"},sizes:"(max-width: 768px) 50vw, 220px"}):(0,o.jsx)("div",{style:{width:"100%",height:"100%",background:"linear-gradient(135deg, ".concat(q.primaryLight," 0%, #DBEAFE 100%)"),display:"flex",justifyContent:"center",alignItems:"center"},children:(0,o.jsx)(j.Z,{style:{fontSize:48,color:q.primary,opacity:.4}})})}),(0,o.jsxs)("div",{style:O.productInfo,className:"pos-product-info-mobile",children:[(0,o.jsx)(K,{ellipsis:!0,style:O.productName,className:"pos-product-name-mobile",children:t.display_name}),(0,o.jsx)(p.Z,{color:"blue",style:{fontSize:10,marginBottom:0,borderRadius:6,border:"none",background:q.primaryLight,color:q.primary},children:(0,X.r6)(t)}),(0,o.jsxs)("div",{style:O.productFooter,className:"pos-product-footer-mobile",children:[(0,o.jsx)(K,{style:O.productPrice,className:"pos-product-price-mobile",children:(0,X.T4)(tF(t))}),(0,o.jsx)(l.ZP,{type:"primary",size:"small",icon:(0,o.jsx)(k.Z,{}),className:"pos-add-button pos-add-button-mobile",style:O.addButton,onClick:e=>{e.stopPropagation(),tG(t)},children:"เพิ่ม"})]})]})]},t.id))}),(0,o.jsx)("div",{style:O.paginationContainer,children:(0,o.jsx)(m.Z,{current:Q,total:td,pageSize:20,onChange:t=>$(t),showSizeChanger:!1,showTotal:t=>"ทั้งหมด ".concat(t," รายการ")})})]}):(0,o.jsx)("div",{style:{background:"#fff",borderRadius:24,padding:"80px 24px",textAlign:"center",boxShadow:"0 4px 24px rgba(0,0,0,0.04)"},children:(0,o.jsx)(u.Z,{image:u.Z.PRESENTED_IMAGE_SIMPLE,imageStyle:{height:120},description:(0,o.jsxs)("div",{style:{marginTop:20},children:[(0,o.jsx)(G,{level:4,style:{marginBottom:8,color:q.text},children:ti?"ไม่พบสินค้า":"ยังไม่มีข้อมูลสินค้า"}),(0,o.jsx)(K,{type:"secondary",style:{fontSize:15},children:ti?"ไม่พบสินค้า".concat(ti?" สำหรับ “".concat(ti,"”"):""," ลองเปลี่ยนคำค้นหา หรือเลือกหมวดอื่น"):"กรุณาเพิ่มสินค้าก่อนใช้งาน"})]}),children:ti?(0,o.jsx)(l.ZP,{size:"large",onClick:()=>{ta(""),$(1)},style:{height:52,padding:"0 40px",borderRadius:16,fontSize:16,fontWeight:700,marginTop:20,background:"#fff",border:"1px solid ".concat(q.border),color:q.text},children:"ล้างคำค้นหา"}):(0,o.jsx)(l.ZP,{type:"primary",size:"large",icon:(0,o.jsx)(j.Z,{}),style:{height:52,padding:"0 40px",borderRadius:16,fontSize:16,fontWeight:600,marginTop:20,background:"linear-gradient(135deg, ".concat(q.primary," 0%, ").concat(q.primaryDark," 100%)"),border:"none",boxShadow:"0 8px 20px rgb(var(--color-primary-rgb) / 0.25)"},onClick:()=>A.push("/pos/products"),children:"ไปหน้าจัดการสินค้า"})})})}),(0,o.jsx)("div",{className:"pos-floating-btn-container",children:(0,o.jsx)(x.Z,{count:tT,size:"default",offset:[-5,5],children:(0,o.jsx)(l.ZP,{type:"primary",shape:"circle",size:"large",icon:(0,o.jsx)(v.Z,{style:{fontSize:26}}),onClick:()=>tp(!0),style:O.floatingCartButton,className:tT>0?"pos-cart-pulse":"","aria-label":"ตะกร้าสินค้า ".concat(tT," รายการ")})})}),(0,o.jsx)(f.Z,{title:(0,o.jsxs)("div",{style:H.drawerTitleRow,children:[(0,o.jsx)("div",{style:H.drawerTitleIcon,children:(0,o.jsx)(v.Z,{style:{fontSize:20,color:"#10b981"}})}),(0,o.jsxs)("div",{children:[(0,o.jsx)(K,{style:{fontSize:18,fontWeight:700,color:"#1e293b",display:"block",lineHeight:1.2},children:"ตะกร้าสินค้า"}),(0,o.jsxs)(K,{type:"secondary",style:{fontSize:12,fontWeight:500},children:[tT," รายการ"]})]})]}),placement:"right",onClose:()=>tp(!1),open:tc,width:420,styles:{wrapper:{maxWidth:"100vw"},body:{padding:"16px 20px",background:"#f8fafc"},header:{padding:"20px",borderBottom:"1px solid #f1f5f9"},footer:{padding:"20px",borderTop:"1px solid #e2e8f0",background:"white"}},footer:(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(K,{type:"secondary",style:{fontSize:15},children:["ยอดรวม (",tT," รายการ)"]}),(0,o.jsx)(K,{style:{fontWeight:600,fontSize:16},children:(0,X.T4)(tZ)})]}),tE>0&&(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)(K,{type:"secondary",style:{fontSize:15},children:"ส่วนลด"}),(0,o.jsxs)(K,{style:{fontWeight:600,fontSize:16,color:"#ef4444"},children:["-",(0,X.T4)(tE)]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,o.jsx)(K,{style:{fontSize:16,fontWeight:700,color:"#1e293b"},children:"ยอดสุทธิ"}),(0,o.jsx)("div",{style:{textAlign:"right"},children:(0,o.jsx)(G,{level:2,style:{margin:0,color:"#10b981",lineHeight:1},children:(0,X.T4)(tR)})})]}),(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:8},children:[(0,o.jsx)(l.ZP,{size:"large",danger:!0,icon:(0,o.jsx)(S.Z,{}),onClick:()=>{y.Z.confirm({title:"ล้างตะกร้าสินค้า?",content:"รายการทั้งหมดจะถูกลบ และไม่สามารถย้อนกลับได้",okText:"ล้างตะกร้า",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:tz})},disabled:0===tw.length,style:{borderRadius:12,height:48,fontWeight:600,border:"none",background:"#fef2f2",color:"#ef4444"},children:"ล้างตะกร้า"}),(0,o.jsx)(l.ZP,{type:"primary",size:"large",onClick:tJ,disabled:0===tw.length,style:{borderRadius:12,height:48,fontWeight:700,background:"#10b981",boxShadow:"0 4px 12px rgba(16, 185, 129, 0.4)"},children:"ชำระเงิน"})]})]}),children:tw.length>0?(0,o.jsx)(g.Z,{dataSource:tw,renderItem:t0,split:!1}):(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",opacity:.5},children:[(0,o.jsx)(v.Z,{style:{fontSize:64,color:"#cbd5e1",marginBottom:16}}),(0,o.jsx)(K,{style:{color:"#64748b",fontSize:16},children:"ไม่มีสินค้าในตะกร้า"}),(0,o.jsx)(K,{style:{color:"#94a3b8",fontSize:14},children:"เลือกสินค้าจากเมนูเพื่อเพิ่มลงตะกร้า"})]})}),tc&&(0,o.jsx)(f.Z,{title:(0,o.jsxs)("div",{style:{...H.modalTitleRow,color:"#fff"},children:[(0,o.jsx)(v.Z,{style:{fontSize:20}}),(0,o.jsx)("span",{style:{fontWeight:700,fontSize:18},children:"สรุปรายการออเดอร์"})]}),width:420,open:tm,onClose:()=>tu(!1),closeIcon:(0,o.jsx)(z.Z,{style:{color:"#fff"}}),styles:{wrapper:{maxWidth:"100vw"},header:{background:"linear-gradient(145deg, ".concat(q.primary," 0%, ").concat(q.primaryDark," 100%)"),padding:"20px 24px"},body:{padding:"0 24px"},footer:{padding:"16px 24px"}},footer:(0,o.jsx)("div",{style:{padding:"8px 0"},children:(0,o.jsx)(l.ZP,{type:"primary",block:!0,size:"large",loading:tx,onClick:tY,style:{background:"linear-gradient(135deg, ".concat(q.success," 0%, #059669 100%)"),border:"none",height:56,fontWeight:700,fontSize:18,borderRadius:14,boxShadow:"0 8px 20px ".concat(q.success,"40")},children:"ยืนยันการสั่งออเดอร์"})}),children:(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:24,padding:"24px 0"},children:[(0,o.jsxs)("section",{children:[(0,o.jsx)(G,{level:5,style:{marginBottom:16,color:q.text},children:"รายการที่สั่ง"}),(0,o.jsx)(g.Z,{itemLayout:"horizontal",dataSource:tV,renderItem:t=>(0,o.jsx)(Y,{item:t,getProductUnitPrice:tF})})]}),(0,o.jsxs)("section",{style:{background:"#F8FAFC",padding:16,borderRadius:14,border:"1px solid #E2E8F0"},children:[(0,o.jsx)(K,{strong:!0,style:{fontSize:14,marginBottom:12,display:"block",color:q.textSecondary},children:"สรุปตามหมวดหมู่"}),t$.map(t=>{let{name:e,count:r}=t;return(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[(0,o.jsx)(K,{type:"secondary",style:{fontSize:13},children:e}),(0,o.jsxs)(K,{strong:!0,style:{fontSize:13},children:[r," รายการ"]})]},e)})]}),(0,o.jsxs)("section",{style:{background:"#fff",padding:"20px",borderTop:"2px solid #E2E8F0"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[(0,o.jsx)(K,{type:"secondary",style:{fontSize:15},children:"รวมจำนวนทั้งหมด"}),(0,o.jsxs)(K,{strong:!0,style:{fontSize:15},children:[tT," รายการ"]})]}),tE>0&&(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[(0,o.jsx)(K,{type:"secondary",style:{fontSize:15},children:"ส่วนลด"}),(0,o.jsxs)(K,{strong:!0,style:{fontSize:15,color:"#ef4444"},children:["-",(0,X.T4)(tE)]})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)(K,{style:{fontSize:20,fontWeight:700,color:q.text},children:"ยอดรวมสุทธิ"}),(0,o.jsx)(K,{style:{fontSize:32,fontWeight:800,color:q.primary},children:(0,X.T4)(tR)})]})]})]})}),(0,o.jsx)(y.Z,{title:(0,o.jsxs)("div",{style:H.modalTitleRow,children:[(0,o.jsx)("div",{style:{...H.modalIconBase,background:q.warningLight},children:(0,o.jsx)(C.Z,{style:{color:q.warning,fontSize:16}})}),(0,o.jsxs)("span",{children:["ระบุรายละเอียด: ",null==tP?void 0:tP.name]})]}),open:tB,onOk:tX,onCancel:()=>{tN(!1),tD(null)},okText:"บันทึก",cancelText:"ยกเลิก",centered:!0,okButtonProps:{style:{...H.modalButton,background:q.primary}},cancelButtonProps:{style:H.modalButton},children:(0,o.jsxs)("div",{style:{padding:"16px 0"},children:[(0,o.jsx)(K,{style:{display:"block",marginBottom:10,color:q.textSecondary},children:"รายละเอียด / หมายเหตุ"}),(0,o.jsx)(d.default.TextArea,{rows:4,value:tW,onChange:t=>tL(t.target.value),placeholder:"เช่น ไม่ใส่ผัก, หวานน้อย, แยกน้ำ...",maxLength:200,showCount:!0,style:{borderRadius:10}})]})}),(0,o.jsx)(y.Z,{title:(0,o.jsxs)("div",{style:H.modalTitleRow,children:[(0,o.jsx)("div",{style:{...H.modalIconBase,background:q.primaryLight},children:(0,o.jsx)(j.Z,{style:{color:q.primary,fontSize:16}})}),(0,o.jsx)("span",{style:{fontWeight:700},children:null==th?void 0:th.display_name})]}),open:ty,onCancel:tQ,centered:!0,width:560,footer:[(0,o.jsx)(l.ZP,{onClick:tQ,style:H.modalButtonLarge,children:"ปิด"},"close"),(0,o.jsx)(l.ZP,{type:"primary",icon:(0,o.jsx)(k.Z,{}),onClick:()=>{th&&(tG(th),tQ())},style:{...H.modalButtonLarge,background:"linear-gradient(135deg, ".concat(q.success," 0%, #059669 100%)"),border:"none",fontWeight:700},children:"เพิ่มลงตะกร้า"},"add")],children:th&&(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[(0,o.jsx)("div",{style:{position:"relative",width:"100%",height:240,borderRadius:16,overflow:"hidden",border:"1px solid ".concat(q.borderLight),background:"linear-gradient(135deg, ".concat(q.primaryLight," 0%, #DBEAFE 100%)")},children:(0,X.dU)(th)?(0,o.jsx)(i.default,{alt:th.product_name,src:th.img_url,fill:!0,style:{objectFit:"cover"},sizes:"(max-width: 768px) 90vw, 560px"}):(0,o.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,o.jsx)(j.Z,{style:{fontSize:56,color:q.primary,opacity:.4}})})}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)(p.Z,{style:{border:"none",background:q.primaryLight,color:q.primary,fontSize:12,padding:"2px 10px",borderRadius:999,margin:0},children:(0,X.r6)(th)}),(0,o.jsx)(G,{level:4,style:{margin:"10px 0 0",color:q.text,lineHeight:1.2},children:th.display_name})]}),(0,o.jsxs)("div",{style:{textAlign:"right"},children:[(0,o.jsx)(K,{type:"secondary",style:{fontSize:12},children:"ราคา"}),(0,o.jsx)("div",{style:{fontSize:24,fontWeight:800,color:q.primary,lineHeight:1.1},children:(0,X.T4)(tF(th))})]})]}),(0,o.jsxs)("div",{style:{background:"#fff",borderRadius:14,padding:14,border:"1px solid ".concat(q.borderLight)},children:[(0,o.jsx)(K,{style:{display:"block",marginBottom:6,fontWeight:700,color:q.textSecondary},children:"รายละเอียดสินค้า"}),(0,o.jsx)(K,{style:{color:q.textSecondary,fontSize:14,lineHeight:1.6},children:(null===(e=th.description)||void 0===e?void 0:e.trim())?th.description:"ไม่มีรายละเอียดสินค้า"})]})]})}),(0,o.jsx)(V,{item:tO,isOpen:tA,onClose:()=>{tq(!1),tH(null)},onSave:t=>{tO&&tC(tO.id,t)}})]})]})}let J=a.memo(function(t){var e;let{item:r,getProductUnitPrice:a,onUpdateQuantity:i,onRemove:n,onOpenNote:s,onOpenDetail:d}=t,c=a(r.product),m=(r.details||[]).reduce((t,e)=>t+Number(e.extra_price||0),0),u=Number(r.discount||0),x=Math.max(0,(c+m)*r.quantity-u),f=r.product.display_name||r.product.product_name||"สินค้า",y=(null===(e=r.product.category)||void 0===e?void 0:e.display_name)||"ทั่วไป";return(0,o.jsx)(g.Z.Item,{style:H.cartItemContainer,className:"cart-item-hover",children:(0,o.jsxs)("div",{style:H.cartItemRow,children:[(0,o.jsx)("div",{style:{flexShrink:0},children:r.product.img_url?(0,o.jsx)("div",{style:H.cartItemImage,children:(0,o.jsx)("img",{src:r.product.img_url,alt:f,style:{width:"100%",height:"100%",objectFit:"cover"}})}):(0,o.jsx)("div",{style:H.cartItemImagePlaceholder,children:(0,o.jsx)(j.Z,{style:{fontSize:24,color:"#94a3b8"}})})}),(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,o.jsxs)("div",{style:{flex:1},children:[(0,o.jsx)(K,{style:{fontWeight:600,fontSize:15,color:"#1e293b",display:"block",lineHeight:1.2,marginBottom:4},children:f}),(0,o.jsx)(p.Z,{style:H.cartItemTag,children:y})]}),(0,o.jsx)(K,{style:{fontWeight:700,fontSize:16,color:"#10b981",whiteSpace:"nowrap",marginLeft:8},children:(0,X.T4)(x)})]}),r.details&&r.details.length>0&&(0,o.jsx)("div",{style:{marginTop:6,marginBottom:4},children:r.details.map((t,e)=>(0,o.jsxs)(K,{style:{display:"block",fontSize:12,color:"#10b981",lineHeight:1.4},children:["+ ",t.detail_name," ",(0,o.jsxs)("span",{style:{opacity:.8},children:["(+",(0,X.T4)(Number(t.extra_price||0)),")"]})]},e))}),r.notes&&(0,o.jsx)("div",{style:H.cartItemNote,children:(0,o.jsxs)(K,{style:{fontSize:11,color:"#ef4444"},children:["โน้ต: ",r.notes]})}),(0,o.jsxs)("div",{className:"pos-cart-item-controls",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:8},children:[(0,o.jsxs)("div",{className:"pos-cart-qty-control",style:H.cartItemQtyControl,children:[(0,o.jsx)(l.ZP,{type:"text",size:"small",icon:(0,o.jsx)(_.Z,{style:{fontSize:10}}),className:"pos-cart-icon-btn pos-cart-qty-btn","aria-label":"ลดจำนวน",onClick:()=>i(r.cart_item_id,r.quantity-1),style:{borderRadius:10,background:"white",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"}}),(0,o.jsx)(K,{style:{margin:"0 8px",fontWeight:600,minWidth:16,textAlign:"center",fontSize:13},children:r.quantity}),(0,o.jsx)(l.ZP,{type:"text",size:"small",icon:(0,o.jsx)(k.Z,{style:{fontSize:10}}),className:"pos-cart-icon-btn pos-cart-qty-btn","aria-label":"เพิ่มจำนวน",onClick:()=>i(r.cart_item_id,r.quantity+1),style:{borderRadius:10,background:"#10b981",color:"white"}})]}),(0,o.jsxs)("div",{className:"pos-cart-action-row",style:{display:"flex",gap:6},children:[(0,o.jsx)(l.ZP,{type:"text",icon:(0,o.jsx)(C.Z,{}),size:"small",className:"pos-cart-icon-btn pos-cart-action-btn","aria-label":"แก้ไขโน้ต",onClick:()=>s(r.cart_item_id,f,r.notes||""),style:{color:"#64748b",background:"#f1f5f9",borderRadius:10}}),(0,o.jsx)(l.ZP,{type:"text",icon:(0,o.jsx)(k.Z,{}),size:"small",className:"pos-cart-icon-btn pos-cart-action-btn","aria-label":"เพิ่มรายละเอียด",onClick:()=>d(r.cart_item_id,f,r.details),style:{color:"#10b981",background:"#ecfdf5",borderRadius:10}}),(0,o.jsx)(l.ZP,{type:"text",danger:!0,icon:(0,o.jsx)(S.Z,{}),size:"small",className:"pos-cart-icon-btn pos-cart-action-btn","aria-label":"ลบออกจากตะกร้า",onClick:()=>n(r.cart_item_id),style:{background:"#fef2f2",borderRadius:10}})]})]})]})]})},r.cart_item_id)}),Y=a.memo(function(t){let{item:e,getProductUnitPrice:r}=t,a=r(e.product),i=(a+(e.details||[]).reduce((t,e)=>t+Number(e.extra_price||0),0))*e.quantity;return(0,o.jsxs)("div",{style:H.checkoutItemRow,children:[(0,o.jsx)("div",{style:H.checkoutItemImage,children:e.product.img_url?(0,o.jsx)("img",{src:e.product.img_url,alt:e.product.display_name,style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,o.jsx)("div",{style:H.checkoutItemImagePlaceholder,children:(0,o.jsx)(j.Z,{style:{fontSize:16,color:q.primary,opacity:.5}})})}),(0,o.jsx)("div",{style:{flex:1,minWidth:0},children:(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,o.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,o.jsx)(K,{strong:!0,style:{fontSize:14,display:"block",marginBottom:4},children:e.product.display_name}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsx)(K,{type:"secondary",style:{fontSize:12},children:"ราคาอาหาร"}),(0,o.jsx)(K,{type:"secondary",style:{fontSize:12},children:(0,X.T4)(a)})]}),e.details&&e.details.map((t,e)=>(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,o.jsxs)(K,{style:{fontSize:12,color:q.success},children:["+ ",t.detail_name]}),(0,o.jsx)(K,{style:{fontSize:12,color:q.success},children:(0,X.T4)(Number(t.extra_price))})]},e)),(0,o.jsx)("div",{style:{marginTop:4},children:(0,o.jsxs)(K,{style:{fontSize:12,fontWeight:700,color:"#B45309"},children:["จำนวน : ",e.quantity]})})]}),e.notes&&(0,o.jsx)("div",{style:{marginTop:8,padding:"6px 10px",background:"#fef2f2",borderRadius:8,borderLeft:"3px solid #ef4444"},children:(0,o.jsxs)(K,{italic:!0,style:{fontSize:12,color:"#ef4444"},children:["โน้ต: ",e.notes]})})]}),(0,o.jsx)(K,{strong:!0,style:{fontSize:15,marginLeft:12,color:q.primary},children:(0,X.T4)(i)})]})})]},e.id)});function V(t){let{item:e,isOpen:r,onClose:i,onSave:n}=t,[s,c]=(0,a.useState)([]);a.useEffect(()=>{e&&r&&c(e.details?[...e.details.map(t=>({...t}))]:[])},[e,r]);let p=t=>{c(s.filter((e,r)=>r!==t))},m=(t,e,r)=>{let o=[...s];o[t]={...o[t],[e]:r},c(o)};return(0,o.jsx)(y.Z,{title:(0,o.jsxs)("div",{style:H.modalTitleRow,children:[(0,o.jsx)("div",{style:{...H.modalIconBase,background:q.successLight},children:(0,o.jsx)(k.Z,{style:{color:q.success,fontSize:16}})}),(0,o.jsxs)("span",{children:["รายละเอียดเพิ่มเติม: ",null==e?void 0:e.name]})]}),open:r,onCancel:i,footer:[(0,o.jsx)(l.ZP,{onClick:i,style:{borderRadius:10,height:42},children:"ยกเลิก"},"cancel"),(0,o.jsx)(l.ZP,{type:"primary",onClick:()=>{n(s.filter(t=>""!==t.detail_name.trim())),i()},style:{background:q.success,borderRadius:10,height:42},children:"บันทึก"},"save")],width:520,centered:!0,children:(0,o.jsxs)("div",{style:{padding:"16px 0"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,o.jsx)(K,{strong:!0,style:{color:q.textSecondary},children:"รายการเพิ่มเติม"}),(0,o.jsx)(l.ZP,{type:"dashed",size:"small",icon:(0,o.jsx)(k.Z,{}),onClick:()=>{c([...s,{detail_name:"",extra_price:0}])},style:{borderRadius:8},children:"เพิ่มรายการ"})]}),0===s.length?(0,o.jsxs)("div",{style:{textAlign:"center",padding:"32px",background:"#F8FAFC",borderRadius:12,color:q.textSecondary},children:[(0,o.jsx)(k.Z,{style:{fontSize:24,marginBottom:8,opacity:.4}}),(0,o.jsx)("div",{children:"ไม่มีรายการเพิ่มเติม"})]}):(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:s.map((t,e)=>(0,o.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[(0,o.jsx)(d.default,{placeholder:"ชื่อรายการ",value:t.detail_name,onChange:t=>m(e,"detail_name",t.target.value),style:{flex:2,borderRadius:8,height:42}}),(0,o.jsx)(h.Z,{placeholder:"ราคา",value:t.extra_price,onChange:t=>m(e,"extra_price",t||0),style:{flex:1,height:42},inputMode:"decimal",controls:!1,min:0,precision:2,formatter:t=>null==t||""===t?"":"".concat(t).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>{let e=Number.parseFloat((null!=t?t:"").replace(/[^\d.]/g,""));return Number.isFinite(e)?e:0},onKeyDown:e=>{/^[0-9]$/.test(e.key)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","."].includes(e.key)||e.preventDefault(),"."===e.key&&t.extra_price.toString().includes(".")&&e.preventDefault()}}),(0,o.jsx)(l.ZP,{danger:!0,type:"text",icon:(0,o.jsx)(S.Z,{}),onClick:()=>p(e),style:{borderRadius:8,height:42,width:42}})]},e))})]})})}},25193:function(t,e,r){r.d(e,{Z:function(){return n}});var o=r(57437);r(2265);var a=r(38616),i=r(87530);function n(t){let{children:e,maxWidth:r=i.H.pageMaxWidth,style:n}=t,s=a.default.useBreakpoint().md?i.H.pagePaddingXDesktop:i.H.pagePaddingXMobile;return(0,o.jsx)("div",{style:{width:"100%",maxWidth:r,margin:"0 auto",padding:"".concat(i.H.pagePaddingY,"px ").concat(s,"px"),...n},children:e})}},87530:function(t,e,r){r.d(e,{H:function(){return o}});let o={pageMaxWidth:1200,pagePaddingXMobile:16,pagePaddingXDesktop:24,pagePaddingY:16,sectionGap:16,cardRadius:16,cardRadiusLG:20,cardShadow:"0 10px 24px rgba(15, 23, 42, 0.08)",surfaceBg:"#ffffff",surfaceBorder:"#e2e8f0"}},79657:function(t,e,r){r.d(e,{L:function(){return s}});var o=r(11713),a=r(2838),i=r(73814);let n="pos:categories";function s(){return(0,o.a)({queryKey:["categories"],queryFn:async()=>{let t=await a.G.findAll();return(null==t?void 0:t.length)&&(0,i.v)(n,t),t},initialData:()=>(0,i.t)(n,3e5)||void 0,staleTime:3e5,refetchOnWindowFocus:!1,retry:1})}},2838:function(t,e,r){r.d(e,{G:function(){return n}});var o=r(2913),a=r(98170);let i="/pos/category",n={findAll:async(t,e)=>{let r=(0,o.b)("GET",i);e&&(r+="?".concat(e.toString()));let n={};t&&(n.Cookie=t);let s=await fetch(r,{cache:"no-store",credentials:"include",headers:n});if(!s.ok){let t=await s.json().catch(()=>({}));throw Error((0,a.i_)(t,"Failed to fetch categories"))}let l=await s.json(),d=(0,a.hH)(l);if(Array.isArray(d))return d;throw Error("Invalid categories response format")},findOne:async(t,e)=>{let r=(0,o.b)("GET","".concat(i,"/").concat(t)),n={};e&&(n.Cookie=e);let s=await fetch(r,{cache:"no-store",credentials:"include",headers:n});if(!s.ok){let t=await s.json().catch(()=>({}));throw Error((0,a.i_)(t,"Failed to fetch category"))}return(0,a.hH)(await s.json())},findOneByName:async(t,e)=>{let r=(0,o.b)("GET","".concat(i,"/name/").concat(t)),n={};e&&(n.Cookie=e);let s=await fetch(r,{cache:"no-store",credentials:"include",headers:n});if(!s.ok){let t=await s.json().catch(()=>({}));throw Error((0,a.i_)(t,"Failed to fetch category by name"))}return(0,a.hH)(await s.json())},create:async(t,e,r)=>{let n=(0,o.b)("POST",i),s={"Content-Type":"application/json"};e&&(s.Cookie=e),r&&(s["X-CSRF-Token"]=r);let l=await fetch(n,{method:"POST",headers:s,body:JSON.stringify(t),credentials:"include"});if(!l.ok){let t=await l.json().catch(()=>({}));throw Error((0,a.i_)(t,"Failed to create category"))}return(0,a.hH)(await l.json())},update:async(t,e,r,n)=>{let s=(0,o.b)("PUT","".concat(i,"/").concat(t)),l={"Content-Type":"application/json"};r&&(l.Cookie=r),n&&(l["X-CSRF-Token"]=n);let d=await fetch(s,{method:"PUT",headers:l,body:JSON.stringify(e),credentials:"include"});if(!d.ok){let t=await d.json().catch(()=>({}));throw Error((0,a.i_)(t,"Failed to update category"))}return(0,a.hH)(await d.json())},delete:async(t,e,r)=>{let n=(0,o.b)("DELETE","".concat(i,"/").concat(t)),s={};e&&(s.Cookie=e),r&&(s["X-CSRF-Token"]=r);let l=await fetch(n,{method:"DELETE",headers:s,credentials:"include"});if(!l.ok){let t=await l.json().catch(()=>({}));throw Error((0,a.i_)(t,"Failed to delete category"))}}}},47799:function(t,e,r){r.d(e,{R:function(){return c}});var o=r(2913),a=r(71567),i=r(20019);let n=i.Ryn({id:i.Z_8(),product_name:i.Z_8(),display_name:i.Z_8(),description:i.Z_8().optional().or(i.Z_8()),price:i.Rxh().or(i.Z_8().transform(t=>Number(t))),price_delivery:i.Rxh().or(i.Z_8().transform(t=>Number(t))).optional(),category_id:i.Z_8(),unit_id:i.Z_8(),img_url:i.Z_8().nullable().optional(),create_date:i.Z_8().or(i.hTZ()).transform(t=>new Date(t)),update_date:i.Z_8().or(i.hTZ()).transform(t=>new Date(t)),is_active:i.O72().optional().default(!0),category:i.YjB().optional(),unit:i.YjB().optional()}).transform(t=>{var e;return{...t,price_delivery:null!==(e=t.price_delivery)&&void 0!==e?e:t.price}}),s=i.Ryn({data:i.IXX(n),total:i.Rxh(),page:i.Rxh(),last_page:i.Rxh()});var l=r(98170);let d=a.q.POS.PRODUCTS,c={findAll:async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,i=(0,o.b)("GET",d),n=new URLSearchParams(a||"");n.append("page",t.toString()),n.append("limit",e.toString()),i+="?".concat(n.toString());let c={};r&&(c.Cookie=r);let p=await fetch(i,{cache:"no-store",credentials:"include",headers:c});if(!p.ok){let t=await p.json().catch(()=>({}));throw Error((0,l.i_)(t,"Failed to fetch products"))}let m=await p.json(),u=(0,l.XO)(m);return s.parse(u)},findOne:async(t,e)=>{let r=(0,o.b)("GET","".concat(d,"/").concat(t)),a={};e&&(a.Cookie=e);let i=await fetch(r,{cache:"no-store",credentials:"include",headers:a});if(!i.ok){let t=await i.json().catch(()=>({}));throw Error((0,l.i_)(t,"Failed to fetch product"))}let s=await i.json();return n.parse((0,l.hH)(s))},findOneByName:async(t,e)=>{let r=(0,o.b)("GET","".concat(d,"/name/").concat(t)),a={};e&&(a.Cookie=e);let i=await fetch(r,{cache:"no-store",credentials:"include",headers:a});if(!i.ok){let t=await i.json().catch(()=>({}));throw Error((0,l.i_)(t,"Failed to fetch product by name"))}let s=await i.json();return n.parse((0,l.hH)(s))},create:async(t,e,r)=>{let a=(0,o.b)("POST",d),i={"Content-Type":"application/json"};e&&(i.Cookie=e),r&&(i["X-CSRF-Token"]=r);let n=await fetch(a,{method:"POST",headers:i,body:JSON.stringify(t),credentials:"include"});if(!n.ok){let t=await n.json().catch(()=>({}));throw Error((0,l.i_)(t,"Failed to create product"))}let s=await n.json();return(0,l.hH)(s)},update:async(t,e,r,a)=>{let i=(0,o.b)("PUT","".concat(d,"/").concat(t)),n={"Content-Type":"application/json"};r&&(n.Cookie=r),a&&(n["X-CSRF-Token"]=a);let s=await fetch(i,{method:"PUT",headers:n,body:JSON.stringify(e),credentials:"include"});if(!s.ok){let t=await s.json().catch(()=>({}));throw Error((0,l.i_)(t,"Failed to update product"))}let c=await s.json();return(0,l.hH)(c)},delete:async(t,e,r)=>{let a=(0,o.b)("DELETE","".concat(d,"/").concat(t)),i={};e&&(i.Cookie=e),r&&(i["X-CSRF-Token"]=r);let n=await fetch(a,{method:"DELETE",headers:i,credentials:"include"});if(!n.ok){let t=await n.json().catch(()=>({}));throw Error((0,l.i_)(t,"Failed to delete product"))}}}},34962:function(t,e,r){var o,a;r.d(e,{c:function(){return o}}),(a=o||(o={})).Available="Available",a.Unavailable="Unavailable"},252:function(t,e,r){r.d(e,{NE:function(){return d},Th:function(){return s},Do:function(){return c},Yx:function(){return p},Zu:function(){return m},Oi:function(){return l},W9:function(){return i},Tf:function(){return n}});var o=r(34962),a=r(32446);function i(t){let e={total:t.length,available:0,occupied:0,inactive:0};return t.forEach(t=>{t.is_active?t.status===o.c.Available?e.available++:e.occupied++:e.inactive++}),e}function n(t){return[...t].sort((t,e)=>{let r=parseInt(t.table_name.replace(/\D/g,"")),o=parseInt(e.table_name.replace(/\D/g,""));return isNaN(r)||isNaN(o)?t.table_name.localeCompare(e.table_name):r-o})}function s(t){return t.filter(t=>t.is_active)}function l(t){return t.is_active?"WaitingForPayment"===t.active_order_status?"waitingForPayment":t.status===o.c.Available?"available":"occupied":"inactive"}function d(t){return t?({Pending:"กำลังดำเนินการ",Cooking:"กำลังปรุง",Served:"เสิร์ฟแล้ว",WaitingForOrder:"รอรับออเดอร์",WaitingForPayment:"รอชำระเงิน",Paid:"ชำระเงินแล้ว",Completed:"เสร็จสมบูรณ์",Cancelled:"ยกเลิก"})[t]||t:""}function c(t){return t.reduce((t,e)=>(t.total++,e.status===a.i.Pending&&t.pending++,e.status===a.i.Cooking&&t.cooking++,e.status===a.i.Served&&t.served++,t),{total:0,pending:0,cooking:0,served:0})}function p(t){switch(t.status){case a.i.Pending:case a.i.Cooking:return"occupied";case a.i.Served:return"waitingForPayment";case a.i.Paid:return"available";default:return"inactive"}}let m=t=>{switch(t){case a.m.DineIn:case"DineIn":return"/pos/channels/dine-in";case a.m.TakeAway:case"TakeAway":return"/pos/channels/takeaway";case a.m.Delivery:case"Delivery":return"/pos/channels/delivery";default:return"/pos/orders"}}},7806:function(t,e,r){r.d(e,{S:function(){return o}});let o=t=>{if(!(null==t?void 0:t.length))return[];let e=new Map;for(let p of t){var r,o,a,i,n,s,l,d,c;let t=(null===(r=p.details)||void 0===r?void 0:r.length)?JSON.stringify(p.details.map(t=>({n:t.detail_name,p:t.extra_price})).sort((t,e)=>t.n.localeCompare(e.n))):"[]",m=(null!==(a=p.notes)&&void 0!==a?a:"").trim().toLowerCase(),u=String(null!==(i=p.status)&&void 0!==i?i:""),x=null!==(s=null!==(n=null===(o=p.product)||void 0===o?void 0:o.id)&&void 0!==n?n:p.product_id)&&void 0!==s?s:"unknown",f="".concat(x,"|").concat(t,"|").concat(m,"|").concat(u),y=e.get(f);if(y){y.quantity+=Number(p.quantity),y.total_price+=Number(null!==(l=p.total_price)&&void 0!==l?l:0),y.originalItems.push(p);continue}let g={...p,id:String(null!==(d=null==p?void 0:p.id)&&void 0!==d?d:f),quantity:Number(p.quantity),total_price:Number(null!==(c=p.total_price)&&void 0!==c?c:0),originalItems:[p]};e.set(f,g)}return Array.from(e.values())}},73814:function(t,e,r){r.d(e,{t:function(){return a},v:function(){return i}});let o=()=>!0,a=(t,e)=>{if(!o())return null;try{var r;let o=window.localStorage.getItem(t);if(!o)return null;let a=JSON.parse(o);if(!(null==a?void 0:a.ts)||Date.now()-a.ts>e)return null;return null!==(r=a.data)&&void 0!==r?r:null}catch(t){return null}},i=(t,e)=>{if(o())try{let r={ts:Date.now(),data:e};window.localStorage.setItem(t,JSON.stringify(r))}catch(t){}}},67338:function(t,e,r){function o(t){return"฿".concat(t.toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2}))}function a(t){var e;return(null===(e=t.category)||void 0===e?void 0:e.display_name)||"ไม่มีหมวดหมู่"}function i(t){return!!t.img_url&&t.img_url.length>0}r.d(e,{T4:function(){return o},dU:function(){return i},r6:function(){return a}})}}]);