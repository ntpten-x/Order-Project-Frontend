"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4737],{25193:function(e,t,n){n.d(t,{Z:function(){return i}});var a=n(57437);n(2265);var r=n(38616),o=n(87530);function i(e){let{children:t,maxWidth:n=o.H.pageMaxWidth,style:i}=e,l=r.default.useBreakpoint().md?o.H.pagePaddingXDesktop:o.H.pagePaddingXMobile;return(0,a.jsx)("div",{style:{width:"100%",maxWidth:n,margin:"0 auto",padding:"".concat(o.H.pagePaddingY,"px ").concat(l,"px"),...i},children:t})}},20148:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(57437);n(2265);var r=n(17588),o=n(2651),i=n(38616),l=n(10868),d=n(50742),s=n(39486),c=n(87530);function u(e){let{title:t,subtitle:n,icon:u,onBack:f,actions:p,style:g}=e,{token:h}=o.default.useToken(),x=i.default.useBreakpoint().md?c.H.pagePaddingXDesktop:c.H.pagePaddingXMobile;return(0,a.jsx)("div",{style:{padding:"".concat(c.H.pagePaddingY,"px ").concat(x,"px"),background:h.colorBgContainer,borderBottom:"1px solid ".concat(h.colorBorderSecondary),...g},children:(0,a.jsxs)(l.Z,{align:"center",justify:"space-between",wrap:"wrap",gap:12,style:{maxWidth:c.H.pageMaxWidth,margin:"0 auto"},children:[(0,a.jsxs)(l.Z,{align:"center",gap:12,style:{minWidth:0},children:[f&&(0,a.jsx)(d.ZP,{type:"text","aria-label":"ย้อนกลับ",icon:(0,a.jsx)(r.Z,{}),onClick:f,style:{borderRadius:12,width:44,height:44}}),u&&(0,a.jsx)("div",{style:{width:44,height:44,borderRadius:14,display:"grid",placeItems:"center",background:h.colorFillTertiary,color:h.colorText},children:u}),(0,a.jsxs)("div",{style:{minWidth:0},children:[(0,a.jsx)(s.default.Title,{level:4,style:{margin:0},children:t}),n&&(0,a.jsx)(s.default.Text,{type:"secondary",children:n})]})]}),p&&(0,a.jsx)(l.Z,{gap:8,wrap:"wrap",children:p})]})})}},37410:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(57437);n(2265);var r=n(2651),o=n(96931),i=n(10868),l=n(39486),d=n(87530);function s(e){let{title:t,extra:n,children:s,style:c}=e,{token:u}=r.default.useToken();return(0,a.jsx)(o.Z,{size:"small",variant:"outlined",style:{borderRadius:d.H.cardRadiusLG,...c},styles:{header:t?{borderBottomColor:u.colorBorderSecondary}:{display:"none"}},title:t?(0,a.jsxs)(i.Z,{align:"center",justify:"space-between",gap:12,children:[(0,a.jsx)(l.default.Text,{strong:!0,children:t}),n]}):void 0,children:s})}},87530:function(e,t,n){n.d(t,{H:function(){return a}});let a={pageMaxWidth:1200,pagePaddingXMobile:16,pagePaddingXDesktop:24,pagePaddingY:16,sectionGap:16,cardRadius:16,cardRadiusLG:20,cardShadow:"0 10px 24px rgba(15, 23, 42, 0.08)",surfaceBg:"#ffffff",surfaceBorder:"#e2e8f0"}},14362:function(e,t,n){n.d(t,{AuthProvider:function(){return f},a:function(){return p}});var a=n(57437),r=n(2265),o=n(99376),i=n(5447),l=n(84859),d=n(48651),s=n(3369),c=n(36799);let u=(0,r.createContext)(void 0),f=e=>{let{children:t}=e,[n,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(!0),h=(0,o.useRouter)(),x=(0,o.usePathname)(),b=async()=>{try{let e=await i.O.getMe();f(e)}catch(e){f(null)}finally{g(!1)}};(0,r.useEffect)(()=>{b()},[]);let{showLoading:y,hideLoading:m}=(0,s.x)();(0,r.useEffect)(()=>{p||n||"/login"===x||h.push("/login")},[n,p,x,h]);let v=async e=>{try{y((0,c.t)("auth.loadingLogin"));let t=await i.O.getCsrfToken(),{token:n,...a}=await i.O.login(e,t);f(a),h.push("/")}catch(e){throw e}finally{m()}},w=async()=>{try{y((0,c.t)("auth.loadingLogout")),await i.O.logout(),l.x.clearQueue(),f(null),h.push("/login")}catch(e){console.error("Logout error:",e)}finally{m()}};return p?(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"#ffffff"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",padding:"24px",background:"#ffffff",borderRadius:"20px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:[(0,a.jsx)(d.Z,{size:"large"}),(0,a.jsx)("div",{style:{color:"#64748b",fontSize:"14px",fontWeight:500},children:"กำลังตรวจสอบสิทธิ์..."})]})}):n||"/login"===x?(0,a.jsx)(u.Provider,{value:{user:n,loading:p,login:v,logout:w,checkAuth:b},children:t}):null},p=()=>{let e=(0,r.useContext)(u);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},3369:function(e,t,n){n.d(t,{GlobalLoadingProvider:function(){return d},O:function(){return c},x:function(){return s}});var a=n(57437),r=n(2265),o=n(48651);let i=(0,r.createContext)(void 0),l=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,[n,d]=(0,r.useState)({}),[s,c]=(0,r.useState)(void 0),u=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";d(e=>({...e,[t]:(e[t]||0)+1})),e&&c(e)},[]),f=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";d(t=>{if(!t[e])return t;let n={...t};return n[e]-=1,n[e]<=0&&delete n[e],n})},[]),p=(0,r.useCallback)(()=>{d({}),c(void 0)},[]),g=Object.keys(n).length>0,h=(0,r.useMemo)(()=>({isLoading:g,loadingMessage:s}),[g,s]),x=(0,r.useMemo)(()=>({showLoading:u,hideLoading:f,resetLoading:p}),[u,f,p]);return(0,a.jsx)(l.Provider,{value:x,children:(0,a.jsxs)(i.Provider,{value:h,children:[t,g&&(0,a.jsx)("div",{role:"status","aria-live":"polite",className:"global-loading-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:13e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(6px)",WebkitBackdropFilter:"blur(6px)",transition:"opacity 0.25s ease"},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16,background:"rgba(255, 255, 255, 0.95)",padding:"28px 40px",borderRadius:20,boxShadow:"0 10px 32px rgba(15, 23, 42, 0.14)",border:"1px solid rgba(148, 163, 184, 0.35)",minWidth:240,textAlign:"center"},children:[(0,a.jsx)(o.Z,{size:"large"}),s&&(0,a.jsx)("div",{style:{fontSize:16,color:"#334155",fontWeight:600,letterSpacing:"0.01em"},children:s})]})})]})})};function s(){let e=(0,r.useContext)(i),t=(0,r.useContext)(l);if(!e||!t)throw Error("useGlobalLoading must be used within a GlobalLoadingProvider");return(0,r.useMemo)(()=>({...e,...t}),[e,t])}function c(){let e=(0,r.useContext)(l);if(!e)throw Error("useGlobalLoadingDispatch must be used within a GlobalLoadingProvider");return e}},81026:function(e,t,n){n.d(t,{E:function(){return o},M:function(){return r}});var a=n(20019);let r=a.Ryn({id:a.Z_8(),branch_name:a.Z_8(),branch_code:a.Z_8(),address:a.Z_8().optional().nullable(),phone:a.Z_8().optional().nullable(),tax_id:a.Z_8().optional().nullable(),is_active:a.O72().default(!0),create_date:a.Z_8().or(a.hTZ()).transform(e=>new Date(e))}),o=a.IXX(r)},84859:function(e,t,n){n.d(t,{M:function(){return d},x:function(){return l}});let a="pos_offline_queue",r=()=>{let e=localStorage.getItem(a);return e?JSON.parse(e):[]},o=e=>{let t=Date.now();return e.filter(e=>t-e.timestamp<=6048e5)},i=e=>{localStorage.setItem(a,JSON.stringify(e))},l={addToQueue:(e,t)=>{let n=o(r()),a={id:"offline-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:e,payload:t,timestamp:Date.now(),retryCount:0};return i([...n,a]),a},getQueue:()=>r(),removeFromQueue:e=>{i(r().filter(t=>t.id!==e))},incrementRetry:(e,t)=>{i(r().map(n=>n.id===e?{...n,retryCount:n.retryCount+1,lastError:t}:n))},clearQueue:()=>{localStorage.removeItem(a)},pruneExceeded:()=>{i(o(r()).filter(e=>e.retryCount<=5))}},d={maxRetry:5,backoff:e=>Math.min(3e4,2e3*e)}},92719:function(e,t,n){n.d(t,{W:function(){return u}});var a=n(2913),r=n(20019);let o=r.Ryn({id:r.Z_8(),roles_name:r.Z_8(),display_name:r.Z_8()});var i=n(81026);let l=r.Ryn({id:r.Z_8(),username:r.Z_8(),name:r.Z_8().optional().nullable(),roles_id:r.Z_8().optional().nullable(),roles:o.optional().nullable(),branch_id:r.Z_8().optional().nullable(),branch:i.M.optional().nullable(),create_date:r.Z_8().or(r.hTZ()).transform(e=>new Date(e)).optional(),last_login_at:r.Z_8().or(r.hTZ()).transform(e=>new Date(e)).optional().nullable(),is_use:r.O72().optional().default(!0),is_active:r.O72().optional().default(!1)}),d=r.IXX(l);var s=n(98170);let c="/users",u={getAllUsers:async(e,t)=>{let n=(0,a.b)("GET",c);t&&(n+="?".concat(t.toString()));let r={};e&&(r.Cookie=e);let o=await fetch(n,{headers:r,credentials:"include",cache:"no-store"});if(!o.ok){var i;let e=await o.json().catch(()=>({}));throw Error((null===(i=e.errors)||void 0===i?void 0:i.map(e=>e.message).join(", "))||(0,s.i_)(e,"ไม่สามารถดึงข้อมูลผู้ใช้ได้"))}let l=await o.json();return d.parse((0,s.hH)(l))},getUserById:async(e,t)=>{let n=(0,a.b)("GET","".concat(c,"/").concat(e)),r={};t&&(r.Cookie=t);let o=await fetch(n,{headers:r,credentials:"include",cache:"no-store"});if(!o.ok){var i;let e=await o.json().catch(()=>({}));throw Error((null===(i=e.errors)||void 0===i?void 0:i.map(e=>e.message).join(", "))||(0,s.i_)(e,"ไม่สามารถดึงข้อมูลผู้ใช้ได้"))}let d=await o.json();return l.parse((0,s.hH)(d))},createUser:async(e,t,n)=>{let r=(0,a.b)("POST",c),o={"Content-Type":"application/json"};t&&(o.Cookie=t),n&&(o["X-CSRF-Token"]=n);let i=await fetch(r,{method:"POST",headers:o,body:JSON.stringify(e),credentials:"include"});if(!i.ok){var l;let e=await i.json().catch(()=>({}));throw Error((null===(l=e.errors)||void 0===l?void 0:l.map(e=>e.message).join(", "))||(0,s.i_)(e,"ไม่สามารถสร้างผู้ใช้ได้"))}return(0,s.hH)(await i.json())},updateUser:async(e,t,n,r)=>{let o=(0,a.b)("PUT","".concat(c,"/").concat(e)),i={"Content-Type":"application/json"};n&&(i.Cookie=n),r&&(i["X-CSRF-Token"]=r);let l=await fetch(o,{method:"PUT",headers:i,body:JSON.stringify(t),credentials:"include"});if(!l.ok){var d;let e=await l.json().catch(()=>({}));throw Error((null===(d=e.errors)||void 0===d?void 0:d.map(e=>e.message).join(", "))||(0,s.i_)(e,"ไม่สามารถอัปเดตผู้ใช้ได้"))}return(0,s.hH)(await l.json())},deleteUser:async(e,t,n)=>{let r=(0,a.b)("DELETE","".concat(c,"/").concat(e)),o={};t&&(o.Cookie=t),n&&(o["X-CSRF-Token"]=n);let i=await fetch(r,{method:"DELETE",headers:o,credentials:"include"});if(!i.ok){var l;let e=await i.json().catch(()=>({}));throw Error((null===(l=e.errors)||void 0===l?void 0:l.map(e=>e.message).join(", "))||(0,s.i_)(e,"ไม่สามารถลบผู้ใช้ได้"))}}}}}]);