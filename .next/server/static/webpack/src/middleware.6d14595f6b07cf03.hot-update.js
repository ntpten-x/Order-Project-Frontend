"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/lib/rbac/policy.ts":
/*!********************************!*\
  !*** ./src/lib/rbac/policy.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALL_ROLES: () => (/* binding */ ALL_ROLES),\n/* harmony export */   asRole: () => (/* binding */ asRole),\n/* harmony export */   isRoleAllowed: () => (/* binding */ isRoleAllowed),\n/* harmony export */   requiredRolesForPath: () => (/* binding */ requiredRolesForPath)\n/* harmony export */ });\nconst ALL_ROLES = [\n    \"Admin\",\n    \"Manager\",\n    \"Employee\"\n];\nfunction asRole(value) {\n    if (value === \"Admin\" || value === \"Manager\" || value === \"Employee\") return value;\n    return null;\n}\nfunction isRoleAllowed(role, allowed) {\n    return allowed.includes(role) || role === \"Admin\";\n}\nfunction requiredRolesForPath(pathname, method) {\n    const m = method.toUpperCase();\n    // Pages\n    if (pathname === \"/login\" || pathname.startsWith(\"/offline\")) return {\n        allowed: ALL_ROLES\n    };\n    // Admin-only pages\n    if (pathname.startsWith(\"/branch/manager\")) return {\n        allowed: [\n            \"Admin\"\n        ],\n        redirectTo: \"/branch\"\n    };\n    // Admin/Manager pages\n    if (pathname.startsWith(\"/audit\")) return {\n        allowed: [\n            \"Admin\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/users\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/branch\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/stock\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    // POS settings/management pages\n    if (pathname.startsWith(\"/pos/settings\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/pos/products/manage\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.includes(\"/manager/\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    // API routes (Next.js proxy)\n    if (pathname.startsWith(\"/api\")) {\n        // Public API endpoints\n        if (pathname === \"/api/csrf\") return {\n            allowed: ALL_ROLES\n        };\n        if (pathname.startsWith(\"/api/auth/login\")) return {\n            allowed: ALL_ROLES\n        };\n        if (pathname.startsWith(\"/api/auth/logout\")) return {\n            allowed: ALL_ROLES\n        };\n        // Admin-only API endpoints\n        if (pathname.startsWith(\"/api/roles\")) return {\n            allowed: [\n                \"Admin\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/auth/switch-branch\")) return {\n            allowed: [\n                \"Admin\"\n            ]\n        };\n        // Admin/Manager API endpoints\n        if (pathname.startsWith(\"/api/users\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/audit\")) return {\n            allowed: [\n                \"Admin\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/stock\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/branches\")) {\n            if (m === \"GET\") return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n            return {\n                allowed: [\n                    \"Admin\"\n                ]\n            };\n        }\n        // POS payment accounts (admin/manager only)\n        if (pathname.startsWith(\"/api/pos/payment-accounts\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        // POS shop profile: everyone can read; only admin/manager can write\n        if (pathname.startsWith(\"/api/pos/shopProfile\")) {\n            if (m === \"GET\") return {\n                allowed: ALL_ROLES\n            };\n            return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n        }\n        // POS master data: everyone can read; only admin/manager can write\n        const masterPrefixes = [\n            \"/api/pos/products\",\n            \"/api/pos/productsUnit\",\n            \"/api/pos/category\",\n            \"/api/pos/discounts\",\n            \"/api/pos/delivery\",\n            \"/api/pos/paymentMethod\"\n        ];\n        if (masterPrefixes.some((p)=>pathname.startsWith(p))) {\n            if (m === \"GET\") return {\n                allowed: ALL_ROLES\n            };\n            return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n        }\n        // POS tables: allow employee to update table status; restrict create/delete\n        if (pathname.startsWith(\"/api/pos/tables\")) {\n            if (m === \"GET\") return {\n                allowed: ALL_ROLES\n            };\n            if (m === \"PUT\" || m === \"PATCH\") return {\n                allowed: ALL_ROLES\n            };\n            return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n        }\n        // POS operations: allow all roles (backend still enforces delete rules)\n        const opsPrefixes = [\n            \"/api/pos/orders\",\n            \"/api/pos/payments\",\n            \"/api/pos/queue\",\n            \"/api/pos/shifts\",\n            \"/api/pos/dashboard\",\n            \"/api/pos/salesOrderItem\",\n            \"/api/pos/salesOrderDetail\"\n        ];\n        if (opsPrefixes.some((p)=>pathname.startsWith(p))) {\n            return {\n                allowed: ALL_ROLES\n            };\n        }\n        // Default: require authentication for any other /api route\n        return {\n            allowed: ALL_ROLES\n        };\n    }\n    // Default: authenticated users can access\n    return {\n        allowed: ALL_ROLES\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LDBDQUEwQztJQUMxQyxPQUFPO1FBQUVLLFNBQVNMO0lBQVU7QUFDOUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2xpYi9yYmFjL3BvbGljeS50cz8zMDg2Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB0eXBlIFJvbGUgPSBcIkFkbWluXCIgfCBcIk1hbmFnZXJcIiB8IFwiRW1wbG95ZWVcIjtcblxuZXhwb3J0IGNvbnN0IEFMTF9ST0xFUzogUm9sZVtdID0gW1wiQWRtaW5cIiwgXCJNYW5hZ2VyXCIsIFwiRW1wbG95ZWVcIl07XG5cbmV4cG9ydCBmdW5jdGlvbiBhc1JvbGUodmFsdWU6IHVua25vd24pOiBSb2xlIHwgbnVsbCB7XG4gIGlmICh2YWx1ZSA9PT0gXCJBZG1pblwiIHx8IHZhbHVlID09PSBcIk1hbmFnZXJcIiB8fCB2YWx1ZSA9PT0gXCJFbXBsb3llZVwiKSByZXR1cm4gdmFsdWU7XG4gIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNSb2xlQWxsb3dlZChyb2xlOiBSb2xlLCBhbGxvd2VkOiBSb2xlW10pOiBib29sZWFuIHtcbiAgcmV0dXJuIGFsbG93ZWQuaW5jbHVkZXMocm9sZSkgfHwgcm9sZSA9PT0gXCJBZG1pblwiO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVxdWlyZWRSb2xlc0ZvclBhdGgoXG4gIHBhdGhuYW1lOiBzdHJpbmcsXG4gIG1ldGhvZDogc3RyaW5nXG4pOiB7IGFsbG93ZWQ6IFJvbGVbXTsgcmVkaXJlY3RUbz86IHN0cmluZyB9IHwgbnVsbCB7XG4gIGNvbnN0IG0gPSBtZXRob2QudG9VcHBlckNhc2UoKTtcblxuICAvLyBQYWdlc1xuICBpZiAocGF0aG5hbWUgPT09IFwiL2xvZ2luXCIgfHwgcGF0aG5hbWUuc3RhcnRzV2l0aChcIi9vZmZsaW5lXCIpKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcblxuICAvLyBBZG1pbi1vbmx5IHBhZ2VzXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2JyYW5jaC9tYW5hZ2VyXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiXSwgcmVkaXJlY3RUbzogXCIvYnJhbmNoXCIgfTtcblxuICAvLyBBZG1pbi9NYW5hZ2VyIHBhZ2VzXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2F1ZGl0XCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiXSwgcmVkaXJlY3RUbzogXCIvcG9zXCIgfTtcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvdXNlcnNcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSwgcmVkaXJlY3RUbzogXCIvcG9zXCIgfTtcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYnJhbmNoXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL3N0b2NrXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG5cbiAgLy8gUE9TIHNldHRpbmdzL21hbmFnZW1lbnQgcGFnZXNcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvcG9zL3NldHRpbmdzXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL3Bvcy9wcm9kdWN0cy9tYW5hZ2VcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSwgcmVkaXJlY3RUbzogXCIvcG9zXCIgfTtcbiAgaWYgKHBhdGhuYW1lLmluY2x1ZGVzKFwiL21hbmFnZXIvXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG5cbiAgLy8gQVBJIHJvdXRlcyAoTmV4dC5qcyBwcm94eSlcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXBpXCIpKSB7XG4gICAgLy8gUHVibGljIEFQSSBlbmRwb2ludHNcbiAgICBpZiAocGF0aG5hbWUgPT09IFwiL2FwaS9jc3JmXCIpIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdXRoL2xvZ2luXCIpKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvYXV0aC9sb2dvdXRcIikpIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuXG4gICAgLy8gQWRtaW4tb25seSBBUEkgZW5kcG9pbnRzXG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXBpL3JvbGVzXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiXSB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdXRoL3N3aXRjaC1icmFuY2hcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCJdIH07XG5cbiAgICAvLyBBZG1pbi9NYW5hZ2VyIEFQSSBlbmRwb2ludHNcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvdXNlcnNcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdWRpdFwiKSkgcmV0dXJuIHsgYWxsb3dlZDogW1wiQWRtaW5cIl0gfTtcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvc3RvY2tcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9icmFuY2hlc1wiKSkge1xuICAgICAgaWYgKG0gPT09IFwiR0VUXCIpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgICAgcmV0dXJuIHsgYWxsb3dlZDogW1wiQWRtaW5cIl0gfTtcbiAgICB9XG5cbiAgICAvLyBQT1MgcGF5bWVudCBhY2NvdW50cyAoYWRtaW4vbWFuYWdlciBvbmx5KVxuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9wb3MvcGF5bWVudC1hY2NvdW50c1wiKSkgcmV0dXJuIHsgYWxsb3dlZDogW1wiQWRtaW5cIiwgXCJNYW5hZ2VyXCJdIH07XG5cbiAgICAvLyBQT1Mgc2hvcCBwcm9maWxlOiBldmVyeW9uZSBjYW4gcmVhZDsgb25seSBhZG1pbi9tYW5hZ2VyIGNhbiB3cml0ZVxuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9wb3Mvc2hvcFByb2ZpbGVcIikpIHtcbiAgICAgIGlmIChtID09PSBcIkdFVFwiKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgIH1cblxuICAgIC8vIFBPUyBtYXN0ZXIgZGF0YTogZXZlcnlvbmUgY2FuIHJlYWQ7IG9ubHkgYWRtaW4vbWFuYWdlciBjYW4gd3JpdGVcbiAgICBjb25zdCBtYXN0ZXJQcmVmaXhlcyA9IFtcbiAgICAgIFwiL2FwaS9wb3MvcHJvZHVjdHNcIixcbiAgICAgIFwiL2FwaS9wb3MvcHJvZHVjdHNVbml0XCIsXG4gICAgICBcIi9hcGkvcG9zL2NhdGVnb3J5XCIsXG4gICAgICBcIi9hcGkvcG9zL2Rpc2NvdW50c1wiLFxuICAgICAgXCIvYXBpL3Bvcy9kZWxpdmVyeVwiLFxuICAgICAgXCIvYXBpL3Bvcy9wYXltZW50TWV0aG9kXCIsXG4gICAgXTtcbiAgICBpZiAobWFzdGVyUHJlZml4ZXMuc29tZSgocCkgPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChwKSkpIHtcbiAgICAgIGlmIChtID09PSBcIkdFVFwiKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgIH1cblxuICAgIC8vIFBPUyB0YWJsZXM6IGFsbG93IGVtcGxveWVlIHRvIHVwZGF0ZSB0YWJsZSBzdGF0dXM7IHJlc3RyaWN0IGNyZWF0ZS9kZWxldGVcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvcG9zL3RhYmxlc1wiKSkge1xuICAgICAgaWYgKG0gPT09IFwiR0VUXCIpIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuICAgICAgaWYgKG0gPT09IFwiUFVUXCIgfHwgbSA9PT0gXCJQQVRDSFwiKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgIH1cblxuICAgIC8vIFBPUyBvcGVyYXRpb25zOiBhbGxvdyBhbGwgcm9sZXMgKGJhY2tlbmQgc3RpbGwgZW5mb3JjZXMgZGVsZXRlIHJ1bGVzKVxuICAgIGNvbnN0IG9wc1ByZWZpeGVzID0gW1xuICAgICAgXCIvYXBpL3Bvcy9vcmRlcnNcIixcbiAgICAgIFwiL2FwaS9wb3MvcGF5bWVudHNcIixcbiAgICAgIFwiL2FwaS9wb3MvcXVldWVcIixcbiAgICAgIFwiL2FwaS9wb3Mvc2hpZnRzXCIsXG4gICAgICBcIi9hcGkvcG9zL2Rhc2hib2FyZFwiLFxuICAgICAgXCIvYXBpL3Bvcy9zYWxlc09yZGVySXRlbVwiLFxuICAgICAgXCIvYXBpL3Bvcy9zYWxlc09yZGVyRGV0YWlsXCIsXG4gICAgXTtcbiAgICBpZiAob3BzUHJlZml4ZXMuc29tZSgocCkgPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChwKSkpIHtcbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuICAgIH1cblxuICAgIC8vIERlZmF1bHQ6IHJlcXVpcmUgYXV0aGVudGljYXRpb24gZm9yIGFueSBvdGhlciAvYXBpIHJvdXRlXG4gICAgcmV0dXJuIHsgYWxsb3dlZDogQUxMX1JPTEVTIH07XG4gIH1cblxuICAvLyBEZWZhdWx0OiBhdXRoZW50aWNhdGVkIHVzZXJzIGNhbiBhY2Nlc3NcbiAgcmV0dXJuIHsgYWxsb3dlZDogQUxMX1JPTEVTIH07XG59XG4iXSwibmFtZXMiOlsiQUxMX1JPTEVTIiwiYXNSb2xlIiwidmFsdWUiLCJpc1JvbGVBbGxvd2VkIiwicm9sZSIsImFsbG93ZWQiLCJpbmNsdWRlcyIsInJlcXVpcmVkUm9sZXNGb3JQYXRoIiwicGF0aG5hbWUiLCJtZXRob2QiLCJtIiwidG9VcHBlckNhc2UiLCJzdGFydHNXaXRoIiwicmVkaXJlY3RUbyIsIm1hc3RlclByZWZpeGVzIiwic29tZSIsInAiLCJvcHNQcmVmaXhlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/lib/rbac/policy.ts\n");

/***/ })

});