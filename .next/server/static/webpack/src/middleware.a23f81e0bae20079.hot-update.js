"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/lib/rbac/policy.ts":
/*!********************************!*\
  !*** ./src/lib/rbac/policy.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALL_ROLES: () => (/* binding */ ALL_ROLES),\n/* harmony export */   asRole: () => (/* binding */ asRole),\n/* harmony export */   isRoleAllowed: () => (/* binding */ isRoleAllowed),\n/* harmony export */   requiredRolesForPath: () => (/* binding */ requiredRolesForPath)\n/* harmony export */ });\nconst ALL_ROLES = [\n    \"Admin\",\n    \"Manager\",\n    \"Employee\"\n];\nfunction asRole(value) {\n    if (value === \"Admin\" || value === \"Manager\" || value === \"Employee\") return value;\n    return null;\n}\nfunction isRoleAllowed(role, allowed) {\n    return allowed.includes(role) || role === \"Admin\";\n}\nfunction requiredRolesForPath(pathname, method) {\n    const m = method.toUpperCase();\n    // Pages\n    if (pathname === \"/login\" || pathname.startsWith(\"/offline\")) return {\n        allowed: ALL_ROLES\n    };\n    // Admin-only pages\n    if (pathname.startsWith(\"/branch/manager\")) return {\n        allowed: [\n            \"Admin\"\n        ],\n        redirectTo: \"/branch\"\n    };\n    // Admin/Manager pages\n    if (pathname.startsWith(\"/audit\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/users\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/branch\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/stock\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    // POS settings/management pages\n    if (pathname.startsWith(\"/pos/settings\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.startsWith(\"/pos/products/manage\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    if (pathname.includes(\"/manager/\")) return {\n        allowed: [\n            \"Admin\",\n            \"Manager\"\n        ],\n        redirectTo: \"/pos\"\n    };\n    // API routes (Next.js proxy)\n    if (pathname.startsWith(\"/api\")) {\n        // Public API endpoints\n        if (pathname === \"/api/csrf\") return {\n            allowed: ALL_ROLES\n        };\n        if (pathname.startsWith(\"/api/auth/login\")) return {\n            allowed: ALL_ROLES\n        };\n        if (pathname.startsWith(\"/api/auth/logout\")) return {\n            allowed: ALL_ROLES\n        };\n        // Admin-only API endpoints\n        if (pathname.startsWith(\"/api/roles\")) return {\n            allowed: [\n                \"Admin\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/auth/switch-branch\")) return {\n            allowed: [\n                \"Admin\"\n            ]\n        };\n        // Admin/Manager API endpoints\n        if (pathname.startsWith(\"/api/users\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/audit\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/stock\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        if (pathname.startsWith(\"/api/branches\")) {\n            if (m === \"GET\") return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n            return {\n                allowed: [\n                    \"Admin\"\n                ]\n            };\n        }\n        // POS payment accounts (admin/manager only)\n        if (pathname.startsWith(\"/api/pos/payment-accounts\")) return {\n            allowed: [\n                \"Admin\",\n                \"Manager\"\n            ]\n        };\n        // POS shop profile: everyone can read; only admin/manager can write\n        if (pathname.startsWith(\"/api/pos/shopProfile\")) {\n            if (m === \"GET\") return {\n                allowed: ALL_ROLES\n            };\n            return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n        }\n        // POS master data: everyone can read; only admin/manager can write\n        const masterPrefixes = [\n            \"/api/pos/products\",\n            \"/api/pos/productsUnit\",\n            \"/api/pos/category\",\n            \"/api/pos/discounts\",\n            \"/api/pos/delivery\",\n            \"/api/pos/paymentMethod\"\n        ];\n        if (masterPrefixes.some((p)=>pathname.startsWith(p))) {\n            if (m === \"GET\") return {\n                allowed: ALL_ROLES\n            };\n            return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n        }\n        // POS tables: allow employee to update table status; restrict create/delete\n        if (pathname.startsWith(\"/api/pos/tables\")) {\n            if (m === \"GET\") return {\n                allowed: ALL_ROLES\n            };\n            if (m === \"PUT\" || m === \"PATCH\") return {\n                allowed: ALL_ROLES\n            };\n            return {\n                allowed: [\n                    \"Admin\",\n                    \"Manager\"\n                ]\n            };\n        }\n        // POS operations: allow all roles (backend still enforces delete rules)\n        const opsPrefixes = [\n            \"/api/pos/orders\",\n            \"/api/pos/payments\",\n            \"/api/pos/queue\",\n            \"/api/pos/shifts\",\n            \"/api/pos/dashboard\",\n            \"/api/pos/salesOrderItem\",\n            \"/api/pos/salesOrderDetail\"\n        ];\n        if (opsPrefixes.some((p)=>pathname.startsWith(p))) {\n            return {\n                allowed: ALL_ROLES\n            };\n        }\n        // Default: require authentication for any other /api route\n        return {\n            allowed: ALL_ROLES\n        };\n    }\n    // Default: authenticated users can access\n    return {\n        allowed: ALL_ROLES\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQzlCO0lBRUEsMENBQTBDO0lBQzFDLE9BQU87UUFBRUssU0FBU0w7SUFBVTtBQUM5QiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvbGliL3JiYWMvcG9saWN5LnRzPzMwODYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHR5cGUgUm9sZSA9IFwiQWRtaW5cIiB8IFwiTWFuYWdlclwiIHwgXCJFbXBsb3llZVwiO1xuXG5leHBvcnQgY29uc3QgQUxMX1JPTEVTOiBSb2xlW10gPSBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIiwgXCJFbXBsb3llZVwiXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFzUm9sZSh2YWx1ZTogdW5rbm93bik6IFJvbGUgfCBudWxsIHtcbiAgaWYgKHZhbHVlID09PSBcIkFkbWluXCIgfHwgdmFsdWUgPT09IFwiTWFuYWdlclwiIHx8IHZhbHVlID09PSBcIkVtcGxveWVlXCIpIHJldHVybiB2YWx1ZTtcbiAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1JvbGVBbGxvd2VkKHJvbGU6IFJvbGUsIGFsbG93ZWQ6IFJvbGVbXSk6IGJvb2xlYW4ge1xuICByZXR1cm4gYWxsb3dlZC5pbmNsdWRlcyhyb2xlKSB8fCByb2xlID09PSBcIkFkbWluXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlZFJvbGVzRm9yUGF0aChcbiAgcGF0aG5hbWU6IHN0cmluZyxcbiAgbWV0aG9kOiBzdHJpbmdcbik6IHsgYWxsb3dlZDogUm9sZVtdOyByZWRpcmVjdFRvPzogc3RyaW5nIH0gfCBudWxsIHtcbiAgY29uc3QgbSA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpO1xuXG4gIC8vIFBhZ2VzXG4gIGlmIChwYXRobmFtZSA9PT0gXCIvbG9naW5cIiB8fCBwYXRobmFtZS5zdGFydHNXaXRoKFwiL29mZmxpbmVcIikpIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuXG4gIC8vIEFkbWluLW9ubHkgcGFnZXNcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYnJhbmNoL21hbmFnZXJcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCJdLCByZWRpcmVjdFRvOiBcIi9icmFuY2hcIiB9O1xuXG4gIC8vIEFkbWluL01hbmFnZXIgcGFnZXNcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXVkaXRcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSwgcmVkaXJlY3RUbzogXCIvcG9zXCIgfTtcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvdXNlcnNcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSwgcmVkaXJlY3RUbzogXCIvcG9zXCIgfTtcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYnJhbmNoXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL3N0b2NrXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG5cbiAgLy8gUE9TIHNldHRpbmdzL21hbmFnZW1lbnQgcGFnZXNcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvcG9zL3NldHRpbmdzXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL3Bvcy9wcm9kdWN0cy9tYW5hZ2VcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSwgcmVkaXJlY3RUbzogXCIvcG9zXCIgfTtcbiAgaWYgKHBhdGhuYW1lLmluY2x1ZGVzKFwiL21hbmFnZXIvXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0sIHJlZGlyZWN0VG86IFwiL3Bvc1wiIH07XG5cbiAgLy8gQVBJIHJvdXRlcyAoTmV4dC5qcyBwcm94eSlcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXBpXCIpKSB7XG4gICAgLy8gUHVibGljIEFQSSBlbmRwb2ludHNcbiAgICBpZiAocGF0aG5hbWUgPT09IFwiL2FwaS9jc3JmXCIpIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdXRoL2xvZ2luXCIpKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvYXV0aC9sb2dvdXRcIikpIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuXG4gICAgLy8gQWRtaW4tb25seSBBUEkgZW5kcG9pbnRzXG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXBpL3JvbGVzXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiXSB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdXRoL3N3aXRjaC1icmFuY2hcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCJdIH07XG5cbiAgICAvLyBBZG1pbi9NYW5hZ2VyIEFQSSBlbmRwb2ludHNcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvdXNlcnNcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaS9hdWRpdFwiKSkgcmV0dXJuIHsgYWxsb3dlZDogW1wiQWRtaW5cIiwgXCJNYW5hZ2VyXCJdIH07XG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXBpL3N0b2NrXCIpKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0gfTtcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvYnJhbmNoZXNcIikpIHtcbiAgICAgIGlmIChtID09PSBcIkdFVFwiKSByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0gfTtcbiAgICAgIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCJdIH07XG4gICAgfVxuXG4gICAgLy8gUE9TIHBheW1lbnQgYWNjb3VudHMgKGFkbWluL21hbmFnZXIgb25seSlcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvcG9zL3BheW1lbnQtYWNjb3VudHNcIikpIHJldHVybiB7IGFsbG93ZWQ6IFtcIkFkbWluXCIsIFwiTWFuYWdlclwiXSB9O1xuXG4gICAgLy8gUE9TIHNob3AgcHJvZmlsZTogZXZlcnlvbmUgY2FuIHJlYWQ7IG9ubHkgYWRtaW4vbWFuYWdlciBjYW4gd3JpdGVcbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGkvcG9zL3Nob3BQcm9maWxlXCIpKSB7XG4gICAgICBpZiAobSA9PT0gXCJHRVRcIikgcmV0dXJuIHsgYWxsb3dlZDogQUxMX1JPTEVTIH07XG4gICAgICByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0gfTtcbiAgICB9XG5cbiAgICAvLyBQT1MgbWFzdGVyIGRhdGE6IGV2ZXJ5b25lIGNhbiByZWFkOyBvbmx5IGFkbWluL21hbmFnZXIgY2FuIHdyaXRlXG4gICAgY29uc3QgbWFzdGVyUHJlZml4ZXMgPSBbXG4gICAgICBcIi9hcGkvcG9zL3Byb2R1Y3RzXCIsXG4gICAgICBcIi9hcGkvcG9zL3Byb2R1Y3RzVW5pdFwiLFxuICAgICAgXCIvYXBpL3Bvcy9jYXRlZ29yeVwiLFxuICAgICAgXCIvYXBpL3Bvcy9kaXNjb3VudHNcIixcbiAgICAgIFwiL2FwaS9wb3MvZGVsaXZlcnlcIixcbiAgICAgIFwiL2FwaS9wb3MvcGF5bWVudE1ldGhvZFwiLFxuICAgIF07XG4gICAgaWYgKG1hc3RlclByZWZpeGVzLnNvbWUoKHApID0+IHBhdGhuYW1lLnN0YXJ0c1dpdGgocCkpKSB7XG4gICAgICBpZiAobSA9PT0gXCJHRVRcIikgcmV0dXJuIHsgYWxsb3dlZDogQUxMX1JPTEVTIH07XG4gICAgICByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0gfTtcbiAgICB9XG5cbiAgICAvLyBQT1MgdGFibGVzOiBhbGxvdyBlbXBsb3llZSB0byB1cGRhdGUgdGFibGUgc3RhdHVzOyByZXN0cmljdCBjcmVhdGUvZGVsZXRlXG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYXBpL3Bvcy90YWJsZXNcIikpIHtcbiAgICAgIGlmIChtID09PSBcIkdFVFwiKSByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICAgIGlmIChtID09PSBcIlBVVFwiIHx8IG0gPT09IFwiUEFUQ0hcIikgcmV0dXJuIHsgYWxsb3dlZDogQUxMX1JPTEVTIH07XG4gICAgICByZXR1cm4geyBhbGxvd2VkOiBbXCJBZG1pblwiLCBcIk1hbmFnZXJcIl0gfTtcbiAgICB9XG5cbiAgICAvLyBQT1Mgb3BlcmF0aW9uczogYWxsb3cgYWxsIHJvbGVzIChiYWNrZW5kIHN0aWxsIGVuZm9yY2VzIGRlbGV0ZSBydWxlcylcbiAgICBjb25zdCBvcHNQcmVmaXhlcyA9IFtcbiAgICAgIFwiL2FwaS9wb3Mvb3JkZXJzXCIsXG4gICAgICBcIi9hcGkvcG9zL3BheW1lbnRzXCIsXG4gICAgICBcIi9hcGkvcG9zL3F1ZXVlXCIsXG4gICAgICBcIi9hcGkvcG9zL3NoaWZ0c1wiLFxuICAgICAgXCIvYXBpL3Bvcy9kYXNoYm9hcmRcIixcbiAgICAgIFwiL2FwaS9wb3Mvc2FsZXNPcmRlckl0ZW1cIixcbiAgICAgIFwiL2FwaS9wb3Mvc2FsZXNPcmRlckRldGFpbFwiLFxuICAgIF07XG4gICAgaWYgKG9wc1ByZWZpeGVzLnNvbWUoKHApID0+IHBhdGhuYW1lLnN0YXJ0c1dpdGgocCkpKSB7XG4gICAgICByZXR1cm4geyBhbGxvd2VkOiBBTExfUk9MRVMgfTtcbiAgICB9XG5cbiAgICAvLyBEZWZhdWx0OiByZXF1aXJlIGF1dGhlbnRpY2F0aW9uIGZvciBhbnkgb3RoZXIgL2FwaSByb3V0ZVxuICAgIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xuICB9XG5cbiAgLy8gRGVmYXVsdDogYXV0aGVudGljYXRlZCB1c2VycyBjYW4gYWNjZXNzXG4gIHJldHVybiB7IGFsbG93ZWQ6IEFMTF9ST0xFUyB9O1xufVxuIl0sIm5hbWVzIjpbIkFMTF9ST0xFUyIsImFzUm9sZSIsInZhbHVlIiwiaXNSb2xlQWxsb3dlZCIsInJvbGUiLCJhbGxvd2VkIiwiaW5jbHVkZXMiLCJyZXF1aXJlZFJvbGVzRm9yUGF0aCIsInBhdGhuYW1lIiwibWV0aG9kIiwibSIsInRvVXBwZXJDYXNlIiwic3RhcnRzV2l0aCIsInJlZGlyZWN0VG8iLCJtYXN0ZXJQcmVmaXhlcyIsInNvbWUiLCJwIiwib3BzUHJlZml4ZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/lib/rbac/policy.ts\n");

/***/ })

});