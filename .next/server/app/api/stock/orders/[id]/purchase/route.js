"use strict";(()=>{var t={};t.id=289,t.ids=[289],t.modules={20399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},89650:(t,e,r)=>{r.r(e),r.d(e,{originalPathname:()=>f,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p});var a={};r.r(a),r.d(a,{POST:()=>u});var o=r(49303),s=r(88716),i=r(60670),n=r(87070),c=r(45657);async function u(t,{params:e}){try{let{id:r}=e,{items:a,purchased_by_id:o}=await t.json(),s=t.headers.get("cookie")||"",i=t.headers.get("X-CSRF-Token")||"",u=await c.x.confirmPurchase(r,a,o,s,i);return n.NextResponse.json(u)}catch(t){return console.error("API Error:",t),n.NextResponse.json({error:t.message||"Internal Server Error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/stock/orders/[id]/purchase/route",pathname:"/api/stock/orders/[id]/purchase",filename:"route",bundlePath:"app/api/stock/orders/[id]/purchase/route"},resolvedPagePath:"E:\\Project\\Order-Project-Frontend\\src\\app\\api\\stock\\orders\\[id]\\purchase\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:h}=d,f="/api/stock/orders/[id]/purchase/route";function m(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}},87456:(t,e,r)=>{function a(t,e){return({GET:`${o.API_BASE_URL}${e}`,POST:`${o.API_BASE_URL}${e}`,PUT:`${o.API_BASE_URL}${e}`,DELETE:`${o.API_BASE_URL}${e}`,PATCH:`${o.API_BASE_URL}${e}`})[t]}r.d(e,{W:()=>o,b:()=>a});let o={get API_BASE_URL(){return"http://13.239.29.168:3000"}}},45657:(t,e,r)=>{r.d(e,{x:()=>n});var a=r(87456),o=r(91525);let s="/stock/orders",i=(t,e="application/json")=>{let r={};return e&&(r["Content-Type"]=e),t&&(r.Cookie=t),r},n={createOrder:async(t,e,r)=>{let n=(0,a.b)("POST",s),c=i(e);r&&(c["X-CSRF-Token"]=r);let u=await fetch(n,{method:"POST",headers:c,body:JSON.stringify(t)});if(!u.ok){let t=await u.text();console.error("Backend Error [createOrder]:",{status:u.status,statusText:u.statusText,url:n,body:t});let e={};try{e=JSON.parse(t)}catch{}throw Error((0,o.i_)(e,`ไม่สามารถสร้างออเดอร์ได้ (${u.status})`))}return(0,o.hH)(await u.json())},getAllOrders:async(t,e)=>{let r=(0,a.b)("GET",s);e&&(r+=`?${e.toString()}`);let n=i(t,""),c=await fetch(r,{cache:"no-store",headers:n});if(!c.ok){let t=await c.json().catch(()=>({}));throw Error((0,o.i_)(t,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}return(0,o.XO)(await c.json())},getOrderById:async(t,e)=>{let r=(0,a.b)("GET",`${s}/${t}`),n=i(e,""),c=await fetch(r,{cache:"no-store",headers:n});if(!c.ok){let t=await c.json().catch(()=>({}));throw Error((0,o.i_)(t,"ไม่สามารถดึงข้อมูลออเดอร์ได้"))}return(0,o.hH)(await c.json())},updateStatus:async(t,e,r,n)=>{let c=(0,a.b)("PUT",`${s}/${t}/status`),u=i(r);n&&(u["X-CSRF-Token"]=n);let d=await fetch(c,{method:"PUT",headers:u,body:JSON.stringify({status:e})});if(!d.ok){let t=await d.json().catch(()=>({}));throw Error((0,o.i_)(t,"ไม่สามารถอัปเดตสถานะออเดอร์ได้"))}return(0,o.hH)(await d.json())},updateOrder:async(t,e,r,n)=>{let c=(0,a.b)("PUT",`${s}/${t}`),u=i(r);n&&(u["X-CSRF-Token"]=n);let d=await fetch(c,{method:"PUT",headers:u,body:JSON.stringify({items:e})});if(!d.ok){let t=await d.text();throw Error(`Failed to update order: ${d.status} ${t}`)}return(0,o.hH)(await d.json())},confirmPurchase:async(t,e,r,n,c)=>{let u=(0,a.b)("POST",`${s}/${t}/purchase`),d=i(n);c&&(d["X-CSRF-Token"]=c);let l=await fetch(u,{method:"POST",headers:d,body:JSON.stringify({items:e,purchased_by_id:r})});if(!l.ok){let t=await l.text();throw Error(`Failed to confirm purchase: ${l.status} ${t}`)}return(0,o.hH)(await l.json())},updatePurchaseDetail:async(t,e)=>{let r=(0,a.b)("POST","/stock/ordersDetail/update"),s=i(e),n=await fetch(r,{method:"POST",headers:s,body:JSON.stringify(t)});if(!n.ok){let t=await n.json().catch(()=>({}));throw Error((0,o.i_)(t,"ไม่สามารถอัปเดตข้อมูลการซื้อได้"))}return(0,o.hH)(await n.json())},deleteOrder:async(t,e,r)=>{let o=(0,a.b)("DELETE",`${s}/${t}`),n=i(e,"");r&&(n["X-CSRF-Token"]=r);let c=await fetch(o,{method:"DELETE",headers:n});if(!c.ok){let t=await c.text();throw Error(`Failed to delete order: ${c.status} ${t}`)}}}},91525:(t,e,r)=>{function a(t){return!!t&&"object"==typeof t}function o(t){return t&&"object"==typeof t&&"success"in t&&!0===t.success&&"data"in t?t.data:t}function s(t,e="Request failed"){if("string"==typeof t)return t;if(!a(t))return e;if(!1===t.success){let e=t.error;if(a(e)&&"string"==typeof e.message&&e.message.trim())return e.message}if("error"in t){let e=t.error;if("string"==typeof e&&e.trim())return e;if(a(e)&&"string"==typeof e.message&&e.message.trim())return e.message}return"string"==typeof t.message&&t.message.trim()?t.message:e}function i(t){if(t&&"object"==typeof t&&"success"in t&&!0===t.success&&Array.isArray(t.data)){let e="number"==typeof t.meta?.total?t.meta.total:t.data.length,r="number"==typeof t.meta?.page?t.meta.page:1,a="number"==typeof t.meta?.limit?t.meta.limit:50,o="number"==typeof t.meta?.totalPages?t.meta.totalPages:Math.max(Math.ceil(e/Math.max(a,1)),1);return{data:t.data,total:e,page:r,last_page:o}}return t}r.d(e,{XO:()=>i,hH:()=>o,i_:()=>s})}};var e=require("../../../../../../webpack-runtime.js");e.C(t);var r=t=>e(e.s=t),a=e.X(0,[9276,5972],()=>r(89650));module.exports=a})();