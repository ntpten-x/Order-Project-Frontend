(()=>{var e={};e.id=9776,e.ids=[9776],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},58842:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>l,routeModule:()=>m,tree:()=>d}),r(93772),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var a=r(23191),s=r(88716),n=r(43315),o=r(95231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);r.d(t,i);let d=["",{children:["(main)",{children:["pos",{children:["paymentMethod",{children:["manager",{children:["[...mode]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,93772)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\paymentMethod\\manager\\[...mode]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],l=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\paymentMethod\\manager\\[...mode]\\page.tsx"],c="/(main)/pos/paymentMethod/manager/[...mode]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(main)/pos/paymentMethod/manager/[...mode]/page",pathname:"/pos/paymentMethod/manager/[...mode]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},16285:(e,t,r)=>{Promise.resolve().then(r.bind(r,44365))},2643:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var a=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};var n=r(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}let i=a.forwardRef((e,t)=>a.createElement(n.Z,o({},e,{ref:t,icon:s})))},44365:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>q});var a=r(10326),s=r(17577),n=r(43359),o=r(46752),i=r(75958),d=r(71935),l=r(92121),c=r(4139),p=r(38106),m=r(49909),h=r(91259),u=r(63459),y=r(35047),x=r(26963),g=r(76892),f=r(52647),j=r(58184),b=r(11397),_=r(31839);let{pageStyles:v,ManagePageStyles:P}=(0,_.dg)({focusColor:"#10b981",focusShadow:"rgba(16, 185, 129, 0.1)",switchGradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)"}),w=({name:e,displayName:t})=>{let r="linear-gradient(135deg, #10b981 0%, #059669 100%)",s=(e||"").toLowerCase();return s.includes("cash")||s.includes("เงินสด")?r="linear-gradient(135deg, #65a30d 0%, #4d7c0f 100%)":s.includes("promptpay")||s.includes("พร้อมเพย์")?r="linear-gradient(135deg, #0f172a 0%, #1e293b 100%)":s.includes("delivery")&&(r="linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"),(0,a.jsxs)("div",{children:[a.jsx(j.default.Text,{type:"secondary",style:{display:"block",marginBottom:12,fontSize:13,textAlign:"center"},children:"ตัวอย่างการแสดงผล (Preview)"}),(0,a.jsxs)("div",{style:{background:r,borderRadius:20,padding:24,boxShadow:"0 10px 30px rgba(0,0,0,0.15)",color:"white",position:"relative",overflow:"hidden",minHeight:180,display:"flex",flexDirection:"column",maxWidth:340,margin:"0 auto"},children:[a.jsx("div",{style:{position:"absolute",top:-20,right:-20,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.1)",zIndex:1}}),a.jsx("div",{style:{position:"absolute",bottom:-30,left:-30,width:100,height:100,borderRadius:"50%",background:"rgba(255,255,255,0.08)",zIndex:1}}),(0,a.jsxs)("div",{style:{position:"relative",zIndex:2,flex:1},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[a.jsx(b.Z,{style:{fontSize:32,opacity:.9}}),a.jsx("div",{style:{fontSize:16,fontWeight:700,opacity:.9,letterSpacing:"1px",textTransform:"uppercase"},children:"PAYMENT"})]}),(0,a.jsxs)("div",{style:{marginTop:40},children:[a.jsx("div",{style:{fontSize:12,opacity:.7,marginBottom:4},children:"Payment Method"}),a.jsx("div",{style:{fontSize:24,fontWeight:700,letterSpacing:"0.5px",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:t||"Display Name"})]}),a.jsx("div",{style:{marginTop:"auto",paddingTop:20,display:"flex",justifyContent:"flex-end"},children:a.jsx("div",{style:{fontSize:14,opacity:.8,background:"rgba(255,255,255,0.2)",padding:"4px 12px",borderRadius:12,fontWeight:500},children:e||"CODE"})})]})]})]})},S=({isEdit:e,loading:t,onCancel:r})=>a.jsx(_.uM,{pageStyles:v,isEdit:e,loading:t,onCancel:r});r(33357);var E=r(45207),k=r(26902),C=r(24297);let T=[{payment_method_name:"PromptPay",display_name:"พร้อมเพย์"},{payment_method_name:"Delivery",display_name:"เดริเวอรี่"},{payment_method_name:"Cash",display_name:"เงินสด"}];function q({params:e}){let t=(0,y.useRouter)(),[r]=n.Z.useForm(),[j,b]=(0,s.useState)(!1),[_,q]=(0,s.useState)(!1),[Z,O]=(0,s.useState)(""),[F,M]=(0,s.useState)(""),[z,$]=(0,s.useState)(""),[R,I]=(0,s.useState)([]),[N,A]=(0,s.useState)(!1),H=e.mode[0],D=e.mode[1]||null,B="edit"===H&&!!D,{isAuthorized:G,isChecking:L}=(0,E.e)({requiredRole:"Admin"});(0,s.useCallback)(async()=>{try{let e=await C.E.getAll();I(e.data||[])}catch(e){console.error("ไม่สามารถดึงข้อมูล payment methods ได้:",e)}},[]),(0,s.useCallback)(async()=>{b(!0);try{let e=await fetch(`/api/pos/paymentMethod/getById/${D}`);if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลวิธีการชำระเงินได้");let t=await e.json();r.setFieldsValue({payment_method_name:t.payment_method_name,display_name:t.display_name,is_active:t.is_active}),O(t.payment_method_name||""),M(t.display_name||"")}catch(e){console.error(e),o.ZP.error("ไม่สามารถดึงข้อมูลวิธีการชำระเงินได้"),t.push("/pos/paymentMethod")}finally{b(!1)}},[D,r,t]);let X=(0,s.useCallback)(e=>!!e&&!!R&&0!==R.length&&(B?R.some(t=>t.payment_method_name===e&&t.id!==D):R.some(t=>t.payment_method_name===e)),[R,B,D]),W=async e=>{if(X(e.payment_method_name)){o.ZP.error(`วิธีการชำระเงิน "${e.display_name}" มีอยู่ในระบบแล้ว`);return}q(!0);try{if(B){let t=await fetch(`/api/pos/paymentMethod/update/${D}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":z},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตวิธีการชำระเงินได้")}o.ZP.success("อัปเดตวิธีการชำระเงินสำเร็จ")}else{let t=await fetch("/api/pos/paymentMethod/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":z},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างวิธีการชำระเงินได้")}o.ZP.success("สร้างวิธีการชำระเงินสำเร็จ")}t.push("/pos/paymentMethod")}catch(e){console.error(e),o.ZP.error(e.message||(B?"ไม่สามารถอัปเดตวิธีการชำระเงินได้":"ไม่สามารถสร้างวิธีการชำระเงินได้"))}finally{q(!1)}},J=()=>t.push("/pos/paymentMethod");return L?a.jsx(k.H,{message:"กำลังตรวจสอบสิทธิ์..."}):G?(0,a.jsxs)("div",{className:"manage-page",style:v.container,children:[a.jsx(P,{}),a.jsx(f.Z,{title:B?"แก้ไขวิธีการชำระเงิน":"เพิ่มวิธีการชำระเงิน",subtitle:B?"แก้ไขข้อมูลวิธีการชำระเงิน":"สร้างวิธีการชำระเงินใหม่",onBack:J,actions:B?a.jsx(d.ZP,{danger:!0,onClick:()=>{D&&i.Z.confirm({title:"ยืนยันการลบวิธีการชำระเงิน",content:`คุณต้องการลบวิธีการชำระเงิน "${F||Z}" หรือไม่?`,okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{if(!(await fetch(`/api/pos/paymentMethod/delete/${D}`,{method:"DELETE",headers:{"X-CSRF-Token":z}})).ok)throw Error("ไม่สามารถลบวิธีการชำระเงินได้");o.ZP.success("ลบวิธีการชำระเงินสำเร็จ"),t.push("/pos/paymentMethod")}catch(e){console.error(e),o.ZP.error("ไม่สามารถลบวิธีการชำระเงินได้")}}})},children:"ลบ"}):null}),a.jsx(x.Z,{maxWidth:1e3,children:a.jsx(g.Z,{children:j?a.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:a.jsx(l.Z,{size:"large"})}):a.jsx(n.Z,{form:r,layout:"vertical",onFinish:W,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.payment_method_name&&O(e.payment_method_name),void 0!==e.display_name&&M(e.display_name)},children:(0,a.jsxs)(c.Z,{gutter:[32,24],children:[(0,a.jsxs)(p.Z,{xs:24,lg:14,xl:15,children:[(0,a.jsxs)("div",{style:v.formSection,children:[a.jsx(n.Z.Item,{name:"payment_method_name",label:"รหัสวิธีการชำระเงิน *",rules:[{required:!0,message:"กรุณาเลือกวิธีการชำระเงิน"}],children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{border:`1px solid ${Z?"#10b981":"#d9d9d9"}`,borderRadius:12,padding:"12px 16px",cursor:B?"not-allowed":"pointer",background:B?"#f5f5f5":"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",height:48,transition:"all 0.2s",boxShadow:Z?"0 0 0 2px rgba(16, 185, 129, 0.1)":"none"},onClick:()=>{B||A(!0)},children:[a.jsx("span",{style:{color:Z?"#1a1a2e":"#bfbfbf",fontSize:16},children:Z?`${F} (${Z})`:"เลือกวิธีการชำระเงิน"}),a.jsx("span",{style:{color:"#bfbfbf"},children:"▼"})]}),a.jsx(n.Z.Item,{name:"payment_method_name",style:{display:"none"},rules:[{required:!0,message:"กรุณาเลือกวิธีการชำระเงิน"}],children:a.jsx(m.default,{})})]})}),a.jsx(i.Z,{title:"เลือกวิธีการชำระเงิน",open:N,onCancel:()=>A(!1),footer:null,centered:!0,width:400,zIndex:10001,children:a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:T.map(e=>{let t=!B&&X(e.payment_method_name),s=Z===e.payment_method_name;return(0,a.jsxs)("div",{onClick:()=>{t||(r.setFieldsValue({payment_method_name:e.payment_method_name,display_name:e.display_name}),O(e.payment_method_name),M(e.display_name),A(!1))},style:{padding:"16px",border:`1px solid ${s?"#10b981":"#e5e7eb"}`,borderRadius:12,cursor:t?"not-allowed":"pointer",background:s?"#ecfdf5":t?"#f5f5f5":"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",opacity:t?.6:1},children:[(0,a.jsxs)("div",{children:[a.jsx("div",{style:{fontWeight:600,color:s?"#047857":"#1f2937",fontSize:16},children:e.display_name}),a.jsx("div",{style:{fontSize:13,color:s?"#059669":"#6b7280"},children:e.payment_method_name})]}),t&&a.jsx("span",{style:{fontSize:12,color:"#ef4444"},children:"มีอยู่แล้ว"}),s&&!t&&a.jsx("span",{style:{color:"#10b981",fontSize:18},children:"✓"})]},e.payment_method_name)})})}),a.jsx(n.Z.Item,{name:"display_name",label:"ชื่อที่แสดง *",rules:[{required:!0,message:"กรุณาเลือกชื่อที่แสดง"}],children:a.jsx(h.default,{size:"large",placeholder:"ชื่อที่แสดงจะถูกตั้งค่าอัตโนมัติ",disabled:!0,getPopupContainer:()=>document.body,dropdownStyle:{zIndex:9999},children:T.map(e=>a.jsx(h.default.Option,{value:e.display_name,children:e.display_name},e.display_name))})}),a.jsx(n.Z.Item,{name:"is_active",label:"สถานะการใช้งาน",valuePropName:"checked",style:{marginTop:24},children:a.jsx(u.Z,{checkedChildren:"เปิดใช้งาน",unCheckedChildren:"ปิดใช้งาน",style:{transform:"scale(1.1)"}})})]}),a.jsx(S,{isEdit:B,loading:_,onCancel:J})]}),a.jsx(p.Z,{xs:24,lg:10,xl:9,children:a.jsx("div",{style:{position:"sticky",top:24,background:"rgba(250, 250, 250, 0.5)",padding:24,borderRadius:20,border:"1px solid #f0f0f0"},children:a.jsx(n.Z.Item,{noStyle:!0,dependencies:["payment_method_name","display_name"],children:({getFieldValue:e})=>a.jsx(w,{name:e("payment_method_name"),displayName:e("display_name")})})})})]})})})})]}):a.jsx(k.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},24297:(e,t,r)=>{"use strict";r.d(t,{E:()=>d});var a=r(12529),s=r(40820),n=r(40577);let o=s.q.POS.PAYMENT_METHODS,i=(e,t="application/json")=>{let r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},d={getAll:async(e,t)=>{let r=(0,a.b)("GET",o),s=new URLSearchParams(t||"");s.has("page")||s.set("page","1"),s.has("limit")||s.set("limit","200");let d=s.toString();d&&(r+=`?${d}`);let l=i(e,""),c=await fetch(r,{cache:"no-store",headers:l,credentials:"include"});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to fetch payment methods")}return(0,n.XO)(await c.json())},getById:async(e,t)=>{let r=(0,a.b)("GET",`${o}/${e}`),s=i(t,""),d=await fetch(r,{cache:"no-store",headers:s,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to fetch payment method")}return(0,n.hH)(await d.json())},getByName:async(e,t)=>{let r=(0,a.b)("GET",`${o}/getByName/${e}`),s=i(t,""),d=await fetch(r,{cache:"no-store",headers:s,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to fetch payment method")}return(0,n.hH)(await d.json())},create:async(e,t,r)=>{let s=(0,a.b)("POST",`${o}`),d=i(t);r&&(d["X-CSRF-Token"]=r);let l=await fetch(s,{method:"POST",headers:d,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to create payment method")}return(0,n.hH)(await l.json())},update:async(e,t,r,s)=>{let d=(0,a.b)("PUT",`${o}/${e}`),l=i(r);s&&(l["X-CSRF-Token"]=s);let c=await fetch(d,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to update payment method")}return(0,n.hH)(await c.json())},delete:async(e,t,r)=>{let s=(0,a.b)("DELETE",`${o}/${e}`),n=i(t,"");r&&(n["X-CSRF-Token"]=r);let d=await fetch(s,{method:"DELETE",headers:n,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to delete payment method")}}}},93772:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\paymentMethod\manager\[...mode]\page.tsx#default`)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,8491,8571,8842,8963,1399,4658,5345],()=>r(58842));module.exports=a})();