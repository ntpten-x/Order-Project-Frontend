(()=>{var e={};e.id=6775,e.ids=[6775],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},62006:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>d.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>n,routeModule:()=>u,tree:()=>l}),t(10442),t(85429),t(58522),t(61804),t(7629),t(11930),t(12523);var i=t(23191),s=t(88716),d=t(43315),a=t(95231),o={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>a[e]);t.d(r,o);let l=["",{children:["(main)",{children:["pos",{children:["products",{children:["manage",{children:["[...mode]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,10442)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\products\\manage\\[...mode]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],n=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\products\\manage\\[...mode]\\page.tsx"],c="/(main)/pos/products/manage/[...mode]/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(main)/pos/products/manage/[...mode]/page",pathname:"/pos/products/manage/[...mode]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},30160:(e,r,t)=>{Promise.resolve().then(t.bind(t,49370))},49370:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>q});var i=t(10326),s=t(17577),d=t(49909),a=t(43359),o=t(46752),l=t(75958),n=t(71935),c=t(92121),p=t(31916),u=t(63459),g=t(66874),m=t(35047),x=t(26963),h=t(76892),y=t(52647),f=t(46226),j=t(62938),b=t(31839),F=t(61357),v=t(56811);let{Text:_}=g.default,{pageStyles:P,ManagePageStyles:E}=(0,b.dg)({focusColor:"#4F46E5",focusShadow:"rgba(79, 70, 229, 0.1)",switchGradient:"linear-gradient(135deg, #4F46E5 0%, #4338CA 100%)"}),w=({name:e,productName:r,imageUrl:t,price:s,priceDelivery:d,category:a,unit:o})=>(0,i.jsxs)("div",{style:{marginTop:24,marginBottom:24,padding:20,background:"#F8FAFC",borderRadius:20,border:"1px dashed #E2E8F0"},children:[i.jsx(_,{type:"secondary",style:{display:"block",marginBottom:12,fontSize:13,textAlign:"center"},children:"ตัวอย่างการแสดงผล (Live Preview)"}),i.jsx("div",{style:{width:"100%",maxWidth:280,margin:"0 auto",background:"white",borderRadius:20,overflow:"hidden",boxShadow:"0 10px 30px rgba(0,0,0,0.06)",border:"1px solid #F1F5F9",transition:"all 0.3s ease"},children:(0,i.jsxs)("div",{style:{padding:12,display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:72,height:72,borderRadius:16,border:"1px solid #F1F5F9",overflow:"hidden",position:"relative",background:"#F8FAFC",flexShrink:0},children:t&&t.match(/^https?:\/\/.+/)?i.jsx(f.default,{src:t,alt:"Preview",fill:!0,style:{objectFit:"cover"},sizes:"72px",onError:e=>{e.target.style.display="none"}}):i.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #EEF2FF 0%, #E0E7FF 100%)"},children:i.jsx(j.Z,{style:{fontSize:24,color:"#6366F1",opacity:.8}})})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx(_,{strong:!0,style:{fontSize:16,color:"#1E293B",flex:1},ellipsis:!0,children:e||"ชื่อสินค้า (ไทย)"}),i.jsx(v.Z,{style:{color:"#10B981",fontSize:14}})]}),i.jsx(_,{type:"secondary",style:{fontSize:13,display:"block",marginBottom:6,color:"#64748B"},ellipsis:!0,children:r||"Product Name (EN)"}),(0,i.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[(0,i.jsxs)(F.Z,{style:{borderRadius:6,margin:0,fontSize:11,fontWeight:700,color:"#059669",background:"#ECFDF5",border:"none",padding:"0 8px"},children:["฿",(s||0).toLocaleString()]}),(0,i.jsxs)(F.Z,{style:{borderRadius:6,margin:0,fontSize:11,fontWeight:700,color:"#db2777",background:"#fdf2f8",border:"none",padding:"0 8px"},children:["Delivery ฿",Number(d??s??0).toLocaleString()]}),a&&i.jsx(F.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:"#4F46E5",background:"#EEF2FF",border:"none"},children:a}),o&&i.jsx(F.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:"#0891B2",background:"#CFFAFE",border:"none"},children:o})]})]})]})})]}),C=({isEdit:e,loading:r,onCancel:t})=>i.jsx(b.uM,{pageStyles:P,isEdit:e,loading:r,onCancel:t});t(33357);var k=t(7670),S=t(26902);let{TextArea:Z}=d.default;function q({params:e}){let r=(0,m.useRouter)(),[t]=a.Z.useForm(),[f,j]=(0,s.useState)(!1),[b,F]=(0,s.useState)(!1),[v,_]=(0,s.useState)([]),[q,z]=(0,s.useState)([]),[R,B]=(0,s.useState)(""),[I,V]=(0,s.useState)(""),[T,A]=(0,s.useState)(""),[O,N]=(0,s.useState)(!1),[W,$]=(0,s.useState)(!1),[,D]=(0,s.useState)({}),L=e.mode[0],M=e.mode[1]||null,G="edit"===L&&!!M,{isAuthorized:H,isChecking:X}=(0,k.e)({allowedRoles:["Admin","Manager"]});(0,s.useCallback)(async()=>{j(!0);try{let e=await fetch(`/api/pos/products/getById/${M}`);if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลสินค้าได้");let r=await e.json();t.setFieldsValue({product_name:r.product_name,display_name:r.display_name,description:r.description,img_url:r.img_url,price:parseFloat(r.price),price_delivery:Number(r.price_delivery??r.price??0),category_id:r.category_id,unit_id:r.unit_id,is_active:r.is_active}),B(r.img_url||""),V(r.display_name||"")}catch(e){console.error(e),o.ZP.error("ไม่สามารถดึงข้อมูลสินค้าได้"),r.push("/pos/products")}finally{j(!1)}},[M,t,r]);let U=async e=>{F(!0);try{if(G){let r=await fetch(`/api/pos/products/update/${M}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":T},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตสินค้าได้")}o.ZP.success("อัปเดตสินค้าสำเร็จ")}else{let r=await fetch("/api/pos/products/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":T},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างสินค้าได้")}o.ZP.success("สร้างสินค้าสำเร็จ")}r.push("/pos/products")}catch(e){console.error(e),o.ZP.error(e.message||(G?"ไม่สามารถอัปเดตสินค้าได้":"ไม่สามารถสร้างสินค้าได้"))}finally{F(!1)}},J=()=>r.push("/pos/products");return X?i.jsx(S.H,{message:"กำลังตรวจสอบสิทธิ์..."}):H?(0,i.jsxs)("div",{className:"manage-page",style:P.container,children:[i.jsx(E,{}),i.jsx(y.Z,{title:G?"แก้ไขสินค้า":"เพิ่มสินค้า",subtitle:G?"แก้ไขข้อมูลสินค้า":"สร้างสินค้าใหม่",onBack:J,actions:G?i.jsx(n.ZP,{danger:!0,onClick:()=>{M&&l.Z.confirm({title:"ยืนยันการลบสินค้า",content:`คุณต้องการลบสินค้า "${I}" หรือไม่?`,okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{if(!(await fetch(`/api/pos/products/delete/${M}`,{method:"DELETE",headers:{"X-CSRF-Token":T}})).ok)throw Error("ไม่สามารถลบสินค้าได้");o.ZP.success("ลบสินค้าสำเร็จ"),r.push("/pos/products")}catch(e){console.error(e),o.ZP.error("ไม่สามารถลบสินค้าได้")}}})},children:"ลบ"}):null}),i.jsx(x.Z,{maxWidth:1200,children:i.jsx(h.Z,{style:{background:"transparent",border:"none"},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:24,alignItems:"start",margin:0},children:[i.jsx("div",{className:"manage-form-card",style:{...P.formCard,gridColumn:"1 / span 1",margin:0},children:f?i.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:i.jsx(c.Z,{size:"large"})}):(0,i.jsxs)(a.Z,{form:t,layout:"vertical",onFinish:U,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0,price:0,price_delivery:0},onValuesChange:e=>{void 0!==e.img_url&&B(e.img_url),void 0!==e.display_name&&V(e.display_name),G||void 0===e.price||t.isFieldTouched("price_delivery")||t.setFieldsValue({price_delivery:e.price}),D({})},children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsx(a.Z.Item,{name:"display_name",label:"ชื่อที่แสดง (ภาษาไทย) *",rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:i.jsx(d.default,{size:"large",placeholder:"เช่น น้ำเปล่า, กาแฟ",maxLength:100})}),i.jsx(a.Z.Item,{name:"product_name",label:"ชื่อสินค้า (ภาษาอังกฤษ) *",rules:[{required:!0,message:"กรุณากรอกชื่อสินค้า"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:i.jsx(d.default,{size:"large",placeholder:"如 Water, Coffee",maxLength:100})})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsx(a.Z.Item,{name:"price",label:"ราคา (หน้าร้าน) *",rules:[{required:!0,message:"กรุณากรอกราคา"},{type:"number",min:0,message:"ราคาต้องไม่ติดลบ"}],children:i.jsx(p.Z,{size:"large",placeholder:"0.00",min:0,precision:2,style:{width:"100%",height:45,fontSize:16,borderRadius:12},formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e?parseFloat(e.replace(/\$\s?|(,*)/g,"")):0,controls:!1})}),i.jsx(a.Z.Item,{name:"price_delivery",label:"ราคา (Delivery) *",rules:[{required:!0,message:"กรุณากรอกราคา Delivery"},{type:"number",min:0,message:"ราคาต้องไม่ติดลบ"}],children:i.jsx(p.Z,{size:"large",placeholder:"0.00",min:0,precision:2,style:{width:"100%",height:45,fontSize:16,borderRadius:12},formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e?parseFloat(e.replace(/\$\s?|(,*)/g,"")):0,controls:!1})})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,i.jsxs)(a.Z.Item,{name:"category_id",label:"หมวดหมู่ *",rules:[{required:!0,message:"กรุณาเลือกหมวดหมู่"}],children:[(0,i.jsxs)("div",{className:"custom-select",onClick:()=>N(!0),style:{border:"1px solid #d9d9d9",borderRadius:12,padding:"10px 16px",cursor:"pointer",height:45,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("span",{style:{color:t.getFieldValue("category_id")?"#1E293B":"#bfbfbf"},children:v.find(e=>e.id===t.getFieldValue("category_id"))?.display_name||"เลือกหมวดหมู่"}),i.jsx("span",{style:{color:"#94A3B8"},children:"▼"})]}),i.jsx(a.Z.Item,{name:"category_id",hidden:!0,children:i.jsx(d.default,{})})]}),(0,i.jsxs)(a.Z.Item,{name:"unit_id",label:"หน่วยสินค้า *",rules:[{required:!0,message:"กรุณาเลือกหน่วยสินค้า"}],children:[(0,i.jsxs)("div",{className:"custom-select",onClick:()=>$(!0),style:{border:"1px solid #d9d9d9",borderRadius:12,padding:"10px 16px",cursor:"pointer",height:45,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("span",{style:{color:t.getFieldValue("unit_id")?"#1E293B":"#bfbfbf"},children:q.find(e=>e.id===t.getFieldValue("unit_id"))?.display_name||"เลือกหน่วย"}),i.jsx("span",{style:{color:"#94A3B8"},children:"▼"})]}),i.jsx(a.Z.Item,{name:"unit_id",hidden:!0,children:i.jsx(d.default,{})})]})]}),i.jsx(a.Z.Item,{name:"img_url",label:"รูปภาพ URL",children:i.jsx(d.default,{size:"large",placeholder:"https://example.com/image.jpg"})}),i.jsx(a.Z.Item,{name:"description",label:"รายละเอียดเพิ่มเติม",children:i.jsx(Z,{rows:4,placeholder:"รายละเอียด...",style:{borderRadius:12}})}),i.jsx(a.Z.Item,{name:"is_active",label:"สถานะ",valuePropName:"checked",children:i.jsx(u.Z,{checkedChildren:"เปิดใช้งาน",unCheckedChildren:"ปิดใช้งาน"})}),i.jsx(C,{isEdit:G,loading:b,onCancel:J})]})}),i.jsx("div",{style:{position:"sticky",top:24,display:"flex",flexDirection:"column",gap:16},children:(0,i.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",border:"1px solid #F1F5F9"},children:[i.jsx(g.default.Title,{level:5,style:{margin:0,marginBottom:16,color:"#475569"},children:"ตัวอย่างการแสดงผล"}),i.jsx(w,{name:I,productName:t.getFieldValue("product_name"),imageUrl:R,price:t.getFieldValue("price"),priceDelivery:t.getFieldValue("price_delivery"),category:v.find(e=>e.id===t.getFieldValue("category_id"))?.display_name,unit:q.find(e=>e.id===t.getFieldValue("unit_id"))?.display_name})]})})]})})}),i.jsx(l.Z,{title:"เลือกหมวดหมู่",open:O,onCancel:()=>N(!1),footer:null,centered:!0,width:400,zIndex:10001,styles:{body:{borderRadius:20,overflow:"hidden",padding:0}},children:i.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto",padding:16,background:"#F8FAFC"},children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:v.map(e=>(0,i.jsxs)("div",{onClick:()=>{t.setFieldsValue({category_id:e.id}),N(!1)},style:{padding:"16px",border:`1px solid ${t.getFieldValue("category_id")===e.id?"#4F46E5":"#E2E8F0"}`,borderRadius:16,cursor:"pointer",background:t.getFieldValue("category_id")===e.id?"#F5F3FF":"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[(0,i.jsxs)("div",{children:[i.jsx("div",{style:{fontWeight:600,color:"#1E293B"},children:e.display_name}),i.jsx("div",{style:{fontSize:12,color:"#64748B"},children:e.category_name})]}),t.getFieldValue("category_id")===e.id&&i.jsx("span",{style:{color:"#4F46E5",fontWeight:"bold"},children:"✓"})]},e.id))})})}),i.jsx(l.Z,{title:"เลือกหน่วยสินค้า",open:W,onCancel:()=>$(!1),footer:null,centered:!0,width:400,zIndex:10001,styles:{body:{borderRadius:20,overflow:"hidden",padding:0}},children:i.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto",padding:16,background:"#F8FAFC"},children:i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:q.map(e=>(0,i.jsxs)("div",{onClick:()=>{t.setFieldsValue({unit_id:e.id}),$(!1)},style:{padding:"16px",border:`1px solid ${t.getFieldValue("unit_id")===e.id?"#10B981":"#E2E8F0"}`,borderRadius:16,cursor:"pointer",background:t.getFieldValue("unit_id")===e.id?"#ECFDF5":"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[(0,i.jsxs)("div",{children:[i.jsx("div",{style:{fontWeight:600,color:"#1E293B"},children:e.display_name}),i.jsx("div",{style:{fontSize:12,color:"#64748B"},children:e.unit_name})]}),t.getFieldValue("unit_id")===e.id&&i.jsx("span",{style:{color:"#10B981",fontWeight:"bold"},children:"✓"})]},e.id))})})})]}):i.jsx(S.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},10442:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});let i=(0,t(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\products\manage\[...mode]\page.tsx#default`)}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[9276,4421,8571,8842,9244,8963,1399,4658,1170],()=>t(62006));module.exports=i})();