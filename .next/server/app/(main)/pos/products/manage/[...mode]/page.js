(()=>{var e={};e.id=6775,e.ids=[6775],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},62006:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>d.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>n,routeModule:()=>u,tree:()=>l}),t(10442),t(85429),t(58522),t(61804),t(7629),t(11930),t(12523);var s=t(23191),i=t(88716),d=t(43315),o=t(95231),a={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>o[e]);t.d(r,a);let l=["",{children:["(main)",{children:["pos",{children:["products",{children:["manage",{children:["[...mode]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,10442)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\products\\manage\\[...mode]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],n=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\products\\manage\\[...mode]\\page.tsx"],c="/(main)/pos/products/manage/[...mode]/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/pos/products/manage/[...mode]/page",pathname:"/pos/products/manage/[...mode]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},30160:(e,r,t)=>{Promise.resolve().then(t.bind(t,49370))},49370:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>k});var s=t(10326),i=t(17577),d=t(49909),o=t(43359),a=t(46752),l=t(75958),n=t(92121),c=t(31916),p=t(63459),u=t(58184),g=t(35047),x=t(46226),m=t(62938),h=t(31839),y=t(61357),f=t(56811);let{Text:j}=u.default,{pageStyles:b,ManagePageStyles:F}=(0,h.dg)({focusColor:"#4F46E5",focusShadow:"rgba(79, 70, 229, 0.1)",switchGradient:"linear-gradient(135deg, #4F46E5 0%, #4338CA 100%)"}),v=({isEdit:e,onBack:r,onDelete:t})=>s.jsx(h.oI,{pageStyles:b,isEdit:e,onBack:r,onDelete:t,titleCreate:"เพิ่มสินค้าใหม่",titleEdit:"แก้ไขข้อมูลสินค้า"}),_=({name:e,productName:r,imageUrl:t,price:i,category:d,unit:o})=>(0,s.jsxs)("div",{style:{marginTop:24,marginBottom:24,padding:20,background:"#F8FAFC",borderRadius:20,border:"1px dashed #E2E8F0"},children:[s.jsx(j,{type:"secondary",style:{display:"block",marginBottom:12,fontSize:13,textAlign:"center"},children:"ตัวอย่างการแสดงผล (Live Preview)"}),s.jsx("div",{style:{width:"100%",maxWidth:280,margin:"0 auto",background:"white",borderRadius:20,overflow:"hidden",boxShadow:"0 10px 30px rgba(0,0,0,0.06)",border:"1px solid #F1F5F9",transition:"all 0.3s ease"},children:(0,s.jsxs)("div",{style:{padding:12,display:"flex",gap:12,alignItems:"center"},children:[s.jsx("div",{style:{width:72,height:72,borderRadius:16,border:"1px solid #F1F5F9",overflow:"hidden",position:"relative",background:"#F8FAFC",flexShrink:0},children:t&&t.match(/^https?:\/\/.+/)?s.jsx(x.default,{src:t,alt:"Preview",fill:!0,style:{objectFit:"cover"},sizes:"72px",onError:e=>{e.target.style.display="none"}}):s.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #EEF2FF 0%, #E0E7FF 100%)"},children:s.jsx(m.Z,{style:{fontSize:24,color:"#6366F1",opacity:.8}})})}),(0,s.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[s.jsx(j,{strong:!0,style:{fontSize:16,color:"#1E293B",flex:1},ellipsis:!0,children:e||"ชื่อสินค้า (ไทย)"}),s.jsx(f.Z,{style:{color:"#10B981",fontSize:14}})]}),s.jsx(j,{type:"secondary",style:{fontSize:13,display:"block",marginBottom:6,color:"#64748B"},ellipsis:!0,children:r||"Product Name (EN)"}),(0,s.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[(0,s.jsxs)(y.Z,{style:{borderRadius:6,margin:0,fontSize:11,fontWeight:700,color:"#059669",background:"#ECFDF5",border:"none",padding:"0 8px"},children:["฿",(i||0).toLocaleString()]}),d&&s.jsx(y.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:"#4F46E5",background:"#EEF2FF",border:"none"},children:d}),o&&s.jsx(y.Z,{style:{borderRadius:6,margin:0,fontSize:10,color:"#0891B2",background:"#CFFAFE",border:"none"},children:o})]})]})]})})]}),E=({isEdit:e,loading:r,onCancel:t})=>s.jsx(h.uM,{pageStyles:b,isEdit:e,loading:r,onCancel:t});t(33357);var P=t(45207),C=t(26902);let{TextArea:w}=d.default;function k({params:e}){let r=(0,g.useRouter)(),[t]=o.Z.useForm(),[x,m]=(0,i.useState)(!1),[h,y]=(0,i.useState)(!1),[f,j]=(0,i.useState)([]),[k,S]=(0,i.useState)([]),[q,Z]=(0,i.useState)(""),[B,I]=(0,i.useState)(""),[R,z]=(0,i.useState)(""),[V,T]=(0,i.useState)(!1),[A,O]=(0,i.useState)(!1),[,N]=(0,i.useState)({}),W=e.mode[0],$=e.mode[1]||null,D="edit"===W&&!!$,{isAuthorized:L,isChecking:G}=(0,P.e)({requiredRole:"Admin"});(0,i.useCallback)(async()=>{m(!0);try{let e=await fetch(`/api/pos/products/getById/${$}`);if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลสินค้าได้");let r=await e.json();t.setFieldsValue({product_name:r.product_name,display_name:r.display_name,description:r.description,img_url:r.img_url,price:parseFloat(r.price),category_id:r.category_id,unit_id:r.unit_id,is_active:r.is_active}),Z(r.img_url||""),I(r.display_name||"")}catch(e){console.error(e),a.ZP.error("ไม่สามารถดึงข้อมูลสินค้าได้"),r.push("/pos/products")}finally{m(!1)}},[$,t,r]);let M=async e=>{y(!0);try{if(D){let r=await fetch(`/api/pos/products/update/${$}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":R},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตสินค้าได้")}a.ZP.success("อัปเดตสินค้าสำเร็จ")}else{let r=await fetch("/api/pos/products/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":R},body:JSON.stringify(e)});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างสินค้าได้")}a.ZP.success("สร้างสินค้าสำเร็จ")}r.push("/pos/products")}catch(e){console.error(e),a.ZP.error(e.message||(D?"ไม่สามารถอัปเดตสินค้าได้":"ไม่สามารถสร้างสินค้าได้"))}finally{y(!1)}},H=()=>r.push("/pos/products");return G?s.jsx(C.H,{message:"กำลังตรวจสอบสิทธิ์..."}):L?(0,s.jsxs)("div",{className:"manage-page",style:b.container,children:[s.jsx(F,{}),s.jsx(v,{isEdit:D,onBack:H,onDelete:D?()=>{$&&l.Z.confirm({title:"ยืนยันการลบสินค้า",content:`คุณต้องการลบสินค้า "${B}" หรือไม่?`,okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{if(!(await fetch(`/api/pos/products/delete/${$}`,{method:"DELETE",headers:{"X-CSRF-Token":R}})).ok)throw Error("ไม่สามารถลบสินค้าได้");a.ZP.success("ลบสินค้าสำเร็จ"),r.push("/pos/products")}catch(e){console.error(e),a.ZP.error("ไม่สามารถลบสินค้าได้")}}})}:void 0}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:24,alignItems:"start",maxWidth:1200,margin:"0 auto"},children:[s.jsx("div",{className:"manage-form-card",style:{...b.formCard,gridColumn:"1 / span 1",margin:0},children:x?s.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:s.jsx(n.Z,{size:"large"})}):(0,s.jsxs)(o.Z,{form:t,layout:"vertical",onFinish:M,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0,price:0},onValuesChange:e=>{void 0!==e.img_url&&Z(e.img_url),void 0!==e.display_name&&I(e.display_name),N({})},children:[(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[s.jsx(o.Z.Item,{name:"display_name",label:"ชื่อที่แสดง (ภาษาไทย) *",rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:s.jsx(d.default,{size:"large",placeholder:"เช่น น้ำเปล่า, กาแฟ",maxLength:100})}),s.jsx(o.Z.Item,{name:"product_name",label:"ชื่อสินค้า (ภาษาอังกฤษ) *",rules:[{required:!0,message:"กรุณากรอกชื่อสินค้า"},{pattern:/^[a-zA-Z0-9\s\-_().]*$/,message:"กรุณากรอกภาษาอังกฤษเท่านั้น"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:s.jsx(d.default,{size:"large",placeholder:"如 Water, Coffee",maxLength:100})})]}),s.jsx(o.Z.Item,{name:"price",label:"ราคา (บาท) *",rules:[{required:!0,message:"กรุณากรอกราคา"},{type:"number",min:0,message:"ราคาต้องไม่ติดลบ"}],children:s.jsx(c.Z,{size:"large",placeholder:"0.00",min:0,precision:2,style:{width:"100%",height:45,fontSize:16,borderRadius:12},formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e?parseFloat(e.replace(/\$\s?|(,*)/g,"")):0,controls:!1})}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[(0,s.jsxs)(o.Z.Item,{name:"category_id",label:"หมวดหมู่ *",rules:[{required:!0,message:"กรุณาเลือกหมวดหมู่"}],children:[(0,s.jsxs)("div",{className:"custom-select",onClick:()=>T(!0),style:{border:"1px solid #d9d9d9",borderRadius:12,padding:"10px 16px",cursor:"pointer",height:45,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:t.getFieldValue("category_id")?"#1E293B":"#bfbfbf"},children:f.find(e=>e.id===t.getFieldValue("category_id"))?.display_name||"เลือกหมวดหมู่"}),s.jsx("span",{style:{color:"#94A3B8"},children:"▼"})]}),s.jsx(o.Z.Item,{name:"category_id",hidden:!0,children:s.jsx(d.default,{})})]}),(0,s.jsxs)(o.Z.Item,{name:"unit_id",label:"หน่วยสินค้า *",rules:[{required:!0,message:"กรุณาเลือกหน่วยสินค้า"}],children:[(0,s.jsxs)("div",{className:"custom-select",onClick:()=>O(!0),style:{border:"1px solid #d9d9d9",borderRadius:12,padding:"10px 16px",cursor:"pointer",height:45,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[s.jsx("span",{style:{color:t.getFieldValue("unit_id")?"#1E293B":"#bfbfbf"},children:k.find(e=>e.id===t.getFieldValue("unit_id"))?.display_name||"เลือกหน่วย"}),s.jsx("span",{style:{color:"#94A3B8"},children:"▼"})]}),s.jsx(o.Z.Item,{name:"unit_id",hidden:!0,children:s.jsx(d.default,{})})]})]}),s.jsx(o.Z.Item,{name:"img_url",label:"รูปภาพ URL",children:s.jsx(d.default,{size:"large",placeholder:"https://example.com/image.jpg"})}),s.jsx(o.Z.Item,{name:"description",label:"รายละเอียดเพิ่มเติม",children:s.jsx(w,{rows:4,placeholder:"รายละเอียด...",style:{borderRadius:12}})}),s.jsx(o.Z.Item,{name:"is_active",label:"สถานะ",valuePropName:"checked",children:s.jsx(p.Z,{checkedChildren:"เปิดใช้งาน",unCheckedChildren:"ปิดใช้งาน"})}),s.jsx(E,{isEdit:D,loading:h,onCancel:H})]})}),s.jsx("div",{style:{position:"sticky",top:24,display:"flex",flexDirection:"column",gap:16},children:(0,s.jsxs)("div",{style:{background:"white",borderRadius:24,padding:24,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",border:"1px solid #F1F5F9"},children:[s.jsx(u.default.Title,{level:5,style:{margin:0,marginBottom:16,color:"#475569"},children:"ตัวอย่างการแสดงผล"}),s.jsx(_,{name:B,productName:t.getFieldValue("product_name"),imageUrl:q,price:t.getFieldValue("price"),category:f.find(e=>e.id===t.getFieldValue("category_id"))?.display_name,unit:k.find(e=>e.id===t.getFieldValue("unit_id"))?.display_name})]})})]}),s.jsx(l.Z,{title:"เลือกหมวดหมู่",open:V,onCancel:()=>T(!1),footer:null,centered:!0,width:400,zIndex:10001,styles:{body:{borderRadius:20,overflow:"hidden",padding:0}},children:s.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto",padding:16,background:"#F8FAFC"},children:s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:f.map(e=>(0,s.jsxs)("div",{onClick:()=>{t.setFieldsValue({category_id:e.id}),T(!1)},style:{padding:"16px",border:`1px solid ${t.getFieldValue("category_id")===e.id?"#4F46E5":"#E2E8F0"}`,borderRadius:16,cursor:"pointer",background:t.getFieldValue("category_id")===e.id?"#F5F3FF":"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[(0,s.jsxs)("div",{children:[s.jsx("div",{style:{fontWeight:600,color:"#1E293B"},children:e.display_name}),s.jsx("div",{style:{fontSize:12,color:"#64748B"},children:e.category_name})]}),t.getFieldValue("category_id")===e.id&&s.jsx("span",{style:{color:"#4F46E5",fontWeight:"bold"},children:"✓"})]},e.id))})})}),s.jsx(l.Z,{title:"เลือกหน่วยสินค้า",open:A,onCancel:()=>O(!1),footer:null,centered:!0,width:400,zIndex:10001,styles:{body:{borderRadius:20,overflow:"hidden",padding:0}},children:s.jsx("div",{style:{maxHeight:"60vh",overflowY:"auto",padding:16,background:"#F8FAFC"},children:s.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:k.map(e=>(0,s.jsxs)("div",{onClick:()=>{t.setFieldsValue({unit_id:e.id}),O(!1)},style:{padding:"16px",border:`1px solid ${t.getFieldValue("unit_id")===e.id?"#10B981":"#E2E8F0"}`,borderRadius:16,cursor:"pointer",background:t.getFieldValue("unit_id")===e.id?"#ECFDF5":"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},children:[(0,s.jsxs)("div",{children:[s.jsx("div",{style:{fontWeight:600,color:"#1E293B"},children:e.display_name}),s.jsx("div",{style:{fontSize:12,color:"#64748B"},children:e.unit_name})]}),t.getFieldValue("unit_id")===e.id&&s.jsx("span",{style:{color:"#10B981",fontWeight:"bold"},children:"✓"})]},e.id))})})})]}):s.jsx(C.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},10442:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\products\manage\[...mode]\page.tsx#default`)}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,8674,8571,8270,9345,6226,9042,1399,4658,2147],()=>t(62006));module.exports=s})();