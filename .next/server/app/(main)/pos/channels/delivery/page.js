(()=>{var e={};e.id=3859,e.ids=[3859],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},11970:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>d,routeModule:()=>u,tree:()=>l}),t(14716),t(85429),t(58522),t(61804),t(7629),t(11930),t(12523);var a=t(23191),n=t(88716),i=t(43315),s=t(95231),o={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>s[e]);t.d(r,o);let l=["",{children:["(main)",{children:["pos",{children:["channels",{children:["delivery",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,14716)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\channels\\delivery\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],d=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\channels\\delivery\\page.tsx"],c="/(main)/pos/channels/delivery/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(main)/pos/channels/delivery/page",pathname:"/pos/channels/delivery",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},9337:(e,r,t)=>{Promise.resolve().then(t.bind(t,56454))},16185:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});var a=t(17577);let n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"};var i=t(74082);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}let o=a.forwardRef((e,r)=>a.createElement(i.Z,s({},e,{ref:r,icon:n})))},62989:function(e){var r;r=function(){return function(e,r,t){e=e||{};var a=r.prototype,n={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function i(e,r,t,n){return a.fromToBase(e,r,t,n)}t.en.relativeTime=n,a.fromToBase=function(r,a,i,s,o){for(var l,d,c,p=i.$locale().relativeTime||n,u=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],m=u.length,y=0;y<m;y+=1){var x=u[y];x.d&&(l=s?t(r).diff(i,x.d,!0):i.diff(r,x.d,!0));var h=(e.rounding||Math.round)(Math.abs(l));if(c=l>0,h<=x.r||!x.r){h<=1&&y>0&&(x=u[y-1]);var f=p[x.l];o&&(h=o(""+h)),d="string"==typeof f?f.replace("%d",h):f(h,a,x.l,c);break}}if(a)return d;var v=c?p.future:p.past;return"function"==typeof v?v(d):v.replace("%s",d)},a.to=function(e,r){return i(e,r,this,!0)},a.from=function(e,r){return i(e,r,this)};var s=function(e){return e.$u?t.utc():t()};a.toNow=function(e){return this.to(s(this),e)},a.fromNow=function(e){return this.from(s(this),e)}}},e.exports=r()},56454:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>V});var a=t(10326),n=t(77626),i=t.n(n),s=t(17577),o=t(35047),l=t(58184),d=t(46752),c=t(64635),p=t(61357),u=t(71935),m=t(4139),y=t(38106),x=t(75958),h=t(91259),f=t(49909),v=t(16185),g=t(72380),b=t(22817),j=t(26963),_=t(76892),P=t(52647),w=t(36231),k=t(44976),N=t(20108),z=t(19211),C=t(12529),S=t(40820),D=t(40577);let q=S.q.POS.DELIVERY,Z=(e,r="application/json")=>{let t={};return r&&(t["Content-Type"]=r),e&&(t.Cookie=e),t},E={getAll:async(e,r)=>{let t=(0,C.b)("GET",q),a=new URLSearchParams(r||"");a.has("page")||a.set("page","1"),a.has("limit")||a.set("limit","200");let n=a.toString();n&&(t+=`?${n}`);let i=Z(e,""),s=await fetch(t,{cache:"no-store",headers:i,credentials:"include"});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e?.error?.message||e.error||e.message||"Failed to fetch delivery providers")}return(0,D.XO)(await s.json())}};var F=t(13976),A=t(93922),T=t(79e3),$=t(15051),O=t(2504),I=t(95963),M=t(37938),R=t(45317),B=t(88295),W=t.n(B),L=t(62989),G=t.n(L);t(63699);let{Text:H}=l.default;function V(){let e=(0,o.useRouter)(),{showLoading:r,hideLoading:t}=(0,M.x)(),{deliveryProviders:n,isLoading:l}=function(){let{socket:e}=(0,s.useContext)(z.J);(0,k.NL)();let{data:r,error:t,isLoading:a,refetch:n}=(0,N.a)({queryKey:["delivery"],queryFn:async()=>(await E.getAll()).data,staleTime:5e3});return{deliveryProviders:r||[],isLoading:a,isError:t,mutate:n}}(),{orders:C,isLoading:S}=(0,R.w)({orderType:F.m.Delivery}),[D,q]=(0,s.useState)(!1),Z=(0,s.useMemo)(()=>(0,O.Do)(C),[C]),[B,L]=(0,s.useState)(""),[G,V]=(0,s.useState)(null),U=(0,s.useMemo)(()=>n.find(e=>e.id===G),[n,G]),Y=r=>{let t=(0,I.M9)(r);e.push(t)},J=()=>{L(""),V(null),q(!0)},K=()=>{if(!G){d.ZP.error("กรุณาเลือกผู้ให้บริการ");return}if(!B.trim()){d.ZP.error("กรุณากรอกรหัสออเดอร์");return}r("กำลังเข้าสู่หน้าออเดอร์...");let t=B.trim();U?.delivery_prefix&&(t=`${U.delivery_prefix}-${t}`),e.push(`/pos/channels/delivery/${G}?code=${encodeURIComponent(t)}`)},X=e=>{switch(e){case"available":return"success";case"occupied":return"orange";case"waitingForPayment":return"blue";default:return"default"}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx($.c,{}),a.jsx(i(),{id:T.N5.__hash,children:T.N5}),a.jsx(i(),{id:"c1ca8602d2ef2218",children:".order-card-hover{-webkit-transition:all.3s cubic-bezier(.4,0,.2,1)!important;-moz-transition:all.3s cubic-bezier(.4,0,.2,1)!important;-o-transition:all.3s cubic-bezier(.4,0,.2,1)!important;transition:all.3s cubic-bezier(.4,0,.2,1)!important}.order-card-hover:hover{-webkit-transform:translatey(-4px)!important;-moz-transform:translatey(-4px)!important;-ms-transform:translatey(-4px)!important;-o-transform:translatey(-4px)!important;transform:translatey(-4px)!important;-webkit-box-shadow:0 12px 28px rgba(0,0,0,.1)!important;-moz-box-shadow:0 12px 28px rgba(0,0,0,.1)!important;box-shadow:0 12px 28px rgba(0,0,0,.1)!important}.order-card-hover:active{-webkit-transform:translatey(-2px)scale(.99)!important;-moz-transform:translatey(-2px)scale(.99)!important;-ms-transform:translatey(-2px)scale(.99)!important;-o-transform:translatey(-2px)scale(.99)!important;transform:translatey(-2px)scale(.99)!important}@media(hover:none){.order-card-hover:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.order-card-hover:hover{-webkit-transform:none!important;-moz-transform:none!important;-ms-transform:none!important;-o-transform:none!important;transform:none!important}}.back-button-hover:hover{background:rgba(255,255,255,.28)!important;-webkit-transform:translatex(-2px);-moz-transform:translatex(-2px);-ms-transform:translatex(-2px);-o-transform:translatex(-2px);transform:translatex(-2px)}.add-button-hover:hover{-webkit-transform:translatey(-2px)!important;-moz-transform:translatey(-2px)!important;-ms-transform:translatey(-2px)!important;-o-transform:translatey(-2px)!important;transform:translatey(-2px)!important;-webkit-box-shadow:0 12px 24px rgba(139,92,246,.35)!important;-moz-box-shadow:0 12px 24px rgba(139,92,246,.35)!important;box-shadow:0 12px 24px rgba(139,92,246,.35)!important}.add-button-hover:active{-webkit-transform:scale(.98)!important;-moz-transform:scale(.98)!important;-ms-transform:scale(.98)!important;-o-transform:scale(.98)!important;transform:scale(.98)!important}.hide-on-mobile{display:inline!important}.show-on-mobile-inline{display:none!important}@media(max-width:768px){.hide-on-mobile{display:none!important}.show-on-mobile-inline{display:inline!important}}.delivery-modal .ant-modal-content{-webkit-border-radius:20px!important;-moz-border-radius:20px!important;border-radius:20px!important;overflow:hidden}.delivery-modal .ant-modal-header{padding:20px 24px 16px!important;border-bottom:1px solid#f0f0f0!important}.delivery-modal .ant-modal-body{padding:24px!important}.delivery-modal .ant-modal-footer{padding:16px 24px 20px!important;border-top:1px solid#f0f0f0!important}"}),(0,a.jsxs)("div",{style:A.Np.container,className:"jsx-c1ca8602d2ef2218",children:[a.jsx(P.Z,{title:"เดลิเวอรี่",subtitle:(0,a.jsxs)(c.Z,{size:8,wrap:!0,children:[(0,a.jsxs)(p.Z,{children:["ทั้งหมด ",Z.total]}),(0,a.jsxs)(p.Z,{color:"orange",children:["กำลังปรุง ",Z.cooking]})]}),onBack:()=>{e.push("/pos/channels")},icon:a.jsx(v.Z,{style:{fontSize:20}}),actions:a.jsx(u.ZP,{type:"primary",icon:a.jsx(g.Z,{}),onClick:J,children:"เพิ่มออเดอร์"})}),a.jsx(j.Z,{children:a.jsx(_.Z,{title:"ออเดอร์",children:C.length>0?a.jsx(m.Z,{gutter:[16,16],children:C.map((e,r)=>{let t=(0,O.Yx)(e),i=A.ax[t],s=n.find(r=>r.id===e.delivery_id),o=e.delivery_code||e.order_no.split("-").pop();return a.jsx(y.Z,{xs:24,sm:12,md:8,lg:6,xl:6,className:"delivery-order-col-mobile",children:(0,a.jsxs)("article",{style:{...T.yy.orderCard,border:`1.5px solid ${i.border}`},onClick:()=>Y(e),onKeyDown:r=>{("Enter"===r.key||" "===r.key)&&(r.preventDefault(),Y(e))},role:"button",tabIndex:0,"aria-label":`ออเดอร์ ${o} - ${(0,O.NE)(e.status)}`,className:`jsx-c1ca8602d2ef2218 order-card-hover delivery-order-card table-card-animate table-card-delay-${r%6+1}`,children:[(0,a.jsxs)("div",{style:{...T.yy.orderCardHeader,background:i.light},className:"jsx-c1ca8602d2ef2218",children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},className:"jsx-c1ca8602d2ef2218",children:[a.jsx("div",{style:{width:40,height:40,borderRadius:12,background:`${i.primary}20`,display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-c1ca8602d2ef2218",children:a.jsx(v.Z,{style:{color:i.primary,fontSize:20}})}),(0,a.jsxs)("div",{className:"jsx-c1ca8602d2ef2218",children:[a.jsx(H,{strong:!0,style:{fontSize:16,color:"#1E293B",display:"block",lineHeight:1.2},children:o}),a.jsx(H,{type:"secondary",style:{fontSize:11},children:s?.delivery_name||"Delivery"})]})]}),a.jsx(p.Z,{color:X(t),style:{borderRadius:8,margin:0,fontWeight:600,border:"none",padding:"4px 12px"},children:(0,O.NE)(e.status)})]}),a.jsx("div",{style:T.yy.orderCardContent,className:"jsx-c1ca8602d2ef2218",children:(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},className:"jsx-c1ca8602d2ef2218",children:[(0,a.jsxs)("div",{className:"jsx-c1ca8602d2ef2218",children:[a.jsx(H,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"รายการสินค้า"}),(0,a.jsxs)(H,{strong:!0,style:{fontSize:16},children:[e.items_count||0," รายการ"]})]}),(0,a.jsxs)("div",{style:{textAlign:"right"},className:"jsx-c1ca8602d2ef2218",children:[a.jsx(H,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:4},children:"ยอดรวม"}),(0,a.jsxs)(H,{strong:!0,style:{fontSize:20,color:i.primary},children:["฿",e.total_amount?.toLocaleString()]})]})]})}),(0,a.jsxs)("div",{style:T.yy.orderCardFooter,className:"jsx-c1ca8602d2ef2218",children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},className:"jsx-c1ca8602d2ef2218",children:[a.jsx(b.Z,{style:{fontSize:12,color:"#94A3B8"}}),a.jsx(H,{type:"secondary",style:{fontSize:12},children:W()(e.create_date).fromNow()})]}),a.jsx(p.Z,{style:{margin:0,borderRadius:6,background:A.hS.delivery.light,color:A.hS.delivery.primary,border:`1px solid ${A.hS.delivery.border}`,fontSize:11,fontWeight:600},children:"Delivery"})]})]})},e.id)})}):a.jsx(w.Z,{title:"ไม่มีออเดอร์เดลิเวอรี่",description:"เริ่มรับออเดอร์โดยกดปุ่ม “เพิ่มออเดอร์”",action:a.jsx(u.ZP,{type:"primary",icon:a.jsx(g.Z,{}),onClick:J,children:"สร้างออเดอร์ใหม่"})})})}),a.jsx(x.Z,{title:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},className:"jsx-c1ca8602d2ef2218",children:[a.jsx("div",{style:{width:40,height:40,borderRadius:12,background:A.hS.delivery.light,display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-c1ca8602d2ef2218",children:a.jsx(v.Z,{style:{color:A.hS.delivery.primary,fontSize:20}})}),(0,a.jsxs)("div",{className:"jsx-c1ca8602d2ef2218",children:[a.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#1E293B"},className:"jsx-c1ca8602d2ef2218",children:"เปิดออเดอร์เดลิเวอรี่"}),a.jsx("div",{style:{fontSize:13,fontWeight:400,color:"#94A3B8"},className:"jsx-c1ca8602d2ef2218",children:"กรอกข้อมูลเพื่อสร้างออเดอร์ใหม่"})]})]}),open:D,onOk:K,onCancel:()=>q(!1),okText:"ยืนยัน",cancelText:"ยกเลิก",centered:!0,className:"delivery-modal",okButtonProps:{style:{background:A.hS.delivery.primary,borderColor:A.hS.delivery.primary,height:44,borderRadius:12,fontWeight:600,padding:"0 24px"},disabled:!G||!B.trim()},cancelButtonProps:{style:{height:44,borderRadius:12,fontWeight:600,padding:"0 24px"}},children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:20},className:"jsx-c1ca8602d2ef2218",children:[(0,a.jsxs)("div",{className:"jsx-c1ca8602d2ef2218",children:[a.jsx(H,{strong:!0,style:{display:"block",marginBottom:8,fontSize:14,color:"#475569"},children:"เลือกผู้ให้บริการ (Delivery Provider)"}),a.jsx(h.default,{placeholder:"เลือกผู้ให้บริการ",style:{width:"100%"},size:"large",value:G,onChange:V,options:n.map(e=>({label:e.delivery_name,value:e.id})),loading:l})]}),(0,a.jsxs)("div",{className:"jsx-c1ca8602d2ef2218",children:[a.jsx(H,{strong:!0,style:{display:"block",marginBottom:8,fontSize:14,color:"#475569"},children:"รหัสเดลิเวอรี่ / Order Code"}),a.jsx(f.default,{placeholder:"ระบุรหัสออเดอร์ (เช่น 123)",addonBefore:U?.delivery_prefix?`${U.delivery_prefix}-`:void 0,value:B,onChange:e=>L(e.target.value),size:"large",onPressEnter:K,style:{borderRadius:8}})]})]})})]})]})}W().extend(G()),W().locale("th")},36231:(e,r,t)=>{"use strict";t.d(r,{Z:()=>l});var a=t(10326);t(17577);var n=t(56249),i=t(75698),s=t(58184),o=t(52386);function l({title:e="ไม่มีข้อมูล",description:r,action:t,image:l}){return a.jsx(n.Z,{size:"small",variant:"outlined",style:{borderRadius:o.H.cardRadiusLG},bodyStyle:{padding:20},children:a.jsx(i.Z,{image:l,description:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsx(s.default.Text,{strong:!0,children:e}),r?a.jsx(s.default.Text,{type:"secondary",children:r}):null]}),children:t})})}},80440:(e,r,t)=>{"use strict";t.d(r,{s:()=>i});var a=t(17577),n=t(19211);let i=()=>(0,a.useContext)(n.J)},10985:(e,r,t)=>{"use strict";var a;t.d(r,{c:()=>a}),function(e){e.Available="Available",e.Unavailable="Unavailable"}(a||(a={}))},2504:(e,r,t)=>{"use strict";t.d(r,{NE:()=>d,Th:()=>o,Do:()=>c,Yx:()=>p,Zu:()=>u,Oi:()=>l,W9:()=>i,Tf:()=>s});var a=t(10985),n=t(13976);function i(e){let r={total:e.length,available:0,occupied:0,inactive:0};return e.forEach(e=>{e.is_active?e.status===a.c.Available?r.available++:r.occupied++:r.inactive++}),r}function s(e){return[...e].sort((e,r)=>{let t=parseInt(e.table_name.replace(/\D/g,"")),a=parseInt(r.table_name.replace(/\D/g,""));return isNaN(t)||isNaN(a)?e.table_name.localeCompare(r.table_name):t-a})}function o(e){return e.filter(e=>e.is_active)}function l(e){return e.is_active?"WaitingForPayment"===e.active_order_status?"waitingForPayment":e.status===a.c.Available?"available":"occupied":"inactive"}function d(e){return e?({Pending:"กำลังดำเนินการ",Cooking:"กำลังปรุง",Served:"เสิร์ฟแล้ว",WaitingForOrder:"รอรับออเดอร์",WaitingForPayment:"รอชำระเงิน",Paid:"ชำระเงินแล้ว",Completed:"เสร็จสมบูรณ์",Cancelled:"ยกเลิก"})[e]||e:""}function c(e){return e.reduce((e,r)=>(e.total++,r.status===n.i.Pending&&e.pending++,r.status===n.i.Cooking&&e.cooking++,r.status===n.i.Served&&e.served++,e),{total:0,pending:0,cooking:0,served:0})}function p(e){switch(e.status){case n.i.Pending:case n.i.Cooking:return"occupied";case n.i.Served:return"waitingForPayment";case n.i.Paid:return"available";default:return"inactive"}}let u=e=>{switch(e){case n.m.DineIn:case"DineIn":return"/pos/channels/dine-in";case n.m.TakeAway:case"TakeAway":return"/pos/channels/takeaway";case n.m.Delivery:case"Delivery":return"/pos/channels/delivery";default:return"/pos/orders"}}},95963:(e,r,t)=>{"use strict";t.d(r,{EO:()=>b,Gs:()=>l,HL:()=>j,M9:()=>_,Nz:()=>x,OY:()=>s,Rr:()=>v,Wl:()=>i,d$:()=>P,d7:()=>o,iN:()=>p,jN:()=>y,ku:()=>f,mz:()=>d,qO:()=>c,xG:()=>m,yj:()=>g,zP:()=>u,zf:()=>w});var a=t(13976),n=t(10985);let i=e=>{if(e.status===n.c.Available)return`/pos/channels/dine-in/${e.id}`;let r=e.active_order_id||e.active_order?.id,t=e.active_order_status||e.active_order?.status;return r?t===a.i.WaitingForPayment?`/pos/items/payment/${r}`:`/pos/orders/${r}`:`/pos/channels/dine-in/${e.id}`},s=e=>{switch(e){case a.i.Pending:return"orange";case a.i.Cooking:return"blue";case a.i.Served:return"green";case a.i.Paid:return"cyan";case a.i.Cancelled:return"red";case a.i.WaitingForPayment:return"gold";default:return"default"}},o=(e,r)=>{switch(e){case a.i.Pending:return"กำลังดำเนินการ";case a.i.Cooking:return"กำลังปรุง";case a.i.Served:if("TakeAway"===r||"Delivery"===r)return"ทำแล้ว";return"เสิร์ฟแล้ว";case a.i.Paid:return"ชำระเงินแล้ว";case a.i.Completed:return"สำเร็จ";case a.i.Cancelled:return"ยกเลิก";case a.i.WaitingForPayment:return"รอชำระเงิน";default:return e}},l=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},d=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},c=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",p=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",u=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",m=e=>{let r="string"==typeof e?parseFloat(e):e;return`฿${Number(r).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2})}`},y=e=>"DineIn"===e.order_type?e.table?.table_name||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||e.delivery?.delivery_name||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A",x=e=>(e??[]).filter(e=>e.status!==a.i.Cancelled),h=e=>(e??[]).reduce((e,r)=>e+(Number(r.extra_price)||0),0),f=(e,r,t)=>((Number(e)||0)+h(t))*r,v=e=>x(e).reduce((e,r)=>{let t=r.product?.category?.display_name||"ไม่ระบุหมวด";return e[t]=(e[t]||0)+(r.quantity||0),e},{}),g=e=>x(e).reduce((e,r)=>e+Number(r.total_price||0),0),b=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",j=e=>`/pos/orders/${e}`,_=e=>e.status===a.i.WaitingForPayment?e.order_type===a.m.Delivery?`/pos/items/delivery/${e.id}`:`/pos/items/payment/${e.id}`:`/pos/orders/${e.id}`,P=e=>e===a.m.Delivery?"/pos/channels/delivery":e===a.m.TakeAway?"/pos/channels/takeaway":e===a.m.DineIn?"/pos/channels/dine-in":"/pos/channels",w=(e,r,t,n)=>({order_no:n.orderNo||`ORD-${Date.now()}`,order_type:r,sub_total:t.subTotal,discount_amount:t.discountAmount,vat:0,total_amount:t.totalAmount,received_amount:0,change_amount:0,status:a.i.Pending,discount_id:n.discountId||null,payment_method_id:null,table_id:n.tableId||null,delivery_id:n.deliveryId||null,delivery_code:n.deliveryCode||null,items:e.map(e=>{let t=r===a.m.Delivery?Number(e.product.price_delivery??e.product.price):Number(e.product.price),n=(t+(e.details||[]).reduce((e,r)=>e+Number(r.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:t,total_price:n,discount_amount:0,notes:e.notes||"",status:a.i.Cooking,details:e.details||[]}})})},45317:(e,r,t)=>{"use strict";t.d(r,{w:()=>y});var a=t(17577),n=t(26859),i=t(13976),s=t(80440),o=t(54354),l=t(81711),d=t.n(l);let c=new Set([i.i.Paid,i.i.Completed,i.i.Cancelled]),p=[i.i.Pending,i.i.Cooking,i.i.Served,i.i.WaitingForPayment].join(","),u=["orders:create","orders:update","orders:delete","payments:create","payments:update"],m=(e,r)=>e.filter(e=>e.order_type===r&&!c.has(e.status));function y({orderType:e,limit:r=100,page:t=1,statusFilter:i=p,enabled:l=!0,refreshIntervalMs:c=15e3,events:y=u}){let{socket:x}=(0,s.s)(),[h,f]=(0,a.useState)([]),[v,g]=(0,a.useState)(!0),b=(0,a.useCallback)(async(a=!1)=>{if(l){a||g(!0);try{let a=await n.x.getAllSummary(void 0,t,r,i,e),s=m(a.data||[],e);f(e=>d()(e,s)?e:s)}catch{}finally{a||g(!1)}}},[l,r,e,t,i]);return(0,o.D)({socket:x,events:y,onRefresh:()=>b(!0),intervalMs:c,enabled:l,debounceMs:800}),{orders:h,isLoading:v,refresh:b}}},54354:(e,r,t)=>{"use strict";function a(e,r,t,a=e=>e.id,n=()=>!0){}function n({socket:e,events:r=[],onRefresh:t,intervalMs:a,enabled:n=!0,debounceMs:i}){}t.d(r,{D:()=>n,v:()=>a}),t(17577)},14716:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\channels\delivery\page.tsx#default`)}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,8491,8571,8842,108,2514,8963,1399,4658,1587],()=>t(11970));module.exports=a})();