(()=>{var e={};e.id=4290,e.ids=[4290],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},77704:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.Z,__next_app__:()=>u,originalPathname:()=>d,pages:()=>c,routeModule:()=>p,tree:()=>l}),r(89464),r(85429),r(58522),r(86296),r(7629),r(11930),r(12523);var a=r(23191),n=r(88716),i=r(43315),s=r(95231),o={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>s[e]);r.d(t,o);let l=["",{children:["(main)",{children:["pos",{children:["channels",{children:["dine-in",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,89464)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\channels\\dine-in\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,86296)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],c=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\channels\\dine-in\\page.tsx"],d="/(main)/pos/channels/dine-in/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(main)/pos/channels/dine-in/page",pathname:"/pos/channels/dine-in",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},1738:(e,t,r)=>{Promise.resolve().then(r.bind(r,16400))},6236:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(17577);let n={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"};var i=r(74082);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}let o=a.forwardRef((e,t)=>a.createElement(i.Z,s({},e,{ref:t,icon:n})))},40553:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(17577);let n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};var i=r(74082);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}let o=a.forwardRef((e,t)=>a.createElement(i.Z,s({},e,{ref:t,icon:n})))},16400:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var a=r(10326),n=r(17577),i=r(35047),s=r(58184),o=r(4139),l=r(38106),c=r(75698),d=r(71935),u=r(2643),p=r(62938),m=r(40553),h=r(6236),y=r(44976),g=r(20108),b=r(19211),v=r(31499),x=r(93922),f=r(79e3),j=r(15051),P=r(95963),_=r(37938),w=r(2504);let{Title:k,Text:E}=s.default;function T(){let e=(0,i.useRouter)(),{showLoading:t,hideLoading:r}=(0,_.x)(),{tables:s,isLoading:T}=function(){let{socket:e}=(0,n.useContext)(b.J);(0,y.NL)();let{data:t,error:r,isLoading:a,refetch:i}=(0,g.a)({queryKey:["tables"],queryFn:async()=>(await v.$.getAll()).data,staleTime:2e3,refetchOnReconnect:!0});return{tables:t||[],isLoading:a,isError:r,mutate:i}}(),N=(0,n.useMemo)(()=>(0,w.W9)(s),[s]),C=(0,n.useMemo)(()=>(0,w.Th)(s),[s]),S=(0,n.useMemo)(()=>(0,w.Tf)(C),[C]);return(0,a.jsxs)(a.Fragment,{children:[a.jsx(j.c,{}),(0,a.jsxs)("div",{style:x.Np.container,children:[(0,a.jsxs)("div",{style:{...f.y.channelHeader,background:x.hS.dineIn.gradient},className:"dine-in-header-mobile",children:[a.jsx("div",{className:"header-pattern"}),(0,a.jsxs)("div",{style:f.y.channelHeaderContent,className:"dine-in-header-content-mobile",children:[(0,a.jsxs)("div",{className:"back-button-hover dine-in-back-button-mobile",style:f.y.channelBackButton,onClick:()=>e.push("/pos/channels"),children:[a.jsx(u.Z,{}),a.jsx("span",{children:"กลับ"})]}),(0,a.jsxs)("div",{style:f.y.channelTitleSection,className:"dine-in-title-section-mobile",children:[a.jsx(p.Z,{style:f.y.channelHeaderIcon,className:"dine-in-header-icon-mobile"}),(0,a.jsxs)("div",{children:[a.jsx(k,{level:3,style:f.y.channelHeaderTitle,className:"dine-in-header-title-mobile",children:"เลือกโต๊ะ"}),a.jsx(E,{style:f.y.channelHeaderSubtitle,children:"Dine In"})]})]}),(0,a.jsxs)("div",{style:f.y.channelStatsBar,className:"dine-in-stats-bar-mobile",children:[(0,a.jsxs)("div",{style:f.y.statItem,children:[a.jsx("span",{style:{...f.y.statDot,background:x.ax.available.primary}}),(0,a.jsxs)(E,{style:f.y.statText,children:["ว่าง ",N.available]})]}),(0,a.jsxs)("div",{style:f.y.statItem,children:[a.jsx("span",{style:{...f.y.statDot,background:x.ax.occupied.primary}}),(0,a.jsxs)(E,{style:f.y.statText,children:["ไม่ว่าง ",N.occupied]})]})]})]})]}),a.jsx("div",{style:{maxWidth:1400,margin:"0 auto",padding:"0 16px 24px"},className:"dine-in-content-mobile",children:s.length>0?a.jsx(o.Z,{gutter:[20,20],children:S.map((t,r)=>{let n=(0,w.Oi)(t),i=x.ax[n],s="Available"===t.status,o=!t.is_active;return a.jsx(l.Z,{xs:12,sm:8,md:6,lg:4,children:(0,a.jsxs)("div",{className:`dine-in-table-card dine-in-table-card-mobile table-card-animate table-card-delay-${r%6+1}`,style:{...f.y.channelPageCard,background:i.light,border:`2px solid ${i.border}`,opacity:o?.6:1},onClick:()=>{if(!o){let r=(0,P.Wl)(t);e.push(r)}},children:[a.jsx("div",{style:{...f.y.channelPageCardGradientOverlay,background:i.gradient}}),(0,a.jsxs)("div",{style:f.y.channelPageCardInner,children:[o?a.jsx(m.Z,{className:"dine-in-table-icon-mobile",style:{...f.y.channelPageCardIcon,color:i.primary}}):s?a.jsx(p.Z,{className:"dine-in-table-icon-mobile",style:{...f.y.channelPageCardIcon,color:i.primary,opacity:.6}}):a.jsx(h.Z,{className:"pulse-soft dine-in-table-icon-mobile",style:{...f.y.channelPageCardIcon,color:i.primary}}),a.jsx("div",{style:f.y.channelPageCardMainText,className:"dine-in-table-name-mobile",children:t.table_name}),(0,a.jsxs)("div",{style:{marginTop:10,display:"flex",flexDirection:"column",gap:4,alignItems:"center"},children:[!o&&a.jsx("div",{style:{fontSize:12,fontWeight:700,color:s?"#52c41a":"#ff4d4f",textTransform:"uppercase",letterSpacing:"0.5px"},children:s?"ว่าง":"ไม่ว่าง"}),a.jsx("div",{style:{...f.y.channelPageCardStatusBadge,background:o?"#bfbfbf":s?"#f0f0f0":i.primary,color:o?"#fff":s?"#8c8c8c":"#fff",border:s?"1px solid #d9d9d9":"none",fontSize:11,padding:"2px 10px",height:"auto",lineHeight:"1.4"},children:o?"ปิดใช้งาน":s?"รอรับออเดอร์":t.active_order_status?(0,w.NE)(t.active_order_status):"ไม่ว่าง"})]})]})]})},t.id)})}):a.jsx("div",{style:{background:"#fff",borderRadius:24,padding:"100px 24px",textAlign:"center",boxShadow:"0 4px 24px rgba(0,0,0,0.04)",marginTop:20},children:a.jsx(c.Z,{image:c.Z.PRESENTED_IMAGE_SIMPLE,imageStyle:{height:120},description:(0,a.jsxs)("div",{style:{marginTop:20},children:[a.jsx(k,{level:4,style:{marginBottom:8},children:"ยังไม่มีข้อมูลโต๊ะ"}),a.jsx(E,{type:"secondary",style:{fontSize:16},children:"กรุณาเพิ่มข้อมูลโต๊ะก่อนเริ่มการขาย"})]}),children:a.jsx(d.ZP,{type:"primary",size:"large",icon:a.jsx(p.Z,{}),style:{height:50,padding:"0 40px",borderRadius:25,fontSize:16,marginTop:20,background:x.hS.dineIn.primary,border:"none"},onClick:()=>e.push("/pos/tables"),children:"ไปหน้าจัดการโต๊ะ"})})})})]})]})}},31499:(e,t,r)=>{"use strict";r.d(t,{$:()=>s});var a=r(12529);let n=r(40820).q.POS.TABLES,i=(e,t="application/json")=>{let r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},s={getAll:async(e,t)=>{let r=(0,a.b)("GET",n),s=new URLSearchParams(t||"");s.has("page")||s.set("page","1"),s.has("limit")||s.set("limit","200");let o=s.toString();o&&(r+=`?${o}`);let l=i(e,""),c=await fetch(r,{cache:"no-store",headers:l,credentials:"include"});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return c.json()},getById:async(e,t)=>{let r=(0,a.b)("GET",`${n}/${e}`),s=i(t,""),o=await fetch(r,{cache:"no-store",headers:s,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return o.json()},getByName:async(e,t)=>{let r=(0,a.b)("GET",`${n}/getByName/${e}`),s=i(t,""),o=await fetch(r,{cache:"no-store",headers:s,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return o.json()},create:async(e,t,r)=>{let s=(0,a.b)("POST",`${n}`),o=i(t);r&&(o["X-CSRF-Token"]=r);let l=await fetch(s,{method:"POST",headers:o,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to create table")}return l.json()},update:async(e,t,r,s)=>{let o=(0,a.b)("PUT",`${n}/${e}`),l=i(r);s&&(l["X-CSRF-Token"]=s);let c=await fetch(o,{method:"PUT",headers:l,credentials:"include",body:JSON.stringify(t)});if(!c.ok){let e=await c.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to update table")}return c.json()},delete:async(e,t,r)=>{let s=(0,a.b)("DELETE",`${n}/${e}`),o=i(t,"");r&&(o["X-CSRF-Token"]=r);let l=await fetch(s,{method:"DELETE",headers:o,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to delete table")}}}},10985:(e,t,r)=>{"use strict";var a;r.d(t,{c:()=>a}),function(e){e.Available="Available",e.Unavailable="Unavailable"}(a||(a={}))},2504:(e,t,r)=>{"use strict";r.d(t,{NE:()=>c,Th:()=>o,Do:()=>d,Yx:()=>u,Zu:()=>p,Oi:()=>l,W9:()=>i,Tf:()=>s});var a=r(10985),n=r(13976);function i(e){let t={total:e.length,available:0,occupied:0,inactive:0};return e.forEach(e=>{e.is_active?e.status===a.c.Available?t.available++:t.occupied++:t.inactive++}),t}function s(e){return[...e].sort((e,t)=>{let r=parseInt(e.table_name.replace(/\D/g,"")),a=parseInt(t.table_name.replace(/\D/g,""));return isNaN(r)||isNaN(a)?e.table_name.localeCompare(t.table_name):r-a})}function o(e){return e.filter(e=>e.is_active)}function l(e){return e.is_active?"WaitingForPayment"===e.active_order_status?"waitingForPayment":e.status===a.c.Available?"available":"occupied":"inactive"}function c(e){return e?({Pending:"กำลังดำเนินการ",Cooking:"กำลังปรุง",Served:"เสิร์ฟแล้ว",WaitingForOrder:"รอรับออเดอร์",WaitingForPayment:"รอชำระเงิน",Paid:"ชำระเงินแล้ว",Completed:"เสร็จสมบูรณ์",Cancelled:"ยกเลิก"})[e]||e:""}function d(e){return e.reduce((e,t)=>(e.total++,t.status===n.i.Pending&&e.pending++,t.status===n.i.Cooking&&e.cooking++,t.status===n.i.Served&&e.served++,e),{total:0,pending:0,cooking:0,served:0})}function u(e){switch(e.status){case n.i.Pending:case n.i.Cooking:return"occupied";case n.i.Served:return"waitingForPayment";case n.i.Paid:return"available";default:return"inactive"}}let p=e=>{switch(e){case n.m.DineIn:case"DineIn":return"/pos/channels/dine-in";case n.m.TakeAway:case"TakeAway":return"/pos/channels/takeaway";case n.m.Delivery:case"Delivery":return"/pos/channels/delivery";default:return"/pos/orders"}}},95963:(e,t,r)=>{"use strict";r.d(t,{EO:()=>f,Gs:()=>l,HL:()=>j,M9:()=>P,Nz:()=>y,OY:()=>s,Rr:()=>v,Wl:()=>i,d$:()=>_,d7:()=>o,iN:()=>u,jN:()=>h,ku:()=>b,mz:()=>c,qO:()=>d,xG:()=>m,yj:()=>x,zP:()=>p,zf:()=>w});var a=r(13976),n=r(10985);let i=e=>{if(e.status===n.c.Available)return`/pos/channels/dine-in/${e.id}`;let t=e.active_order_id||e.active_order?.id,r=e.active_order_status||e.active_order?.status;return t?r===a.i.WaitingForPayment?`/pos/items/payment/${t}`:`/pos/orders/${t}`:`/pos/channels/dine-in/${e.id}`},s=e=>{switch(e){case a.i.Pending:return"orange";case a.i.Cooking:return"blue";case a.i.Served:return"green";case a.i.Paid:return"cyan";case a.i.Cancelled:return"red";case a.i.WaitingForPayment:return"gold";default:return"default"}},o=(e,t)=>{switch(e){case a.i.Pending:return"กำลังดำเนินการ";case a.i.Cooking:return"กำลังปรุง";case a.i.Served:if("TakeAway"===t||"Delivery"===t)return"ทำแล้ว";return"เสิร์ฟแล้ว";case a.i.Paid:return"ชำระเงินแล้ว";case a.i.Completed:return"สำเร็จ";case a.i.Cancelled:return"ยกเลิก";case a.i.WaitingForPayment:return"รอชำระเงิน";default:return e}},l=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},c=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},d=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",u=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",p=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",m=e=>{let t="string"==typeof e?parseFloat(e):e;return`฿${Number(t).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2})}`},h=e=>"DineIn"===e.order_type?e.table?.table_name||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||e.delivery?.delivery_name||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A",y=e=>(e??[]).filter(e=>e.status!==a.i.Cancelled),g=e=>(e??[]).reduce((e,t)=>e+(Number(t.extra_price)||0),0),b=(e,t,r)=>((Number(e)||0)+g(r))*t,v=e=>y(e).reduce((e,t)=>{let r=t.product?.category?.display_name||"ไม่ระบุหมวด";return e[r]=(e[r]||0)+(t.quantity||0),e},{}),x=e=>y(e).reduce((e,t)=>e+Number(t.total_price||0),0),f=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",j=e=>`/pos/orders/${e}`,P=e=>e.status===a.i.WaitingForPayment?e.order_type===a.m.Delivery?`/pos/items/delivery/${e.id}`:`/pos/items/payment/${e.id}`:`/pos/orders/${e.id}`,_=e=>e===a.m.Delivery?"/pos/channels/delivery":e===a.m.TakeAway?"/pos/channels/takeaway":e===a.m.DineIn?"/pos/channels/dine-in":"/pos/channels",w=(e,t,r,n)=>({order_no:n.orderNo||`ORD-${Date.now()}`,order_type:t,sub_total:r.subTotal,discount_amount:r.discountAmount,vat:0,total_amount:r.totalAmount,received_amount:0,change_amount:0,status:a.i.Pending,discount_id:n.discountId||null,payment_method_id:null,table_id:n.tableId||null,delivery_id:n.deliveryId||null,delivery_code:n.deliveryCode||null,items:e.map(e=>{let t=Number(e.product.price),r=(t+(e.details||[]).reduce((e,t)=>e+Number(t.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:t,total_price:r,discount_amount:0,notes:e.notes||"",status:a.i.Cooking,details:e.details||[]}})})},89464:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\channels\dine-in\page.tsx#default`)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5898,8571,6927,108,5717,6857,4300,2118],()=>r(77704));module.exports=a})();