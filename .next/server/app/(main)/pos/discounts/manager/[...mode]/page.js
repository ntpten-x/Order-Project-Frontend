(()=>{var e={};e.id=6012,e.ids=[6012],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},28438:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.Z,__next_app__:()=>u,originalPathname:()=>c,pages:()=>l,routeModule:()=>p,tree:()=>d}),r(62430),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var s=r(23191),i=r(88716),o=r(43315),n=r(95231),a={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>n[e]);r.d(t,a);let d=["",{children:["(main)",{children:["pos",{children:["discounts",{children:["manager",{children:["[...mode]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,62430)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\discounts\\manager\\[...mode]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],l=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\discounts\\manager\\[...mode]\\page.tsx"],c="/(main)/pos/discounts/manager/[...mode]/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/pos/discounts/manager/[...mode]/page",pathname:"/pos/discounts/manager/[...mode]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},86089:(e,t,r)=>{Promise.resolve().then(r.bind(r,13559))},2643:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};var o=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let a=s.forwardRef((e,t)=>s.createElement(o.Z,n({},e,{ref:t,icon:i})))},98064:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855.7 210.8l-42.4-42.4a8.03 8.03 0 00-11.3 0L168.3 801.9a8.03 8.03 0 000 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144zm0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zm416 344c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144zm0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z"}}]},name:"percentage",theme:"outlined"};var o=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let a=s.forwardRef((e,t)=>s.createElement(o.Z,n({},e,{ref:t,icon:i})))},13559:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var s=r(10326),i=r(17577),o=r(49909),n=r(43359),a=r(46752),d=r(75958),l=r(71935),c=r(92121),u=r(73664),p=r(31916),m=r(63459),g=r(35047),h=r(82451),x=r(26963),y=r(76892),f=r(52647),b=r(58184),j=r(99251),v=r(98064),P=r(31839);let{pageStyles:F,ManagePageStyles:w}=(0,P.dg)({focusColor:"#F59E0B",focusShadow:"rgba(245, 158, 11, 0.15)",switchGradient:"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)",extraCss:`
        .manage-page .ant-radio-button-wrapper {
            border-radius: 12px !important;
            border: 2px solid #f0f0f0 !important;
            margin-right: 8px;
            padding: 8px 16px;
            height: auto !important;
        }

        .manage-page .ant-radio-button-wrapper:first-child {
            border-radius: 12px !important;
        }

        .manage-page .ant-radio-button-wrapper:last-child {
            border-radius: 12px !important;
        }

        .manage-page .ant-radio-button-wrapper-checked {
            border-color: #F59E0B !important;
            background: linear-gradient(135deg, #FFF7ED 0%, #FFEDD5 100%) !important;
            color: #F59E0B !important;
        }

        .manage-page .ant-radio-button-wrapper-checked::before {
            display: none !important;
        }
    `}),E=({displayName:e,discountType:t,discountAmount:r})=>{let i=t===h.L.Fixed;return(0,s.jsxs)("div",{children:[s.jsx(b.default.Text,{type:"secondary",style:{display:"block",marginBottom:12,fontSize:13,textAlign:"center"},children:"ตัวอย่างคูปอง (Preview)"}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:20,overflow:"hidden",boxShadow:"0 8px 30px rgba(0,0,0,0.06)",border:"1px solid #F1F5F9",maxWidth:300,margin:"0 auto",position:"relative"},children:[(0,s.jsxs)("div",{style:{height:80,background:i?"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)":"linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[s.jsx("div",{style:{width:48,height:48,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid rgba(255,255,255,0.3)"},children:i?s.jsx(j.Z,{style:{fontSize:24,color:"white"}}):s.jsx(v.Z,{style:{fontSize:24,color:"white"}})}),s.jsx("div",{style:{position:"absolute",bottom:-10,left:-10,width:20,height:20,borderRadius:"50%",background:"#F8FAFC"}}),s.jsx("div",{style:{position:"absolute",bottom:-10,right:-10,width:20,height:20,borderRadius:"50%",background:"#F8FAFC"}})]}),(0,s.jsxs)("div",{style:{padding:"24px 20px",textAlign:"center"},children:[(0,s.jsxs)("div",{style:{fontSize:32,fontWeight:800,color:i?"#2563EB":"#7C3AED",lineHeight:1,marginBottom:8},children:[i?"฿":"",(r||0).toLocaleString(),i?"":"%"]}),s.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#94A3B8",textTransform:"uppercase",letterSpacing:"1px",marginBottom:16},children:"DISCOUNT"}),s.jsx("div",{style:{height:1,background:"#E2E8F0",marginBottom:16,width:"100%"}}),s.jsx(b.default.Text,{strong:!0,style:{fontSize:16,color:"#1E293B",display:"block",marginBottom:4},children:e||"ชื่อส่วนลด"}),s.jsx(b.default.Text,{type:"secondary",style:{fontSize:12},children:"พร้อมใช้งานทันที"})]})]})]})},_=({isEdit:e,loading:t,onCancel:r})=>s.jsx(P.uM,{pageStyles:F,isEdit:e,loading:t,onCancel:r});r(33357);var k=r(45207),C=r(26902);let{TextArea:Z}=o.default;function B({params:e}){let t=(0,g.useRouter)(),[r]=n.Z.useForm(),[b,j]=(0,i.useState)(!1),[v,P]=(0,i.useState)(!1),[B,q]=(0,i.useState)(""),[L,S]=(0,i.useState)(h.L.Fixed),[A,O]=(0,i.useState)(""),T=e.mode[0],z=e.mode[1]||null,D="edit"===T&&!!z,{isAuthorized:R,isChecking:I}=(0,k.e)({requiredRole:"Admin"});(0,i.useCallback)(async()=>{j(!0);try{let e=await fetch(`/api/pos/discounts/getById/${z}`);if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลส่วนลดได้");let t=await e.json();r.setFieldsValue({discount_name:t.discount_name,display_name:t.display_name,description:t.description,discount_type:t.discount_type,discount_amount:t.discount_amount,is_active:t.is_active}),q(t.display_name||t.discount_name||""),S(t.discount_type||h.L.Fixed)}catch(e){console.error(e),a.ZP.error("ไม่สามารถดึงข้อมูลส่วนลดได้"),t.push("/pos/discounts")}finally{j(!1)}},[z,r,t]);let N=async e=>{P(!0);try{if(D){let t=await fetch(`/api/pos/discounts/update/${z}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":A},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถอัปเดตส่วนลดได้")}a.ZP.success("อัปเดตส่วนลดสำเร็จ")}else{let t=await fetch("/api/pos/discounts/create",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":A},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.error||e.message||"ไม่สามารถสร้างส่วนลดได้")}a.ZP.success("สร้างส่วนลดสำเร็จ")}t.push("/pos/discounts")}catch(e){console.error(e),a.ZP.error(e.message||(D?"ไม่สามารถอัปเดตส่วนลดได้":"ไม่สามารถสร้างส่วนลดได้"))}finally{P(!1)}},H=()=>t.push("/pos/discounts");return I?s.jsx(C.H,{message:"กำลังตรวจสอบสิทธิ์..."}):R?(0,s.jsxs)("div",{className:"manage-page",style:F.container,children:[s.jsx(w,{}),s.jsx(f.Z,{title:D?"แก้ไขส่วนลด":"เพิ่มส่วนลด",subtitle:D?"แก้ไขข้อมูลส่วนลด":"สร้างส่วนลดใหม่",onBack:H,actions:D?s.jsx(l.ZP,{danger:!0,onClick:()=>{z&&d.Z.confirm({title:"ยืนยันการลบส่วนลด",content:`คุณต้องการลบส่วนลด "${B}" หรือไม่?`,okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,onOk:async()=>{try{if(!(await fetch(`/api/pos/discounts/delete/${z}`,{method:"DELETE",headers:{"X-CSRF-Token":A}})).ok)throw Error("ไม่สามารถลบส่วนลดได้");a.ZP.success("ลบส่วนลดสำเร็จ"),t.push("/pos/discounts")}catch(e){console.error(e),a.ZP.error("ไม่สามารถลบส่วนลดได้")}}})},children:"ลบ"}):null}),s.jsx(x.Z,{maxWidth:1e3,children:s.jsx(y.Z,{style:{background:"transparent",border:"none"},children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"md:col-span-2",style:{...F.formCard,margin:0},children:b?s.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"60px 0"},children:s.jsx(c.Z,{size:"large"})}):(0,s.jsxs)(n.Z,{form:r,layout:"vertical",onFinish:N,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0,discount_type:h.L.Fixed,discount_amount:0},onValuesChange:e=>{void 0!==e.display_name&&q(e.display_name),void 0!==e.discount_type&&S(e.discount_type)},children:[s.jsx(n.Z.Item,{name:"discount_name",label:"รหัสส่วนลด (ในระบบ) *",rules:[{required:!0,message:"กรุณากรอกรหัสส่วนลด"},{max:50,message:"ความยาวต้องไม่เกิน 50 ตัวอักษร"}],children:s.jsx(o.default,{size:"large",placeholder:"เช่น DISCOUNT_10, NEW_YEAR",maxLength:50})}),s.jsx(n.Z.Item,{name:"display_name",label:"ชื่อที่แสดงให้ลูกค้า *",rules:[{required:!0,message:"กรุณากรอกชื่อที่แสดง"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"}],children:s.jsx(o.default,{size:"large",placeholder:"เช่น ส่วนลดปีใหม่, ลด 10%",maxLength:100})}),s.jsx(n.Z.Item,{name:"description",label:"รายละเอียด/เงื่อนไข",rules:[{max:500,message:"ความยาวต้องไม่เกิน 500 ตัวอักษร"}],children:s.jsx(Z,{rows:3,placeholder:"รายละเอียดเงื่อนไขของส่วนลด (ถ้ามี)",maxLength:500,style:{borderRadius:12}})}),(0,s.jsxs)("div",{style:{background:"#F8FAFC",padding:16,borderRadius:16,marginBottom:24,border:"1px solid #E2E8F0"},children:[s.jsx(n.Z.Item,{name:"discount_type",label:"ประเภทส่วนลด *",rules:[{required:!0,message:"กรุณาเลือกประเภทส่วนลด"}],style:{marginBottom:16},children:(0,s.jsxs)(u.ZP.Group,{buttonStyle:"solid",style:{width:"100%",display:"flex",gap:8},children:[s.jsx(u.ZP.Button,{value:h.L.Fixed,style:{flex:1,textAlign:"center",borderRadius:10,height:40,lineHeight:"38px",border:L===h.L.Fixed?"none":"1px solid #E2E8F0",background:L===h.L.Fixed?"#3B82F6":"white",fontWeight:600},children:"\uD83D\uDCB5 ลดเป็นบาท (THB)"}),s.jsx(u.ZP.Button,{value:h.L.Percentage,style:{flex:1,textAlign:"center",borderRadius:10,height:40,lineHeight:"38px",border:L===h.L.Percentage?"none":"1px solid #E2E8F0",background:L===h.L.Percentage?"#8B5CF6":"white",fontWeight:600},children:"\uD83D\uDCCA ลดเปอร์เซ็นต์ (%)"})]})}),s.jsx(n.Z.Item,{name:"discount_amount",label:L===h.L.Fixed?"จำนวนเงินส่วนลด (บาท) *":"เปอร์เซ็นต์ส่วนลด (%) *",rules:[{required:!0,message:"กรุณากรอกมูลค่าส่วนลด"},{validator:async(e,t)=>{if(t<0)throw Error("มูลค่าต้องไม่ติดลบ");if(L===h.L.Percentage&&t>100)throw Error("เปอร์เซ็นต์ต้องไม่เกิน 100%")}}],style:{marginBottom:0},children:s.jsx(p.Z,{size:"large",min:0,max:L===h.L.Percentage?100:void 0,placeholder:L===h.L.Fixed?"เช่น 50":"เช่น 10",style:{width:"100%",height:45,borderRadius:12,fontSize:16},controls:!1,precision:L===h.L.Percentage?2:0,parser:e=>e?Number(e.replace(/[^0-9.]/g,"")):0,formatter:e=>`${e}`.replace(/[^0-9.]/g,""),onKeyDown:e=>{if(!(["Backspace","Tab","Enter","Escape","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(e.key)||(e.ctrlKey||e.metaKey)&&["a","c","v","x"].includes(e.key.toLowerCase()))){if("."===e.key&&L===h.L.Percentage){String(r.getFieldValue("discount_amount")||"").includes(".")&&e.preventDefault();return}/^[0-9]$/.test(e.key)||e.preventDefault()}},suffix:L===h.L.Fixed?s.jsx("span",{style:{color:"#94A3B8"},children:"THB"}):s.jsx("span",{style:{color:"#94A3B8"},children:"%"})})})]}),s.jsx(n.Z.Item,{name:"is_active",label:"สถานะการใช้งาน",valuePropName:"checked",children:s.jsx(m.Z,{checkedChildren:"เปิดใช้งาน",unCheckedChildren:"ปิดใช้งาน"})}),s.jsx(_,{isEdit:D,loading:v,onCancel:H})]})}),s.jsx("div",{className:"hidden md:block",style:{position:"sticky",top:24},children:s.jsx(n.Z.Item,{noStyle:!0,dependencies:["display_name","discount_type","discount_amount"],children:({getFieldValue:e})=>s.jsx(E,{displayName:e("display_name"),discountType:e("discount_type"),discountAmount:e("discount_amount")})})})]})})})]}):s.jsx(C.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},82451:(e,t,r)=>{"use strict";var s;r.d(t,{L:()=>s}),function(e){e.Fixed="Fixed",e.Percentage="Percentage"}(s||(s={}))},62430:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\discounts\manager\[...mode]\page.tsx#default`)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,8491,8571,8842,8963,1399,4658,5345],()=>r(28438));module.exports=s})();