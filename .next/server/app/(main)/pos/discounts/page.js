(()=>{var e={};e.id=2519,e.ids=[2519],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},76651:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.Z,__next_app__:()=>p,originalPathname:()=>d,pages:()=>c,routeModule:()=>u,tree:()=>l}),r(743),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var s=r(23191),i=r(88716),n=r(43315),o=r(95231),a={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>o[e]);r.d(t,a);let l=["",{children:["(main)",{children:["pos",{children:["discounts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,743)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\discounts\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],c=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\discounts\\page.tsx"],d="/(main)/pos/discounts/page",p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/pos/discounts/page",pathname:"/pos/discounts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},48046:(e,t,r)=>{Promise.resolve().then(r.bind(r,83609))},2643:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};var n=r(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let a=s.forwardRef((e,t)=>s.createElement(n.Z,o({},e,{ref:t,icon:i})))},98064:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855.7 210.8l-42.4-42.4a8.03 8.03 0 00-11.3 0L168.3 801.9a8.03 8.03 0 000 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144zm0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zm416 344c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144zm0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z"}}]},name:"percentage",theme:"outlined"};var n=r(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let a=s.forwardRef((e,t)=>s.createElement(n.Z,o({},e,{ref:t,icon:i})))},40553:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};var n=r(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let a=s.forwardRef((e,t)=>s.createElement(n.Z,o({},e,{ref:t,icon:i})))},83609:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>U});var s=r(10326),i=r(17577),n=r.n(i),o=r(66874),a=r(56249),l=r(61357),c=r(71935),d=r(75958),p=r(46752),u=r(64635),x=r(49909);let h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};var g=r(74082);function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let f=i.forwardRef((e,t)=>i.createElement(g.Z,y({},e,{ref:t,icon:h})));var m=r(99251),j=r(98064),v=r(56811),b=r(40553),F=r(46024),P=r(63191),E=r(24395),w=r(80490),Z=r(72380),k=r(82451),z=r(35047),S=r(37938),C=r(59746),_=r(80440),O=r(33357),B=r(7670),R=r(54354),q=r(83179),I=r(44528);let A={...(0,I.yf)("linear-gradient(135deg, #F59E0B 0%, #D97706 100%)"),discountCard:I.YO,discountCardInner:I.lv},H=(0,I.IU)(".discount-page",".discount-card");var L=r(26902),D=r(26963),W=r(52647),T=r(76892),M=r(18978),G=r(36231);let{Text:V,Title:$}=o.default,J=({total:e,fixed:t,percent:r,active:i,inactive:n})=>(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[(0,s.jsxs)("div",{style:{background:"white",padding:"12px 14px",borderRadius:16,boxShadow:"0 2px 10px rgba(0,0,0,0.02)",border:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:10},children:[s.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#FFF7ED",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s.jsx(f,{style:{fontSize:20,color:"#F59E0B"}})}),(0,s.jsxs)("div",{style:{minWidth:0},children:[s.jsx(V,{style:{color:"#64748B",display:"block",fontSize:11},children:"ทั้งหมด"}),s.jsx($,{level:4,style:{margin:0,color:"#1E293B",fontWeight:700,fontSize:18},children:e})]})]}),(0,s.jsxs)("div",{style:{background:"white",padding:"12px 14px",borderRadius:16,boxShadow:"0 2px 10px rgba(0,0,0,0.02)",border:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:10},children:[s.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#F0F9FF",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s.jsx(m.Z,{style:{fontSize:20,color:"#0EA5E9"}})}),(0,s.jsxs)("div",{style:{minWidth:0},children:[s.jsx(V,{style:{color:"#64748B",display:"block",fontSize:11},children:"แบบบาท"}),s.jsx($,{level:4,style:{margin:0,color:"#1E293B",fontWeight:700,fontSize:18},children:t})]})]}),(0,s.jsxs)("div",{style:{background:"white",padding:"12px 14px",borderRadius:16,boxShadow:"0 2px 10px rgba(0,0,0,0.02)",border:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:10},children:[s.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#F5F3FF",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s.jsx(j.Z,{style:{fontSize:20,color:"#8B5CF6"}})}),(0,s.jsxs)("div",{style:{minWidth:0},children:[s.jsx(V,{style:{color:"#64748B",display:"block",fontSize:11},children:"แบบ %"}),s.jsx($,{level:4,style:{margin:0,color:"#1E293B",fontWeight:700,fontSize:18},children:r})]})]}),(0,s.jsxs)("div",{style:{background:"white",padding:"12px 14px",borderRadius:16,boxShadow:"0 2px 10px rgba(0,0,0,0.02)",border:"1px solid #F1F5F9",display:"flex",alignItems:"center",gap:10},children:[s.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#ECFDF5",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s.jsx(v.Z,{style:{fontSize:20,color:"#10B981"}})}),(0,s.jsxs)("div",{style:{minWidth:0},children:[s.jsx(V,{style:{color:"#64748B",display:"block",fontSize:11},children:"ใช้งาน"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"baseline",gap:4},children:[s.jsx($,{level:4,style:{margin:0,color:"#1E293B",fontWeight:700,fontSize:18},children:i}),n>0&&(0,s.jsxs)(V,{type:"secondary",style:{fontSize:11},children:["(ปิด ",n,")"]})]})]})]})]}),N=n().memo(({discount:e,onEdit:t,onDelete:r})=>{let i=e.discount_type===k.L.Fixed;return(0,s.jsxs)(a.Z,{hoverable:!0,onClick:()=>t(e),style:{borderRadius:20,border:"none",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",transition:"all 0.2s",overflow:"hidden",background:"white",opacity:e.is_active?1:.7},styles:{body:{padding:16}},children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[s.jsx("div",{style:{width:56,height:56,borderRadius:16,background:i?"linear-gradient(135deg, #E0F2FE 0%, #BAE6FD 100%)":"linear-gradient(135deg, #F3E8FF 0%, #D8B4FE 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:i?"0 4px 12px rgba(14, 165, 233, 0.2)":"0 4px 12px rgba(139, 92, 246, 0.2)"},children:i?s.jsx(m.Z,{style:{fontSize:24,color:"#0369A1"}}):s.jsx(j.Z,{style:{fontSize:24,color:"#7E22CE"}})}),(0,s.jsxs)("div",{style:{padding:"4px 10px",borderRadius:20,background:e.is_active?"#ECFDF5":"#F1F5F9",color:e.is_active?"#059669":"#64748B",fontSize:12,fontWeight:600,display:"flex",alignItems:"center",gap:4},children:[e.is_active?s.jsx(v.Z,{}):s.jsx(b.Z,{}),e.is_active?"Active":"Inactive"]})]}),(0,s.jsxs)("div",{style:{marginBottom:16},children:[s.jsx($,{level:5,style:{margin:0,marginBottom:4,color:"#1E293B"},ellipsis:!0,children:e.display_name}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[s.jsx(V,{type:"secondary",style:{fontSize:13},children:"Code:"}),s.jsx(l.Z,{style:{margin:0,borderRadius:6,background:"#F8FAFC",border:"1px solid #E2E8F0",color:"#475569"},children:e.discount_name})]})]}),(0,s.jsxs)("div",{style:{background:"#F8FAFC",borderRadius:12,padding:"10px 12px",marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx(V,{style:{fontSize:12,color:"#64748B"},children:"มูลค่าส่วนลด"}),s.jsx(V,{style:{fontSize:16,fontWeight:700,color:"#F59E0B"},children:i?`฿${e.discount_amount.toLocaleString()}`:`${e.discount_amount}% OFF`})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:8,marginTop:"auto"},children:[s.jsx(c.ZP,{type:"text",icon:s.jsx(F.Z,{}),block:!0,onClick:r=>{r.stopPropagation(),t(e)},style:{borderRadius:10,background:"#FFF7ED",color:"#F59E0B",fontWeight:600},children:"แก้ไข"}),s.jsx(c.ZP,{type:"text",icon:s.jsx(P.Z,{}),onClick:t=>{t.stopPropagation(),r(e)},style:{borderRadius:10,background:"#FEF2F2",color:"#EF4444"}})]})]})});function U(){return s.jsx(X,{})}function X(){let e=(0,z.useRouter)(),[t,r]=(0,i.useState)([]),[n,o]=(0,i.useState)([]),[a,l]=(0,i.useState)(""),{execute:h}=(0,C.J)(),{showLoading:g}=(0,S.x)(),{socket:y}=(0,_.s)(),{isAuthorized:f,isChecking:m}=(0,B.e)({allowedRoles:["Admin","Manager"]}),v=(0,i.useCallback)(async()=>{h(async()=>{let e=await fetch("/api/pos/discounts");if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลส่วนลดได้");let t=await e.json();r(t),o(t)},"กำลังโหลดข้อมูลส่วนลด...")},[h]);(0,R.v)(y,{create:q.b.discounts.create,update:q.b.discounts.update,delete:q.b.discounts.delete},r);let b=()=>{g("กำลังเปิดหน้าจัดการส่วนลด..."),e.push("/pos/discounts/manager/add")},F=t=>{g("กำลังเปิดหน้าแก้ไขส่วนลด..."),e.push(`/pos/discounts/manager/edit/${t.id}`)},I=e=>{d.Z.confirm({title:"ยืนยันการลบส่วนลด",content:`คุณต้องการลบส่วนลด "${e.display_name||e.discount_name}" หรือไม่?`,okText:"ลบรายการ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:s.jsx(P.Z,{style:{color:"#EF4444"}}),styles:{body:{borderRadius:16}},onOk:async()=>{await h(async()=>{let t=await (0,O.P)();if(!(await fetch(`/api/pos/discounts/delete/${e.id}`,{method:"DELETE",headers:{"X-CSRF-Token":t}})).ok)throw Error("ไม่สามารถลบส่วนลดได้");p.ZP.success("ลบส่วนลดสำเร็จ")},"กำลังลบส่วนลด...")}})};if(m)return s.jsx(L.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."});if(!f)return s.jsx(L.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"});let V=t.filter(e=>e.is_active),$=t.filter(e=>!e.is_active),U=t.filter(e=>e.discount_type===k.L.Fixed),X=t.filter(e=>e.discount_type===k.L.Percentage);return(0,s.jsxs)("div",{className:"discount-page px-4 md:px-6",style:{...A.container,paddingTop:16,paddingBottom:24,background:"#F8FAFC",minHeight:"100vh"},children:[s.jsx("style",{children:H}),s.jsx(W.Z,{title:"ส่วนลด",subtitle:`${t.length} รายการ`,icon:s.jsx(j.Z,{}),actions:(0,s.jsxs)(u.Z,{size:8,wrap:!0,children:[s.jsx(x.default,{prefix:s.jsx(E.Z,{style:{color:"#94A3B8"}}),allowClear:!0,placeholder:"ค้นหา...",value:a,onChange:e=>l(e.target.value),style:{minWidth:200}}),s.jsx(c.ZP,{icon:s.jsx(w.Z,{}),onClick:v}),s.jsx(c.ZP,{type:"primary",icon:s.jsx(Z.Z,{}),onClick:b,children:"เพิ่มส่วนลด"})]})}),s.jsx(D.Z,{children:(0,s.jsxs)(M.Z,{children:[s.jsx(J,{total:t.length,fixed:U.length,percent:X.length,active:V.length,inactive:$.length}),s.jsx(T.Z,{title:"รายการส่วนลด",children:s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:16},children:n.length>0?n.map(e=>s.jsx(N,{discount:e,onEdit:F,onDelete:I},e.id)):s.jsx("div",{style:{gridColumn:"1 / -1"},children:s.jsx(G.Z,{title:a.trim()?"ไม่พบส่วนลดที่ค้นหา":"ยังไม่มีรายการส่วนลด",description:a.trim()?"ลองเปลี่ยนคำค้นหาใหม่":"เพิ่มส่วนลดแรกเพื่อเริ่มใช้งาน",action:a.trim()?null:s.jsx(c.ZP,{type:"primary",icon:s.jsx(Z.Z,{}),onClick:b,children:"เพิ่มส่วนลด"})})})})})]})})]})}N.displayName="DiscountCard"},18978:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(10326);r(17577);var i=r(21020),n=r(52386);function o({children:e,gap:t=n.H.sectionGap,style:r}){return s.jsx(i.Z,{vertical:!0,gap:t,style:r,children:e})}},36231:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(10326);r(17577);var i=r(56249),n=r(75698),o=r(66874),a=r(52386);function l({title:e="ไม่มีข้อมูล",description:t,action:r,image:l}){return s.jsx(i.Z,{size:"small",variant:"outlined",style:{borderRadius:a.H.cardRadiusLG},bodyStyle:{padding:20},children:s.jsx(n.Z,{image:l,description:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[s.jsx(o.default.Text,{strong:!0,children:e}),t?s.jsx(o.default.Text,{type:"secondary",children:t}):null]}),children:r})})}},59746:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});var s=r(17577),i=r(75958),n=r(37938);let o=()=>{let{showLoading:e,hideLoading:t}=(0,n.x)();return{execute:(0,s.useCallback)(async(r,s="กำลังดำเนินการ...",n,o="เกิดข้อผิดพลาด")=>{try{return e(s,"async"),await r()}catch(t){console.error("Async action error:",t);let e=o;"string"==typeof t?e=t:t instanceof Error?e=t.message:"object"==typeof t&&null!==t&&(e=t.response?.data?.message??t.message??(()=>{try{return JSON.stringify(t)}catch{return"เกิดข้อผิดพลาดที่ไม่ทราบสาเหตุ (Unknown Error)"}})()),i.Z.error({title:"ข้อผิดพลาด",content:e});return}finally{t("async")}},[e,t])}}},80440:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var s=r(17577),i=r(19211);let n=()=>(0,s.useContext)(i.J)},82451:(e,t,r)=>{"use strict";var s;r.d(t,{L:()=>s}),function(e){e.Fixed="Fixed",e.Percentage="Percentage"}(s||(s={}))},54354:(e,t,r)=>{"use strict";function s(e,t,r,s=e=>e.id,i=()=>!0){}function i({socket:e,events:t=[],onRefresh:r,intervalMs:s,enabled:i=!0,debounceMs:n}){}r.d(t,{D:()=>i,v:()=>s}),r(17577)},743:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\discounts\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,4421,8571,8842,8963,1399,4658,3849],()=>r(76651));module.exports=s})();