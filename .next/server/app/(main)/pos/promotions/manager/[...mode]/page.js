(()=>{var e={};e.id=327,e.ids=[327],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},63801:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.Z,__next_app__:()=>u,originalPathname:()=>c,pages:()=>d,routeModule:()=>m,tree:()=>l}),r(24446),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var i=r(23191),n=r(88716),a=r(43315),s=r(95231),o={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>s[e]);r.d(t,o);let l=["",{children:["(main)",{children:["pos",{children:["promotions",{children:["manager",{children:["[...mode]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,24446)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\promotions\\manager\\[...mode]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],d=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\promotions\\manager\\[...mode]\\page.tsx"],c="/(main)/pos/promotions/manager/[...mode]/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new i.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(main)/pos/promotions/manager/[...mode]/page",pathname:"/pos/promotions/manager/[...mode]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},96887:(e,t,r)=>{Promise.resolve().then(r.bind(r,43446))},50477:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var i=r(17577);let n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};var a=r(74082);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let o=i.forwardRef((e,t)=>i.createElement(a.Z,s({},e,{ref:t,icon:n})))},63699:function(e,t,r){var i;i=function(e){"use strict";var t={name:"th",weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"},ordinal:function(e){return e+"."}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(t,null,!0),t},e.exports=i(r(88295))},43446:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>P});var i=r(10326),n=r(17577),a=r(49909),s=r(14374),o=r(43359),l=r(46752),d=r(92121),c=r(73664),u=r(31916),m=r(63459),p=r(35047),x=r(28357),f=r(45207),b=r(26902),h=r(50477),g=r(88295),y=r.n(g);r(63699);let{TextArea:_}=a.default,{RangePicker:j}=s.default;y().locale("th");let v=[{label:"ซื้อ X แถม Y",value:x.q.BuyXGetY},{label:"ลดเปอร์เซ็นต์",value:x.q.PercentageOff},{label:"ลดจำนวนเงิน",value:x.q.FixedAmountOff},{label:"ฟรีค่าจัดส่ง",value:x.q.FreeShipping},{label:"ชุดโปรโมชัน",value:x.q.Bundle},{label:"ซื้อขั้นต่ำ",value:x.q.MinimumPurchase}],w=[{label:"ทุกสินค้า",value:x.x.AllProducts},{label:"หมวดหมู่เฉพาะ",value:x.x.SpecificCategory},{label:"สินค้าเฉพาะ",value:x.x.SpecificProduct},{label:"ยอดซื้อขั้นต่ำ",value:x.x.MinimumAmount}];function P({params:e}){let t=(0,p.useRouter)(),[s]=o.Z.useForm(),[g,P]=(0,n.useState)(!1),[k,q]=(0,n.useState)(!1),[Z,z]=(0,n.useState)(x.q.PercentageOff),[M,O]=(0,n.useState)(x.x.AllProducts),S=e.mode[0],I=e.mode[1]||null,A="edit"===S&&!!I,{isAuthorized:Y,isChecking:F}=(0,f.e)({requiredRole:"Admin"});(0,n.useCallback)(async()=>{P(!0);try{if(!I)return;let{promotionsService:e}=await r.e(689).then(r.bind(r,60689)),t=await e.getById(I);s.setFieldsValue({promotion_code:t.promotion_code,name:t.name,description:t.description,promotion_type:t.promotion_type,condition_type:t.condition_type,condition_value:t.condition_value?JSON.parse(t.condition_value):void 0,discount_amount:t.discount_amount,discount_percentage:t.discount_percentage,minimum_purchase:t.minimum_purchase,buy_quantity:t.buy_quantity,get_quantity:t.get_quantity,start_date:t.start_date?y()(t.start_date):void 0,end_date:t.end_date?y()(t.end_date):void 0,usage_limit:t.usage_limit,usage_limit_per_user:t.usage_limit_per_user,is_active:t.is_active}),z(t.promotion_type||x.q.PercentageOff),O(t.condition_type||x.x.AllProducts)}catch(e){console.error(e),l.ZP.error("ไม่สามารถดึงข้อมูลโปรโมชันได้"),t.push("/pos/promotions")}finally{P(!1)}},[I,s,t]);let E=async e=>{q(!0);try{let i={...e,condition_value:e.condition_value?JSON.stringify(e.condition_value):void 0,start_date:e.start_date?e.start_date.toISOString():void 0,end_date:e.end_date?e.end_date.toISOString():void 0},{promotionsService:n}=await r.e(689).then(r.bind(r,60689));A?(await n.update(I,i),l.ZP.success("อัปเดตโปรโมชันสำเร็จ")):(await n.create(i),l.ZP.success("สร้างโปรโมชันสำเร็จ")),t.push("/pos/promotions")}catch(e){l.ZP.error(e instanceof Error?e.message:"เกิดข้อผิดพลาด")}finally{q(!1)}};return F?i.jsx(b.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."}):Y?(0,i.jsxs)("div",{style:{padding:"24px",maxWidth:800,margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:20,padding:"24px",marginBottom:24,display:"flex",alignItems:"center",gap:16},children:[i.jsx(h.Z,{style:{fontSize:32,color:"white"}}),i.jsx("div",{children:i.jsx("h2",{style:{color:"white",margin:0},children:A?"แก้ไขโปรโมชัน":"เพิ่มโปรโมชัน"})})]}),i.jsx(d.Z,{spinning:g,children:(0,i.jsxs)(o.Z,{form:s,layout:"vertical",onFinish:E,initialValues:{promotion_type:x.q.PercentageOff,condition_type:x.x.AllProducts,is_active:!0,usage_limit:0,usage_limit_per_user:1},children:[i.jsx(o.Z.Item,{label:"รหัสโปรโมชัน",name:"promotion_code",rules:[{required:!0,message:"กรุณากรอกรหัสโปรโมชัน"}],children:i.jsx(a.default,{placeholder:"เช่น SUMMER2024"})}),i.jsx(o.Z.Item,{label:"ชื่อโปรโมชัน",name:"name",rules:[{required:!0,message:"กรุณากรอกชื่อโปรโมชัน"}],children:i.jsx(a.default,{placeholder:"เช่น โปรโมชันฤดูร้อน"})}),i.jsx(o.Z.Item,{label:"รายละเอียด",name:"description",children:i.jsx(_,{rows:3,placeholder:"อธิบายรายละเอียดโปรโมชัน"})}),i.jsx(o.Z.Item,{label:"ประเภทโปรโมชัน",name:"promotion_type",rules:[{required:!0}],children:i.jsx(c.ZP.Group,{options:v,onChange:e=>z(e.target.value)})}),i.jsx(o.Z.Item,{label:"เงื่อนไข",name:"condition_type",rules:[{required:!0}],children:i.jsx(c.ZP.Group,{options:w,onChange:e=>O(e.target.value)})}),(Z===x.q.PercentageOff||Z===x.q.FixedAmountOff)&&(0,i.jsxs)(i.Fragment,{children:[Z===x.q.PercentageOff&&i.jsx(o.Z.Item,{label:"เปอร์เซ็นต์ส่วนลด",name:"discount_percentage",rules:[{required:!0,message:"กรุณากรอกเปอร์เซ็นต์ส่วนลด"}],children:i.jsx(u.Z,{min:0,max:100,placeholder:"เช่น 10",style:{width:"100%"},addonAfter:"%"})}),Z===x.q.FixedAmountOff&&i.jsx(o.Z.Item,{label:"จำนวนเงินส่วนลด",name:"discount_amount",rules:[{required:!0,message:"กรุณากรอกจำนวนเงินส่วนลด"}],children:i.jsx(u.Z,{min:0,placeholder:"เช่น 50",style:{width:"100%"},addonAfter:"บาท"})})]}),Z===x.q.BuyXGetY&&(0,i.jsxs)(i.Fragment,{children:[i.jsx(o.Z.Item,{label:"จำนวนที่ต้องซื้อ",name:"buy_quantity",rules:[{required:!0}],children:i.jsx(u.Z,{min:1,style:{width:"100%"}})}),i.jsx(o.Z.Item,{label:"จำนวนที่ได้ฟรี",name:"get_quantity",rules:[{required:!0}],children:i.jsx(u.Z,{min:1,style:{width:"100%"}})})]}),Z===x.q.MinimumPurchase&&(0,i.jsxs)(i.Fragment,{children:[i.jsx(o.Z.Item,{label:"ยอดซื้อขั้นต่ำ",name:"minimum_purchase",rules:[{required:!0}],children:i.jsx(u.Z,{min:0,style:{width:"100%"},addonAfter:"บาท"})}),i.jsx(o.Z.Item,{label:"ส่วนลด",name:"discount_amount",rules:[{required:!0}],children:i.jsx(u.Z,{min:0,style:{width:"100%"},addonAfter:"บาท"})})]}),(M===x.x.SpecificCategory||M===x.x.SpecificProduct)&&i.jsx(o.Z.Item,{label:"ค่าเงื่อนไข (JSON Array)",name:"condition_value",tooltip:"กรอกเป็น JSON Array เช่น ['id1', 'id2']",children:i.jsx(_,{rows:2,placeholder:'["id1", "id2"]'})}),i.jsx(o.Z.Item,{label:"วันที่เริ่มต้น - สิ้นสุด",children:i.jsx(j,{style:{width:"100%"},showTime:!0,format:"DD/MM/YYYY HH:mm"})}),i.jsx(o.Z.Item,{label:"จำนวนครั้งที่ใช้ได้ (0 = ไม่จำกัด)",name:"usage_limit",children:i.jsx(u.Z,{min:0,style:{width:"100%"}})}),i.jsx(o.Z.Item,{label:"จำนวนครั้งที่ใช้ได้ต่อผู้ใช้",name:"usage_limit_per_user",children:i.jsx(u.Z,{min:1,style:{width:"100%"}})}),i.jsx(o.Z.Item,{label:"สถานะ",name:"is_active",valuePropName:"checked",children:i.jsx(m.Z,{})}),i.jsx(o.Z.Item,{children:(0,i.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:()=>t.back(),style:{padding:"8px 24px",borderRadius:8,border:"1px solid #d9d9d9",background:"white",cursor:"pointer"},children:"ยกเลิก"}),i.jsx("button",{type:"submit",disabled:k,style:{padding:"8px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",color:"white",cursor:"pointer",fontWeight:600},children:k?"กำลังบันทึก...":A?"อัปเดต":"สร้าง"})]})})]})})]}):i.jsx(b.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},26902:(e,t,r)=>{"use strict";r.d(t,{H:()=>h});var i=r(10326),n=r(77626),a=r.n(n),s=r(17577),o=r(58184),l=r(54547),d=r(92121);let c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM540 701v53c0 4.4-3.6 8-8 8h-40c-4.4 0-8-3.6-8-8v-53a48.01 48.01 0 1156 0zm152-237H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224z"}}]},name:"lock",theme:"filled"};var u=r(74082);function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let p=s.forwardRef((e,t)=>s.createElement(u.Z,m({},e,{ref:t,icon:c})));var x=r(39275);let{Text:f,Title:b}=o.default,h=({message:e,tone:t="secondary"})=>(0,i.jsxs)("div",{className:"jsx-e041fd1637d3b0f2 access-guard-container",children:[i.jsx(l.ZP,{theme:{token:{colorPrimary:"#3b82f6"}},children:(0,i.jsxs)("div",{className:"jsx-e041fd1637d3b0f2 content-wrapper",children:["danger"===t?i.jsx("div",{className:"jsx-e041fd1637d3b0f2 icon-circle danger",children:i.jsx(p,{style:{fontSize:32,color:"#ef4444"}})}):i.jsx("div",{className:"jsx-e041fd1637d3b0f2 spinner-wrapper",children:i.jsx(d.Z,{indicator:i.jsx(x.Z,{style:{fontSize:40},spin:!0})})}),(0,i.jsxs)("div",{className:"jsx-e041fd1637d3b0f2 text-content",children:[i.jsx(b,{level:4,style:{margin:0,color:"#1e293b"},children:"danger"===t?"Access Denied":"Loading"}),i.jsx(f,{type:t,style:{fontSize:16},children:e})]})]})}),i.jsx(a(),{id:"e041fd1637d3b0f2",children:".access-guard-container.jsx-e041fd1637d3b0f2{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:100vh;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;background:#f8fafc}.content-wrapper.jsx-e041fd1637d3b0f2{background:white;padding:40px;-webkit-border-radius:24px;-moz-border-radius:24px;border-radius:24px;-webkit-box-shadow:0 20px 40px rgba(0,0,0,.05);-moz-box-shadow:0 20px 40px rgba(0,0,0,.05);box-shadow:0 20px 40px rgba(0,0,0,.05);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:24px;text-align:center;min-width:320px;-webkit-animation:fadeIn.5s ease-out;-moz-animation:fadeIn.5s ease-out;-o-animation:fadeIn.5s ease-out;animation:fadeIn.5s ease-out}.icon-circle.jsx-e041fd1637d3b0f2{width:80px;height:80px;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;background:#fff1f2}.spinner-wrapper.jsx-e041fd1637d3b0f2{padding:20px}.text-content.jsx-e041fd1637d3b0f2{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:8px}@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);-moz-transform:translatey(10px);-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"})]})},28357:(e,t,r)=>{"use strict";var i,n;r.d(t,{q:()=>i,x:()=>n}),function(e){e.BuyXGetY="BuyXGetY",e.PercentageOff="PercentageOff",e.FixedAmountOff="FixedAmountOff",e.FreeShipping="FreeShipping",e.Bundle="Bundle",e.MinimumPurchase="MinimumPurchase"}(i||(i={})),function(e){e.AllProducts="AllProducts",e.SpecificCategory="SpecificCategory",e.SpecificProduct="SpecificProduct",e.MinimumAmount="MinimumAmount"}(n||(n={}))},45207:(e,t,r)=>{"use strict";r.d(t,{e:()=>s});var i=r(17577),n=r(35047),a=r(94001);function s({requiredRole:e="Admin",redirectUnauthenticated:t="/login",redirectUnauthorized:r="/pos",unauthorizedMessage:s="คุณไม่มีสิทธิ์เข้าถึงหน้านี้"}={}){(0,n.useRouter)();let{user:o,loading:l}=(0,a.a)(),d=(0,i.useMemo)(()=>l?"checking":o?e&&o.role!==e?"unauthorized":"authorized":"unauthenticated",[o,l,e]);return(0,i.useRef)(!1),{status:d,isAuthorized:"authorized"===d,isChecking:"checking"===d,user:o}}},24446:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\promotions\manager\[...mode]\page.tsx#default`)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[9276,8674,8571,8270,9345,9042,1399,4658],()=>r(63801));module.exports=i})();