(()=>{var e={};e.id=6651,e.ids=[6651,689],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},48001:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.Z,__next_app__:()=>u,originalPathname:()=>d,pages:()=>l,routeModule:()=>p,tree:()=>c}),r(70022),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var s=r(23191),i=r(88716),o=r(43315),n=r(95231),a={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>n[e]);r.d(t,a);let c=["",{children:["(main)",{children:["pos",{children:["promotions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,70022)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\promotions\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],l=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\promotions\\page.tsx"],d="/(main)/pos/promotions/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/pos/promotions/page",pathname:"/pos/promotions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},10948:(e,t,r)=>{Promise.resolve().then(r.bind(r,41232))},50477:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};var o=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let a=s.forwardRef((e,t)=>s.createElement(o.Z,n({},e,{ref:t,icon:i})))},63699:function(e,t,r){var s;s=function(e){"use strict";var t={name:"th",weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"},ordinal:function(e){return e+"."}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(t,null,!0),t},e.exports=s(r(88295))},41232:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>R});var s=r(10326),i=r(17577),o=r(58184),n=r(64635),a=r(49909),c=r(71935),l=r(56249),d=r(11401),u=r(75698),p=r(61357),m=r(50477),h=r(80490),x=r(72380),f=r(56811),y=r(54695),g=r(46024),b=r(63348),j=r(35047),v=r(44976),w=r(20108),P=r(10119),k=r(19211),_=r(60689),S=r(46752),O=r(28357),M=r(45207),z=r(26902),E=r(56368),Z=r(88295),q=r.n(Z);r(63699);let{Text:A,Title:C}=o.default;q().locale("th");let T={[O.q.BuyXGetY]:"ซื้อ X แถม Y",[O.q.PercentageOff]:"ลดเปอร์เซ็นต์",[O.q.FixedAmountOff]:"ลดจำนวนเงิน",[O.q.FreeShipping]:"ฟรีค่าจัดส่ง",[O.q.Bundle]:"ชุดโปรโมชัน",[O.q.MinimumPurchase]:"ซื้อขั้นต่ำ"};function R(){let e=(0,j.useRouter)(),[t,r]=(0,i.useState)(""),o=(0,E.c)(t.trim(),400),{promotions:O,isLoading:Z,refetch:R}=function(){let{socket:e}=(0,i.useContext)(k.J),t=(0,v.NL)(),{data:r=[],isLoading:s,refetch:o}=(0,w.a)({queryKey:["promotions","active"],queryFn:async()=>await _.promotionsService.getActivePromotions(),staleTime:3e5}),n=(0,P.D)({mutationFn:e=>_.promotionsService.validatePromotion(e)}),a=(0,P.D)({mutationFn:e=>_.promotionsService.applyPromotion(e),onSuccess:()=>{t.invalidateQueries({queryKey:["promotions"]}),S.ZP.success("ใช้โปรโมชันสำเร็จ")},onError:e=>{S.ZP.error(e.message||"ไม่สามารถใช้โปรโมชันได้")}});return{promotions:r,isLoading:s,refetch:o,validatePromotion:n.mutateAsync,applyPromotion:a.mutateAsync,isValidating:n.isPending,isApplying:a.isPending}}(),{isAuthorized:Y,isChecking:L}=(0,M.e)({requiredRole:"Admin"}),F=O.filter(e=>{if(!o)return!0;let t=o.toLowerCase();return e.name.toLowerCase().includes(t)||e.promotion_code.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)}),B=F.filter(e=>e.is_active),I=F.filter(e=>!!e.end_date&&q()(e.end_date).isBefore(q()()));return L?s.jsx(z.H,{message:"กำลังตรวจสอบสิทธิ์การใช้งาน..."}):Y?(0,s.jsxs)("div",{style:{padding:"24px",maxWidth:1400,margin:"0 auto"},children:[(0,s.jsxs)("div",{style:{background:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",borderRadius:20,padding:"32px 24px",marginBottom:24,position:"relative",overflow:"hidden"},children:[s.jsx("div",{style:{position:"absolute",top:-50,right:-50,width:200,height:200,borderRadius:"50%",background:"rgba(255,255,255,0.1)"}}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[s.jsx("div",{style:{width:64,height:64,borderRadius:16,background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(m.Z,{style:{fontSize:28,color:"white"}})}),(0,s.jsxs)("div",{children:[s.jsx(A,{style:{color:"rgba(255,255,255,0.85)",fontSize:14,display:"block"},children:"จัดการโปรโมชัน"}),s.jsx(C,{level:3,style:{color:"white",margin:0,fontWeight:700},children:"Promotions"})]})]}),(0,s.jsxs)(n.Z,{children:[s.jsx(a.default,{allowClear:!0,placeholder:"ค้นหาโปรโมชัน...",value:t,onChange:e=>r(e.target.value),style:{width:240,borderRadius:10}}),s.jsx(c.ZP,{icon:s.jsx(h.Z,{}),onClick:()=>R(),style:{background:"rgba(255,255,255,0.2)",color:"white",border:"none"}}),s.jsx(c.ZP,{type:"primary",icon:s.jsx(x.Z,{}),onClick:()=>e.push("/pos/promotions/manager/add"),style:{background:"white",color:"#f5576c"},children:"เพิ่มโปรโมชัน"})]})]})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16,marginBottom:24},children:[s.jsx(l.Z,{children:(0,s.jsxs)("div",{style:{textAlign:"center"},children:[s.jsx(d.Z,{count:F.length,showZero:!0,children:s.jsx(m.Z,{style:{fontSize:32,color:"#f5576c"}})}),s.jsx("div",{style:{marginTop:8},children:s.jsx(A,{type:"secondary",children:"ทั้งหมด"})})]})}),s.jsx(l.Z,{children:(0,s.jsxs)("div",{style:{textAlign:"center"},children:[s.jsx(d.Z,{count:B.length,showZero:!0,children:s.jsx(f.Z,{style:{fontSize:32,color:"#52c41a"}})}),s.jsx("div",{style:{marginTop:8},children:s.jsx(A,{type:"secondary",children:"เปิดใช้งาน"})})]})}),s.jsx(l.Z,{children:(0,s.jsxs)("div",{style:{textAlign:"center"},children:[s.jsx(d.Z,{count:I.length,showZero:!0,children:s.jsx(y.Z,{style:{fontSize:32,color:"#ff4d4f"}})}),s.jsx("div",{style:{marginTop:8},children:s.jsx(A,{type:"secondary",children:"หมดอายุ"})})]})})]}),Z?s.jsx(l.Z,{loading:!0}):0===F.length?s.jsx(l.Z,{children:s.jsx(u.Z,{description:"ยังไม่มีโปรโมชัน"})}):s.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:16},children:F.map(t=>{let r=t.end_date&&q()(t.end_date).isBefore(q()()),i=t.is_active&&!r;return s.jsx(l.Z,{style:{borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",border:i?"2px solid #52c41a":"1px solid #f0f0f0"},actions:[s.jsx(c.ZP,{type:"text",icon:s.jsx(g.Z,{}),onClick:()=>e.push(`/pos/promotions/manager/edit/${t.id}`),children:"แก้ไข"},"edit")],children:(0,s.jsxs)("div",{children:[s.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:12},children:(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[s.jsx(A,{strong:!0,style:{fontSize:16},children:t.name}),i?s.jsx(f.Z,{style:{color:"#52c41a",fontSize:14}}):s.jsx(y.Z,{style:{color:"#ff4d4f",fontSize:14}})]}),s.jsx(p.Z,{color:"purple",style:{marginBottom:8},children:t.promotion_code}),s.jsx(p.Z,{color:i?"success":"default",children:T[t.promotion_type]})]})}),t.description&&s.jsx(A,{type:"secondary",style:{fontSize:12,display:"block",marginBottom:8},children:t.description}),(0,s.jsxs)("div",{style:{display:"flex",gap:16,fontSize:12,color:"#8c8c8c",marginTop:12},children:[t.start_date&&(0,s.jsxs)("div",{children:[s.jsx(b.Z,{})," เริ่ม: ",q()(t.start_date).format("DD/MM/YYYY")]}),t.end_date&&(0,s.jsxs)("div",{children:[s.jsx(b.Z,{})," สิ้นสุด: ",q()(t.end_date).format("DD/MM/YYYY")]})]}),t.usage_limit&&s.jsx("div",{style:{marginTop:8},children:(0,s.jsxs)(A,{type:"secondary",style:{fontSize:12},children:["ใช้แล้ว: ",t.usage_count||0," / ",t.usage_limit]})})]})},t.id)})})]}):s.jsx(z.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},26902:(e,t,r)=>{"use strict";r.d(t,{H:()=>y});var s=r(10326),i=r(77626),o=r.n(i),n=r(17577),a=r(58184),c=r(54547),l=r(92121);let d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM540 701v53c0 4.4-3.6 8-8 8h-40c-4.4 0-8-3.6-8-8v-53a48.01 48.01 0 1156 0zm152-237H332V240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224z"}}]},name:"lock",theme:"filled"};var u=r(74082);function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let m=n.forwardRef((e,t)=>n.createElement(u.Z,p({},e,{ref:t,icon:d})));var h=r(39275);let{Text:x,Title:f}=a.default,y=({message:e,tone:t="secondary"})=>(0,s.jsxs)("div",{className:"jsx-e041fd1637d3b0f2 access-guard-container",children:[s.jsx(c.ZP,{theme:{token:{colorPrimary:"#3b82f6"}},children:(0,s.jsxs)("div",{className:"jsx-e041fd1637d3b0f2 content-wrapper",children:["danger"===t?s.jsx("div",{className:"jsx-e041fd1637d3b0f2 icon-circle danger",children:s.jsx(m,{style:{fontSize:32,color:"#ef4444"}})}):s.jsx("div",{className:"jsx-e041fd1637d3b0f2 spinner-wrapper",children:s.jsx(l.Z,{indicator:s.jsx(h.Z,{style:{fontSize:40},spin:!0})})}),(0,s.jsxs)("div",{className:"jsx-e041fd1637d3b0f2 text-content",children:[s.jsx(f,{level:4,style:{margin:0,color:"#1e293b"},children:"danger"===t?"Access Denied":"Loading"}),s.jsx(x,{type:t,style:{fontSize:16},children:e})]})]})}),s.jsx(o(),{id:"e041fd1637d3b0f2",children:".access-guard-container.jsx-e041fd1637d3b0f2{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:100vh;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;background:#f8fafc}.content-wrapper.jsx-e041fd1637d3b0f2{background:white;padding:40px;-webkit-border-radius:24px;-moz-border-radius:24px;border-radius:24px;-webkit-box-shadow:0 20px 40px rgba(0,0,0,.05);-moz-box-shadow:0 20px 40px rgba(0,0,0,.05);box-shadow:0 20px 40px rgba(0,0,0,.05);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:24px;text-align:center;min-width:320px;-webkit-animation:fadeIn.5s ease-out;-moz-animation:fadeIn.5s ease-out;-o-animation:fadeIn.5s ease-out;animation:fadeIn.5s ease-out}.icon-circle.jsx-e041fd1637d3b0f2{width:80px;height:80px;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;background:#fff1f2}.spinner-wrapper.jsx-e041fd1637d3b0f2{padding:20px}.text-content.jsx-e041fd1637d3b0f2{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:8px}@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(10px);-moz-transform:translatey(10px);-o-transform:translatey(10px);transform:translatey(10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"})]})},60689:(e,t,r)=>{"use strict";r.d(t,{promotionsService:()=>c});var s=r(12529),i=r(40820),o=r(33357);let n=i.q.POS.PROMOTIONS,a=(e,t="application/json")=>{let r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},c={getAll:async(e,t)=>{let r=new URLSearchParams;void 0!==t&&r.append("isActive",t.toString());let i=r.toString()?`${n}?${r.toString()}`:n,o=(0,s.b)("GET",i),c=a(e,""),l=await fetch(o,{cache:"no-store",headers:c,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถดึงข้อมูลโปรโมชันได้")}let d=await l.json();return d.success&&Array.isArray(d.data)?d.data:Array.isArray(d)?d:[]},getActivePromotions:async e=>{let t=(0,s.b)("GET",`${n}/active`),r=a(e,""),i=await fetch(t,{cache:"no-store",headers:r,credentials:"include"});if(!i.ok){let e=await i.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถดึงข้อมูลโปรโมชันได้")}let o=await i.json();return o.success&&Array.isArray(o.data)?o.data:Array.isArray(o)?o:[]},getById:async(e,t)=>{let r=(0,s.b)("GET",`${n}/getById/${e}`),i=a(t,""),o=await fetch(r,{cache:"no-store",headers:i,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถดึงข้อมูลโปรโมชันได้")}let c=await o.json();return c.success&&c.data?c.data:c},create:async(e,t)=>{let r=(0,s.b)("POST",`${n}/create`),i=a(t),c=await (0,o.P)();c&&(i["X-CSRF-Token"]=c);let l=await fetch(r,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถสร้างโปรโมชันได้")}let d=await l.json();return d.success&&d.data?d.data:d},update:async(e,t,r)=>{let i=(0,s.b)("PUT",`${n}/update/${e}`),c=a(r),l=await (0,o.P)();l&&(c["X-CSRF-Token"]=l);let d=await fetch(i,{method:"PUT",headers:c,credentials:"include",body:JSON.stringify(t)});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถอัปเดตโปรโมชันได้")}let u=await d.json();return u.success&&u.data?u.data:u},delete:async(e,t)=>{let r=(0,s.b)("DELETE",`${n}/delete/${e}`),i=a(t,""),c=await (0,o.P)();c&&(i["X-CSRF-Token"]=c);let l=await fetch(r,{method:"DELETE",headers:i,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถลบโปรโมชันได้")}},validatePromotion:async(e,t)=>{let r=(0,s.b)("POST",`${n}/validate`),i=a(t),o=await fetch(r,{method:"POST",headers:i,credentials:"include",body:JSON.stringify(e)});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถตรวจสอบโปรโมชันได้")}let c=await o.json();return c.success&&c.data?c.data:c},applyPromotion:async(e,t)=>{let r=(0,s.b)("POST",`${n}/apply`),i=a(t),c=await (0,o.P)();c&&(i["X-CSRF-Token"]=c);let l=await fetch(r,{method:"POST",headers:i,credentials:"include",body:JSON.stringify({code:e})});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error?.message||e.message||"ไม่สามารถใช้โปรโมชันได้")}let d=await l.json();return d.success&&d.data?d.data:d}}},28357:(e,t,r)=>{"use strict";var s,i;r.d(t,{q:()=>s,x:()=>i}),function(e){e.BuyXGetY="BuyXGetY",e.PercentageOff="PercentageOff",e.FixedAmountOff="FixedAmountOff",e.FreeShipping="FreeShipping",e.Bundle="Bundle",e.MinimumPurchase="MinimumPurchase"}(s||(s={})),function(e){e.AllProducts="AllProducts",e.SpecificCategory="SpecificCategory",e.SpecificProduct="SpecificProduct",e.MinimumAmount="MinimumAmount"}(i||(i={}))},45207:(e,t,r)=>{"use strict";r.d(t,{e:()=>n});var s=r(17577),i=r(35047),o=r(94001);function n({requiredRole:e="Admin",redirectUnauthenticated:t="/login",redirectUnauthorized:r="/pos",unauthorizedMessage:n="คุณไม่มีสิทธิ์เข้าถึงหน้านี้"}={}){(0,i.useRouter)();let{user:a,loading:c}=(0,o.a)(),l=(0,s.useMemo)(()=>c?"checking":a?e&&a.role!==e?"unauthorized":"authorized":"unauthenticated",[a,c,e]);return(0,s.useRef)(!1),{status:l,isAuthorized:"authorized"===l,isChecking:"checking"===l,user:a}}},56368:(e,t,r)=>{"use strict";r.d(t,{c:()=>i});var s=r(17577);let i=(e,t=400)=>{let[r,i]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let r=setTimeout(()=>{i(e)},t);return()=>{clearTimeout(r)}},[e,t]),r}},70022:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\promotions\page.tsx#default`)},10119:(e,t,r)=>{"use strict";r.d(t,{D:()=>d});var s=r(17577),i=r(71180),o=r(12113),n=r(64351),a=r(3341),c=class extends n.l{#e;#t=void 0;#r;#s;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,a.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,a.Ym)(t.mutationKey)!==(0,a.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#o(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#i(),this.#o()}mutate(e,t){return this.#s=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#i(){let e=this.#r?.state??(0,i.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#o(e){o.Vr.batch(()=>{if(this.#s&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context,s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#s.onSuccess?.(e.data,t,r,s)}catch(e){Promise.reject(e)}try{this.#s.onSettled?.(e.data,null,t,r,s)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#s.onError?.(e.error,t,r,s)}catch(e){Promise.reject(e)}try{this.#s.onSettled?.(void 0,e.error,t,r,s)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},l=r(44976);function d(e,t){let r=(0,l.NL)(t),[i]=s.useState(()=>new c(r,e));s.useEffect(()=>{i.setOptions(e)},[i,e]);let n=s.useSyncExternalStore(s.useCallback(e=>i.subscribe(o.Vr.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),d=s.useCallback((e,t)=>{i.mutate(e,t).catch(a.ZT)},[i]);if(n.error&&(0,a.L3)(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:d,mutateAsync:n.mutate}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,8674,8571,8270,9345,108,9042,1399,4658],()=>r(48001));module.exports=s})();