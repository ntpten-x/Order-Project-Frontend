(()=>{var e={};e.id=1304,e.ids=[1304],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},96110:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.Z,__next_app__:()=>u,originalPathname:()=>c,pages:()=>d,routeModule:()=>h,tree:()=>o}),r(64538),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var i=r(23191),s=r(88716),a=r(43315),n=r(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);r.d(t,l);let o=["",{children:["(main)",{children:["pos",{children:["orders",{children:["[...ordersId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,64538)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\orders\\[...ordersId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],d=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\orders\\[...ordersId]\\page.tsx"],c="/(main)/pos/orders/[...ordersId]/page",u={require:r,loadChunk:()=>Promise.resolve()},h=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(main)/pos/orders/[...ordersId]/page",pathname:"/pos/orders/[...ordersId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},75349:(e,t,r)=>{Promise.resolve().then(r.bind(r,45997))},2643:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},12226:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},41684:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},16185:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},30278:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},61758:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M922.9 701.9H327.4l29.9-60.9 496.8-.9c16.8 0 31.2-12 34.2-28.6l68.8-385.1c1.8-10.1-.9-20.5-7.5-28.4a34.99 34.99 0 00-26.6-12.5l-632-2.1-5.4-25.4c-3.4-16.2-18-28-34.6-28H96.5a35.3 35.3 0 100 70.6h125.9L246 312.8l58.1 281.3-74.8 122.1a34.96 34.96 0 00-3 36.8c6 11.9 18.1 19.4 31.5 19.4h62.8a102.43 102.43 0 00-20.6 61.7c0 56.6 46 102.6 102.6 102.6s102.6-46 102.6-102.6c0-22.3-7.4-44-20.6-61.7h161.1a102.43 102.43 0 00-20.6 61.7c0 56.6 46 102.6 102.6 102.6s102.6-46 102.6-102.6c0-22.3-7.4-44-20.6-61.7H923c19.4 0 35.3-15.8 35.3-35.3a35.42 35.42 0 00-35.4-35.2zM305.7 253l575.8 1.9-56.4 315.8-452.3.8L305.7 253zm96.9 612.7c-17.4 0-31.6-14.2-31.6-31.6 0-17.4 14.2-31.6 31.6-31.6s31.6 14.2 31.6 31.6a31.6 31.6 0 01-31.6 31.6zm325.1 0c-17.4 0-31.6-14.2-31.6-31.6 0-17.4 14.2-31.6 31.6-31.6s31.6 14.2 31.6 31.6a31.6 31.6 0 01-31.6 31.6z"}}]},name:"shopping-cart",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},75621:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var i=r(17577);let s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let l=i.forwardRef((e,t)=>i.createElement(a.Z,n({},e,{ref:t,icon:s})))},63699:function(e,t,r){var i;i=function(e){"use strict";var t={name:"th",weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"ม.ค._ก.พ._มี.ค._เม.ย._พ.ค._มิ.ย._ก.ค._ส.ค._ก.ย._ต.ค._พ.ย._ธ.ค.".split("_"),formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา H:mm",LLLL:"วันddddที่ D MMMM YYYY เวลา H:mm"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"},ordinal:function(e){return e+"."}};return(e&&"object"==typeof e&&"default"in e?e:{default:e}).default.locale(t,null,!0),t},e.exports=i(r(88295))},45997:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eg});var i=r(10326),s=r(77626),a=r.n(s),n=r(17577),l=r(35047),o=r(58184),d=r(46752),c=r(75698),u=r(64635),h=r(61357),p=r(6400),y=r(71935),m=r(4139),x=r(38106),g=r(56249),f=r(30124),j=r(13483),b=r(276),v=r(62938),_=r(41684),S=r(24895),k=r(46024),w=r(63191),z=r(49965),Z=r(2643),P=r(9297),C=r(16185),A=r(75621),B=r(80490),N=r(72380),T=r(12226),O=r(26859),R=r(33357),L=r(31499),q=r(13976),M=r(10985),I=r(43401),H=r(95963),E=r(88295),$=r.n(E);r(63699);var D=r(46226),F=r(35509),W=r(75958),Y=r(49909),G=r(31916),Q=r(24395),V=r(61758),K=r(38572),U=r(51562),X=r(47374),J=r(37938);let{Text:ee,Title:et}=o.default,er=({isOpen:e,onClose:t,onAddItem:r})=>{let{message:s}=F.Z.useApp(),[l,o]=(0,n.useState)([]),[d,u]=(0,n.useState)([]),[h,p]=(0,n.useState)([]),[m,x]=(0,n.useState)(null),[g,f]=(0,n.useState)(""),{showLoading:j,hideLoading:v}=(0,J.x)(),[_,S]=(0,n.useState)(null),[k,P]=(0,n.useState)(1),[C,A]=(0,n.useState)(""),[B,T]=(0,n.useState)([]),O=(0,n.useCallback)(async()=>{try{j("กำลังโหลดข้อมูลสินค้า...");let[e,t]=await Promise.all([X.R.findAll(1,100),U.G.findAll()]);o(e.data),u(e.data),p(Array.isArray(t)?t:[])}catch{s.error("ไม่สามารถโหลดข้อมูลได้")}finally{v()}},[j,v,s]),R=(0,n.useCallback)(()=>{P(1),A(""),T([]),S(null),f("")},[]);(0,n.useEffect)(()=>{e&&(O(),R())},[O,e,R]);let L=e=>{x(e),q(g,e)},q=(e,t)=>{let r=l;t&&(r=r.filter(e=>e.category_id===t)),e&&(r=r.filter(t=>t.display_name.toLowerCase().includes(e.toLowerCase()))),u(r)},M=e=>{S(e),P(1),A(""),T([])},E=(e,t,r)=>{T(i=>i.map(i=>{if(i.id!==e)return i;if("price"===t){let e="number"==typeof r?r:Number(r)||0;return{...i,price:e}}return{...i,name:String(r)}}))},$=e=>{T(t=>t.filter(t=>t.id!==e))},er=async()=>{if(_)try{j("กำลังเพิ่มรายการ...");let e=B.filter(e=>""!==e.name.trim()).map(e=>({detail_name:e.name,extra_price:e.price}));await r(_,k,C,e),s.success("เพิ่มรายการเรียบร้อย"),t(),S(null)}catch{}finally{v()}};return(0,i.jsxs)(W.Z,{className:"mobile-fullscreen-modal",title:null,open:e,onCancel:t,footer:null,width:850,destroyOnHidden:!0,centered:!0,children:[i.jsx(a(),{id:I.$k.__hash,children:I.$k}),(0,i.jsxs)("div",{style:I.il.modalHeader,className:"modal-header",children:[_?i.jsx(y.ZP,{type:"text",icon:i.jsx(Z.Z,{}),onClick:()=>S(null),"aria-label":"กลับ",style:{height:44,width:44,borderRadius:12,background:I._A.backgroundSecondary,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${I._A.border}`},className:"scale-hover"}):i.jsx(y.ZP,{type:"text",icon:i.jsx(z.Z,{}),onClick:t,"aria-label":"ปิด",style:{height:44,width:44,borderRadius:12,background:I._A.backgroundSecondary,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${I._A.border}`},className:"scale-hover"}),i.jsx(ee,{strong:!0,style:{fontSize:18,flex:1,color:I._A.text,lineHeight:1.4},children:_?"ระบุรายละเอียด":"เลือกสินค้า"})]}),_?i.jsx("div",{style:I.m4.detailSection,className:"detail-section",children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},className:"product-info-section",children:[_.img_url?i.jsx(i.Fragment,{children:i.jsx(D.default,{src:_.img_url,alt:_.display_name,width:100,height:100,style:{objectFit:"cover",borderRadius:12,flexShrink:0}})}):i.jsx("div",{style:{width:100,height:100,background:I._A.backgroundSecondary,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.jsx(V.Z,{style:{fontSize:32,opacity:.2}})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[i.jsx(et,{level:4,style:{margin:"0 0 6px 0",fontSize:20,lineHeight:1.3},children:_.display_name}),(0,i.jsxs)(ee,{style:{fontSize:20,fontWeight:700,color:I._A.primary,lineHeight:1.2},children:["฿",Number(_.price).toLocaleString()]})]})]}),i.jsx(b.Z,{style:{margin:"0"}}),(0,i.jsxs)("div",{children:[i.jsx(ee,{strong:!0,style:{display:"block",marginBottom:14,fontSize:16,color:I._A.text},children:"จำนวน"}),(0,i.jsxs)("div",{style:I.il.quantityControl,className:"quantity-control",children:[i.jsx(y.ZP,{type:"primary",icon:i.jsx(K.Z,{}),onClick:()=>P(e=>Math.max(1,e-1)),disabled:k<=1,style:{...I.il.quantityButton,background:I._A.white,color:I._A.primary,border:`2px solid ${I._A.primary}`},className:"scale-hover quantity-button"}),i.jsx("div",{style:I.il.quantityDisplay,className:"quantity-display",children:k}),i.jsx(y.ZP,{type:"primary",icon:i.jsx(N.Z,{}),onClick:()=>P(e=>e+1),style:{...I.il.quantityButton,background:`linear-gradient(135deg, ${I._A.primary} 0%, ${I._A.primaryDark} 100%)`,border:"none"},className:"scale-hover quantity-button"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx(ee,{strong:!0,style:{fontSize:16},children:"ตัวเลือกเพิ่มเติม (Optional)"}),i.jsx(y.ZP,{size:"small",type:"dashed",onClick:()=>{T(e=>[...e,{id:Date.now(),name:"",price:0}])},icon:i.jsx(N.Z,{}),children:"เพิ่ม"})]}),B.map(e=>(0,i.jsxs)("div",{style:I.m4.detailItemRow,className:"detail-item-row",children:[i.jsx(Y.default,{placeholder:"ไข่ดาว, พิเศษ...",value:e.name,onChange:t=>E(e.id,"name",t.target.value),style:{flex:1,borderRadius:10,height:44,fontSize:15}}),i.jsx(G.Z,{placeholder:"0.00",value:e.price,onChange:t=>E(e.id,"price",t||0),style:{width:110,borderRadius:10,height:44,fontSize:15},inputMode:"decimal",controls:!1,min:0,precision:2,formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),onKeyDown:t=>{/^[0-9]$/.test(t.key)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","."].includes(t.key)||t.preventDefault(),"."===t.key&&e.price.toString().includes(".")&&t.preventDefault()}}),i.jsx(y.ZP,{type:"text",danger:!0,icon:i.jsx(w.Z,{}),onClick:()=>$(e.id),style:{width:44,height:44,borderRadius:10},className:"scale-hover"})]},e.id))]}),(0,i.jsxs)("div",{children:[i.jsx(ee,{strong:!0,style:{display:"block",marginBottom:10,fontSize:16,color:I._A.text},children:"หมายเหตุ"}),i.jsx(Y.default.TextArea,{rows:3,value:C,onChange:e=>A(e.target.value),placeholder:"เช่น ไม่ใส่ผัก, เผ็ดน้อย...",style:{borderRadius:12,fontSize:15,padding:"12px 14px",lineHeight:1.5}})]}),(0,i.jsxs)("div",{style:{marginTop:24},children:[(0,i.jsxs)("div",{style:I.il.priceCard,children:[i.jsx(ee,{strong:!0,style:{fontSize:16,color:I._A.text},children:"ยอดรวมรายการนี้"}),i.jsx(et,{level:4,style:{margin:0,color:I._A.priceTotal,fontSize:24},children:(0,H.xG)((()=>{if(!_)return 0;let e=B.map(e=>({detail_name:e.name,extra_price:e.price}));return(0,H.ku)(_.price,k,e)})())})]}),(0,i.jsxs)("div",{style:I.il.actionButtons,className:"action-buttons",children:[i.jsx(y.ZP,{onClick:()=>S(null),style:I.il.secondaryButton,className:"scale-hover secondary-button",children:"ย้อนกลับ"}),i.jsx(y.ZP,{type:"primary",onClick:er,icon:i.jsx(N.Z,{}),style:I.il.primaryButton,className:"scale-hover primary-button",children:"เพิ่มลงออเดอร์"})]})]})]})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{...I.m4.searchBar,paddingBottom:8},children:[i.jsx(Y.default,{placeholder:"ค้นหาสินค้าหรือรหัส...",prefix:i.jsx(Q.Z,{style:{color:I._A.textSecondary}}),value:g,onChange:e=>{let t=e.target.value;f(t),q(t,m)},allowClear:!0,style:{...I.m4.searchInput,marginBottom:12}}),(0,i.jsxs)("div",{style:{display:"flex",overflowX:"auto",gap:8,paddingBottom:4,scrollBehavior:"smooth",scrollbarWidth:"none",msOverflowStyle:"none"},className:"hide-scrollbar",children:[i.jsx(y.ZP,{size:"middle",type:null===m?"primary":"default",onClick:()=>L(null),style:{borderRadius:20,minWidth:70,border:null===m?"none":`1px solid ${I._A.border}`},children:"ทั้งหมด"}),h.map(e=>i.jsx(y.ZP,{size:"middle",type:m===e.id?"primary":"default",onClick:()=>L(e.id),style:{borderRadius:20,border:m===e.id?"none":`1px solid ${I._A.border}`},children:e.display_name||e.category_name},e.id))]})]}),(0,i.jsxs)("div",{style:{maxHeight:"calc(100vh - 180px)",overflowY:"auto",paddingBottom:20},className:"order-detail-content",children:[i.jsx("div",{style:I.m4.productGrid,className:"product-grid",children:d.map(e=>(0,i.jsxs)("div",{style:I.m4.productCard,onClick:()=>M(e),className:"product-card-hoverable scale-in",children:[i.jsx("div",{style:{position:"relative",width:"100%",height:130,background:I._A.backgroundSecondary},children:e.img_url?i.jsx(i.Fragment,{children:i.jsx(D.default,{alt:e.display_name,src:e.img_url,fill:!0,style:{objectFit:"cover",borderRadius:"12px 12px 0 0"},sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"})}):i.jsx("div",{style:I.m4.productPlaceholder,children:i.jsx(V.Z,{style:{fontSize:28,opacity:.3}})})}),(0,i.jsxs)("div",{style:I.m4.productInfo,className:"product-info",children:[i.jsx("div",{style:{...I.m4.productName},className:"product-name",children:e.display_name}),i.jsx(ee,{style:{...I.m4.productPrice},className:"product-price",children:(0,H.xG)(e.price)})]})]},e.id))}),0===d.length&&i.jsx(c.Z,{description:"ไม่พบสินค้าที่คุณต้องการ",style:{marginTop:60,padding:"40px 20px"}})]})]})]})};var ei=r(30278);let{Text:es,Title:ea}=o.default,{TextArea:en}=Y.default,el=({item:e,isOpen:t,onClose:r,onSave:s})=>{let[a,l]=(0,n.useState)(1),[o,c]=(0,n.useState)(""),[p,m]=(0,n.useState)([]),x=(0,n.useRef)(null),{showLoading:g,hideLoading:f}=(0,J.x)();(0,n.useEffect)(()=>{if(e&&t){let t=e.id;t!==x.current&&(l(e.quantity),c(e.notes||""),m(e.details?[...e.details.map(e=>({detail_name:e.detail_name,extra_price:e.extra_price}))]:[]),x.current=t)}},[e,t]),(0,n.useEffect)(()=>{t||(x.current=null,l(1),c(""),m([]))},[t]);let j=(0,n.useCallback)(async()=>{if(e)try{g("กำลังบันทึกแก้ไข...");let t=p.filter(e=>e.detail_name&&""!==e.detail_name.trim());await s(e.id,a,o,t)}catch(e){console.error(e),d.ZP.error("บันทึกรายการไม่สำเร็จ")}finally{f()}},[e,a,o,p,s,g,f]),v=(0,n.useCallback)(()=>{l(e=>e+1)},[]),S=(0,n.useCallback)(()=>{l(e=>Math.max(1,e-1))},[]),k=(0,n.useCallback)(()=>{m(e=>[...e,{detail_name:"",extra_price:0}])},[]),Z=(0,n.useCallback)(e=>{m(t=>t.filter((t,r)=>r!==e))},[]),P=(0,n.useCallback)((e,t,r)=>{m(i=>{let s=[...i];return s[e]={...s[e],[t]:r},s})},[]);return e?(0,i.jsxs)(W.Z,{className:"mobile-fullscreen-modal",title:null,open:t,onCancel:r,footer:null,width:500,destroyOnHidden:!0,centered:!0,closable:!1,children:[(0,i.jsxs)("div",{style:I.il.modalHeader,className:"modal-header",children:[i.jsx(es,{strong:!0,style:{fontSize:18,flex:1,color:I._A.text,lineHeight:1.4},children:"แก้ไขรายการ"}),i.jsx(y.ZP,{type:"text",icon:i.jsx(z.Z,{}),onClick:r,"aria-label":"ปิด",style:{height:44,width:44,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:12,color:I._A.textSecondary,background:I._A.backgroundSecondary,border:`1px solid ${I._A.border}`},className:"scale-hover"})]}),(0,i.jsxs)("div",{style:{padding:"20px",maxHeight:"calc(100vh - 200px)",overflowY:"auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:16,marginBottom:24,alignItems:"center",background:I._A.backgroundSecondary,padding:16,borderRadius:16},children:[i.jsx("div",{style:{flexShrink:0},children:e.product?.img_url?i.jsx(D.default,{src:e.product.img_url,alt:e.product?.display_name??"สินค้า",width:80,height:80,style:{borderRadius:14,objectFit:"cover",border:`1px solid ${I._A.borderLight}`}}):i.jsx("div",{style:{width:80,height:80,borderRadius:14,background:`linear-gradient(135deg, ${I._A.primaryLight} 0%, #DBEAFE 100%)`,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(_.Z,{style:{fontSize:28,color:I._A.primary,opacity:.5}})})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[i.jsx(ea,{level:5,style:{margin:0,fontSize:18,color:I._A.text},children:e.product?.display_name||"ไม่ระบุ"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6},children:[e.product?.category?.display_name&&i.jsx(h.Z,{color:"cyan",style:{fontSize:11,margin:0,borderRadius:6,fontWeight:500},children:e.product.category.display_name}),i.jsx(es,{style:{fontSize:16,fontWeight:600,color:I._A.primary},children:(0,H.xG)(e.price)})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[i.jsx(es,{strong:!0,style:{fontSize:16,color:I._A.text},children:"รายการเพิ่มเติม (Topping)"}),i.jsx(y.ZP,{type:"text",icon:i.jsx(N.Z,{style:{fontSize:12}}),onClick:k,style:{borderRadius:12,background:I._A.primaryLight,color:I._A.primary,fontWeight:600,fontSize:13,height:36,padding:"0 16px",border:`1px solid ${I._A.primary}30`,display:"flex",alignItems:"center",justifyContent:"center"},className:"scale-hover",children:"เพิ่มรายการ"})]}),0===p.length?i.jsx("div",{style:{textAlign:"center",padding:"16px",background:I._A.backgroundSecondary,borderRadius:12,border:`1px dashed ${I._A.border}`},children:i.jsx(es,{type:"secondary",style:{fontSize:13},children:"ไม่มีรายการเพิ่มเติม"})}):i.jsx(u.Z,{direction:"vertical",style:{width:"100%"},size:12,children:p.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center",padding:"12px 14px",background:I._A.backgroundSecondary,borderRadius:12,border:`1px solid ${I._A.border}`},children:[i.jsx(Y.default,{placeholder:"รายการ",value:e.detail_name,onChange:e=>P(t,"detail_name",e.target.value),style:{flex:2,borderRadius:10,height:44,fontSize:15}}),i.jsx(G.Z,{placeholder:"ราคา",value:e.extra_price,onChange:e=>P(t,"extra_price",e||0),style:{flex:1,borderRadius:10,height:44,fontSize:15},inputMode:"decimal",controls:!1,min:0,precision:2,formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),onKeyDown:t=>{/^[0-9]$/.test(t.key)||["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter","."].includes(t.key)||t.preventDefault(),"."===t.key&&e.extra_price.toString().includes(".")&&t.preventDefault()}}),i.jsx(y.ZP,{danger:!0,type:"text",icon:i.jsx(w.Z,{}),onClick:()=>Z(t),style:{color:I._A.danger,borderRadius:10,width:44,height:44},className:"scale-hover"})]},t))})]}),i.jsx(b.Z,{style:{margin:"0 0 20px 0"}}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[i.jsx(es,{strong:!0,style:{display:"block",marginBottom:14,fontSize:16,color:I._A.text},children:"ปรับจำนวน"}),(0,i.jsxs)("div",{style:I.il.quantityControl,className:"quantity-control",children:[i.jsx(y.ZP,{type:"primary",icon:i.jsx(K.Z,{}),onClick:S,disabled:a<=1,style:{...I.il.quantityButton,background:I._A.white,color:I._A.primary,border:`2px solid ${I._A.primary}`},className:"scale-hover quantity-button"}),i.jsx("div",{style:I.il.quantityDisplay,className:"quantity-display",children:a}),i.jsx(y.ZP,{type:"primary",icon:i.jsx(N.Z,{}),onClick:v,style:{...I.il.quantityButton,background:`linear-gradient(135deg, ${I._A.primary} 0%, ${I._A.primaryDark} 100%)`,border:"none"},className:"scale-hover quantity-button"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:24},children:[i.jsx(es,{strong:!0,style:{display:"block",marginBottom:10,fontSize:16,color:I._A.text},children:"หมายเหตุ / คำแนะนำพิเศษ"}),i.jsx(en,{value:o,onChange:e=>c(e.target.value),placeholder:"เช่น หวานน้อย, ไม่ใส่น้ำตาล...",rows:3,style:{borderRadius:12,padding:"12px 14px",fontSize:15,lineHeight:1.5}})]}),(0,i.jsxs)("div",{style:I.il.priceCard,children:[i.jsx(es,{strong:!0,style:{fontSize:16,color:I._A.text},children:"ยอดรวมรายการนี้"}),(0,i.jsxs)(ea,{level:4,style:{margin:0,color:I._A.priceTotal,fontSize:22},children:["฿",(0,H.ku)(Number(e.price),a,p).toLocaleString()]})]})]}),(0,i.jsxs)("div",{style:I.il.actionButtons,className:"action-buttons",children:[i.jsx(y.ZP,{onClick:r,style:I.il.secondaryButton,className:"scale-hover secondary-button",children:"ยกเลิก"}),i.jsx(y.ZP,{type:"primary",onClick:j,icon:i.jsx(ei.Z,{}),style:I.il.primaryButton,className:"scale-hover primary-button",children:"บันทึกแก้ไข"})]})]},e?.id||"edit-modal"):null};var eo=r(4106),ed=r(67355),ec=r(3548),eu=r(80440),eh=r(54354),ep=r(13778),ey=r(43822);let{Title:em,Text:ex}=o.default;function eg(){let e=(0,l.useRouter)(),t=(0,l.useParams)(),r=Array.isArray(t?.ordersId)?t.ordersId[0]:t?.ordersId,[s,o]=(0,n.useState)(null),[E,D]=(0,n.useState)(!0),[F,W]=(0,n.useState)(!1),{showLoading:Y,hideLoading:G}=(0,J.x)(),{socket:Q}=(0,eu.s)(),V=(0,ed.L)(),{queue:K,addToQueue:U,removeFromQueue:X,isLoading:ee}=(0,ep.G)(),et=s?K.find(e=>e.order_id===s.id):null,[ei,es]=(0,n.useState)([]),[ea,en]=(0,n.useState)(!1),[eg,ef]=(0,n.useState)(null),[ej,eb]=(0,n.useState)(!1),[ev,e_]=(0,n.useState)({open:!1,type:"confirm",title:"",content:"",onOk:()=>{}}),eS=()=>e_(e=>({...e,open:!1})),ek=(0,n.useCallback)(async t=>{try{D(!0),Y("กำลังโหลดข้อมูลออเดอร์...");let r=await O.x.getById(t);if([q.i.Paid,q.i.Cancelled,q.i.WaitingForPayment].includes(r.status)){let t=(0,H.EO)(r);e.push(t);return}o(r)}catch{d.ZP.error("ไม่สามารถโหลดข้อมูลออเดอร์ได้")}finally{D(!1),G()}},[e,Y,G]);(0,eh.D)({socket:Q,events:["orders:update","orders:delete","orders:create","payments:create","payments:update"],onRefresh:()=>{r&&ek(r)},intervalMs:15e3,enabled:!!r});let ew=async e=>{try{W(!0),Y("กำลังดำเนินการเสิร์ฟ...");let t=await (0,R.P)();await O.x.updateItemStatus(e,q.i.Served,void 0,t),d.ZP.success("เสิร์ฟรายการเรียบร้อย"),ek(r)}catch{d.ZP.error("เกิดข้อผิดพลาดในการเสิร์ฟ")}finally{W(!1),G()}},ez=async()=>{if(0!==ei.length)try{W(!0),Y(`กำลังดำเนินการเสิร์ฟ ${ei.length} รายการ...`);let e=await (0,R.P)();await Promise.all(ei.map(t=>O.x.updateItemStatus(t.toString(),q.i.Served,void 0,e))),d.ZP.success("เสิร์ฟรายการที่เลือกเรียบร้อย"),es([]),ek(r)}catch{d.ZP.error("เกิดข้อผิดพลาดในการเสิร์ฟ")}finally{W(!1),G()}},eZ=async()=>{0!==ei.length&&e_({open:!0,type:"danger",title:"ยืนยันการยกเลิก",content:`คุณต้องการยกเลิก ${ei.length} รายการที่เลือกใช่หรือไม่?`,okText:"ยืนยันยกเลิก",cancelText:"ไม่ยกเลิก",onOk:async()=>{try{W(!0),Y("กำลังดำเนินการยกเลิก..."),eS();let e=await (0,R.P)();await Promise.all(ei.map(t=>O.x.updateItemStatus(t.toString(),q.i.Cancelled,void 0,e))),d.ZP.success("ยกเลิกรายการที่เลือกเรียบร้อย"),es([]),ek(r)}catch{d.ZP.error("เกิดข้อผิดพลาดในการยกเลิก")}finally{W(!1),G()}}})},eP=async e=>{try{W(!0),Y("กำลังย้อนกลับสถานะ...");let t=await (0,R.P)();await O.x.updateItemStatus(e,q.i.Cooking,void 0,t),d.ZP.success("ยกเลิกการเสิร์ฟ (กลับไปปรุง)"),ek(r)}finally{W(!1),G()}},eC=async e=>{e_({open:!0,type:"danger",title:"ยืนยันการลบ",content:"คุณต้องการลบรายการสินค้านี้ใช่หรือไม่?",okText:"ลบ",cancelText:"ยกเลิก",onOk:async()=>{try{W(!0),Y("กำลังลบรายการ..."),eS();let t=await (0,R.P)();await O.x.deleteItem(e,void 0,t),d.ZP.success("ลบรายการเรียบร้อย"),ek(r)}catch{d.ZP.error("ไม่สามารถลบรายการได้")}finally{W(!1),G()}}})},eA=async(e,t,i,s=[])=>{try{W(!0),Y("กำลังบันทึกข้อมูล...");let a=await (0,R.P)();if(!t||t<1)throw d.ZP.error("จำนวนต้องมากกว่า 0"),Error("Invalid quantity");let n={quantity:Number(t),notes:String(i||""),details:Array.isArray(s)?s.map(e=>({detail_name:String(e.detail_name||""),extra_price:Number(e.extra_price||0)})):[]};await O.x.updateItem(e,n,void 0,a),d.ZP.success("แก้ไขรายการเรียบร้อย"),en(!1),ef(null),en(!1),ef(null),await new Promise(e=>setTimeout(e,600)),await ek(r),setTimeout(async()=>{let i=await O.x.getById(r),s=i?.items?.find(t=>t.id===e);s&&(s.quantity===t?o(i):setTimeout(async()=>{await ek(r)},1e3))},500)}catch(e){throw d.ZP.error("ไม่สามารถแก้ไขรายการได้"),e}finally{W(!1),G()}},eB=e=>{ef(e),en(!0)},eN=async(e,t,i,s=[])=>{let a=(Number(e.price)+s.reduce((e,t)=>e+t.extra_price,0))*t;if(!V){ec.x.addToQueue("ADD_ITEM",{orderId:r,itemData:{product_id:e.id,quantity:t,price:e.price,notes:i,discount_amount:0,total_price:a,details:s}}),d.ZP.warning("บันทึกข้อมูลแบบ Offline แล้ว"),ek(r);return}try{W(!0),Y("กำลังเพิ่มสินค้า...");let n=await (0,R.P)();await O.x.addItem(r,{product_id:e.id,quantity:t,price:e.price,notes:i,discount_amount:0,total_price:a,details:s,status:q.i.Cooking},void 0,n),d.ZP.success("เพิ่มสินค้าเรียบร้อย"),ek(r)}catch(e){throw d.ZP.error("เพิ่มสินค้าไม่สำเร็จ"),e}finally{W(!1),G()}},eT=async()=>{let t=s?.order_type===q.m.Delivery;e_({open:!0,type:"success",title:t?"ยืนยันจัดออเดอร์เสร็จสิ้น":`ยืนยันการ${(0,H.qO)(s?.order_type)}ทั้งหมด`,content:t?"จัดเตรียมอาหารเรียบร้อยแล้ว ต้องการส่งมอบให้ไรเดอร์หรือไม่?":"รายการทั้งหมดเสร็จสิ้นแล้ว ต้องการเข้าสู่ขั้นตอนการชำระเงินหรือไม่?",okText:"ยืนยัน",cancelText:"ยกเลิก",onOk:async()=>{try{W(!0),Y("กำลังยืนยันรายการ..."),eS();let t=await (0,R.P)();if(await O.x.updateStatus(r,q.i.WaitingForPayment,t),d.ZP.success("ยืนยันออเดอร์เรียบร้อย"),s){let t=(0,H.EO)(s);e.push(t)}else e.push("/pos/orders")}catch{d.ZP.error("เกิดข้อผิดพลาดในการยืนยัน")}finally{W(!1),G()}}})};if(E&&!s)return null;if(!s)return i.jsx(c.Z,{description:"ไม่พบข้อมูล"});let eO=[{title:"",key:"image",width:70,align:"center",render:(e,t)=>t.product?.img_url?i.jsx(i.Fragment,{children:i.jsx("img",{src:t.product.img_url,alt:t.product?.display_name??"สินค้า",style:I.B9.productThumb})}):i.jsx("div",{style:I.B9.productThumbPlaceholder,children:i.jsx(v.Z,{})})},{title:"รายการ",key:"product",align:"center",render:(e,t)=>(0,i.jsxs)(u.Z,{orientation:"vertical",size:2,align:"center",children:[i.jsx(ex,{strong:!0,style:{fontSize:15,lineHeight:"1.2"},children:t.product?.display_name}),t.details&&t.details.length>0&&i.jsx("div",{style:{fontSize:13,color:I._A.served,textAlign:"center"},children:t.details.map((e,t)=>(0,i.jsxs)("div",{style:{lineHeight:"1.4"},children:["+ ",e.detail_name]},t))}),t.notes&&(0,i.jsxs)(ex,{style:{fontSize:13,color:I._A.cancelled},children:[i.jsx(_.Z,{})," ",t.notes]})]})},{title:"หมวดหมู่",key:"category",width:120,align:"center",render:(e,t)=>i.jsx(u.Z,{orientation:"vertical",size:0,align:"center",children:t.product?.category?.display_name?i.jsx(h.Z,{color:"cyan",style:I.B9.categoryTag,children:t.product.category.display_name}):"-"})},{title:"ราคา",key:"price",width:110,align:"center",render:(e,t)=>(0,i.jsxs)(u.Z,{orientation:"vertical",size:0,align:"center",children:[(0,i.jsxs)(ex,{style:{...I.B9.priceTag,fontSize:18},children:["฿",Number(t.price).toLocaleString()]}),t.details&&t.details.length>0&&t.details.map((e,t)=>(0,i.jsxs)(ex,{style:{fontSize:13,color:I._A.priceTotal,display:"block",lineHeight:"1.4"},children:["+ ฿",Number(e.extra_price).toLocaleString()]},t))]})},{title:"สถานะ",dataIndex:"status",key:"status",width:120,align:"center",render:e=>i.jsx(h.Z,{color:e===q.i.Pending?"orange":e===q.i.Cooking?"blue":"green",children:(0,H.d7)(e,s.order_type)})},{title:"จำนวน",dataIndex:"quantity",key:"quantity",width:80,align:"center",render:e=>(0,i.jsxs)(ex,{strong:!0,style:{fontSize:16},children:["x",e]})},{title:"จัดการ",key:"actions",width:130,align:"right",render:(e,t)=>(0,i.jsxs)(u.Z,{children:[i.jsx(p.Z,{title:(0,H.qO)(s.order_type),children:(0,i.jsxs)(y.ZP,{type:"primary",onClick:()=>ew(t.id),style:{background:I._A.served,borderColor:I._A.served,height:"auto",padding:"4px 8px",display:"flex",flexDirection:"column",alignItems:"center",gap:2,minWidth:60,borderRadius:10},children:[i.jsx(S.Z,{style:{fontSize:16}}),i.jsx("span",{style:{fontSize:10,fontWeight:700},children:(0,H.qO)(s.order_type)})]})}),i.jsx(p.Z,{title:"แก้ไข",children:i.jsx(y.ZP,{type:"text",icon:i.jsx(k.Z,{}),onClick:()=>eB(t)})}),i.jsx(p.Z,{title:"ลบ",children:i.jsx(y.ZP,{type:"text",danger:!0,icon:i.jsx(w.Z,{}),onClick:()=>eC(t.id)})})]})}],eR=[{title:"",key:"image",width:70,align:"center",render:(e,t)=>t.product?.img_url?i.jsx(i.Fragment,{children:i.jsx("img",{src:t.product.img_url,alt:t.product?.display_name??"สินค้า",style:{...I.B9.productThumb,opacity:.7}})}):i.jsx("div",{style:I.B9.productThumbPlaceholder,children:i.jsx(v.Z,{})})},{title:"รายการ",key:"product",align:"center",render:(e,t)=>(0,i.jsxs)(u.Z,{orientation:"vertical",size:2,align:"center",children:[i.jsx(ex,{strong:!0,style:{fontSize:15,lineHeight:"1.2",textDecoration:t.status===q.i.Cancelled?"line-through":"none",color:t.status===q.i.Cancelled?I._A.textLight:I._A.text},children:t.product?.display_name}),t.details&&t.details.length>0&&i.jsx("div",{style:{fontSize:12,color:I._A.served,opacity:.7,textAlign:"center"},children:t.details.map((e,t)=>(0,i.jsxs)("div",{style:{lineHeight:"1.4"},children:["+ ",e.detail_name]},t))}),t.notes&&(0,i.jsxs)(ex,{style:{fontSize:12,opacity:.7,color:I._A.cancelled},children:[i.jsx(_.Z,{})," ",t.notes]})]})},{title:"หมวดหมู่",key:"category",width:120,align:"center",render:(e,t)=>i.jsx(u.Z,{orientation:"vertical",size:0,align:"center",children:t.product?.category?.display_name?i.jsx(h.Z,{color:"cyan",style:{...I.B9.categoryTag,opacity:.7},children:t.product.category.display_name}):"-"})},{title:"ราคา",key:"price",width:110,align:"center",render:(e,t)=>(0,i.jsxs)(u.Z,{orientation:"vertical",size:0,align:"center",children:[(0,i.jsxs)(ex,{style:{...I.B9.priceTag,opacity:.7},children:["฿",Number(t.price).toLocaleString()]}),t.details&&t.details.length>0&&t.details.map((e,t)=>(0,i.jsxs)(ex,{style:{fontSize:11,opacity:.7,color:I._A.priceTotal,display:"block",lineHeight:"1.4"},children:["+ ฿",Number(e.extra_price).toLocaleString()]},t))]})},{title:"ราคารวม",key:"total",width:120,align:"center",render:(e,t)=>(0,i.jsxs)(ex,{strong:!0,style:{color:t.status===q.i.Cancelled?I._A.textLight:I._A.priceTotal,fontSize:16,textDecoration:t.status===q.i.Cancelled?"line-through":"none"},children:["฿",Number(t.total_price).toLocaleString()]})},{title:"สถานะ",dataIndex:"status",key:"status",width:120,align:"center",render:e=>i.jsx(h.Z,{color:(0,H.OY)(e),children:(0,H.d7)(e,s.order_type)})},{title:"จำนวน",dataIndex:"quantity",key:"quantity",width:80,align:"center",render:e=>(0,i.jsxs)(ex,{strong:!0,style:{fontSize:16},children:["x",e]})},{title:"จัดการ",key:"actions",width:130,align:"right",render:(e,t)=>t.status===q.i.Served?i.jsx(y.ZP,{size:"small",className:"unserve-button",style:I.B9.unserveButton,icon:i.jsx(z.Z,{}),onClick:()=>eP(t.id),children:s.order_type===q.m.DineIn?"ยกเลิกเสิร์ฟ":"ยกเลิกปรุงเสร็จ"}):null}],eL=s.items?.filter(e=>e.status===q.i.Pending||e.status===q.i.Cooking)||[],eq=(s.items?.filter(e=>e.status===q.i.Served||e.status===q.i.Cancelled||e.status===q.i.WaitingForPayment)||[]).sort((e,t)=>e.status===q.i.Cancelled&&t.status!==q.i.Cancelled?1:e.status!==q.i.Cancelled&&t.status===q.i.Cancelled?-1:0),eM=(0,H.Nz)(s.items),eI=(0,H.yj)(s.items),eH=0===eL.length&&(s.items?.length||0)>0,eE=eL.length>12,e$=eq.length>12;return(0,i.jsxs)("div",{style:I.B9.container,className:"order-detail-page",children:[i.jsx(a(),{id:I.$k.__hash,children:I.$k}),i.jsx("header",{style:I.B9.header,className:"order-detail-header",children:(0,i.jsxs)("div",{style:I.B9.headerContent,className:"header-content",children:[i.jsx(y.ZP,{type:"text",icon:i.jsx(Z.Z,{}),onClick:()=>{s?.order_type===q.m.DineIn?e.push("/pos/channels/dine-in"):e.back()},"aria-label":"กลับ",style:I.B9.headerBackButton,className:"scale-hover header-back-button"}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap",marginBottom:4},children:[i.jsx(em,{level:4,style:I.B9.headerTitle,className:"header-title",children:s.order_no}),s.order_type===q.m.DineIn&&s.table&&(0,i.jsxs)(h.Z,{style:I.B9.tableNameBadge,children:["\uD83E\uDE91 โต๊ะ ",s.table.table_name]}),s.order_type===q.m.Delivery&&s.delivery_code&&(0,i.jsxs)(h.Z,{style:I.B9.tableNameBadge,children:["\uD83D\uDCCB ",s.delivery_code]}),i.jsx(h.Z,{color:(0,H.OY)(s.status),className:"status-badge",style:{margin:0,fontSize:12,fontWeight:600,borderRadius:8,padding:"4px 12px",lineHeight:1.3},children:(0,H.d7)(s.status,s.order_type)})]}),(0,i.jsxs)("div",{style:I.B9.headerMetaRow,children:[i.jsx(h.Z,{icon:s.order_type===q.m.DineIn?i.jsx(v.Z,{style:{fontSize:10}}):s.order_type===q.m.TakeAway?i.jsx(P.Z,{style:{fontSize:10}}):i.jsx(C.Z,{style:{fontSize:10}}),style:{...I.B9.channelBadge,background:(0,H.Gs)(s.order_type)+"15",color:(0,H.Gs)(s.order_type)},children:(0,H.mz)(s.order_type)}),i.jsx("div",{style:I.B9.headerMetaSeparator}),i.jsx(ex,{type:"secondary",style:{fontSize:11,lineHeight:1.2},children:$()(s.create_date).format("HH:mm | D MMM YY")}),et&&(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{style:I.B9.headerMetaSeparator}),(0,i.jsxs)(h.Z,{color:et.status===ey.l.Pending?"orange":et.status===ey.l.Processing?"blue":et.status===ey.l.Completed?"green":"red",style:{margin:0,fontSize:11,borderRadius:6,padding:"3px 10px",lineHeight:1.3},children:["คิว #",et.queue_position]})]})]})]})]})}),s&&s.status!==q.i.Cancelled&&s.status!==q.i.Completed&&i.jsx("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"flex-end",gap:8,background:I._A.backgroundSecondary,borderBottom:`1px solid ${I._A.border}`},children:et?i.jsx(y.ZP,{danger:!0,icon:i.jsx(w.Z,{}),onClick:()=>{X(et.id)},loading:ee,size:"middle",style:{borderRadius:10,height:36,fontWeight:500,fontSize:13},className:"scale-hover queue-action-button",children:"ลบออกจากคิว"}):i.jsx(y.ZP,{type:"primary",icon:i.jsx(A.Z,{}),onClick:()=>{U({orderId:s.id,priority:ey.t.Normal})},loading:ee,size:"middle",style:{borderRadius:10,height:36,fontWeight:500,fontSize:13,background:`linear-gradient(135deg, ${I._A.primary} 0%, ${I._A.primaryDark} 100%)`,border:"none",boxShadow:`0 2px 8px ${I._A.primary}25`},className:"scale-hover queue-action-button",children:"เพิ่มเข้าคิว"})}),i.jsx("main",{style:I.B9.contentWrapper,className:"order-detail-content",children:(0,i.jsxs)(m.Z,{gutter:[20,20],children:[(0,i.jsxs)(x.Z,{xs:24,lg:16,children:[i.jsx(g.Z,{className:"order-detail-card fade-in",style:I.B9.card,title:(0,i.jsxs)("div",{className:"card-header-wrapper",children:[(0,i.jsxs)("div",{className:"card-header-top-row",children:[(0,i.jsxs)("div",{className:"card-header-left",children:[i.jsx("div",{style:I.B9.masterCheckboxWrapper,children:i.jsx(f.Z,{indeterminate:ei.length>0&&ei.length<eL.length,checked:eL.length>0&&ei.length===eL.length,onChange:e=>{e.target.checked?es(eL.map(e=>e.id)):es([])},style:I.B9.masterCheckbox})}),(0,i.jsxs)(ex,{strong:!0,style:I.Qo.sectionTitle,className:"section-title-text",children:["กำลังทำอาหาร (",eL.length,")"]})]}),i.jsx("div",{className:"card-header-right",children:(0,i.jsxs)("div",{className:"header-actions-container",children:[i.jsx(y.ZP,{icon:i.jsx(B.Z,{}),onClick:()=>ek(r),size:"small",style:I.B9.actionButtonSecondary,className:"header-action-btn",title:"รีเฟรช"}),i.jsx(y.ZP,{type:"primary",icon:i.jsx(N.Z,{}),onClick:()=>eb(!0),size:"small",style:I.B9.actionButtonPrimary,className:"header-action-btn",children:i.jsx("span",{children:"เพิ่ม"})})]})})]}),ei.length>0&&(0,i.jsxs)("div",{className:"bulk-actions-container",children:[i.jsx(y.ZP,{danger:!0,icon:i.jsx(w.Z,{}),onClick:eZ,size:"small",className:"bulk-action-btn",children:(0,i.jsxs)("span",{children:["ยกเลิก (",ei.length,")"]})}),i.jsx(y.ZP,{type:"primary",icon:i.jsx(S.Z,{}),onClick:ez,loading:F,size:"small",style:{background:I._A.served,borderColor:I._A.served},className:"bulk-action-btn",children:(0,i.jsxs)("span",{children:[(0,H.qO)(s.order_type)," (",ei.length,")"]})})]})]}),children:eL.length>0?(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:"order-detail-table-desktop",children:i.jsx(j.Z,{dataSource:eL,columns:eO,rowKey:"id",virtual:eE,scroll:eE?{y:420}:void 0,pagination:!1,size:"middle",className:"order-items-table",rowSelection:{selectedRowKeys:ei,onChange:e=>{es(e)},hideSelectAll:!0}})}),i.jsx("div",{className:"order-detail-cards-mobile",children:eL.map(e=>(0,i.jsxs)("div",{style:{...I.B9.itemCard,...I.B9.itemCardActive},className:"order-item-card scale-in",children:[(0,i.jsxs)("div",{style:{display:"flex",gap:10,marginBottom:10},children:[i.jsx("div",{style:{flexShrink:0},children:e.product?.img_url?i.jsx(i.Fragment,{children:i.jsx("img",{src:e.product.img_url,alt:e.product?.display_name??"สินค้า",style:{...I.B9.productThumb,width:56,height:56,borderRadius:10}})}):i.jsx("div",{style:{...I.B9.productThumbPlaceholder,width:56,height:56,borderRadius:10},children:i.jsx(v.Z,{style:{fontSize:20}})})}),(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,i.jsxs)("div",{style:{flex:1,minWidth:0},children:[i.jsx(f.Z,{checked:ei.includes(e.id),onChange:t=>{es(t.target.checked?[...ei,e.id]:ei.filter(t=>t!==e.id))},children:i.jsx(ex,{strong:!0,style:{fontSize:17,lineHeight:1.5},children:e.product?.display_name})}),i.jsx("div",{style:{paddingLeft:24,marginTop:2},children:e.product?.category?.display_name&&i.jsx(h.Z,{color:"cyan",style:{...I.B9.categoryTag,fontSize:9},children:e.product.category.display_name})})]}),(0,i.jsxs)(ex,{strong:!0,style:{fontSize:19,color:I._A.primary,marginLeft:8,lineHeight:1.4},children:["x",e.quantity]})]}),(0,i.jsxs)("div",{style:{paddingLeft:24,marginTop:2},children:[e.details&&e.details.length>0&&i.jsx("div",{style:{fontSize:13,color:I._A.served,marginBottom:4,lineHeight:1.4},children:e.details.map(e=>`${e.detail_name} (+ ฿${Number(e.extra_price).toLocaleString()})`).join(", ")}),i.jsx(u.Z,{orientation:"vertical",size:2,children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.jsxs)(ex,{style:{...I.B9.priceTag,fontSize:15},children:["฿",Number(e.price).toLocaleString()]}),(0,i.jsxs)(ex,{strong:!0,style:{color:I._A.priceTotal,fontSize:16},children:["รวม ฿",Number(e.total_price).toLocaleString()]})]})}),e.notes&&i.jsx("div",{style:{marginTop:4},children:(0,i.jsxs)(ex,{style:{fontSize:13,color:I._A.cancelled,lineHeight:1.4},children:[i.jsx(_.Z,{style:{fontSize:13}})," ",e.notes]})})]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",borderTop:`1px solid ${I._A.border}`,paddingTop:10,gap:6,marginTop:10},children:[i.jsx(y.ZP,{size:"small",type:"text",danger:!0,icon:i.jsx(w.Z,{}),onClick:()=>eC(e.id),style:{height:34,borderRadius:8,fontSize:13,padding:"0 12px",fontWeight:500},className:"scale-hover",children:"ลบ"}),i.jsx(y.ZP,{size:"small",type:"text",icon:i.jsx(k.Z,{}),onClick:()=>eB(e),style:{height:34,borderRadius:8,fontSize:13,padding:"0 12px",fontWeight:500},className:"scale-hover",children:"แก้ไข"}),(0,i.jsxs)(y.ZP,{size:"small",type:"primary",onClick:()=>ew(e.id),style:{background:I._A.served,borderColor:I._A.served,height:34,padding:"0 14px",borderRadius:8,fontSize:13,fontWeight:600},className:"scale-hover",children:[i.jsx(S.Z,{style:{fontSize:13,marginRight:4}}),(0,H.qO)(s.order_type)]})]})]},e.id))})]}):(0,i.jsxs)("div",{style:I.B9.emptyState,children:[i.jsx(T.Z,{className:"empty-state-icon"}),i.jsx(ex,{className:"empty-state-text",children:"ไม่มีรายการที่กำลังรอ"})]})}),i.jsx(g.Z,{className:"order-detail-card fade-in",style:I.B9.card,title:(0,i.jsxs)(ex,{strong:!0,style:{...I.Qo.sectionTitle,color:I._A.textSecondary},children:[(0,H.zP)(s.order_type)," (",eq.length,")"]}),children:eq.length>0?(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:"order-detail-table-desktop",children:i.jsx(j.Z,{dataSource:eq,columns:eR,rowKey:"id",virtual:e$,scroll:e$?{y:360}:void 0,pagination:!1,size:"small",className:"order-items-table",rowClassName:e=>e.status===q.i.Cancelled?"row-cancelled":""})}),i.jsx("div",{className:"order-detail-cards-mobile",children:eq.map(e=>(0,i.jsxs)("div",{style:{...I.B9.itemCard,...I.B9.itemCardServed,backgroundColor:e.status===q.i.Cancelled?I._A.cancelledLight:I._A.white,borderColor:e.status===q.i.Cancelled?I._A.cancelled+"30":I._A.border,position:"relative"},children:[i.jsx("div",{style:{position:"absolute",top:10,right:10},children:i.jsx(h.Z,{color:(0,H.OY)(e.status),style:{margin:0,fontSize:10,padding:"2px 8px",borderRadius:6,lineHeight:1.2},children:(0,H.d7)(e.status,s.order_type)})}),(0,i.jsxs)("div",{style:{display:"flex",gap:10},children:[i.jsx("div",{style:{flexShrink:0},children:e.product?.img_url?i.jsx(i.Fragment,{children:i.jsx("img",{src:e.product.img_url,alt:e.product?.display_name??"สินค้า",style:{...I.B9.productThumb,width:52,height:52,borderRadius:10,opacity:.7}})}):i.jsx("div",{style:{...I.B9.productThumbPlaceholder,width:52,height:52,borderRadius:10},children:i.jsx(v.Z,{style:{fontSize:18}})})}),i.jsx("div",{style:{flex:1,minWidth:0,paddingRight:50},children:i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:(0,i.jsxs)("div",{style:{flex:1},children:[i.jsx(ex,{strong:!0,style:{fontSize:16,textDecoration:e.status===q.i.Cancelled?"line-through":"none",color:e.status===q.i.Cancelled?I._A.textLight:I._A.text,lineHeight:1.5},children:e.product?.display_name}),i.jsx("div",{style:{marginTop:2},children:e.product?.category?.display_name&&i.jsx(h.Z,{color:"cyan",style:{...I.B9.categoryTag,fontSize:9},children:e.product.category.display_name})}),e.details&&e.details.length>0&&i.jsx("div",{style:{fontSize:13,color:I._A.served,opacity:.7,marginBottom:4,lineHeight:1.4},children:e.details.map(e=>`${e.detail_name} (+ ฿${Number(e.extra_price).toLocaleString()})`).join(", ")}),i.jsx(u.Z,{orientation:"vertical",size:2,style:{marginTop:4,width:"100%"},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)(ex,{style:{...I.B9.priceTag,fontSize:14,opacity:.7},children:["฿",Number(e.price).toLocaleString()]}),(0,i.jsxs)(ex,{strong:!0,style:{marginLeft:8,color:I._A.textSecondary,opacity:.7,fontSize:15},children:["รวม ฿",Number(e.total_price).toLocaleString()]})]}),(0,i.jsxs)(ex,{strong:!0,style:{color:I._A.textSecondary,fontSize:15},children:["x",e.quantity]})]})}),e.notes&&i.jsx("div",{style:{marginTop:4},children:(0,i.jsxs)(ex,{style:{fontSize:13,opacity:.7,color:I._A.cancelled,lineHeight:1.4},children:[i.jsx(_.Z,{style:{fontSize:13}})," ",e.notes]})})]})})})]}),e.status===q.i.Served&&i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10,paddingTop:10,borderTop:`1px solid ${I._A.border}`},children:i.jsx(y.ZP,{size:"small",className:"unserve-button",style:{...I.B9.unserveButton,height:34,fontSize:13,padding:"0 14px",borderRadius:8,fontWeight:500},icon:i.jsx(z.Z,{style:{fontSize:13}}),onClick:()=>eP(e.id),children:s?.order_type===q.m.DineIn?"ยกเลิกเสิร์ฟ":"ยกเลิกปรุงเสร็จ"})})]},e.id))})]}):i.jsx("div",{style:{textAlign:"center",padding:"20px 0"},children:i.jsx(ex,{type:"secondary",children:"ยังไม่มีรายการที่ดำเนินการแล้ว"})})})]}),i.jsx(x.Z,{xs:24,lg:8,children:(0,i.jsxs)(g.Z,{className:"order-detail-card summary-card",style:I.B9.summaryCard,children:[i.jsx(em,{level:5,style:{marginBottom:16,fontSize:18,fontWeight:600},children:"สรุปการสั่งซื้อ"}),(0,i.jsxs)("div",{style:{...I.B9.summaryList,background:"white"},children:[i.jsx(ex,{strong:!0,style:{fontSize:15,marginBottom:10,display:"block",color:I._A.textSecondary},children:"รายการสินค้า"}),eM.map((e,t)=>(0,i.jsxs)("div",{style:I.B9.summaryItemRow,children:[e.product?.img_url?i.jsx(i.Fragment,{children:i.jsx("img",{src:e.product.img_url,alt:e.product?.display_name||"สินค้า",style:I.B9.summaryItemImage})}):i.jsx("div",{style:{...I.B9.summaryItemImage,display:"flex",alignItems:"center",justifyContent:"center",background:"#f8fafc"},children:i.jsx(v.Z,{style:{fontSize:16,color:"#bfbfbf"}})}),(0,i.jsxs)("div",{style:I.B9.summaryItemContent,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[i.jsx(ex,{strong:!0,style:{fontSize:15,flex:1,lineHeight:1.4},children:e.product?.display_name}),(0,i.jsxs)(ex,{strong:!0,style:{fontSize:15,color:I._A.primary,lineHeight:1.4},children:["฿",Number(e.total_price).toLocaleString()]})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:4},children:[(0,i.jsxs)(ex,{type:"secondary",style:{fontSize:13,lineHeight:1.4},children:["จำนวน : ",e.quantity]}),(0,i.jsxs)(ex,{type:"secondary",style:{fontSize:13,lineHeight:1.4},children:["ราคา : ",Number(e.price).toLocaleString()]})]}),e.details&&e.details.length>0&&(0,i.jsxs)("div",{style:I.B9.summaryDetailText,children:[i.jsx(N.Z,{style:{fontSize:10}})," ",e.details.map(e=>`${e.detail_name} (+${Number(e.extra_price).toLocaleString()})`).join(", ")]}),e.notes&&(0,i.jsxs)("div",{style:{...I.B9.summaryDetailText,color:I._A.cancelled,fontStyle:"italic"},children:["โน้ต: ",e.notes]})]})]},e.id||t))]}),(0,i.jsxs)("div",{style:I.B9.summaryList,children:[i.jsx(ex,{strong:!0,style:{fontSize:15,marginBottom:10,display:"block",color:I._A.textSecondary},children:"แยกตามหมวดหมู่"}),Object.entries((0,H.Rr)(s?.items||[])).map(([e,t])=>(0,i.jsxs)("div",{style:I.B9.summaryRow,children:[i.jsx(ex,{type:"secondary",style:{fontSize:14,lineHeight:1.4},children:e}),(0,i.jsxs)(ex,{strong:!0,style:{fontSize:14,lineHeight:1.4},children:[String(t)," รายการ"]})]},e)),i.jsx(b.Z,{style:{margin:"10px 0"}}),(0,i.jsxs)("div",{style:I.B9.summaryRow,children:[i.jsx(ex,{type:"secondary",style:{fontSize:14,lineHeight:1.4},children:"จำนวนรายการทั้งหมด"}),(0,i.jsxs)(ex,{strong:!0,style:{fontSize:14,lineHeight:1.4},children:[eM.length," รายการ"]})]})]}),i.jsx("div",{style:{padding:"0 4px"},children:(0,i.jsxs)("div",{style:I.B9.summaryMainRow,children:[i.jsx(ex,{strong:!0,style:{fontSize:20,lineHeight:1.3},children:"ยอดรวมทั้งสิ้น"}),(0,i.jsxs)(ex,{strong:!0,style:{fontSize:28,color:I._A.primary,lineHeight:1.2},children:["฿",eI.toLocaleString()]})]})}),eH&&i.jsx(y.ZP,{type:"primary",block:!0,size:"large",onClick:eT,style:{marginTop:16,height:48,borderRadius:10,fontWeight:600,fontSize:16,background:`linear-gradient(135deg, ${I._A.served} 0%, #059669 100%)`,border:"none",boxShadow:`0 4px 12px ${I._A.served}25`},className:"scale-hover",children:(0,H.iN)(s.order_type)}),i.jsx(y.ZP,{danger:!0,block:!0,size:"large",onClick:()=>{s&&e_({open:!0,type:"danger",title:"ยืนยันการยกเลิกออเดอร์?",content:"การดำเนินการนี้จะยกเลิกสินค้าทุกรายการและคืนสถานะโต๊ะ (หากมี) คุณแน่ใจหรือไม่?",okText:"ยืนยันการยกเลิก",cancelText:"ยกเลิก",onOk:async()=>{try{W(!0),Y("กำลังดำเนินการยกเลิก..."),eS();let t=await (0,R.P)(),r=s.items?.filter(e=>e.status!==q.i.Cancelled)||[];await Promise.all(r.map(e=>O.x.updateItemStatus(e.id,q.i.Cancelled,void 0,t))),await O.x.updateStatus(s.id,q.i.Cancelled,t),s.table_id&&await L.$.update(s.table_id,{status:M.c.Available},void 0,t),d.ZP.success("ยกเลิกออเดอร์เรียบร้อย"),e.push((0,H.d$)(s.order_type))}catch{d.ZP.error("ไม่สามารถยกเลิกออเดอร์ได้")}finally{W(!1),G()}}})},style:{marginTop:12,height:44,borderRadius:10,fontWeight:500,fontSize:15,border:`1px solid ${I._A.danger}`},disabled:F,className:"scale-hover",children:"ยกเลิกออเดอร์"})]})})]})}),i.jsx(er,{isOpen:ej,onClose:()=>eb(!1),onAddItem:eN}),ea&&eg&&i.jsx(el,{item:eg,isOpen:ea,onClose:()=>{en(!1),ef(null)},onSave:eA},`edit-modal-${eg.id}`),i.jsx(eo.Z,{open:ev.open,type:ev.type,title:ev.title,content:ev.content,okText:ev.okText,cancelText:ev.cancelText,onOk:ev.onOk,onCancel:eS,loading:F})]})}$().locale("th")},4106:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var i=r(10326),s=r(77626),a=r.n(s),n=r(17577),l=r(58184),o=r(54547),d=r(75958),c=r(71935),u=r(9136),h=r(38815),p=r(56811),y=r(7059);let m={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 708c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40zm62.9-219.5a48.3 48.3 0 00-30.9 44.8V620c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-21.5c0-23.1 6.7-45.9 19.9-64.9 12.9-18.6 30.9-32.8 52.1-40.9 34-13.1 56-41.6 56-72.7 0-44.1-43.1-80-96-80s-96 35.9-96 80v7.6c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V420c0-39.3 17.2-76 48.4-103.3C430.4 290.4 470 276 512 276s81.6 14.5 111.6 40.7C654.8 344 672 380.7 672 420c0 57.8-38.1 109.8-97.1 132.5z"}}]},name:"question-circle",theme:"filled"};var x=r(74082);function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}).apply(this,arguments)}let f=n.forwardRef((e,t)=>n.createElement(x.Z,g({},e,{ref:t,icon:m}))),{Title:j,Text:b}=l.default,v=({open:e,type:t="confirm",title:r,content:s,okText:n="ยืนยัน",cancelText:l="ยกเลิก",onOk:m,onCancel:x,loading:g=!1,icon:v})=>{let _=()=>{switch(t){case"danger":return"#ff4d4f";case"warning":return"#faad14";case"success":return"#52c41a";default:return"#1890ff"}},S=_();return i.jsx(o.ZP,{theme:{components:{Modal:{contentBg:"#ffffff",headerBg:"#ffffff",borderRadiusLG:24},Button:{borderRadius:12,controlHeightLG:48,fontSizeLG:16,fontWeight:600}}},children:(0,i.jsxs)(d.Z,{open:e,onCancel:x,footer:null,centered:!0,width:360,closable:!1,styles:{mask:{backdropFilter:"blur(8px)",background:"rgba(0, 0, 0, 0.25)"}},className:"soft-confirm-modal",children:[(0,i.jsxs)("div",{style:{padding:"32px 24px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},className:"jsx-14a62d28233e1b8c",children:[i.jsx("div",{style:{marginBottom:20,width:80,height:80,borderRadius:"40%",backgroundColor:`${S}15`,display:"flex",alignItems:"center",justifyContent:"center",animation:"float 3s ease-in-out infinite"},className:"jsx-14a62d28233e1b8c",children:(()=>{if(v)return v;let e={fontSize:48,color:_()};switch(t){case"danger":return i.jsx(u.Z,{style:e});case"warning":return i.jsx(h.Z,{style:e});case"success":return i.jsx(p.Z,{style:e});case"info":return i.jsx(y.Z,{style:e});default:return i.jsx(f,{style:e})}})()}),i.jsx(j,{level:4,style:{marginBottom:12,fontWeight:700,color:"#1f1f1f"},children:r}),i.jsx("div",{style:{marginBottom:32,width:"100%"},className:"jsx-14a62d28233e1b8c",children:"string"==typeof s?i.jsx(b,{type:"secondary",style:{fontSize:16,lineHeight:1.6},children:s}):s}),(0,i.jsxs)("div",{style:{width:"100%",display:"flex",gap:12,flexDirection:"row"},className:"jsx-14a62d28233e1b8c",children:[i.jsx(c.ZP,{block:!0,size:"large",onClick:x,disabled:g,style:{border:"none",background:"#f5f5f5",color:"#595959",boxShadow:"none"},className:"hover-scale",children:l}),i.jsx(c.ZP,{block:!0,type:"primary",size:"large",onClick:m,loading:g,style:{background:S,border:"none",boxShadow:`0 8px 20px ${S}40`},className:"hover-scale",children:n})]})]}),i.jsx(a(),{id:"14a62d28233e1b8c",children:"@-webkit-keyframes float{0%{-webkit-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-5px);transform:translatey(-5px)}100%{-webkit-transform:translatey(0px);transform:translatey(0px)}}@-moz-keyframes float{0%{-moz-transform:translatey(0px);transform:translatey(0px)}50%{-moz-transform:translatey(-5px);transform:translatey(-5px)}100%{-moz-transform:translatey(0px);transform:translatey(0px)}}@-o-keyframes float{0%{-o-transform:translatey(0px);transform:translatey(0px)}50%{-o-transform:translatey(-5px);transform:translatey(-5px)}100%{-o-transform:translatey(0px);transform:translatey(0px)}}@keyframes float{0%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}50%{-webkit-transform:translatey(-5px);-moz-transform:translatey(-5px);-o-transform:translatey(-5px);transform:translatey(-5px)}100%{-webkit-transform:translatey(0px);-moz-transform:translatey(0px);-o-transform:translatey(0px);transform:translatey(0px)}}.hover-scale{-webkit-transition:-webkit-transform.2s cubic-bezier(.34,1.56,.64,1);-moz-transition:-moz-transform.2s cubic-bezier(.34,1.56,.64,1);-o-transition:-o-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-webkit-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-moz-transform.2s cubic-bezier(.34,1.56,.64,1);transition:-o-transform.2s cubic-bezier(.34,1.56,.64,1);transition:transform.2s cubic-bezier(.34,1.56,.64,1)}.hover-scale:active{-webkit-transform:scale(.96);-moz-transform:scale(.96);-ms-transform:scale(.96);-o-transform:scale(.96);transform:scale(.96)}@media(max-width:480px){.soft-confirm-modal .ant-modal-content{-webkit-border-radius:20px!important;-moz-border-radius:20px!important;border-radius:20px!important}}.soft-confirm-modal .ant-modal-content{-webkit-box-shadow:0 20px 50px rgba(0,0,0,.1)!important;-moz-box-shadow:0 20px 50px rgba(0,0,0,.1)!important;box-shadow:0 20px 50px rgba(0,0,0,.1)!important;padding:0!important}"})]})})}},13778:(e,t,r)=>{"use strict";r.d(t,{G:()=>c});var i=r(44976),s=r(20108),a=r(10119),n=r(17577),l=r(19211),o=r(52249),d=r(46752);function c(e){let{socket:t}=(0,n.useContext)(l.J),r=(0,i.NL)(),{data:c=[],isLoading:u,refetch:h}=(0,s.a)({queryKey:["orderQueue",e],queryFn:async()=>await o.e.getAll(void 0,e),staleTime:2e3}),p=(0,a.D)({mutationFn:e=>o.e.addToQueue(e),onSuccess:()=>{r.invalidateQueries({queryKey:["orderQueue"]}),d.ZP.success("เพิ่มออเดอร์เข้าคิวสำเร็จ")},onError:e=>{d.ZP.error(e.message||"ไม่สามารถเพิ่มออเดอร์เข้าคิวได้")}}),y=(0,a.D)({mutationFn:({id:e,data:t})=>o.e.updateStatus(e,t),onSuccess:()=>{r.invalidateQueries({queryKey:["orderQueue"]}),d.ZP.success("อัปเดตสถานะสำเร็จ")},onError:e=>{d.ZP.error(e.message||"ไม่สามารถอัปเดตสถานะได้")}}),m=(0,a.D)({mutationFn:e=>o.e.removeFromQueue(e),onSuccess:()=>{r.invalidateQueries({queryKey:["orderQueue"]}),d.ZP.success("ลบออกจากคิวสำเร็จ")},onError:e=>{d.ZP.error(e.message||"ไม่สามารถลบออกจากคิวได้")}}),x=(0,a.D)({mutationFn:()=>o.e.reorderQueue(),onSuccess:()=>{r.invalidateQueries({queryKey:["orderQueue"]}),d.ZP.success("จัดเรียงคิวใหม่สำเร็จ")},onError:e=>{d.ZP.error(e.message||"ไม่สามารถจัดเรียงคิวใหม่ได้")}});return{queue:c,isLoading:u,refetch:h,addToQueue:p.mutate,updateStatus:y.mutate,removeFromQueue:m.mutate,reorderQueue:x.mutate,isAdding:p.isPending,isUpdating:y.isPending,isRemoving:m.isPending,isReordering:x.isPending}}},80440:(e,t,r)=>{"use strict";r.d(t,{s:()=>a});var i=r(17577),s=r(19211);let a=()=>(0,i.useContext)(s.J)},31499:(e,t,r)=>{"use strict";r.d(t,{$:()=>n});var i=r(12529);let s=r(40820).q.POS.TABLES,a=(e,t="application/json")=>{let r={};return t&&(r["Content-Type"]=t),e&&(r.Cookie=e),r},n={getAll:async(e,t)=>{let r=(0,i.b)("GET",s),n=new URLSearchParams(t||"");n.has("page")||n.set("page","1"),n.has("limit")||n.set("limit","200");let l=n.toString();l&&(r+=`?${l}`);let o=a(e,""),d=await fetch(r,{cache:"no-store",headers:o,credentials:"include"});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return d.json()},getById:async(e,t)=>{let r=(0,i.b)("GET",`${s}/${e}`),n=a(t,""),l=await fetch(r,{cache:"no-store",headers:n,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return l.json()},getByName:async(e,t)=>{let r=(0,i.b)("GET",`${s}/getByName/${e}`),n=a(t,""),l=await fetch(r,{cache:"no-store",headers:n,credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to fetch tables")}return l.json()},create:async(e,t,r)=>{let n=(0,i.b)("POST",`${s}`),l=a(t);r&&(l["X-CSRF-Token"]=r);let o=await fetch(n,{method:"POST",headers:l,credentials:"include",body:JSON.stringify(e)});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to create table")}return o.json()},update:async(e,t,r,n)=>{let l=(0,i.b)("PUT",`${s}/${e}`),o=a(r);n&&(o["X-CSRF-Token"]=n);let d=await fetch(l,{method:"PUT",headers:o,credentials:"include",body:JSON.stringify(t)});if(!d.ok){let e=await d.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to update table")}return d.json()},delete:async(e,t,r)=>{let n=(0,i.b)("DELETE",`${s}/${e}`),l=a(t,"");r&&(l["X-CSRF-Token"]=r);let o=await fetch(n,{method:"DELETE",headers:l,credentials:"include"});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(e.error||e.message||"Failed to delete table")}}}},43822:(e,t,r)=>{"use strict";var i,s;r.d(t,{l:()=>i,t:()=>s}),function(e){e.Pending="Pending",e.Processing="Processing",e.Completed="Completed",e.Cancelled="Cancelled"}(i||(i={})),function(e){e.Low="Low",e.Normal="Normal",e.High="High",e.Urgent="Urgent"}(s||(s={}))},54354:(e,t,r)=>{"use strict";function i(e,t,r,i=e=>e.id,s=()=>!0){}function s({socket:e,events:t=[],onRefresh:r,intervalMs:i,enabled:s=!0,debounceMs:a}){}r.d(t,{D:()=>s,v:()=>i}),r(17577)},64538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\orders\[...ordersId]\page.tsx#default`)},10119:(e,t,r)=>{"use strict";r.d(t,{D:()=>c});var i=r(17577),s=r(71180),a=r(12113),n=r(64351),l=r(3341),o=class extends n.l{#e;#t=void 0;#r;#i;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,l.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.Ym)(t.mutationKey)!==(0,l.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#s(),this.#a()}mutate(e,t){return this.#i=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#s(){let e=this.#r?.state??(0,s.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#a(e){a.Vr.batch(()=>{if(this.#i&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#i.onSuccess?.(e.data,t,r,i)}catch(e){Promise.reject(e)}try{this.#i.onSettled?.(e.data,null,t,r,i)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#i.onError?.(e.error,t,r,i)}catch(e){Promise.reject(e)}try{this.#i.onSettled?.(void 0,e.error,t,r,i)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},d=r(44976);function c(e,t){let r=(0,d.NL)(t),[s]=i.useState(()=>new o(r,e));i.useEffect(()=>{s.setOptions(e)},[s,e]);let n=i.useSyncExternalStore(i.useCallback(e=>s.subscribe(a.Vr.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),c=i.useCallback((e,t)=>{s.mutate(e,t).catch(l.ZT)},[s]);if(n.error&&(0,l.L3)(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:c,mutateAsync:n.mutate}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[9276,8674,8571,8270,9345,108,6226,9042,1399,4658,8498],()=>r(96110));module.exports=i})();