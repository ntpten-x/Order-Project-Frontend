(()=>{var e={};e.id=1694,e.ids=[1694],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},61742:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>d,routeModule:()=>u,tree:()=>l}),r(15403),r(85429),r(58522),r(61804),r(7629),r(11930),r(12523);var s=r(23191),i=r(88716),a=r(43315),n=r(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let l=["",{children:["(main)",{children:["pos",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,15403)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\settings\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],d=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\settings\\page.tsx"],c="/(main)/pos/settings/page",p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/pos/settings/page",pathname:"/pos/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},50405:(e,t,r)=>{Promise.resolve().then(r.bind(r,76993))},12226:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var s=r(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};var a=r(74082);function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e}).apply(this,arguments)}let o=s.forwardRef((e,t)=>s.createElement(a.Z,n({},e,{ref:t,icon:i})))},76993:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var s=r(10326),i=r(17577),a=r(66874),n=r(97930),o=r(3861),l=r(46752),d=r(64635),c=r(71935),p=r(61357),u=r(49909),x=r(92442),g=r(56249),h=r(91377),m=r(80490),f=r(46024),b=r(72380),y=r(74215),j=r(12226),v=r(58029),P=r(24395),k=r(35047),Z=r(2175),w=r(33357),C=r(80440),_=r(54354),R=r(7670),q=r(26902),I=r(26963),S=r(76892),z=r(18978),A=r(52647),E=r(36231),B=r(83179),O=r(93922);let W={container:{minHeight:"100vh",background:O.X1.background,fontFamily:"var(--font-sans), 'Sarabun', sans-serif",paddingBottom:60},heroParams:{background:`linear-gradient(145deg, ${O.X1.primary} 0%, ${O.X1.primaryDark} 100%)`,padding:"20px 20px 60px",position:"relative",borderBottomLeftRadius:24,borderBottomRightRadius:24,boxShadow:"0 8px 24px rgba(99, 102, 241, 0.2)",zIndex:1,overflow:"hidden"},heroDecoCircle1:{position:"absolute",top:-60,right:-60,width:160,height:160,borderRadius:"50%",background:"rgba(255,255,255,0.08)"},heroDecoCircle2:{position:"absolute",bottom:-40,left:-40,width:120,height:120,borderRadius:"50%",background:"rgba(255,255,255,0.06)"},headerContent:{maxWidth:1e3,margin:"0 auto",position:"relative",zIndex:10},headerRow:{display:"flex",alignItems:"center",gap:16},backButton:{width:44,height:44,borderRadius:14,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,0.3)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},headerIconBox:{width:56,height:56,borderRadius:16,background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center"},sectionTitle:{display:"flex",alignItems:"center",gap:12,marginBottom:20,color:"#fff"},contentWrapper:{maxWidth:700,margin:"-40px auto 30px",padding:"0 20px",position:"relative",zIndex:20},card:{borderRadius:20,boxShadow:"0 4px 20px rgba(0,0,0,0.06)",border:"none"},activeAccountCard:{background:"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)",border:"1px solid #a7f3d0",borderRadius:16,padding:"20px",marginBottom:24},addButton:{borderRadius:14,height:52,fontSize:16,fontWeight:600,background:"#fff",border:`2px dashed ${O.X1.primary}`,color:O.X1.primary,transition:"all 0.2s ease"},dividerTitle:{fontSize:16,fontWeight:600},accountSelector:{border:"1px solid #e2e8f0",borderRadius:14,padding:"14px 18px",cursor:"pointer",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:56,transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},accountSelectorHover:{borderColor:O.X1.primary,boxShadow:`0 0 0 3px ${O.X1.primaryLight}`},modalAccountItem:{padding:"16px",border:"1px solid #e5e7eb",borderRadius:14,cursor:"pointer",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s ease"},modalAccountItemActive:{border:"2px solid #10b981",background:"#ecfdf5"},accountIconBox:{width:44,height:44,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center"}},{Text:F}=a.default,M=(e,t)=>{let r=e?.status,s=e?.code,i=e?.message||"",a=i.toLowerCase();return"DUPLICATE_ENTRY"===s||a.includes("duplicate")||a.includes("already exists")?a.includes("active")?"มีบัญชีหลักอยู่แล้ว กรุณาเปลี่ยนบัญชีหลักจากรายการ":"เลขพร้อมเพย์นี้ถูกใช้งานแล้ว กรุณาตรวจสอบและลองใหม่":409===r&&"DATABASE_ERROR"===s?"เกิดข้อผิดพลาดฐานข้อมูลจากฝั่งเซิร์ฟเวอร์ (ไม่ใช่เลขซ้ำ) กรุณาลองใหม่หรือตรวจสอบ backend":409===r?i||"เกิดข้อขัดแย้งของข้อมูล กรุณารีเฟรชแล้วลองใหม่":400===r?i||"ข้อมูลไม่ถูกต้อง กรุณาตรวจสอบอีกครั้ง":403===r?"สิทธิ์ไม่เพียงพอ หรือ CSRF token หมดอายุ กรุณารีเฟรชหน้าแล้วลองใหม่":404===r?"ไม่พบบัญชีที่ต้องการใช้งาน":i||t};function $({label:e,value:t,color:r}){return(0,s.jsxs)("div",{style:{borderRadius:14,border:"1px solid #e2e8f0",background:"#fff",padding:12,textAlign:"center"},children:[s.jsx("div",{style:{fontSize:24,fontWeight:700,color:r},children:t}),s.jsx(F,{type:"secondary",style:{fontSize:12},children:e})]})}function L({compact:e=!1}){return(0,s.jsxs)("div",{style:{display:"grid",gap:e?8:12},children:[s.jsx(n.Z.Input,{active:!0,block:!0,style:{height:e?30:36}}),s.jsx(n.Z.Input,{active:!0,block:!0,style:{height:e?30:36}}),s.jsx(n.Z.Button,{active:!0,block:!0,style:{height:e?40:44}})]})}function T(){let e=(0,k.useRouter)(),{socket:t}=(0,C.s)(),r=!o.default.useBreakpoint().md,{isAuthorized:a,isChecking:O}=(0,R.e)({allowedRoles:["Admin","Manager"]}),[T,X]=(0,i.useState)(!0),[D,H]=(0,i.useState)(!1),[G,N]=(0,i.useState)([]),[U,Y]=(0,i.useState)(null),[J,K]=(0,i.useState)(""),[Q,V]=(0,i.useState)("all"),ee=(0,i.useCallback)(async(e=!1)=>{try{e?H(!0):X(!0);let t=await Z.p.getByShopId();N(t)}catch(e){console.error(e),l.ZP.error(M(e,"ไม่สามารถดึงข้อมูลบัญชีพร้อมเพย์ได้"))}finally{e?H(!1):X(!1)}},[]);(0,_.D)({socket:t,events:[B.b.paymentAccounts.create,B.b.paymentAccounts.update,B.b.paymentAccounts.delete],onRefresh:()=>ee(!0),intervalMs:3e4});let et=(0,i.useMemo)(()=>G.filter(e=>"PromptPay"===e.account_type),[G]),er=(0,i.useMemo)(()=>et.find(e=>e.is_active)||null,[et]),es=(0,i.useMemo)(()=>{let e=et.length,t=et.filter(e=>e.is_active).length;return{total:e,active:t,inactive:e-t}},[et]),ei=(0,i.useMemo)(()=>{let e=et;"active"===Q?e=e.filter(e=>e.is_active):"inactive"===Q&&(e=e.filter(e=>!e.is_active));let t=J.trim().toLowerCase();return t&&(e=e.filter(e=>e.account_name.toLowerCase().includes(t)||e.account_number.toLowerCase().includes(t))),e},[et,Q,J]),ea=async(e,t)=>{Y(e);try{let r=await (0,w.P)();await Z.p.activate(e,void 0,void 0,r),l.ZP.success(`ตั้ง "${t}" เป็นบัญชีหลักสำเร็จ`),await ee(!0)}catch(e){console.error(e),l.ZP.error(M(e,"ไม่สามารถเปลี่ยนบัญชีหลักได้"))}finally{Y(null)}};return O?s.jsx(q.H,{message:"กำลังตรวจสอบสิทธิ์..."}):a?(0,s.jsxs)("div",{style:W.container,children:[s.jsx(A.Z,{title:"ตั้งค่าบัญชีพร้อมเพย์",subtitle:"กำหนดบัญชีหลักและจัดการช่องทางรับชำระด้วยพร้อมเพย์",icon:s.jsx(h.Z,{}),onBack:()=>e.back(),actions:(0,s.jsxs)(d.Z,{size:8,wrap:!0,children:[s.jsx(c.ZP,{icon:s.jsx(m.Z,{}),onClick:()=>ee(!1),loading:D||T}),s.jsx(c.ZP,{icon:s.jsx(f.Z,{}),onClick:()=>e.push("/pos/settings/payment-accounts/manage"),children:"จัดการทั้งหมด"}),s.jsx(c.ZP,{type:"primary",icon:s.jsx(b.Z,{}),onClick:()=>e.push("/pos/settings/payment-accounts/add"),children:"เพิ่มพร้อมเพย์"})]})}),s.jsx(I.Z,{maxWidth:1040,children:(0,s.jsxs)(z.Z,{children:[s.jsx(S.Z,{title:"ภาพรวมบัญชีพร้อมเพย์",children:T?s.jsx(L,{compact:r}):(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:r?"repeat(2, minmax(0, 1fr))":"repeat(3, minmax(0, 1fr))",gap:r?8:10},children:[s.jsx($,{label:"ทั้งหมด",value:es.total,color:"#1e293b"}),s.jsx($,{label:"บัญชีหลัก",value:es.active,color:"#16a34a"}),s.jsx($,{label:"ไม่ใช้งาน",value:es.inactive,color:"#b91c1c"})]})}),s.jsx(S.Z,{title:"บัญชีหลักปัจจุบัน",children:T?s.jsx(L,{compact:r}):er?(0,s.jsxs)("div",{style:{borderRadius:14,border:"1px solid #bbf7d0",background:"#f0fdf4",padding:r?10:14,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0},children:[s.jsx("div",{style:{width:r?38:44,height:r?38:44,borderRadius:10,background:"#fdf2f8",color:"#db2777",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(y.Z,{})}),(0,s.jsxs)("div",{style:{minWidth:0},children:[s.jsx(F,{strong:!0,style:{display:"block"},children:er.account_name}),s.jsx(F,{type:"secondary",style:{fontSize:12},children:er.account_number}),(0,s.jsxs)("div",{style:{marginTop:6,display:"flex",alignItems:"center",gap:6},children:[(0,s.jsxs)(p.Z,{color:"green",style:{margin:0,borderRadius:6},children:[s.jsx(j.Z,{})," บัญชีหลัก"]}),s.jsx(p.Z,{style:{margin:0,borderRadius:6},children:"พร้อมเพย์"})]})]})]}),s.jsx(c.ZP,{icon:s.jsx(v.Z,{}),onClick:()=>e.push("/pos/settings/payment-accounts/manage"),children:"เปลี่ยนบัญชีหลัก"})]}):s.jsx(E.Z,{title:"ยังไม่มีบัญชีพร้อมเพย์หลัก",description:"เพิ่มบัญชีพร้อมเพย์แรกเพื่อเริ่มใช้งานการรับชำระ",action:s.jsx(c.ZP,{type:"primary",icon:s.jsx(b.Z,{}),onClick:()=>e.push("/pos/settings/payment-accounts/add"),children:"เพิ่มบัญชีแรก"})})}),s.jsx(S.Z,{title:"ค้นหาและตัวกรอง",children:T?s.jsx(L,{compact:r}):(0,s.jsxs)("div",{style:{display:"grid",gap:r?8:10},children:[s.jsx(u.default,{size:r?"middle":"large",prefix:s.jsx(P.Z,{style:{color:"#94a3b8"}}),placeholder:"ค้นหาจากชื่อบัญชี หรือเลขพร้อมเพย์...",allowClear:!0,value:J,onChange:e=>K(e.target.value)}),s.jsx(x.Z,{options:[{label:`ทั้งหมด (${et.length})`,value:"all"},{label:`ใช้งาน (${es.active})`,value:"active"},{label:`ไม่ใช้งาน (${es.inactive})`,value:"inactive"}],block:r,size:r?"small":"middle",value:Q,onChange:e=>V(e)})]})}),s.jsx(S.Z,{title:"รายการบัญชีพร้อมเพย์",extra:s.jsx("span",{style:{fontWeight:600},children:ei.length}),children:T?s.jsx("div",{style:{display:"grid",gap:r?8:10},children:Array.from({length:3}).map((e,t)=>s.jsx(g.Z,{size:"small",style:{borderRadius:12},children:s.jsx(n.Z,{active:!0,paragraph:{rows:1},title:{width:"60%"}})},t))}):ei.length>0?s.jsx("div",{style:{display:"grid",gap:r?8:10},children:ei.map(t=>(0,s.jsxs)("div",{style:{borderRadius:14,border:`1px solid ${t.is_active?"#86efac":"#e2e8f0"}`,background:t.is_active?"#f0fdf4":"#fff",padding:r?10:12,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,minWidth:0},children:[s.jsx("div",{style:{width:r?34:38,height:r?34:38,borderRadius:10,background:"#fdf2f8",color:"#db2777",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(y.Z,{})}),(0,s.jsxs)("div",{style:{minWidth:0},children:[s.jsx(F,{strong:!0,style:{display:"block"},children:t.account_name}),s.jsx(F,{type:"secondary",style:{fontSize:12},children:t.account_number})]})]}),(0,s.jsxs)(d.Z,{size:8,wrap:!0,children:[s.jsx(p.Z,{color:t.is_active?"green":"default",style:{borderRadius:6,margin:0},children:t.is_active?"บัญชีหลัก":"พร้อมเพย์"}),t.is_active?null:s.jsx(c.ZP,{type:"primary",size:"small",loading:U===t.id,onClick:()=>ea(t.id,t.account_name),children:"ตั้งเป็นบัญชีหลัก"}),s.jsx(c.ZP,{size:"small",onClick:()=>e.push(`/pos/settings/payment-accounts/edit/${t.id}`),children:"แก้ไข"})]})]},t.id))}):s.jsx(E.Z,{title:J.trim()?"ไม่พบบัญชีตามคำค้น":"ยังไม่มีบัญชีพร้อมเพย์",description:J.trim()?"ลองเปลี่ยนคำค้นหาหรือตัวกรอง":"เพิ่มบัญชีพร้อมเพย์เพื่อเริ่มใช้งานการชำระเงิน",action:J.trim()?null:s.jsx(c.ZP,{type:"primary",icon:s.jsx(b.Z,{}),onClick:()=>e.push("/pos/settings/payment-accounts/add"),children:"เพิ่มบัญชีพร้อมเพย์"})})})]})})]}):s.jsx(q.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},15403:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\settings\page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,4421,8571,1742,8963,1399,4658,4287],()=>r(61742));module.exports=s})();