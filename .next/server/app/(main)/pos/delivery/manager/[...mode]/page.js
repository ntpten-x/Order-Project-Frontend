(()=>{var e={};e.id=6834,e.ids=[6834],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},2974:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.Z,__next_app__:()=>p,originalPathname:()=>c,pages:()=>d,routeModule:()=>u,tree:()=>l}),t(90796),t(85429),t(58522),t(61804),t(7629),t(11930),t(12523);var s=t(23191),i=t(88716),a=t(43315),o=t(95231),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);t.d(r,n);let l=["",{children:["(main)",{children:["pos",{children:["delivery",{children:["manager",{children:["[...mode]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,90796)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\delivery\\manager\\[...mode]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,85429)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58522)),"E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,61804)),"E:\\Project\\Order-Project-Frontend\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"E:\\Project\\Order-Project-Frontend\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"E:\\Project\\Order-Project-Frontend\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"E:\\Project\\Order-Project-Frontend\\src\\app\\not-found.tsx"]}],d=["E:\\Project\\Order-Project-Frontend\\src\\app\\(main)\\pos\\delivery\\manager\\[...mode]\\page.tsx"],c="/(main)/pos/delivery/manager/[...mode]/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/pos/delivery/manager/[...mode]/page",pathname:"/pos/delivery/manager/[...mode]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},25122:(e,r,t)=>{Promise.resolve().then(t.bind(t,36693))},2643:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});var s=t(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};var a=t(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e}).apply(this,arguments)}let n=s.forwardRef((e,r)=>s.createElement(a.Z,o({},e,{ref:r,icon:i})))},16771:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});var s=t(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"};var a=t(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e}).apply(this,arguments)}let n=s.forwardRef((e,r)=>s.createElement(a.Z,o({},e,{ref:r,icon:i})))},41684:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});var s=t(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"};var a=t(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e}).apply(this,arguments)}let n=s.forwardRef((e,r)=>s.createElement(a.Z,o({},e,{ref:r,icon:i})))},30278:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});var s=t(17577);let i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};var a=t(74082);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e}).apply(this,arguments)}let n=s.forwardRef((e,r)=>s.createElement(a.Z,o({},e,{ref:r,icon:i})))},36693:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>I});var s=t(10326),i=t(17577),a=t(66874),o=t(71209),n=t(74944),l=t(43359),d=t(46752),c=t(75958),p=t(71935),u=t(92121),x=t(4139),h=t(38106),g=t(56249),y=t(49909),m=t(63459),f=t(35047),v=t(26963),j=t(76892),b=t(52647),P=t(71696),_=t(56811),Z=t(63191),w=t(10907),F=t(41684),E=t(30278),O=t(16771);t(33357);var S=t(7670),k=t(26902),q=t(86230);let{Title:z,Text:C}=a.default,R=e=>{if(!e)return"-";let r=new Date(e);return Number.isNaN(r.getTime())?"-":new Intl.DateTimeFormat("th-TH",{dateStyle:"medium",timeStyle:"short"}).format(r)},B=({deliveryName:e,deliveryPrefix:r,logo:t,isActive:i})=>(0,s.jsxs)("div",{style:{background:"white",borderRadius:20,padding:20,boxShadow:"0 10px 30px rgba(0,0,0,0.05)",border:"1px solid #F1F5F9"},children:[s.jsx(z,{level:5,style:{color:"#0891B2",marginBottom:16,fontWeight:700},children:"ตัวอย่างการแสดงผล"}),(0,s.jsxs)("div",{style:{borderRadius:16,border:`1px solid ${i?"#a5f3fc":"#e2e8f0"}`,padding:14,background:i?"#ecfeff":"#f8fafc",display:"flex",alignItems:"center",gap:12,marginBottom:16},children:[s.jsx(o.Z,{shape:"square",size:48,src:t||void 0,icon:s.jsx(P.Z,{}),style:{borderRadius:12,background:i?"linear-gradient(135deg, #cffafe 0%, #a5f3fc 100%)":"#e2e8f0",color:i?"#0891B2":"#64748b"}}),(0,s.jsxs)("div",{style:{textAlign:"left",flex:1},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx(C,{strong:!0,style:{fontSize:16,color:"#0f172a"},children:e||"ชื่อช่องทางจัดส่ง"}),i&&s.jsx(_.Z,{style:{color:"#10B981",fontSize:14}})]}),(0,s.jsxs)(C,{type:"secondary",style:{fontSize:13,display:"block"},children:["Prefix: ",r||"-"]})]})]}),s.jsx(n.Z,{type:i?"success":"warning",showIcon:!0,message:i?"ช่องทางนี้พร้อมใช้งานในหน้า POS":"ช่องทางนี้จะไม่แสดงให้เลือกใช้งาน"})]});function I({params:e}){let r=(0,f.useRouter)(),[t]=l.Z.useForm(),[a,o]=(0,i.useState)(!1),[P,_]=(0,i.useState)(!1),[I,T]=(0,i.useState)(""),[M,L]=(0,i.useState)(""),[A,V]=(0,i.useState)(""),[N,H]=(0,i.useState)(!0),[W,U]=(0,i.useState)(""),[$,G]=(0,i.useState)(null),[D,X]=(0,i.useState)(""),J=e.mode?.[0],Y=e.mode?.[1]||null,K="edit"===J&&!!Y,{isAuthorized:Q,isChecking:ee}=(0,S.e)({allowedRoles:["Admin","Manager"]}),er=(0,i.useMemo)(()=>K?"แก้ไขช่องทางจัดส่ง":"เพิ่มช่องทางจัดส่ง",[K]);(0,i.useCallback)(async()=>{if(Y){o(!0);try{let e=await fetch(`/api/pos/delivery/getById/${Y}`);if(!e.ok)throw Error("ไม่สามารถดึงข้อมูลช่องทางจัดส่งได้");let r=await e.json();t.setFieldsValue({delivery_name:r.delivery_name,delivery_prefix:r.delivery_prefix,logo:r.logo,is_active:r.is_active}),T(r.delivery_name||""),L(r.delivery_prefix||""),V(r.logo||""),H(!!r.is_active),X((r.delivery_name||"").toLowerCase()),G(r)}catch(e){console.error(e),d.ZP.error("ไม่สามารถดึงข้อมูลช่องทางจัดส่งได้"),r.replace("/pos/delivery")}finally{o(!1)}}},[Y,t,r]);let et=(0,i.useCallback)(async e=>{let r=e.trim();if(!r||K&&r.toLowerCase()===D)return!1;try{let e=await fetch(`/api/pos/delivery/getByName/${encodeURIComponent(r)}`);if(!e.ok)return!1;let t=await e.json();if(!t?.id||K&&t.id===Y)return!1;return!0}catch{return!1}},[D,Y,K]),es=async e=>{_(!0);try{let t={delivery_name:e.delivery_name.trim(),delivery_prefix:e.delivery_prefix?.trim().toUpperCase()||void 0,logo:e.logo?.trim()||void 0,is_active:e.is_active},s=K?`/api/pos/delivery/update/${Y}`:"/api/pos/delivery/create",i=K?"PUT":"POST",a=await fetch(s,{method:i,headers:{"Content-Type":"application/json","X-CSRF-Token":W},body:JSON.stringify(t)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.error||e.message||(K?"ไม่สามารถอัปเดตช่องทางจัดส่งได้":"ไม่สามารถสร้างช่องทางจัดส่งได้"))}d.ZP.success(K?"อัปเดตช่องทางจัดส่งสำเร็จ":"สร้างช่องทางจัดส่งสำเร็จ"),r.push("/pos/delivery")}catch(e){console.error(e),d.ZP.error(e instanceof Error?e.message:"ไม่สามารถบันทึกข้อมูลได้")}finally{_(!1)}},ei=()=>r.push("/pos/delivery");return ee?s.jsx(k.H,{message:"กำลังตรวจสอบสิทธิ์..."}):Q?(0,s.jsxs)("div",{className:"manage-page",style:q.R.container,children:[s.jsx(b.Z,{title:er,subtitle:K?"ปรับแก้ชื่อ Prefix รูปโลโก้ และสถานะการใช้งาน":"สร้างช่องทางจัดส่งใหม่ให้พร้อมใช้งานในระบบ POS",onBack:ei,actions:K?s.jsx(p.ZP,{danger:!0,onClick:()=>{Y&&c.Z.confirm({title:"ยืนยันการลบช่องทางจัดส่ง",content:`คุณต้องการลบช่องทางจัดส่ง "${I||"-"}" หรือไม่?`,okText:"ลบ",okType:"danger",cancelText:"ยกเลิก",centered:!0,icon:s.jsx(Z.Z,{style:{color:"#EF4444"}}),onOk:async()=>{try{if(!(await fetch(`/api/pos/delivery/delete/${Y}`,{method:"DELETE",headers:{"X-CSRF-Token":W}})).ok)throw Error("ไม่สามารถลบช่องทางจัดส่งได้");d.ZP.success("ลบช่องทางจัดส่งสำเร็จ"),r.push("/pos/delivery")}catch(e){console.error(e),d.ZP.error("ไม่สามารถลบช่องทางจัดส่งได้")}}})},icon:s.jsx(Z.Z,{}),children:"ลบ"}):null}),s.jsx(v.Z,{maxWidth:1040,children:s.jsx(j.Z,{style:{background:"transparent",border:"none"},children:a?s.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"90px 0"},children:s.jsx(u.Z,{size:"large",tip:"กำลังโหลดข้อมูล..."})}):(0,s.jsxs)(x.Z,{gutter:[20,20],children:[s.jsx(h.Z,{xs:24,lg:15,children:(0,s.jsxs)(g.Z,{bordered:!1,style:{borderRadius:20,boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},styles:{body:{padding:24}},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:20},children:[s.jsx(w.Z,{style:{fontSize:20,color:"#0891B2"}}),s.jsx(z,{level:5,style:{margin:0},children:"ข้อมูลช่องทางจัดส่ง"})]}),(0,s.jsxs)(l.Z,{form:t,layout:"vertical",onFinish:es,requiredMark:!1,autoComplete:"off",initialValues:{is_active:!0},onValuesChange:e=>{void 0!==e.delivery_name&&T(e.delivery_name),void 0!==e.delivery_prefix&&L(e.delivery_prefix),void 0!==e.logo&&V(e.logo),void 0!==e.is_active&&H(e.is_active)},children:[s.jsx(l.Z.Item,{name:"delivery_name",label:s.jsx("span",{style:{fontWeight:600,color:"#334155"},children:"ชื่อระบบ (delivery_name)"}),validateTrigger:["onBlur","onSubmit"],rules:[{required:!0,message:"กรุณากรอกชื่อระบบ"},{max:100,message:"ความยาวต้องไม่เกิน 100 ตัวอักษร"},{validator:async(e,r)=>{if(r?.trim()&&await et(r))throw Error("ชื่อระบบนี้ถูกใช้งานแล้ว")}}],children:s.jsx(y.default,{size:"large",placeholder:"เช่น GrabFood, LINE MAN, ShopeeFood",style:{borderRadius:12,height:46,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:100})}),s.jsx(l.Z.Item,{name:"delivery_prefix",label:s.jsx("span",{style:{fontWeight:600,color:"#334155"},children:"Prefix"}),rules:[{max:10,message:"ความยาวต้องไม่เกิน 10 ตัวอักษร"},{pattern:/^[A-Za-z0-9_-]*$/,message:"กรอกได้เฉพาะตัวอักษรภาษาอังกฤษ ตัวเลข _ และ -"}],children:s.jsx(y.default,{size:"large",placeholder:"เช่น GF, LM",style:{borderRadius:12,height:46,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0",textTransform:"uppercase"},maxLength:10})}),s.jsx(l.Z.Item,{name:"logo",label:s.jsx("span",{style:{fontWeight:600,color:"#334155"},children:"URL โลโก้"}),rules:[{validator:async(e,r)=>{if(r?.trim())try{new URL(r.trim())}catch{throw Error("กรุณากรอก URL ที่ถูกต้อง")}}}],children:s.jsx(y.default,{size:"large",placeholder:"https://example.com/logo.png",style:{borderRadius:12,height:46,backgroundColor:"#F8FAFC",border:"1px solid #E2E8F0"},maxLength:255})}),s.jsx("div",{style:{padding:"16px",background:"#F8FAFC",borderRadius:14,marginTop:16,marginBottom:18},children:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[(0,s.jsxs)("div",{children:[s.jsx(C,{strong:!0,style:{fontSize:15,display:"block"},children:"สถานะการใช้งาน"}),s.jsx(C,{type:"secondary",style:{fontSize:13},children:"เปิดเพื่อให้แสดงในหน้า POS ที่เกี่ยวข้องกับเดลิเวอรี่"})]}),s.jsx(l.Z.Item,{name:"is_active",valuePropName:"checked",noStyle:!0,children:s.jsx(m.Z,{style:{background:N?"#10B981":void 0}})})]})}),s.jsx(n.Z,{showIcon:!0,type:"info",icon:s.jsx(F.Z,{}),message:"ข้อมูลที่จำเป็น",description:"ต้องกรอกชื่อระบบ และควรกำหนด Prefix ให้สั้นเพื่อใช้อ้างอิงรหัสออเดอร์",style:{marginBottom:24}}),(0,s.jsxs)("div",{style:{marginTop:12,display:"flex",gap:12},children:[s.jsx(p.ZP,{size:"large",onClick:ei,style:{flex:1,borderRadius:12,height:46,fontWeight:600},children:"ยกเลิก"}),s.jsx(p.ZP,{type:"primary",htmlType:"submit",loading:P,icon:s.jsx(E.Z,{}),style:{flex:2,borderRadius:12,height:46,fontWeight:600,background:"#0891B2",boxShadow:"0 4px 12px rgba(8, 145, 178, 0.25)"},children:"บันทึกข้อมูล"})]})]})]})}),s.jsx(h.Z,{xs:24,lg:9,children:(0,s.jsxs)("div",{style:{display:"grid",gap:14},children:[s.jsx(B,{deliveryName:I,deliveryPrefix:M,logo:A,isActive:N}),K?(0,s.jsxs)(g.Z,{style:{borderRadius:16},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:10},children:[s.jsx(O.Z,{style:{color:"#0369a1"}}),s.jsx(C,{strong:!0,children:"รายละเอียดรายการ"})]}),(0,s.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,s.jsxs)(C,{type:"secondary",children:["ID: ",$?.id||"-"]}),(0,s.jsxs)(C,{type:"secondary",children:["สร้างเมื่อ: ",R($?.create_date)]}),(0,s.jsxs)(C,{type:"secondary",children:["อัปเดตเมื่อ: ",R($?.update_date)]})]})]}):null]})})]})})})]}):s.jsx(k.H,{message:"คุณไม่มีสิทธิ์เข้าถึงหน้านี้",tone:"danger"})}},86230:(e,r,t)=>{"use strict";t.d(r,{R:()=>i,W:()=>a});var s=t(44528);let i={...(0,s.yf)("linear-gradient(135deg, #06B6D4 0%, #0891B2 100%)"),deliveryCard:s.YO,deliveryCardInner:s.lv},a=(0,s.IU)(".delivery-page",".delivery-card")},90796:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`E:\Project\Order-Project-Frontend\src\app\(main)\pos\delivery\manager\[...mode]\page.tsx#default`)}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,4421,8571,1742,8963,1399,4658,3849],()=>t(2974));module.exports=s})();