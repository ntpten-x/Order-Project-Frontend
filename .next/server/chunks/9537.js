exports.id=9537,exports.ids=[9537],exports.modules={62989:function(e){var t;t=function(){return function(e,t,r){e=e||{};var a=t.prototype,n={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function i(e,t,r,n){return a.fromToBase(e,t,r,n)}r.en.relativeTime=n,a.fromToBase=function(t,a,i,s,d){for(var o,l,u,c=i.$locale().relativeTime||n,y=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],m=y.length,p=0;p<m;p+=1){var v=y[p];v.d&&(o=s?r(t).diff(i,v.d,!0):i.diff(t,v.d,!0));var f=(e.rounding||Math.round)(Math.abs(o));if(u=o>0,f<=v.r||!v.r){f<=1&&p>0&&(v=y[p-1]);var h=c[v.l];d&&(f=d(""+f)),l="string"==typeof h?h.replace("%d",f):h(f,a,v.l,u);break}}if(a)return l;var g=u?c.future:c.past;return"function"==typeof g?g(l):g.replace("%s",l)},a.to=function(e,t){return i(e,t,this,!0)},a.from=function(e,t){return i(e,t,this)};var s=function(e){return e.$u?r.utc():r()};a.toNow=function(e){return this.to(s(this),e)},a.fromNow=function(e){return this.from(s(this),e)}}},e.exports=t()},36231:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(10326);r(17577);var n=r(56249),i=r(75698),s=r(66874),d=r(52386);function o({title:e="ไม่มีข้อมูล",description:t,action:r,image:o}){return a.jsx(n.Z,{size:"small",variant:"outlined",style:{borderRadius:d.H.cardRadiusLG},bodyStyle:{padding:20},children:a.jsx(i.Z,{image:o,description:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsx(s.default.Text,{strong:!0,children:e}),t?a.jsx(s.default.Text,{type:"secondary",children:t}):null]}),children:r})})}},80440:(e,t,r)=>{"use strict";r.d(t,{s:()=>i});var a=r(17577),n=r(19211);let i=()=>(0,a.useContext)(n.J)},10985:(e,t,r)=>{"use strict";var a;r.d(t,{c:()=>a}),function(e){e.Available="Available",e.Unavailable="Unavailable"}(a||(a={}))},2504:(e,t,r)=>{"use strict";r.d(t,{NE:()=>l,Th:()=>d,Do:()=>u,Yx:()=>c,Zu:()=>y,Oi:()=>o,W9:()=>i,Tf:()=>s});var a=r(10985),n=r(13976);function i(e){let t={total:e.length,available:0,occupied:0,inactive:0};return e.forEach(e=>{e.is_active?e.status===a.c.Available?t.available++:t.occupied++:t.inactive++}),t}function s(e){return[...e].sort((e,t)=>{let r=parseInt(e.table_name.replace(/\D/g,"")),a=parseInt(t.table_name.replace(/\D/g,""));return isNaN(r)||isNaN(a)?e.table_name.localeCompare(t.table_name):r-a})}function d(e){return e.filter(e=>e.is_active)}function o(e){return e.is_active?"WaitingForPayment"===e.active_order_status?"waitingForPayment":e.status===a.c.Available?"available":"occupied":"inactive"}function l(e){return e?({Pending:"กำลังดำเนินการ",Cooking:"กำลังปรุง",Served:"เสิร์ฟแล้ว",WaitingForOrder:"รอรับออเดอร์",WaitingForPayment:"รอชำระเงิน",Paid:"ชำระเงินแล้ว",Completed:"เสร็จสมบูรณ์",Cancelled:"ยกเลิก"})[e]||e:""}function u(e){return e.reduce((e,t)=>(e.total++,t.status===n.i.Pending&&e.pending++,t.status===n.i.Cooking&&e.cooking++,t.status===n.i.Served&&e.served++,e),{total:0,pending:0,cooking:0,served:0})}function c(e){switch(e.status){case n.i.Pending:case n.i.Cooking:return"occupied";case n.i.Served:return"waitingForPayment";case n.i.Paid:return"available";default:return"inactive"}}let y=e=>{switch(e){case n.m.DineIn:case"DineIn":return"/pos/channels/dine-in";case n.m.TakeAway:case"TakeAway":return"/pos/channels/takeaway";case n.m.Delivery:case"Delivery":return"/pos/channels/delivery";default:return"/pos/orders"}}},95963:(e,t,r)=>{"use strict";r.d(t,{EO:()=>D,Gs:()=>l,HL:()=>w,M9:()=>k,Nz:()=>f,OY:()=>s,Rr:()=>_,Wl:()=>i,d$:()=>P,d7:()=>o,iN:()=>y,jN:()=>v,ku:()=>g,mz:()=>u,qO:()=>c,s6:()=>d,xG:()=>p,yj:()=>b,zP:()=>m,zf:()=>x});var a=r(13976),n=r(10985);let i=e=>{if(e.status===n.c.Available)return`/pos/channels/dine-in/${e.id}`;let t=e.active_order_id||e.active_order?.id,r=e.active_order_status||e.active_order?.status;return t?r===a.i.WaitingForPayment?`/pos/items/payment/${t}`:`/pos/orders/${t}`:`/pos/channels/dine-in/${e.id}`},s=e=>{switch(e){case a.i.Pending:return"orange";case a.i.Cooking:return"blue";case a.i.Served:return"green";case a.i.Paid:return"cyan";case a.i.Cancelled:return"red";case a.i.WaitingForPayment:return"gold";default:if("cancelled"===String(e??"").trim().toLowerCase())return"red";return"default"}},d=e=>"cancelled"===String(e??"").trim().toLowerCase(),o=(e,t)=>{switch(e){case a.i.Pending:return"กำลังดำเนินการ";case a.i.Cooking:return"กำลังปรุง";case a.i.Served:if("TakeAway"===t||"Delivery"===t)return"ทำแล้ว";return"เสิร์ฟแล้ว";case a.i.Paid:return"ชำระเงินแล้ว";case a.i.Completed:return"สำเร็จ";case a.i.Cancelled:return"ยกเลิก";case a.i.WaitingForPayment:return"รอชำระเงิน";default:if(d(e))return"ยกเลิก";return e}},l=e=>{switch(e){case"DineIn":return"#722ed1";case"TakeAway":return"#fa8c16";case"Delivery":return"#eb2f96";default:return"#1890ff"}},u=e=>{switch(e){case"DineIn":return"ทานที่ร้าน";case"TakeAway":return"สั่งกลับบ้าน";case"Delivery":return"เดลิเวอรี่";default:return e}},c=e=>"DineIn"===e?"เสิร์ฟ":"ทำแล้ว",y=e=>"Delivery"===e?"จัดออเดอร์เสร็จแล้วพร้อมส่งให้ไรเดอร์":"DineIn"===e?"ยืนยันเสิร์ฟพร้อมชำระเงิน":"ยืนยันทำแล้วพร้อมชำระเงิน",m=e=>"DineIn"===e?"เสิร์ฟอาหารแล้ว":"ปรุงเสร็จแล้ว",p=e=>{let t="string"==typeof e?parseFloat(e):e;return`฿${Number(t).toLocaleString("th-TH",{minimumFractionDigits:0,maximumFractionDigits:2})}`},v=e=>"DineIn"===e.order_type?e.table?.table_name||"ไม่ระบุโต๊ะ":"Delivery"===e.order_type?e.delivery_code||e.delivery?.delivery_name||"ไม่ระบุข้อมูล":"TakeAway"===e.order_type?e.order_no||"ไม่ระบุเลขที่":e.order_no||"N/A",f=e=>(e??[]).filter(e=>!d(e.status)),h=e=>(e??[]).reduce((e,t)=>e+(Number(t.extra_price)||0),0),g=(e,t,r)=>((Number(e)||0)+h(r))*t,_=e=>f(e).reduce((e,t)=>{let r=t.product?.category?.display_name||"ไม่ระบุหมวด";return e[r]=(e[r]||0)+(t.quantity||0),e},{}),b=e=>f(e).reduce((e,t)=>e+Number(t.total_price||0),0),D=e=>"DineIn"===e.order_type?"/pos/channels/dine-in":"TakeAway"===e.order_type?"/pos/channels/takeaway":"Delivery"===e.order_type?"/pos/channels/delivery":"/pos/orders",w=e=>`/pos/orders/${e}`,k=e=>e.status===a.i.WaitingForPayment?e.order_type===a.m.Delivery?`/pos/items/delivery/${e.id}`:`/pos/items/payment/${e.id}`:`/pos/orders/${e.id}`,P=e=>e===a.m.Delivery?"/pos/channels/delivery":e===a.m.TakeAway?"/pos/channels/takeaway":e===a.m.DineIn?"/pos/channels/dine-in":"/pos/channels",x=(e,t,r,n)=>({order_no:n.orderNo||`ORD-${Date.now()}`,order_type:t,sub_total:r.subTotal,discount_amount:r.discountAmount,vat:0,total_amount:r.totalAmount,received_amount:0,change_amount:0,status:a.i.Pending,discount_id:n.discountId||null,payment_method_id:null,table_id:n.tableId||null,delivery_id:n.deliveryId||null,delivery_code:n.deliveryCode||null,items:e.map(e=>{let r=t===a.m.Delivery?Number(e.product.price_delivery??e.product.price):Number(e.product.price),n=(r+(e.details||[]).reduce((e,t)=>e+Number(t.extra_price),0))*e.quantity;return{product_id:e.product.id,quantity:e.quantity,price:r,total_price:n,discount_amount:0,notes:e.notes||"",status:a.i.Cooking,details:e.details||[]}})})},45317:(e,t,r)=>{"use strict";r.d(t,{w:()=>v});var a=r(17577),n=r(26859),i=r(13976),s=r(80440),d=r(54354),o=r(81711),l=r.n(o),u=r(83179);let c=new Set([i.i.Paid,i.i.Completed,i.i.Cancelled]),y=[i.i.Pending,i.i.Cooking,i.i.Served,i.i.WaitingForPayment].join(","),m=[u.b.orders.create,u.b.orders.update,u.b.orders.delete,u.b.payments.create,u.b.payments.update,u.b.salesOrderItem.create,u.b.salesOrderItem.update,u.b.salesOrderItem.delete,u.b.salesOrderDetail.create,u.b.salesOrderDetail.update,u.b.salesOrderDetail.delete],p=(e,t)=>e.filter(e=>e.order_type===t&&!c.has(e.status));function v({orderType:e,limit:t=100,page:r=1,statusFilter:i=y,enabled:o=!0,refreshIntervalMs:u=15e3,events:c=m}){let{socket:v}=(0,s.s)(),[f,h]=(0,a.useState)([]),[g,_]=(0,a.useState)(!0),b=(0,a.useCallback)(async(a=!1)=>{if(o){a||_(!0);try{let a=await n.x.getAllSummary(void 0,r,t,i,e),s=p(a.data||[],e);h(e=>l()(e,s)?e:s)}catch{}finally{a||_(!1)}}},[o,t,e,r,i]);return(0,d.D)({socket:v,events:c,onRefresh:()=>b(!0),intervalMs:u,enabled:o,debounceMs:800}),{orders:f,isLoading:g,refresh:b}}},54354:(e,t,r)=>{"use strict";function a(e,t,r,a=e=>e.id,n=()=>!0){}function n({socket:e,events:t=[],onRefresh:r,intervalMs:a,enabled:n=!0,debounceMs:i}){}r.d(t,{D:()=>n,v:()=>a}),r(17577)}};